---
ms.date: 09/10/2018
contributor: JKeithB
keywords: коллекции,powershell,командлет,psgallery
title: Управление ключами API
ms.openlocfilehash: 954eb27c25babdb8efe50c13caf5f2d287c6b3e3
ms.sourcegitcommit: e46b868f56f359909ff7c8230b1d1770935cce0e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2018
ms.locfileid: "45523157"
---
# <a name="managing-api-keys"></a>Управление ключами API

В коллекции PowerShell доступна возможность создания нескольких ключей API для поддержки ряда требований к публикации. Ключ API можно применять к одному или нескольким пакетам, он предоставляет определенные привилегии и имеет срок действия.

> [!IMPORTANT]
> Пользователи, которые выполняли публикацию в коллекцию PowerShell до появления ключей API с заданной областью действия, получат ключ API полного доступа. В ключах полного доступа отсутствуют усовершенствования системы безопасности, встроенные в ключи API с заданной областью. Ключи полного доступа имеют неограниченный срок действия и применяются ко всем элементам, принадлежащим пользователю. Удаленный ключ нельзя создать повторно.

Ниже показаны параметры, доступные при создании ключа API с заданной областью.

![Создание ключей API](../../Images/PSGallery_KeyScoped.png)

В этом примере создан ключ API с именем **AzureRMDataFactory**. Это значение ключа можно использовать для отправки пакетов, имена которых начинаются с AzureRM.DataFactory. Ключ действителен в течение 365 дней. Это типичный сценарий, когда разные команды в одной организации работают с разными пакетами. У членов группы есть ключ, который предоставляет им привилегии, необходимые для работы с определенным пакетом.
Поскольку ключ имеет ограниченный срок действия, использовать устаревшие или забытые ключи невозможно.

## <a name="using-glob-patterns"></a>Использование стандартных масок

При работе с несколькими пакетами можно использовать стандартные маски для сопоставления нескольких пакетов в виде группы. Разрешения ключа API применяются ко всем новым пакетам, соответствующим стандартной маске. Например, в предыдущем примере используется значение **стандартной маски** AzureRM.DataFactory *. С помощью этого ключа можно отправить пакет AzureRm.DataFactoryV2.Netcore, так как пакет соответствует стандартной маске.

## <a name="create-api-keys-securely"></a>Безопасное создание ключей API

В целях безопасности значение созданного ключа никогда не отображается на экране и доступно только с помощью кнопки копирования, как показано ниже.

![Получение нового значения ключа API](../../Images/PSGallery_CopyCreatedKey.png)

> [!IMPORTANT]
> Скопировать значение ключа API можно только сразу после его создания или обновления. Оно не будет отображается и будет недоступно после обновления страницы. В случае утери значения ключа необходимо воспользоваться кнопкой "Повторно создать" и скопировать ключ после его повторного создания.

## <a name="key-permissions-and-expiration"></a>Разрешения и срок действия ключа

Ключи API с заданной областью можно использовать для назначения следующих разрешений:

- отправка новых пакетов;
- отправка новых пакетов или обновление пакетов;
- удаление пакетов из списка.

Каждый новый ключ имеет срок действия. Значение срока действия измеряется в днях. Ниже приведены возможные значения срока действия.

- 1 день
- 90 дней
- 180 дней
- 270 дней
- 365 дней (по умолчанию)

После создания ключа эти параметры изменить невозможно. Нельзя создать ключ с неограниченным сроком действия.

## <a name="editing-and-deleting-existing-api-keys"></a>Изменение и удаление существующих ключей API

Можно изменить некоторые параметры существующего ключа. Как уже отмечалось, нельзя изменить область безопасности для существующего ключа API или изменить срок его действия. На следующем снимке экрана показаны изменяемые параметры.

![Получение нового значения ключа API](../../Images/PSGallery_EditAPIKey.png)

Чтобы изменить пакеты, управляемые с помощью ключа, можно выбрать отдельные пакеты в списке или изменить стандартную маску.

Нажмите кнопку **Повторно создать**, чтобы создать значение ключа. Так же, как при первоначальном создании ключа, необходимо **скопировать** значение ключа сразу же после его обновления. После закрытия этой страницы возможность **копирования** будет недоступна.

После нажатия кнопки **Удалить** появится сообщение с подтверждением. После удаления ключ будет непригоден для использования.

## <a name="key-expiration"></a>Окончание срока действия ключа

За десять дней до окончания срока действия коллекция PowerShell отправляет владельцу ключа API предупреждение. После окончания срока действия ключ будет непригоден для использования. Предупреждение с перечнем недействительных ключей отображается в верхней части страницы управления ключами API. Можно создать новое значение ключа.
