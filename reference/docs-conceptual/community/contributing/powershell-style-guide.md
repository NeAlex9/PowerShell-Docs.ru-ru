---
title: Руководство по стилю для документации PowerShell
description: В этой статье приводятся стилевые рекомендации для написания документации по PowerShell.
ms.date: 03/05/2020
ms.topic: conceptual
ms.openlocfilehash: 32df641f7cafa2a5bfcf1bcbf94be594aa77c7d0
ms.sourcegitcommit: 105c69ecedfe5180d8c12e8015d667c5f1a71579
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85837449"
---
# <a name="powershell-docs-style-guide"></a>Руководство по стилю для документации PowerShell

В этой статье представлено руководство по стилю для документации PowerShell. Эта статья основана на сведениях, указанных в разделе [Обзор](overview.md#get-started-writing-docs).

## <a name="product-terminology"></a>Терминология продукта

Существует несколько вариантов PowerShell.

- **PowerShell** — используется по умолчанию. Это понятие подразумевает PowerShell 7 и последующих версий.
- **PowerShell Core** — PowerShell на основе .NET Core. Понятие **Core** должно использоваться только в тех ситуациях, когда необходимо отличить PowerShell Core от Windows PowerShell.
- **Windows PowerShell** — PowerShell на основе .NET Framework. Windows PowerShell поставляется только в Windows, и для его работы требуется полная версия платформы .NET Framework.

  В общем случае ссылки на "Windows PowerShell" в документации можно изменить на "PowerShell".
  При обсуждении поведения, характерного для Windows PowerShell, нужно использовать термин "Windows PowerShell".

Связанные продукты

- **Visual Studio Code (VS Code)**  — это бесплатный редактор от Майкрософт с открытым кодом. При первом упоминании имя должно быть указано полностью. Затем можно использовать **VS Code**. Не используйте "VSCode".
- **Расширение PowerShell для Visual Studio Code** — это расширение делает VS Code предпочтительной интегрированной средой разработки для PowerShell. При первом упоминании имя должно быть указано полностью. Затем можно использовать термин **расширение PowerShell**.
- **Azure PowerShell** — это коллекция модулей PowerShell, используемых для управления службами Azure.
- **Azure Stack PowerShell** — это коллекция модулей PowerShell, используемых для управления гибридным облачным решением Майкрософт.

## <a name="markdown-specifics"></a>Особенности Markdown

В системе Microsoft Open Publishing System (OPS), лежащей в основе нашей документации, используется [markdig][] для обработки документов Markdown. Markdig анализирует документы на основе правил последней версии спецификации [CommonMark][].

Новая версия спецификации CommonMark является более строгой в отношении структуры некоторых элементов Markdown. Обратите особое внимание на сведения, приведенные в этом документе.

### <a name="blank-lines-spaces-and-tabs"></a>Пустые строки, пробелы и знаки табуляции

Пустые строки также обозначают конец блока в Markdown. Между блоками Markdown разных типов (например, между абзацем и списком или заголовком) должна быть одна пустая строка.

Удалите дублирующиеся пустые строки. Несколько пустых строк отображаются в виде одной пустой строки в формате HTML, поэтому указывать несколько пустых строк не требуется. Несколько пустых строк в блоке кода разбивают блок кода на фрагменты.

Удалите лишние пробелы в конце строк.

> [!NOTE]
> Промежутки очень важны в Markdown. Вместо символов табуляции всегда используйте пробелы. Пробелы в конце могут изменить способ отображения Markdown.

### <a name="titles-and-headings"></a>Заголовки

Используйте только [стиль заголовков с ATX][atx] (стиль #, а не стиль заголовков `=` или `-`).

- Используйте регистр обычных предложений: начинать с заглавной буквы следует только определенные существительные и заголовки
- Между `#` и первой буквой заголовка должен быть один пробел
- До и после заголовка необходимо указать по одной пустой строке
- В документе должен быть только один заголовок H1
- Уровни заголовков должны увеличиваться на единицу. Не пропускайте уровни
- Не используйте полужирный шрифт и другую разметку в заголовках

### <a name="limit-line-length-to-100-characters"></a>Ограничьте длину строки 100 символами

Это относится к концептуальным статьям и к справочнику по командлетам. Ограничение длины строки повышает удобочитаемость сравнения изменений и журнала Git. Кроме того, это упрощает изменение содержимого для других авторов.

Используйте расширение [Reflow Markdown][reflow] в Visual Studio Code, чтобы легко переформатировать абзацы в соответствии с заданной длиной строки.

Разделы "about" ограничены 80 символами. Дополнительные сведения см. в разделе [Форматирование файлов About_](./editing-cmdlet-ref.md#formatting-about_-files).

### <a name="lists"></a>Списки

Если список содержит несколько предложений или абзацев, используйте заголовки нижнего уровня, а не список.

До и после списка необходимо указать по одной пустой строке.

#### <a name="unordered-lists"></a>Неупорядоченные списки

Не ставьте в конце элементов списка точку (только если они не содержат несколько предложений). Используйте знак дефиса (`-`) для обозначения элементов списка. Это позволяет избежать путаницы с полужирной или курсивной разметкой, в которой используется звездочка [`*`]. Чтобы включить абзац или другие элементы в элемент маркированного списка, вставьте разрыв строки и выровняйте отступы с первым символом после маркера.

Пример:

```markdown
This is a list that contain sub-elements under a bullet item.

- First bullet item

  Sentence explaining the first bullet.

  - Sub-bullet item

    Sentence explaining the sub-bullet.

- Second bullet item
- Third bullet item
```

Это список, содержащий вложенные элементы в элементе маркированного списка.

- Первый элемент маркированного списка

  Предложение, объясняющее первый маркер.

  - Вложенный элемент маркированного списка

    Предложение, объясняющее вложенный элемент.

- Второй элемент маркированного списка
- Третий элемент маркированного списка

#### <a name="ordered-lists"></a>Упорядоченные списки

Чтобы включить абзац или другие элементы в элемент нумерованного списка, выровняйте отступы с первым символом после номера элемента. Для всех элементов нумерованного списка необходимо указать число `1.` вместо того, чтобы увеличивать номер каждого элемента вручную. Markdown увеличит значения автоматически при выводе. Это упрощает изменение порядка элементов и стандартизирует отступы для вложенного содержимого.

Пример:

```markdown
1. For the first element, insert a single space after the 1. Long sentences should be
   wrapped to the next line and must line up with the first character after the numbered
   list marker.

   To include a second element (like this one), insert a line break after the first
   and align indentations. The indentation of the second element must line up with
   the first character after the numbered list marker. For single digit items, like
   this one, you indent to column 4. For double digits items, for example item number
   10, you indent to column 5.

1. The next numbered item starts here.
```

Итоговый тест Markdown будет выведен следующим образом:

1. Для первого элемента добавьте один пробел после цифры 1. Длинные предложения необходимо переносить на следующую строку и выравнивать по первому символу после маркера нумерованного списка.

   Чтобы включить второй элемент (такой, как этот), вставьте разрыв строки после первого элемента и выровняйте отступы. Отступ второго элемента необходимо выравнивать с первым символом после маркера нумерованного списка. Для однозначных номеров элементов, таких как этот, необходимо осуществлять отступ по столбцу 4. Для двузначных номеров элементов, например, для элемента № 10, необходимо осуществлять отступ по столбцу 5.

1. Следующий элемент нумерованного списка начинается здесь.

### <a name="images"></a>Изображения

Для включения изображения используется следующий синтаксис:

```markdown
![[alt text]](<folderPath>)

Example:
![Introduction](./media/overview/Introduction.png)
```

Здесь `alt text` — краткое описание изображения, а `<folder path>` — относительный путь к изображению. Необходимо указать дополнительный текст для средств чтения с экрана для лиц с ослабленным зрением. Этот текст также пригодится при возникновении ошибки на сайте, из-за которой изображение не будет отображаться на экране.

Изображения должны храниться в папке `media/<article-name>` в подпапке, содержащей статью.
Изображения не должны одновременно использоваться в нескольких статьях. Создайте подпапку, соответствующую имени файла статьи, в папке `media`. Скопируйте изображения для этой статьи в созданную подпапку. Если изображение используется в нескольких статьях, необходимо скопировать это изображение в каждую подпапку с изображениями для соответствующей статьи. Это позволяет избежать ситуации, когда изменение изображения в одной статье влияет на другую статью.

Поддерживаются следующие типы файлов изображений: `*.png`, `*.gif`, `*.jpeg`, `*.jpg`, `*.svg`

### <a name="markdown-extensions-supported-by-open-publishing"></a>Расширения Markdown, поддерживаемые Open Publishing

[Пакет создания документации Майкрософт](/contribute/how-to-write-docs-auth-pack) содержит средства, которые поддерживают функции, уникальные для нашей системы публикации. Оповещения — это расширение Markdown для создания блочных цитат, которые отображаются на сайте docs.microsoft.com с цветовым оформлением и значками, указывающими на значимость содержимого. Поддерживаются следующие типы оповещений:

```markdown
> [!NOTE]
> Information the user should notice even if skimming.

> [!TIP]
> Optional information to help a user be more successful.

> [!IMPORTANT]
> Essential information required for user success.

> [!CAUTION]
> Negative potential consequences of an action.

> [!WARNING]
> Dangerous certain consequences of an action.
```

На сайте docs.microsoft.com эти оповещения выглядят следующим образом:

Блок примечаний

> [!NOTE]
> Информация, которую пользователь должен заметить даже при беглом чтении текста.

Блок советов

> [!TIP]
> Дополнительные сведения, которые могут пригодиться пользователю для успешного выполнения действия.

Блок "Важно!"

> [!IMPORTANT]
> Обязательные сведения, необходимые для успешного выполнения действия пользователем.

Блок "Внимание!"

> [!CAUTION]
> Возможные отрицательные последствия действия.

Блок "Предупреждение"

> [!WARNING]
> Определенные опасные последствия действия.

### <a name="hyperlinks"></a>Гиперссылки

- Гиперссылки должны использовать синтаксис Markdown `[friendlyname](url-or-path)`.
- По возможности следует использовать ссылки с HTTPS.
- Ссылки должны иметь понятное имя (обычно это заголовок соответствующего раздела)
- Все элементы в разделе "Связанные ссылки" в нижней части страницы должны быть оформлены как гиперссылки.
- Не используйте обратные кавычки, полужирный шрифт или другую разметку в квадратных скобках гиперссылки.
- Если речь идет о конкретном URI, можно использовать неоформленные URL-адреса. URI должен быть заключен в обратные кавычки. Пример:

  ```markdown
  By default, if you do not specify this parameter, the DMTF standard resource URI
  `http://schemas.dmtf.org/wbem/wscim/1/cim-schema/2/` is used and the class name is appended to it.
  ```

#### <a name="linking-to-other-content"></a>Ссылки на другое содержимое

Существует два типа гиперссылок, поддерживаемых системой публикации:

В качестве **URL-адреса** можно указать путь URL-адреса, который является относительным к корню сайта docs.microsoft.com. Также можно указать абсолютный URL-адрес в соответствии с синтаксисом полного URL-адреса. Например: `https:/github.com/MicrosoftDocs/PowerShell-Docs`

- Используйте URL-адреса для ссылки на содержимое, расположенное за пределами PowerShell, а также для ссылок между справкой по командлетам и абстрактными статьями в документации по PowerShell. Самый простой способ получить относительную ссылку — скопировать URL-адрес из браузера, а затем удалить `https://docs.microsoft.com/en-us` и вставить оставшуюся часть ссылки в Markdown.
- Не включайте языковой стандарт в URL-адреса страниц на сайтах Майкрософт (например, удалите `/en-us` из URL-адреса).
- Удалите ненужные параметры запроса из URL-адреса, если не требуется ссылка на определенную версию статьи. Примеры:
  - `?view=powershell-5.1` — используется для создания ссылки на определенную версию PowerShell.
  - `?redirectedfrom=MSDN` — добавляется к URL-адресу при перенаправлении из старой статьи в новое расположение.
- Во всех URL-адресах, указывающих на внешние веб-сайты, должен использоваться префикс HTTPS, если это возможно.

**Ссылка на файл** используется для создания ссылки из одной справочной статьи на другую или из одной ознакомительной статьи на другую. Если необходимо создать ссылку на справочную статью для определенной версии PowerShell, используйте URL-адрес.

- Ссылки на файлы содержат относительный путь к файлу (например, `../folder/file.md`)
- Во всех путях к файлам должна использоваться косая черта (`/`)

Создание глубинных ссылок разрешено как для URL-адресов, так и для ссылок на файлы. Добавьте привязку в конец целевого пути.
Пример:

- `[about_Splatting](about_Splatting.md#splatting-with-arrays)`
- `[custom key bindings](https://code.visualstudio.com/docs/getstarted/keybindings#_custom-keybindings-for-refactorings)`

Дополнительные сведения см. в статье [Использование ссылок в документации](/contribute/how-to-write-links).

## <a name="formatting-command-syntax-elements"></a>Элементы синтаксиса команды форматирования

- Всегда используйте полные имена командлетов и параметров. Старайтесь не использовать псевдонимы, если только вы не демонстрируете псевдоним специально.

- Свойство, параметр, объект, имена типов, имена классов, методы класса должны быть выделены **полужирным** шрифтом.
  - Значения свойств и параметров должны быть заключены в обратные кавычки (`` ` ``).
  - При указании типов в квадратных скобках используйте обратные кавычки. Например: `[System.Io.FileInfo]`

- Ключевые слова языка, имена командлетов, функции, переменные, собственные исполняемые файлы, пути к файлам и встроенные примеры синтаксиса должны быть заключены в символы обратных кавычек (`` ` ``).

  Пример:

  ~~~markdown
  The following code uses `Get-ChildItem` to list the contents of `C:\Windows` and assigns
  the output to the `$files` variable.

  ```powershell
  $files = Get-ChildItem C:\Windows
  ```
  ~~~

  - При ссылке на параметр по имени его имя должно быть выделено **полужирным** шрифтом. При демонстрации использования параметра с префиксом дефиса параметр должен быть заключен в обратные кавычки. Пример:

    ```markdown
    The parameter's name is **Name**, but it is typed as `-Name` when used on the command
    line as a parameter.
    ```

  - При демонстрации примера использования внешней команды этот пример должен быть заключен в обратные кавычки.
    Всегда включайте расширение файла в собственную команду. Пример:

    ```markdown
    To start the spooler service on a remote computer named DC01, you type `sc.exe \\DC01 start spooler`.
    ```

    Включение расширения файла гарантирует выполнение правильной команды в соответствии с очередностью команд PowerShell.

- При оформлении абстрактной статьи (в отличие от справочных материалов) представляйте первый экземпляр имени командлета в виде гиперссылки на документацию по командлетам. Не используйте обратные кавычки, полужирный шрифт или другую разметку в квадратных скобках гиперссылки.

  Пример:

  ```markdown
  This [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet
  uses the **Object** parameter to ...
  ```

  Дополнительные сведения см. в разделе [Гиперссылки](#hyperlinks) в этой статье.

## <a name="markdown-for-code-samples"></a>Markdown для примеров кода

Markdown поддерживает два различных стиля кода:

- **Фрагменты кода (встроенный код)**  — помечаются символом обратных кавычек (`` ` ``). Они используются внутри абзаца, а не в виде автономного блока.
- **Блоки кода** — это многострочный блок, заключенный в тройные обратные кавычки (`` ``` ``). В блоках кода после обратных кавычек также может быть указана метка языка. При указании метки языка включается подсветка синтаксиса для содержимого блока кода.

Все блоки кода должны находиться в границах кода. Ни в коем случае не используйте отступы для блоков кода. Markdown допускает использование такого шаблона, но это может вызвать проблемы, поэтому его следует избегать.

Блок кода — это одна или несколько строк кода, заключенных в тройные обратные кавычки (`` ``` ``).
Маркеры границ кода должны располагаться на отдельных строках до и после примера кода. Метка в начале блока кода может содержать метку языка. Система публикации Майкрософт Open Publishing System (OPS) использует метки языка для подсветки синтаксиса.

Полный список поддерживаемых тегов языков см. в разделе [Огороженные блоки кода](/contribute/code-in-docs#fenced-code-blocks) централизованного руководства для участников.

OPS также добавляет кнопку **Копировать**, которая копирует содержимое блока кода в буфер обмена. Это позволяет быстро вставить код в скрипт для тестирования примера кода. Однако не все примеры в нашей документации предназначены для выполнения без модификации. Некоторые блоки кода просто иллюстрируют концепцию PowerShell.

В нашей документации используются три типа блоков кода:

1. Блоки синтаксиса.
1. Иллюстративные примеры
1. Примеры для выполнения

### <a name="syntax-code-blocks"></a>Блоки кода синтаксиса

Блоки кода синтаксиса используются для описания синтаксической структуры команды. Не используйте тег языка в границе кода. В этом примере показаны все возможные параметры командлета `Get-Command`.

~~~markdown
```
Get-Command [-Verb <String[]>] [-Noun <String[]>] [-Module <String[]>]
  [-FullyQualifiedModule <ModuleSpecification[]>] [-TotalCount <Int32>] [-Syntax]
  [-ShowCommandInfo] [[-ArgumentList] <Object[]>] [-All] [-ListImported]
  [-ParameterName <String[]>] [-ParameterType <PSTypeName[]>] [<CommonParameters>]
```
~~~

В этом примере описана инструкция `for` с использованием обобщенных понятий:

~~~markdown
```
for (<init>; <condition>; <repeat>)
{<statement list>}
```
~~~

### <a name="illustrative-examples"></a>Иллюстративные примеры

Иллюстративные примеры используются для объяснения концепции PowerShell. Они не предназначены для копирования в буфер обмена с целью последующего выполнения. Они чаще всего используются для простых примеров, код которых прост для понимания и который легко набрать. Блок кода может включать в себя командную строку PowerShell и выходные данные примера.

Ниже приведен простой пример с операторами сравнения PowerShell. В данном случае не предполагается, что читатель будет копировать и запускать этот пример.

~~~markdown
```powershell
PS> 2 -eq 2
True

PS> 2 -eq 3
False

PS>  1,2,3 -eq 2
2

PS> "abc" -eq "abc"
True

PS> "abc" -eq "abc", "def"
False

PS> "abc", "def" -eq "abc"
abc
```
~~~

### <a name="executable-examples"></a>Примеры для выполнения

В сложных примерах и примерах, предназначенных для копирования и выполнения, должна использоваться следующая разметка с использованием обратных кавычек:

~~~markdown
```powershell
<Your PowerShell code goes here>
```
~~~

Выходные данные команд PowerShell необходимо заключить в блок кода **Выходные данные**, чтобы для них не выполнялась подсветка синтаксиса. Пример:

~~~markdown
```powershell
Get-Command -Module Microsoft.PowerShell.Security
```

```Output
CommandType  Name                        Version    Source
-----------  ----                        -------    ------
Cmdlet       ConvertFrom-SecureString    3.0.0.0    Microsoft.PowerShell.Security
Cmdlet       ConvertTo-SecureString      3.0.0.0    Microsoft.PowerShell.Security
Cmdlet       Get-Acl                     3.0.0.0    Microsoft.PowerShell.Security
Cmdlet       Get-AuthenticodeSignature   3.0.0.0    Microsoft.PowerShell.Security
Cmdlet       Get-CmsMessage              3.0.0.0    Microsoft.PowerShell.Security
Cmdlet       Get-Credential              3.0.0.0    Microsoft.PowerShell.Security
Cmdlet       Get-ExecutionPolicy         3.0.0.0    Microsoft.PowerShell.Security
Cmdlet       Get-PfxCertificate          3.0.0.0    Microsoft.PowerShell.Security
Cmdlet       New-FileCatalog             3.0.0.0    Microsoft.PowerShell.Security
Cmdlet       Protect-CmsMessage          3.0.0.0    Microsoft.PowerShell.Security
Cmdlet       Set-Acl                     3.0.0.0    Microsoft.PowerShell.Security
Cmdlet       Set-AuthenticodeSignature   3.0.0.0    Microsoft.PowerShell.Security
Cmdlet       Set-ExecutionPolicy         3.0.0.0    Microsoft.PowerShell.Security
Cmdlet       Test-FileCatalog            3.0.0.0    Microsoft.PowerShell.Security
Cmdlet       Unprotect-CmsMessage        3.0.0.0    Microsoft.PowerShell.Security
```
~~~

Метка кода **Выходные данные** не является официальным "языком", поддерживаемым системой подсветки синтаксиса.
Однако эта метка полезна, так как OPS добавляет метку "Выходные данные" в рамку блока кода на веб-странице. В блоке кода "Выходные данные" подсветка синтаксиса не выполняется.

## <a name="coding-style-rules"></a>Стилевые правила оформления кода

### <a name="avoid-line-continuation-in-code-samples"></a>Избегайте разрыва строк в примерах кода

Не используйте символы продолжения строки (`` ` ``) в примерах кода PowerShell. Эти символы трудно увидеть и могут вызвать проблемы, если в конце строки есть лишние пробелы.

- Используйте сплаттинг PowerShell, чтобы сократить длину строки для командлетов с большим количеством параметров.
- Используйте естественные возможности переноса строк в PowerShell, например, после символа вертикальной черты (`|`), открывающих фигурных скобок, круглых скобок и квадратных скобок.

### <a name="avoid-using-powershell-prompts-in-examples"></a>Избегайте использования командной строки PowerShell в примерах

Использование командной строки в примерах не рекомендуется и должно быть ограничено сценариями, предназначенными для иллюстрации использования командной строки. В большинстве этих примеров командная строка должна иметь вид `PS>`. Такая командная строка не зависит от характеристик конкретной ОС.

Командная строка требуется для примеров, иллюстрирующих команды, которые изменяют командную строку, или в тех случаях, когда отображаемый в командной строке путь важен для сценария, о котором идет речь. В следующем примере показано изменение командной строки при использовании поставщика реестра.

```powershell
PS C:\> cd HKCU:\System\
PS HKCU:\System\> dir

    Hive: HKEY_CURRENT_USER\System

Name                   Property
----                   --------
CurrentControlSet
GameConfigStore        GameDVR_Enabled                       : 1
                       GameDVR_FSEBehaviorMode               : 2
                       Win32_AutoGameModeDefaultProfile      : {2, 0, 1, 0...}
                       Win32_GameModeRelatedProcesses        : {1, 0, 1, 0...}
                       GameDVR_HonorUserFSEBehaviorMode      : 0
                       GameDVR_DXGIHonorFSEWindowsCompatible : 0
```

### <a name="do-not-use-aliases-in-examples"></a>Не используйте псевдонимы в примерах

Следует всегда использовать полные имена командлетов и параметров, если только речь не идет именно об этом псевдониме. При написании имен командлетов и параметров необходимо использовать нотацию в стиле Pascal.

### <a name="using-parameters-in-examples"></a>Использование параметров в примерах

Старайтесь не использовать позиционные параметры. В общем случае следует всегда включать в пример имя параметра, даже если параметр является позиционным. Это снижает вероятность путаницы в ваших примерах.

## <a name="next-steps"></a>Дальнейшие действия

[Редактирование справки по командлетам](editing-cmdlet-ref.md)

<!-- External URLs -->
[platyPS]: https://github.com/PowerShell/platyPS
[markdig]: https://github.com/lunet-io/markdig
[CommonMark]: https://spec.commonmark.org/
[atx]: https://github.github.com/gfm/#atx-headings
[pascal-case]: https://en.wikipedia.org/wiki/PascalCase
[reflow]: https://marketplace.visualstudio.com/items?itemName=marvhen.reflow-markdown
