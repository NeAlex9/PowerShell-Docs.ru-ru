---
title: Справочник по Windows PowerShell — новые возможности
ms.date: 09/13/2016
ms.topic: article
ms.openlocfilehash: 364d081ddf2f87ceeaa47732266a35f4a126246f
ms.sourcegitcommit: 52a67bcd9d7bf3e8600ea4302d1fa8970ff9c998
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/15/2019
ms.locfileid: "72366093"
---
# <a name="whats-new"></a>Новые возможности

Windows PowerShell 2,0 предоставляет следующие новые функции для использования при написании командлетов, поставщиков и ведущих приложений.

## <a name="modules"></a>Модули

Теперь вы можете упаковывать и распространять решения Windows PowerShell с помощью модулей. Модули позволяют секционировать, организовывать и систематизировать код Windows PowerShell в автономных, многократно используемых единицах. Дополнительные сведения о модулях см. в разделе Написание модуля Windows PowerShell.

## <a name="the-powershell-class"></a>Класс PowerShell

Класс PowerShell предоставляет более простое решение для создания приложений, называемое ведущими приложениями, которые программно выполняют команды. Этот класс позволяет создать конвейер команд, указать пространство выполнения, используемое для выполнения команд, и указать синхронный или асинхронный вызов команд.

## <a name="the-runspacepool-class"></a>Класс Рунспацепул

Пулы пространства выполнения позволяют создавать несколько пространств в одном вызове. Метод Креатерунспацепул предоставляет несколько перегрузок, которые можно использовать для создания пространств выполнения с такими же функциями, как узел, исходное состояние сеанса и сведения о соединении.

## <a name="the-initialsessionstate-class"></a>Класс InitialSessionState

Класс InitialSessionState позволяет создать конфигурацию состояния сеанса, которая используется при открытии пространства выполнения. Можно создать пользовательскую конфигурацию, конфигурацию по умолчанию, включающую команды, предоставляемые mshshort, и конфигурацию, команды которой ограничены в зависимости от возможностей сеанса.

## <a name="remote-runspaces"></a>Удаленные пространства выполнения

Теперь можно создавать пространства выполнения, которые могут быть открыты на удаленных компьютерах, что позволяет выполнять команды на удаленном компьютере и сохранять результаты локально. Чтобы создать удаленное пространство выполнения, необходимо указать сведения об удаленном подключении при создании пространства выполнения. Примеры см. в описании методов Креатерунспаце и Креатерунспацепул. Сведения о соединении определяются классом Рунспацеконнектионинфо.

## <a name="private-runspace-elements"></a>Закрытые элементы пространства выполнения

Теперь можно создавать пространства выполнения, элементы которых являются открытыми или закрытыми. Это позволяет создавать пространства выполнения, элементы которых доступны в пространстве, но недоступны пользователю. Сведения о том, какие элементы пространства выполнения могут быть сделаны частными, см. в описании класса Констраинедсессионстатинтри.

## <a name="runspace-threading-modes-and-apartment-state"></a>Режимы потоковой обработки пространства выполнения и состояние апартамента

Теперь можно указать, как потоки создаются и используются при выполнении команд в пространстве выполнения. См. свойства System. Management. Automation. пространства выполнения. Среадоптионс и System. Management. Automation. пространства. Рунспацепул. Среадоптионс.

Теперь можно получить состояние апартамента потоков, которые используются для выполнения команд в пространстве выполнения. См. свойства System. Management. Automation. пространства выполнения., заменяющих. ApartmentState и System. Management. Automation. пространства. Рунспацепул. ApartmentState.

## <a name="transaction-cmdlets"></a>Командлеты транзакций

Теперь можно создавать командлеты, которые можно использовать в транзакции. Если в транзакции используется командлет, его действия являются временными и могут быть приняты или отклонены командлетами транзакций, предоставляемыми Windows PowerShell.

Дополнительные сведения о транзакциях см. в разделе Поддержка транзакций.

## <a name="transaction-provider"></a>Поставщик транзакций

Теперь можно создавать поставщики, которые можно использовать в транзакции. Аналогично командлетам, когда поставщик используется в транзакции, его действия являются временными и могут быть приняты или отклонены командлетами транзакций, предоставляемыми Windows PowerShell.

Дополнительные сведения об указании поддержки транзакции в классе поставщика см. в описании свойства System. Management. Automation. Provider. Кмдлетпровидераттрибуте. Провидеркапабилитиес.

## <a name="job-cmdlets"></a>Командлеты заданий

Теперь можно написать командлеты, которые могут выполнять свои действия в качестве задания. Эти задания выполняются в фоновом режиме без взаимодействия с текущим сеансом. Дополнительные сведения о том, как Windows PowerShell поддерживает задания, см. в разделе фоновые задания.

## <a name="cmdlet-output-types"></a>Типы выходных данных командлета

Теперь можно указать типы .NET Framework, возвращаемые командлетами, путем объявления атрибута OutputType при записи командлетов. Это позволит другим определить тип объектов, возвращаемых командлетом, путем просмотра свойства OutputType командлета.

## <a name="event-support"></a>Поддержка событий

Теперь можно писать командлеты, которые добавляют и потребляют события. См. класс Псевент.

## <a name="proxy-commands"></a>Команды прокси-сервера

Теперь можно создавать команды прокси-сервера, которые можно использовать для выполнения другой команды. Команда прокси позволяет контролировать, какие функции исходного командлета доступны пользователю. Например, можно создать команду прокси-сервера, которая удаляет параметр, предоставленный исходной командой. См. класс Проксикомманд.

## <a name="multiple-choice-prompts"></a>Несколько запросов выбора

Теперь можно создавать приложения, которые могут предоставлять запросы, позволяющие пользователю выбрать несколько вариантов. См. интерфейс Ихостуисуппортсмултиплечоицеселектион

## <a name="interactive-sessions"></a>Интерактивные сеансы

Теперь можно создавать приложения, которые могут запускать и прекращать интерактивный сеанс на удаленном компьютере.
См. интерфейс Ихостсуппортсинтерактивесессион.

## <a name="custom-cmdlet-help-for-providers"></a>Справка по пользовательским командлетам для поставщиков

Теперь можно создавать настраиваемые разделы справки для командлетов поставщика. Разделы справки по пользовательским командлетам могут объяснить, как работает командлет в пути поставщика, и специальные функции, включая динамические параметры, которые поставщик добавляет в командлет.
