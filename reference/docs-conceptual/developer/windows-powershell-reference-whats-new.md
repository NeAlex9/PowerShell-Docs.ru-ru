---
ms.date: 09/13/2016
ms.topic: reference
title: Справочник по Windows PowerShell — новые возможности
description: Справочник по Windows PowerShell — новые возможности
ms.openlocfilehash: b6fa97eacd476f055dd0c69eed2e547c450b85e1
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "92647128"
---
# <a name="whats-new"></a><span data-ttu-id="9f192-103">What's New</span><span class="sxs-lookup"><span data-stu-id="9f192-103">What's New</span></span>

<span data-ttu-id="9f192-104">Windows PowerShell 2,0 предоставляет следующие новые функции для использования при написании командлетов, поставщиков и ведущих приложений.</span><span class="sxs-lookup"><span data-stu-id="9f192-104">Windows PowerShell 2.0 provides the following new features for use when writing cmdlets, providers, and host applications.</span></span>

## <a name="modules"></a><span data-ttu-id="9f192-105">Модули</span><span class="sxs-lookup"><span data-stu-id="9f192-105">Modules</span></span>

<span data-ttu-id="9f192-106">Теперь вы можете упаковывать и распространять решения Windows PowerShell с помощью модулей.</span><span class="sxs-lookup"><span data-stu-id="9f192-106">You can now package and distribute Windows PowerShell solutions by using modules.</span></span> <span data-ttu-id="9f192-107">Модули позволяют секционировать, организовывать и систематизировать код Windows PowerShell в автономных, многократно используемых единицах.</span><span class="sxs-lookup"><span data-stu-id="9f192-107">Modules allow you to partition, organize, and abstract your Windows PowerShell code into self-contained, reusable units.</span></span> <span data-ttu-id="9f192-108">Дополнительные сведения о модулях см. в разделе Написание модуля Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9f192-108">For more information about modules, see Writing a Windows PowerShell Module.</span></span>

## <a name="the-powershell-class"></a><span data-ttu-id="9f192-109">Класс PowerShell</span><span class="sxs-lookup"><span data-stu-id="9f192-109">The PowerShell class</span></span>

<span data-ttu-id="9f192-110">Класс PowerShell предоставляет более простое решение для создания приложений, называемое ведущими приложениями, которые программно выполняют команды.</span><span class="sxs-lookup"><span data-stu-id="9f192-110">The PowerShell class provides a simpler solution for creating applications, referred to as host applications, that programmatically run commands.</span></span> <span data-ttu-id="9f192-111">Этот класс позволяет создать конвейер команд, указать пространство выполнения, используемое для выполнения команд, и указать синхронный или асинхронный вызов команд.</span><span class="sxs-lookup"><span data-stu-id="9f192-111">This class allows you to create a pipeline of commands, specify the runspace that is used to run the commands, and specify invoking the commands synchronously or asynchronously.</span></span>

## <a name="the-runspacepool-class"></a><span data-ttu-id="9f192-112">Класс Рунспацепул</span><span class="sxs-lookup"><span data-stu-id="9f192-112">The RunspacePool class</span></span>

<span data-ttu-id="9f192-113">Пулы пространства выполнения позволяют создавать несколько пространств в одном вызове.</span><span class="sxs-lookup"><span data-stu-id="9f192-113">Runspace pools allow you to create multiple runspaces by using a single call.</span></span> <span data-ttu-id="9f192-114">Метод Креатерунспацепул предоставляет несколько перегрузок, которые можно использовать для создания пространств выполнения с такими же функциями, как узел, исходное состояние сеанса и сведения о соединении.</span><span class="sxs-lookup"><span data-stu-id="9f192-114">The CreateRunspacePool method provides several overloads that can be used to create runspaces that have the same features, such as the same host, initial session state, and connection information.</span></span>

## <a name="the-initialsessionstate-class"></a><span data-ttu-id="9f192-115">Класс InitialSessionState</span><span class="sxs-lookup"><span data-stu-id="9f192-115">The InitialSessionState class</span></span>

<span data-ttu-id="9f192-116">Класс InitialSessionState позволяет создать конфигурацию состояния сеанса, которая используется при открытии пространства выполнения.</span><span class="sxs-lookup"><span data-stu-id="9f192-116">The InitialSessionState class allows you to create a session state configuration that is used when a runspace is opened.</span></span> <span data-ttu-id="9f192-117">Можно создать пользовательскую конфигурацию, конфигурацию по умолчанию, включающую команды, предоставляемые mshshort, и конфигурацию, команды которой ограничены в зависимости от возможностей сеанса.</span><span class="sxs-lookup"><span data-stu-id="9f192-117">You can create a custom configuration, a default configuration that includes the commands provided by mshshort, and a configuration whose commands are restricted based on the capabilities of the session.</span></span>

## <a name="remote-runspaces"></a><span data-ttu-id="9f192-118">Удаленные пространства выполнения</span><span class="sxs-lookup"><span data-stu-id="9f192-118">Remote runspaces</span></span>

<span data-ttu-id="9f192-119">Теперь можно создавать пространства выполнения, которые могут быть открыты на удаленных компьютерах, что позволяет выполнять команды на удаленном компьютере и сохранять результаты локально.</span><span class="sxs-lookup"><span data-stu-id="9f192-119">You can now create runspaces that can be opened on remote computers, allowing you to run commands on the remote machine and collect the results locally.</span></span> <span data-ttu-id="9f192-120">Чтобы создать удаленное пространство выполнения, необходимо указать сведения об удаленном подключении при создании пространства выполнения.</span><span class="sxs-lookup"><span data-stu-id="9f192-120">To create a remote runspace, you must specify information about the remote connection when creating the runspace.</span></span> <span data-ttu-id="9f192-121">Примеры см. в описании методов Креатерунспаце и Креатерунспацепул.</span><span class="sxs-lookup"><span data-stu-id="9f192-121">See the CreateRunspace and CreateRunspacePool methods for examples.</span></span> <span data-ttu-id="9f192-122">Сведения о соединении определяются классом Рунспацеконнектионинфо.</span><span class="sxs-lookup"><span data-stu-id="9f192-122">The connection information is defined by the RunspaceConnectionInfo class.</span></span>

## <a name="private-runspace-elements"></a><span data-ttu-id="9f192-123">Закрытые элементы пространства выполнения</span><span class="sxs-lookup"><span data-stu-id="9f192-123">Private runspace elements</span></span>

<span data-ttu-id="9f192-124">Теперь можно создавать пространства выполнения, элементы которых являются открытыми или закрытыми.</span><span class="sxs-lookup"><span data-stu-id="9f192-124">You can now create runspaces whose elements are public or private.</span></span> <span data-ttu-id="9f192-125">Это позволяет создавать пространства выполнения, элементы которых доступны в пространстве, но недоступны пользователю.</span><span class="sxs-lookup"><span data-stu-id="9f192-125">This allows you to create runspaces whose elements are available to the runspace, but are not available to the user.</span></span> <span data-ttu-id="9f192-126">Сведения о том, какие элементы пространства выполнения могут быть сделаны частными, см. в описании класса Констраинедсессионстатинтри.</span><span class="sxs-lookup"><span data-stu-id="9f192-126">See the ConstrainedSessionStateEntry class to find out which elements of the runspace can be made private.</span></span>

## <a name="runspace-threading-modes-and-apartment-state"></a><span data-ttu-id="9f192-127">Режимы потоковой обработки пространства выполнения и состояние апартамента</span><span class="sxs-lookup"><span data-stu-id="9f192-127">Runspace threading modes and apartment state</span></span>

<span data-ttu-id="9f192-128">Теперь можно указать, как потоки создаются и используются при выполнении команд в пространстве выполнения.</span><span class="sxs-lookup"><span data-stu-id="9f192-128">You can now specify how threads are created and used when running commands in a runspace.</span></span> <span data-ttu-id="9f192-129">См. свойства System. Management. Automation. пространства выполнения. Среадоптионс и System. Management. Automation. пространства. Рунспацепул. Среадоптионс.</span><span class="sxs-lookup"><span data-stu-id="9f192-129">See the System.Management.Automation.Runspaces.Runspace.ThreadOptions and System.Management.Automation.Runspaces.RunspacePool.ThreadOptions properties.</span></span>

<span data-ttu-id="9f192-130">Теперь можно получить состояние апартамента потоков, которые используются для выполнения команд в пространстве выполнения.</span><span class="sxs-lookup"><span data-stu-id="9f192-130">You can now get the apartment state of the threads that are used to run commands in a runspace.</span></span> <span data-ttu-id="9f192-131">См. свойства System. Management. Automation. пространства выполнения., заменяющих. ApartmentState и System. Management. Automation. пространства. Рунспацепул. ApartmentState.</span><span class="sxs-lookup"><span data-stu-id="9f192-131">See the System.Management.Automation.Runspaces.Runspace.ApartmentState and System.Management.Automation.Runspaces.RunspacePool.ApartmentState properties.</span></span>

## <a name="transaction-cmdlets"></a><span data-ttu-id="9f192-132">Командлеты транзакций</span><span class="sxs-lookup"><span data-stu-id="9f192-132">Transaction cmdlets</span></span>

<span data-ttu-id="9f192-133">Теперь можно создавать командлеты, которые можно использовать в транзакции.</span><span class="sxs-lookup"><span data-stu-id="9f192-133">You can now create cmdlets that can be used within a transaction.</span></span> <span data-ttu-id="9f192-134">Если в транзакции используется командлет, его действия являются временными и могут быть приняты или отклонены командлетами транзакций, предоставляемыми Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9f192-134">When a cmdlet is used in a transaction, its actions are temporary, and they can be accepted or rejected by the transaction cmdlets provided by Windows PowerShell.</span></span>

<span data-ttu-id="9f192-135">Дополнительные сведения о транзакциях см. в разделе Поддержка транзакций.</span><span class="sxs-lookup"><span data-stu-id="9f192-135">For more information about transactions, see How to Support Transactions.</span></span>

## <a name="transaction-provider"></a><span data-ttu-id="9f192-136">Поставщик транзакций</span><span class="sxs-lookup"><span data-stu-id="9f192-136">Transaction provider</span></span>

<span data-ttu-id="9f192-137">Теперь можно создавать поставщики, которые можно использовать в транзакции.</span><span class="sxs-lookup"><span data-stu-id="9f192-137">You can now create providers that can be used within a transaction.</span></span> <span data-ttu-id="9f192-138">Аналогично командлетам, когда поставщик используется в транзакции, его действия являются временными и могут быть приняты или отклонены командлетами транзакций, предоставляемыми Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9f192-138">Similar to cmdlets, when a provider is used in a transaction, its actions are temporary, and they can be accepted or rejected by the transaction cmdlets provided by Windows PowerShell.</span></span>

<span data-ttu-id="9f192-139">Дополнительные сведения об указании поддержки транзакции в классе поставщика см. в описании свойства System. Management. Automation. Provider. Кмдлетпровидераттрибуте. Провидеркапабилитиес.</span><span class="sxs-lookup"><span data-stu-id="9f192-139">For more information about specifying support for transaction within a provider class, see the System.Management.Automation.Provider.CmdletProviderAttribute.ProviderCapabilities property.</span></span>

## <a name="job-cmdlets"></a><span data-ttu-id="9f192-140">Командлеты заданий</span><span class="sxs-lookup"><span data-stu-id="9f192-140">Job cmdlets</span></span>

<span data-ttu-id="9f192-141">Теперь можно написать командлеты, которые могут выполнять свои действия в качестве задания.</span><span class="sxs-lookup"><span data-stu-id="9f192-141">You can now write cmdlets that can perform their action as a job.</span></span> <span data-ttu-id="9f192-142">Эти задания выполняются в фоновом режиме без взаимодействия с текущим сеансом.</span><span class="sxs-lookup"><span data-stu-id="9f192-142">These jobs are run in the background without interacting with the current session.</span></span> <span data-ttu-id="9f192-143">Дополнительные сведения о том, как Windows PowerShell поддерживает задания, см. в разделе фоновые задания.</span><span class="sxs-lookup"><span data-stu-id="9f192-143">For more information about how Windows PowerShell supports jobs, see Background Jobs.</span></span>

## <a name="cmdlet-output-types"></a><span data-ttu-id="9f192-144">Типы выходных данных командлета</span><span class="sxs-lookup"><span data-stu-id="9f192-144">Cmdlet output types</span></span>

<span data-ttu-id="9f192-145">Теперь можно указать типы .NET Framework, возвращаемые командлетами, путем объявления атрибута OutputType при записи командлетов.</span><span class="sxs-lookup"><span data-stu-id="9f192-145">You can now specify the .NET Framework types that are returned by your cmdlets by declaring the OutputType attribute when writing your cmdlets.</span></span> <span data-ttu-id="9f192-146">Это позволит другим определить тип объектов, возвращаемых командлетом, путем просмотра свойства OutputType командлета.</span><span class="sxs-lookup"><span data-stu-id="9f192-146">This will allow others to determine what type of objects are returned by a cmdlet by looking at the OutputType property of the cmdlet.</span></span>

## <a name="event-support"></a><span data-ttu-id="9f192-147">Поддержка событий</span><span class="sxs-lookup"><span data-stu-id="9f192-147">Event support</span></span>

<span data-ttu-id="9f192-148">Теперь можно писать командлеты, которые добавляют и потребляют события.</span><span class="sxs-lookup"><span data-stu-id="9f192-148">You can now write cmdlets that add and consume events.</span></span> <span data-ttu-id="9f192-149">См. класс Псевент.</span><span class="sxs-lookup"><span data-stu-id="9f192-149">See the PSEvent class.</span></span>

## <a name="proxy-commands"></a><span data-ttu-id="9f192-150">Команды прокси-сервера</span><span class="sxs-lookup"><span data-stu-id="9f192-150">Proxy commands</span></span>

<span data-ttu-id="9f192-151">Теперь можно создавать команды прокси-сервера, которые можно использовать для выполнения другой команды.</span><span class="sxs-lookup"><span data-stu-id="9f192-151">You can now write proxy commands that can be used to run another command.</span></span> <span data-ttu-id="9f192-152">Команда прокси позволяет контролировать, какие функции исходного командлета доступны пользователю.</span><span class="sxs-lookup"><span data-stu-id="9f192-152">A proxy command allows you to control what functionality of the source cmdlet is available to the user.</span></span> <span data-ttu-id="9f192-153">Например, можно создать команду прокси-сервера, которая удаляет параметр, предоставленный исходной командой.</span><span class="sxs-lookup"><span data-stu-id="9f192-153">For example, you can create a proxy command that removes a parameter that is supplied by the source command.</span></span> <span data-ttu-id="9f192-154">См. класс Проксикомманд.</span><span class="sxs-lookup"><span data-stu-id="9f192-154">See the ProxyCommand class.</span></span>

## <a name="multiple-choice-prompts"></a><span data-ttu-id="9f192-155">Несколько запросов выбора</span><span class="sxs-lookup"><span data-stu-id="9f192-155">Multiple choice prompts</span></span>

<span data-ttu-id="9f192-156">Теперь можно создавать приложения, которые могут предоставлять запросы, позволяющие пользователю выбрать несколько вариантов.</span><span class="sxs-lookup"><span data-stu-id="9f192-156">You can now write applications that can provide prompts that allow the user to select multiple choices.</span></span> <span data-ttu-id="9f192-157">См. интерфейс Ихостуисуппортсмултиплечоицеселектион</span><span class="sxs-lookup"><span data-stu-id="9f192-157">See the IHostUISupportsMultipleChoiceSelection interface</span></span>

## <a name="interactive-sessions"></a><span data-ttu-id="9f192-158">Интерактивные сеансы</span><span class="sxs-lookup"><span data-stu-id="9f192-158">Interactive sessions</span></span>

<span data-ttu-id="9f192-159">Теперь можно создавать приложения, которые могут запускать и прекращать интерактивный сеанс на удаленном компьютере.</span><span class="sxs-lookup"><span data-stu-id="9f192-159">You can now write applications that can start and stop an interactive session on a remote computer.</span></span>
<span data-ttu-id="9f192-160">См. интерфейс Ихостсуппортсинтерактивесессион.</span><span class="sxs-lookup"><span data-stu-id="9f192-160">See the IHostSupportsInteractiveSession interface.</span></span>

## <a name="custom-cmdlet-help-for-providers"></a><span data-ttu-id="9f192-161">Справка по пользовательским командлетам для поставщиков</span><span class="sxs-lookup"><span data-stu-id="9f192-161">Custom Cmdlet Help for Providers</span></span>

<span data-ttu-id="9f192-162">Теперь можно создавать настраиваемые разделы справки для командлетов поставщика.</span><span class="sxs-lookup"><span data-stu-id="9f192-162">You can now create customized Help topics for the provider cmdlets.</span></span> <span data-ttu-id="9f192-163">Разделы справки по пользовательским командлетам могут объяснить, как работает командлет в пути поставщика, и специальные функции, включая динамические параметры, которые поставщик добавляет в командлет.</span><span class="sxs-lookup"><span data-stu-id="9f192-163">Custom cmdlet help topics can explain how the cmdlet works in the provider path and document special features, including the dynamic parameters that the provider adds to the cmdlet.</span></span>
