---
title: Загрузка и экспорт данных форматирования | Документация Майкрософт
ms.date: 09/13/2016
ms.openlocfilehash: b449b280ccee561679d58f2f2a8b467c83150766
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2020
ms.locfileid: "87781126"
---
# <a name="loading-and-exporting-formatting-data"></a>Загрузка и экспорт данных форматирования

После создания файла форматирования необходимо обновить данные формата сеанса, загрузив файлы в текущий сеанс. (Файлы форматирования, предоставляемые Windows PowerShell, загружаются оснастками, которые регистрируются при открытии текущего сеанса.) После обновления данных форматирования текущего сеанса Windows PowerShell использует эти данные для отображения объектов .NET, связанных с представлениями, определенными в загруженных файлах форматирования. Количество файлов форматирования, которые можно загрузить в текущий сеанс, не ограничено. В дополнение к обновлению данных форматирования можно экспортировать данные формата в текущем сеансе обратно в файл форматирования.

## <a name="loading-format-data"></a>Загрузка данных формата

Файлы форматирования можно загрузить в текущий сеанс с помощью следующих методов:

- Файл форматирования можно импортировать в текущий сеанс из командной строки. Используйте командлет [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) , как описано в следующей процедуре.

- Можно создать манифест модуля, который ссылается на файл форматирования. Модули позволяют упаковать файлы форматирования для распространения. Используйте командлет [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) , чтобы создать манифест, и командлет [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) для загрузки модуля в текущий сеанс. Дополнительные сведения о модулях см. [в разделе Написание модуля Windows PowerShell](../module/writing-a-windows-powershell-module.md).

- Вы можете создать оснастку, которая ссылается на файл форматирования. Используйте [System. Management. Automation. PSSnapin. formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) для ссылки на файлы форматирования. Настоятельно рекомендуется использовать модули для пакетных командлетов и связанных файлов форматирования и типов для распространения. Дополнительные сведения о модулях см. [в разделе Написание модуля Windows PowerShell](../module/writing-a-windows-powershell-module.md).

- При программном вызове команд можно добавить запись файла форматирования в исходное состояние сеанса пространства выполнения, в котором выполняются команды. Дополнительные сведения о типе .NET, используемом для добавления файла форматирования, см. в разделе [System. Management. Automation. пространства. сессионстатеформатентри? DisplayProperty = FullName](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) , класс.

При загрузке файла форматирования он добавляется во внутренний список, который используется Windows PowerShell для определения представления, которое будет использоваться при отображении объектов в командной строке. Вы можете добавить файл форматирования в начало списка, а также в конец списка. Знание того, где в этот список добавляется файл форматирования, важно, если загружается файл форматирования, определяющий представление для объекта, для которого определено существующее представление, например, если требуется изменить способ отображения объекта, возвращаемого командлетом Windows PowerShell Core. При загрузке файла форматирования, который определяет единственное представление для объекта, можно использовать любой из описанных выше методов.  Если вы загружаете файл форматирования, который определяет другое представление для объекта, необходимо использовать командлет [Update-FormatData и добавить](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) файл в начало списка.

## <a name="storing-your-formatting-file"></a>Сохранение файла форматирования

Нет необходимости в том, где хранятся файлы форматирования на диске. Однако настоятельно рекомендуется хранить их в следующей папке:`user\documents\windowspowershell\`

#### <a name="loading-a-format-file-using-import-formatdata"></a>Загрузка файла форматирования с помощью команды Import-FormatData

1. Сохраните файл форматирования на диске.

2. Выполните командлет [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) , используя одну из следующих команд.

   Чтобы добавить файл форматирования в начало списка, используйте эту команду. Используйте эту команду, если изменяется отображение объекта.

   ```powershell
   Update-FormatData -PrependPath PathToFormattingFile
   ```

   Чтобы добавить файл форматирования в конец списка, используйте эту команду.

   ```powershell
   Update-FormatData -AppendPath PathToFormattingFile
   ```

   После добавления файла с помощью командлета [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) этот файл нельзя удалить из списка, пока сеанс открыт. Необходимо закрыть сеанс, чтобы удалить файл форматирования из списка.

## <a name="exporting-format-data"></a>Экспорт данных формата

Вставьте сюда основную часть.
