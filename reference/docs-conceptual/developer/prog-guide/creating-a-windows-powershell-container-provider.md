---
title: Создание поставщика контейнеров Windows PowerShell | Документация Майкрософт
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- providers [PowerShell Programmer's Guide], container provider
- container providers [PowerShell Programmer's Guide]
ms.assetid: a7926647-0d18-45b2-967e-b31f92004bc4
caps.latest.revision: 5
ms.openlocfilehash: 0822e01d1191b019318fd0ea06dadea1a87a299e
ms.sourcegitcommit: 52a67bcd9d7bf3e8600ea4302d1fa8970ff9c998
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/15/2019
ms.locfileid: "72366853"
---
# <a name="creating-a-windows-powershell-container-provider"></a><span data-ttu-id="eec6e-102">Создание поставщика контейнеров Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="eec6e-102">Creating a Windows PowerShell Container Provider</span></span>

<span data-ttu-id="eec6e-103">В этом разделе описывается создание поставщика Windows PowerShell, который может работать с хранилищами данных с несколькими уровнями.</span><span class="sxs-lookup"><span data-stu-id="eec6e-103">This topic describes how to create a Windows PowerShell provider that can work on multi-layer data stores.</span></span> <span data-ttu-id="eec6e-104">Для этого типа хранилища данных верхний уровень хранилища содержит корневые элементы, а каждый последующий уровень называется узлом дочерних элементов.</span><span class="sxs-lookup"><span data-stu-id="eec6e-104">For this type of data store, the top level of the store contains the root items and each subsequent level is referred to as a node of child items.</span></span> <span data-ttu-id="eec6e-105">Разрешая пользователю работать с этими дочерними узлами, пользователь может выполнять иерархическую работу через хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="eec6e-105">By allowing the user to work on these child nodes, a user can interact hierarchically through the data store.</span></span>

<span data-ttu-id="eec6e-106">Поставщики, которые могут работать с многоуровневые хранилищами данных, называются поставщиками контейнеров Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="eec6e-106">Providers that can work on multi-level data stores are referred to as Windows PowerShell container providers.</span></span> <span data-ttu-id="eec6e-107">Однако имейте в виду, что поставщик контейнеров Windows PowerShell можно использовать только при наличии одного контейнера (без вложенных контейнеров) с элементами в нем.</span><span class="sxs-lookup"><span data-stu-id="eec6e-107">However, be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="eec6e-108">При наличии вложенных контейнеров необходимо реализовать поставщик навигации Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="eec6e-108">If there are nested containers, then you must implement a Windows PowerShell navigation provider.</span></span> <span data-ttu-id="eec6e-109">Дополнительные сведения о реализации поставщика навигации Windows PowerShell см. [в разделе Создание поставщика навигации Windows PowerShell](./creating-a-windows-powershell-navigation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="eec6e-109">For more information about implementing Windows PowerShell navigation provider, see [Creating a Windows PowerShell Navigation Provider](./creating-a-windows-powershell-navigation-provider.md).</span></span>

> [!NOTE]
> <span data-ttu-id="eec6e-110">Вы можете скачать C# исходный файл (AccessDBSampleProvider04.cs) для этого поставщика с помощью пакета средств разработки программного обеспечения Microsoft Windows для компонентов среды выполнения Windows Vista и .NET Framework 3,0.</span><span class="sxs-lookup"><span data-stu-id="eec6e-110">You can download the C# source file (AccessDBSampleProvider04.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="eec6e-111">Инструкции по загрузке см. в статье [Установка Windows PowerShell и Загрузка пакета SDK для Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="eec6e-111">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="eec6e-112">Скачанные исходные файлы доступны в каталоге **\<PowerShell samples >** Directory.</span><span class="sxs-lookup"><span data-stu-id="eec6e-112">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="eec6e-113">Дополнительные сведения о других реализациях поставщиков Windows PowerShell см. в разделе [Разработка поставщика Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="eec6e-113">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="eec6e-114">Поставщик контейнера Windows PowerShell, описанный здесь, определяет базу данных в качестве единого контейнера с таблицами и строками базы данных, определенными в качестве элементов контейнера.</span><span class="sxs-lookup"><span data-stu-id="eec6e-114">The Windows PowerShell container provider described here defines the database as its single container, with the tables and rows of the database defined as items of the container.</span></span>

> [!CAUTION]
> <span data-ttu-id="eec6e-115">Имейте в виду, что в этом проекте предполагается, что база данных имеет поле с ИДЕНТИФИКАТОРом Name, а тип поля — Лонгинтежер.</span><span class="sxs-lookup"><span data-stu-id="eec6e-115">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

## <a name="defining-a-windows-powershell-container-provider-class"></a><span data-ttu-id="eec6e-116">Определение класса поставщика контейнеров Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="eec6e-116">Defining a Windows PowerShell Container Provider Class</span></span>

<span data-ttu-id="eec6e-117">Поставщик контейнера Windows PowerShell должен определять класс .NET, производный от базового класса [System. Management. Automation. Provider. контаинеркмдлетпровидер](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-117">A Windows PowerShell container provider must define a .NET class that derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="eec6e-118">Ниже приведено определение класса для поставщика контейнеров Windows PowerShell, описанного в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="eec6e-118">Here is the class definition for the Windows PowerShell container provider described in this section.</span></span>

```csharp
   [CmdletProvider("AccessDB", ProviderCapabilities.None)]
   public class AccessDBProvider : ContainerCmdletProvider
```

[!code-csharp[AccessDBProviderSample04.cs](../../../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L34-L35 "AccessDBProviderSample04.cs")]

<span data-ttu-id="eec6e-119">Обратите внимание, что в этом определении класса атрибут [System. Management. Automation. Provider. кмдлетпровидераттрибуте](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) включает два параметра.</span><span class="sxs-lookup"><span data-stu-id="eec6e-119">Notice that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="eec6e-120">Первый параметр задает понятное имя для поставщика, используемого Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="eec6e-120">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="eec6e-121">Второй параметр указывает специальные возможности Windows PowerShell, которые поставщик предоставляет среде выполнения Windows PowerShell во время обработки команды.</span><span class="sxs-lookup"><span data-stu-id="eec6e-121">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="eec6e-122">Для этого поставщика не добавляются специальные возможности Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="eec6e-122">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="eec6e-123">Определение базовых функций</span><span class="sxs-lookup"><span data-stu-id="eec6e-123">Defining Base Functionality</span></span>

<span data-ttu-id="eec6e-124">Как описано в разделе [проектирование поставщика Windows PowerShell](./designing-your-windows-powershell-provider.md), класс [System. Management. Automation. Provider. контаинеркмдлетпровидер](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) является производным от нескольких других классов, предоставилих различные функции поставщика.</span><span class="sxs-lookup"><span data-stu-id="eec6e-124">As described in [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="eec6e-125">Таким образом, поставщик контейнера Windows PowerShell должен определить все функциональные возможности, предоставляемые этими классами.</span><span class="sxs-lookup"><span data-stu-id="eec6e-125">A Windows PowerShell container provider, therefore, needs to define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="eec6e-126">Сведения о реализации функций для добавления сведений об инициализации для конкретного сеанса и освобождения ресурсов, используемых поставщиком, см. в разделе [Создание базового поставщика Windows PowerShell](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="eec6e-126">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="eec6e-127">Однако большинство поставщиков (включая описанный здесь поставщик) могут использовать реализацию этой функции по умолчанию, предоставляемую Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="eec6e-127">However, most providers (including the provider described here) can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="eec6e-128">Чтобы получить доступ к хранилищу данных, поставщик должен реализовать методы базового класса [System. Management. Automation. Provider. дривекмдлетпровидер](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-128">To get access to the data store, the provider must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="eec6e-129">Дополнительные сведения о реализации этих методов см. в разделе [Создание поставщика диска Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="eec6e-129">For more information about implementing these methods, see [Creating an Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="eec6e-130">Чтобы управлять элементами хранилища данных, такими как получение, установка и очистка элементов, поставщик должен реализовать методы, предоставляемые базовым классом [System. Management. Automation. Provider. итемкмдлетпровидер](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-130">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="eec6e-131">Дополнительные сведения о реализации этих методов см. в разделе [Создание поставщика элементов Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="eec6e-131">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

## <a name="retrieving-child-items"></a><span data-ttu-id="eec6e-132">Получение дочерних элементов</span><span class="sxs-lookup"><span data-stu-id="eec6e-132">Retrieving Child Items</span></span>

<span data-ttu-id="eec6e-133">Чтобы получить дочерний элемент, поставщик контейнера Windows PowerShell должен переопределить метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) для поддержки вызовов из командлета `Get-ChildItem`.</span><span class="sxs-lookup"><span data-stu-id="eec6e-133">To retrieve a child item, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method to support calls from the `Get-ChildItem` cmdlet.</span></span> <span data-ttu-id="eec6e-134">Этот метод получает дочерние элементы из хранилища данных и записывает их в конвейер в виде объектов.</span><span class="sxs-lookup"><span data-stu-id="eec6e-134">This method retrieves child items from the data store and writes them to the pipeline as objects.</span></span> <span data-ttu-id="eec6e-135">Если указан параметр `recurse` командлета, метод получает все дочерние элементы независимо от того, на каком уровне они находятся.</span><span class="sxs-lookup"><span data-stu-id="eec6e-135">If the `recurse` parameter of the cmdlet is specified, the method retrieves all children regardless of what level they are at.</span></span> <span data-ttu-id="eec6e-136">Если параметр `recurse` не указан, метод извлекает только один уровень дочерних элементов.</span><span class="sxs-lookup"><span data-stu-id="eec6e-136">If the `recurse` parameter is not specified, the method retrieves only a single level of children.</span></span>

<span data-ttu-id="eec6e-137">Ниже приведена реализация метода [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) для этого поставщика.</span><span class="sxs-lookup"><span data-stu-id="eec6e-137">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method for this provider.</span></span> <span data-ttu-id="eec6e-138">Обратите внимание, что этот метод получает дочерние элементы во всех таблицах базы данных, если путь указывает на базу данных Access, и получает дочерние элементы из строк этой таблицы, если путь указывает на таблицу данных.</span><span class="sxs-lookup"><span data-stu-id="eec6e-138">Notice that this method retrieves the child items in all database tables when the path indicates the Access database, and retrieves the child items from the rows of that table if the path indicates a data table.</span></span>

```csharp
protected override void GetChildItems(string path, bool recurse)
{
    // If path represented is a drive then the children in the path are
    // tables. Hence all tables in the drive represented will have to be
    // returned
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table, path, true);

            // if the specified item exists and recurse has been set then
            // all child items within it have to be obtained as well
            if (ItemExists(path) && recurse)
            {
                GetChildItems(path + pathSeparator + table.Name, recurse);
            }
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get the table name, row number and type of path from the
        // path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Obtain all the rows within the table
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);
            WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
        }
        else
        {
            // In this case, the path specified is not valid
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L311-L362 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchilditems"></a><span data-ttu-id="eec6e-139">Вопросы, связанные с реализацией Жетчилдитемс</span><span class="sxs-lookup"><span data-stu-id="eec6e-139">Things to Remember About Implementing GetChildItems</span></span>

<span data-ttu-id="eec6e-140">Следующие условия могут применяться к реализации [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="eec6e-140">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="eec6e-141">При определении класса поставщика поставщик контейнера Windows PowerShell может объявлять возможности поставщика Експандвилдкардс, Filter, include или Exclude из перечисления [System. Management. Automation. Provider. провидеркапабилитиес](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-141">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="eec6e-142">В таких случаях реализация метода [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) должна обеспечить соответствие пути, переданного методу, требованиям указанных возможностей.</span><span class="sxs-lookup"><span data-stu-id="eec6e-142">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="eec6e-143">Для этого метод должен получить доступ к соответствующему свойству, например к свойствам [System. Management. Automation. Provider. кмдлетпровидер. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) и [System. Management. Automation. Provider. кмдлетпровидер. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-143">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="eec6e-144">Реализация этого метода должна учитывать любую форму доступа к элементу, который может сделать элемент видимым для пользователя.</span><span class="sxs-lookup"><span data-stu-id="eec6e-144">The implementation of this method should take into account any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="eec6e-145">Например, если пользователь имеет доступ на запись к файлу через поставщик FileSystem (предоставляемый Windows PowerShell), но не имеет доступа на чтение, файл все еще существует, а [System. Management. Automation. Provider. итемкмдлетпровидер. итемексистс \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) возвращает @no__ t-1.</span><span class="sxs-lookup"><span data-stu-id="eec6e-145">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="eec6e-146">Для реализации может потребоваться проверка родительского элемента, чтобы узнать, можно ли перечислить дочерний элемент.</span><span class="sxs-lookup"><span data-stu-id="eec6e-146">Your implementation might require the checking of a parent item to see if the child can be enumerated.</span></span>

- <span data-ttu-id="eec6e-147">При записи нескольких элементов метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) может занять некоторое время.</span><span class="sxs-lookup"><span data-stu-id="eec6e-147">When writing multiple items, the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method can take some time.</span></span> <span data-ttu-id="eec6e-148">Вы можете спроектировать поставщик для записи элементов с помощью метода [System. Management. автоматизации. Provider. кмдлетпровидер. вритеитемобжект \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) по одному за раз.</span><span class="sxs-lookup"><span data-stu-id="eec6e-148">You can design your provider to write the items using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method one at a time.</span></span> <span data-ttu-id="eec6e-149">При использовании этого метода элементы будут представлены пользователю в потоке.</span><span class="sxs-lookup"><span data-stu-id="eec6e-149">Using this technique will present the items to the user in a stream.</span></span>

- <span data-ttu-id="eec6e-150">Реализация [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) отвечает за предотвращение бесконечной рекурсии при наличии циклических ссылок и подобной.</span><span class="sxs-lookup"><span data-stu-id="eec6e-150">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="eec6e-151">Для отражения такого условия должно быть создано соответствующее завершающее исключение.</span><span class="sxs-lookup"><span data-stu-id="eec6e-151">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet"></a><span data-ttu-id="eec6e-152">Присоединение динамических параметров к командлету Get-ChildItem</span><span class="sxs-lookup"><span data-stu-id="eec6e-152">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet</span></span>

<span data-ttu-id="eec6e-153">Иногда для командлета `Get-ChildItem`, вызывающего [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) , требуются дополнительные параметры, которые динамически задаются во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="eec6e-153">Sometimes the `Get-ChildItem` cmdlet that calls [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="eec6e-154">Чтобы предоставить эти динамические параметры, поставщик контейнера Windows PowerShell должен реализовать метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилдитемсдинамикпараметерс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-154">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) method.</span></span> <span data-ttu-id="eec6e-155">Этот метод получает динамические параметры для элемента по указанному пути и возвращает объект со свойствами и полями с атрибутами синтаксического анализа, похожими на класс командлета или [System. Management. Automation. рунтимедефинедпараметердиктионари](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) объектами.</span><span class="sxs-lookup"><span data-stu-id="eec6e-155">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="eec6e-156">Среда выполнения Windows PowerShell использует возвращенный объект для добавления параметров в командлет `Get-ChildItem`.</span><span class="sxs-lookup"><span data-stu-id="eec6e-156">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="eec6e-157">Этот метод не реализуется этим поставщиком контейнера Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="eec6e-157">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="eec6e-158">Однако приведенный ниже код является реализацией этого метода по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="eec6e-158">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters](Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters)]  -->

## <a name="retrieving-child-item-names"></a><span data-ttu-id="eec6e-159">Получение имен дочерних элементов</span><span class="sxs-lookup"><span data-stu-id="eec6e-159">Retrieving Child Item Names</span></span>

<span data-ttu-id="eec6e-160">Чтобы получить имена дочерних элементов, поставщик контейнера Windows PowerShell должен переопределить метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилднамес \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) для поддержки вызовов командлета `Get-ChildItem`, когда `Name` указан параметр.</span><span class="sxs-lookup"><span data-stu-id="eec6e-160">To retrieve the names of child items, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method to support calls from the `Get-ChildItem` cmdlet when its `Name` parameter is specified.</span></span> <span data-ttu-id="eec6e-161">Этот метод получает имена дочерних элементов для указанных пути или имен дочерних элементов для всех контейнеров, если указан параметр `returnAllContainers` командлета.</span><span class="sxs-lookup"><span data-stu-id="eec6e-161">This method retrieves the names of the child items for the specified path or child item names for all containers if the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="eec6e-162">Дочернее имя — это конечная часть пути.</span><span class="sxs-lookup"><span data-stu-id="eec6e-162">A child name is the leaf portion of a path.</span></span> <span data-ttu-id="eec6e-163">Например, дочерним именем для пути c:\windows\system32\abc.dll является ABC. dll.</span><span class="sxs-lookup"><span data-stu-id="eec6e-163">For example, the child name for the path c:\windows\system32\abc.dll is "abc.dll".</span></span> <span data-ttu-id="eec6e-164">Дочернее имя каталога c:\Windows\System32 — System32.</span><span class="sxs-lookup"><span data-stu-id="eec6e-164">The child name for the directory c:\windows\system32 is "system32".</span></span>

<span data-ttu-id="eec6e-165">Ниже приведена реализация метода [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилднамес \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) для этого поставщика.</span><span class="sxs-lookup"><span data-stu-id="eec6e-165">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method for this provider.</span></span> <span data-ttu-id="eec6e-166">Обратите внимание, что метод получает имена таблиц, если указанный путь указывает на базу данных Access (диск) и номера строк, если путь указывает на таблицу.</span><span class="sxs-lookup"><span data-stu-id="eec6e-166">Notice that the method retrieves table names if the specified path indicates the Access database (drive) and row numbers if the path indicates a table.</span></span>

```csharp
protected override void GetChildNames(string path,
                            ReturnContainers returnContainers)
{
    // If the path represented is a drive, then the child items are
    // tables. get the names of all the tables in the drive.
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table.Name, path, true);
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get type, table name and row number from path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Get all the rows in the table and then write out the
            // row numbers.
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row.RowNumber, path, false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);

            WriteItemObject(row.RowNumber, path, false);
        }
        else
        {
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildNames
```

[!code-csharp[AccessDBProviderSample04.cs](../../../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L369-L411 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchildnames"></a><span data-ttu-id="eec6e-167">Вопросы, связанные с реализацией Жетчилднамес</span><span class="sxs-lookup"><span data-stu-id="eec6e-167">Things to Remember About Implementing GetChildNames</span></span>

<span data-ttu-id="eec6e-168">Следующие условия могут применяться к реализации [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="eec6e-168">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="eec6e-169">При определении класса поставщика поставщик контейнера Windows PowerShell может объявлять возможности поставщика Експандвилдкардс, Filter, include или Exclude из перечисления [System. Management. Automation. Provider. провидеркапабилитиес](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-169">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="eec6e-170">В таких случаях реализация метода [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) должна обеспечить соответствие пути, переданного методу, требованиям указанных возможностей.</span><span class="sxs-lookup"><span data-stu-id="eec6e-170">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="eec6e-171">Для этого метод должен получить доступ к соответствующему свойству, например к свойствам [System. Management. Automation. Provider. кмдлетпровидер. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) и [System. Management. Automation. Provider. кмдлетпровидер. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-171">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

  > [!NOTE]
  > <span data-ttu-id="eec6e-172">Исключение из этого правила возникает при указании параметра `returnAllContainers` командлета.</span><span class="sxs-lookup"><span data-stu-id="eec6e-172">An exception to this rule occurs when the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="eec6e-173">В этом случае метод должен получить любое дочернее имя для контейнера, даже если оно не соответствует значениям [System. Management. Automation. Provider. кмдлетпровидер. Filter \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [ Свойства System. Management. Automation. Provider. Кмдлетпровидер. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)или [System. Management. Automation. Provider. Кмдлетпровидер. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-173">In this case, the method should retrieve any child name for a container, even if it does not match the values of the [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), or [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) properties.</span></span>

- <span data-ttu-id="eec6e-174">По умолчанию переопределения этого метода не должны извлекать имена объектов, которые обычно скрыты от пользователя, если не указано свойство [System. Management. Automation. Provider. кмдлетпровидер. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-174">By default, overrides of this method should not retrieve names of objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="eec6e-175">Если указанный путь указывает на контейнер, свойство [System. Management. Automation. Provider. кмдлетпровидер. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) не является обязательным.</span><span class="sxs-lookup"><span data-stu-id="eec6e-175">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="eec6e-176">Реализация [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилднамес \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) отвечает за предотвращение бесконечной рекурсии при наличии циклических ссылок и подобной.</span><span class="sxs-lookup"><span data-stu-id="eec6e-176">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="eec6e-177">Для отражения такого условия должно быть создано соответствующее завершающее исключение.</span><span class="sxs-lookup"><span data-stu-id="eec6e-177">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet-name"></a><span data-ttu-id="eec6e-178">Присоединение динамических параметров к командлету Get-ChildItem (имя)</span><span class="sxs-lookup"><span data-stu-id="eec6e-178">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet (Name)</span></span>

<span data-ttu-id="eec6e-179">Иногда для командлета `Get-ChildItem` (с параметром `Name`) требуются дополнительные параметры, которые динамически задаются во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="eec6e-179">Sometimes the `Get-ChildItem` cmdlet (with the `Name` parameter) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="eec6e-180">Чтобы предоставить эти динамические параметры, поставщик контейнера Windows PowerShell должен реализовать метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилднамесдинамикпараметерс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-180">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) method.</span></span> <span data-ttu-id="eec6e-181">Этот метод получает динамические параметры для элемента по указанному пути и возвращает объект со свойствами и полями с атрибутами синтаксического анализа, похожими на класс командлета или [System. Management. Automation. рунтимедефинедпараметердиктионари ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)объект.</span><span class="sxs-lookup"><span data-stu-id="eec6e-181">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="eec6e-182">Среда выполнения Windows PowerShell использует возвращенный объект для добавления параметров в командлет `Get-ChildItem`.</span><span class="sxs-lookup"><span data-stu-id="eec6e-182">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="eec6e-183">Этот метод не реализуется этим поставщиком.</span><span class="sxs-lookup"><span data-stu-id="eec6e-183">This provider does not implement this method.</span></span> <span data-ttu-id="eec6e-184">Однако приведенный ниже код является реализацией этого метода по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="eec6e-184">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters](Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters)]  -->

## <a name="renaming-items"></a><span data-ttu-id="eec6e-185">Переименование элементов</span><span class="sxs-lookup"><span data-stu-id="eec6e-185">Renaming Items</span></span>

<span data-ttu-id="eec6e-186">Для переименования элемента поставщик контейнера Windows PowerShell должен переопределять метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. ренамеитем \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) для поддержки вызовов из командлета `Rename-Item`.</span><span class="sxs-lookup"><span data-stu-id="eec6e-186">To rename an item, a Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method to support calls from the `Rename-Item` cmdlet.</span></span> <span data-ttu-id="eec6e-187">Этот метод изменяет имя элемента по указанному пути на новое указанное имя.</span><span class="sxs-lookup"><span data-stu-id="eec6e-187">This method changes the name of the item at the specified path to the new name provided.</span></span> <span data-ttu-id="eec6e-188">Новое имя всегда должно относиться к родительскому элементу (контейнеру).</span><span class="sxs-lookup"><span data-stu-id="eec6e-188">The new name must always be relative to the parent item (container).</span></span>

<span data-ttu-id="eec6e-189">Этот поставщик не переопределяет метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. ренамеитем \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-189">This provider does not override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method.</span></span> <span data-ttu-id="eec6e-190">Однако ниже приведена реализация по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="eec6e-190">However, the following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitem](Msh_samplestestcmdlets#testproviderrenameitem)]  -->

#### <a name="things-to-remember-about-implementing-renameitem"></a><span data-ttu-id="eec6e-191">Вопросы, связанные с реализацией Ренамеитем</span><span class="sxs-lookup"><span data-stu-id="eec6e-191">Things to Remember About Implementing RenameItem</span></span>

<span data-ttu-id="eec6e-192">Следующие условия могут применяться к реализации [System. Management. Automation. Provider. контаинеркмдлетпровидер. ренамеитем \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span><span class="sxs-lookup"><span data-stu-id="eec6e-192">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span></span>

- <span data-ttu-id="eec6e-193">При определении класса поставщика поставщик контейнера Windows PowerShell может объявлять возможности поставщика Експандвилдкардс, Filter, include или Exclude из перечисления [System. Management. Automation. Provider. провидеркапабилитиес](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-193">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="eec6e-194">В таких случаях реализация метода [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) должна обеспечить соответствие пути, переданного методу, требованиям указанных возможностей.</span><span class="sxs-lookup"><span data-stu-id="eec6e-194">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="eec6e-195">Для этого метод должен получить доступ к соответствующему свойству, например к свойствам [System. Management. Automation. Provider. кмдлетпровидер. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) и [System. Management. Automation. Provider. кмдлетпровидер. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-195">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="eec6e-196">Метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. ренамеитем \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) предназначен только для изменения имени элемента, а не для операций перемещения.</span><span class="sxs-lookup"><span data-stu-id="eec6e-196">The [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method is intended for the modification of the name of an item only, and not for move operations.</span></span> <span data-ttu-id="eec6e-197">Реализация метода должна записать ошибку, если параметр `newName` содержит разделители пути или в противном случае может привести к изменению родительского расположения элемента.</span><span class="sxs-lookup"><span data-stu-id="eec6e-197">Your implementation of the method should write an error if the `newName` parameter contains path separators, or might otherwise cause the item to change its parent location.</span></span>

- <span data-ttu-id="eec6e-198">По умолчанию переопределения этого метода не должны переименовывать объекты, если не указано свойство [System. Management. Automation. Provider. кмдлетпровидер. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-198">By default, overrides of this method should not rename objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="eec6e-199">Если указанный путь указывает на контейнер, свойство [System. Management. Automation. Provider. кмдлетпровидер. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) не является обязательным.</span><span class="sxs-lookup"><span data-stu-id="eec6e-199">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="eec6e-200">Реализация метода [System. Management. Automation. Provider. контаинеркмдлетпровидер. ренамеитем \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) должна вызывать [System. Management. Automation. Provider. кмдлетпровидер. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) и проверять его возвращаемое значение до внесение любых изменений в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="eec6e-200">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="eec6e-201">Этот метод используется для подтверждения выполнения операции при внесении изменений в состояние системы, например при переименовании файлов.</span><span class="sxs-lookup"><span data-stu-id="eec6e-201">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span> <span data-ttu-id="eec6e-202">[System. Management. Automation. Provider. кмдлетпровидер. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) отправляет имя ресурса, который будет изменен пользователю, при этом среда выполнения Windows PowerShell учитывает все параметры командной строки или привилегированные переменные при определении что следует отображать.</span><span class="sxs-lookup"><span data-stu-id="eec6e-202">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="eec6e-203">После вызова метода [System. Management. Automation. Provider. кмдлетпровидер. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) возвращает `true`, метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. ренамеитем \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) должен вызывать [ Метод System. Management. Automation. Provider. Кмдлетпровидер. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-203">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="eec6e-204">Этот метод отправляет пользователю сообщение с подтверждением, чтобы разрешить дополнительные отзывы, чтобы сказать, следует ли продолжать операцию.</span><span class="sxs-lookup"><span data-stu-id="eec6e-204">This method sends a message a confirmation message to the user to allow additional feedback to say if the operation should be continued.</span></span> <span data-ttu-id="eec6e-205">Поставщик должен вызывать [System. Management. Automation. Provider. кмдлетпровидер. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) в качестве дополнительной проверки потенциально опасной модификации системы.</span><span class="sxs-lookup"><span data-stu-id="eec6e-205">A provider should call [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-rename-item-cmdlet"></a><span data-ttu-id="eec6e-206">Присоединение динамических параметров к командлету Rename-Item</span><span class="sxs-lookup"><span data-stu-id="eec6e-206">Attaching Dynamic Parameters to the Rename-Item Cmdlet</span></span>

<span data-ttu-id="eec6e-207">Иногда командлету `Rename-Item` требуются дополнительные параметры, которые задаются динамически во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="eec6e-207">Sometimes the `Rename-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="eec6e-208">Чтобы предоставить эти динамические параметры, поставщик контейнера Windows PowerShell должен реализовать метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. ренамеитемдинамикпараметерс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-208">To provide these dynamic parameters, Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) method.</span></span> <span data-ttu-id="eec6e-209">Этот метод получает параметры для элемента по указанному пути и возвращает объект со свойствами и полями с атрибутами синтаксического анализа, похожими на класс командлета или [System. Management. Automation. рунтимедефинедпараметердиктионари](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) объектами.</span><span class="sxs-lookup"><span data-stu-id="eec6e-209">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="eec6e-210">Среда выполнения Windows PowerShell использует возвращенный объект для добавления параметров в командлет `Rename-Item`.</span><span class="sxs-lookup"><span data-stu-id="eec6e-210">The Windows PowerShell runtime uses the returned object to add the parameters to the `Rename-Item` cmdlet.</span></span>

<span data-ttu-id="eec6e-211">Этот метод не реализуется этим поставщиком контейнера.</span><span class="sxs-lookup"><span data-stu-id="eec6e-211">This container provider does not implement this method.</span></span> <span data-ttu-id="eec6e-212">Однако приведенный ниже код является реализацией этого метода по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="eec6e-212">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters](Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters)]  -->

## <a name="creating-new-items"></a><span data-ttu-id="eec6e-213">Создание новых элементов</span><span class="sxs-lookup"><span data-stu-id="eec6e-213">Creating New Items</span></span>

<span data-ttu-id="eec6e-214">Для создания новых элементов поставщик контейнера должен реализовать метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) для поддержки вызовов из командлета `New-Item`.</span><span class="sxs-lookup"><span data-stu-id="eec6e-214">To create new items, a container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method to support calls from the `New-Item` cmdlet.</span></span> <span data-ttu-id="eec6e-215">Этот метод создает элемент данных, расположенный по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="eec6e-215">This method creates a data item located at the specified path.</span></span> <span data-ttu-id="eec6e-216">Параметр `type` командлета содержит тип, определяемый поставщиком для нового элемента.</span><span class="sxs-lookup"><span data-stu-id="eec6e-216">The `type` parameter of the cmdlet contains the provider-defined type for the new item.</span></span> <span data-ttu-id="eec6e-217">Например, Поставщик FileSystem использует параметр `type` со значением "File" или "Directory".</span><span class="sxs-lookup"><span data-stu-id="eec6e-217">For example, the FileSystem provider uses a `type` parameter with a value of "file" or "directory".</span></span> <span data-ttu-id="eec6e-218">Параметр `newItemValue` командлета задает зависящее от поставщика значение для нового элемента.</span><span class="sxs-lookup"><span data-stu-id="eec6e-218">The `newItemValue` parameter of the cmdlet specifies a provider-specific value for the new item.</span></span>

<span data-ttu-id="eec6e-219">Ниже приведена реализация метода [System. Management. Automation. Provider. контаинеркмдлетпровидер. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) для этого поставщика.</span><span class="sxs-lookup"><span data-stu-id="eec6e-219">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method for this provider.</span></span>

```csharp
protected override void NewItem( string path, string type,
                                 object newItemValue )
{
    // Create the new item here after
    // performing necessary validations
    //
    // WriteItemObject(newItemValue, path, false);

    // Example
    //
    // if (ShouldProcess(path, "new item"))
    // {
    //      // Create a new item and then call WriteObject
    //      WriteObject(newItemValue, path, false);
    // }

} // NewItem
```

[!code-csharp[AccessDBProviderSample04.cs](../../../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L939-L955 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-newitem"></a><span data-ttu-id="eec6e-220">Вопросы, связанные с реализацией NewItem</span><span class="sxs-lookup"><span data-stu-id="eec6e-220">Things to Remember About Implementing NewItem</span></span>

<span data-ttu-id="eec6e-221">Следующие условия могут применяться к реализации [System. Management. Automation. Provider. контаинеркмдлетпровидер. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="eec6e-221">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="eec6e-222">Метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) должен выполнять сравнение строк, переданных в параметре `type`, без учета регистра.</span><span class="sxs-lookup"><span data-stu-id="eec6e-222">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should perform a case-insensitive comparison of the string passed in the `type` parameter.</span></span> <span data-ttu-id="eec6e-223">Он также должен позволять наименее неоднозначные совпадения.</span><span class="sxs-lookup"><span data-stu-id="eec6e-223">It should also allow for least ambiguous matches.</span></span> <span data-ttu-id="eec6e-224">Например, для типов "File" и "Directory" для устранения неоднозначности требуется только первая буква.</span><span class="sxs-lookup"><span data-stu-id="eec6e-224">For example, for the types "file" and "directory", only the first letter is required to disambiguate.</span></span> <span data-ttu-id="eec6e-225">Если параметр `type` указывает тип, который поставщик не может создать, метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) должен записать ArgumentException с сообщением, указывающим типы, которые поставщик может создания.</span><span class="sxs-lookup"><span data-stu-id="eec6e-225">If the `type` parameter indicates a type your provider cannot create, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should write an ArgumentException with a message indicating the types the provider can create.</span></span>

- <span data-ttu-id="eec6e-226">Для параметра `newItemValue` рекомендуется реализовать метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) , чтобы принимать строки как минимум.</span><span class="sxs-lookup"><span data-stu-id="eec6e-226">For the `newItemValue` parameter, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method is recommended to accept strings at a minimum.</span></span> <span data-ttu-id="eec6e-227">Он также должен принять тип объекта, который извлекается методом [System. Management. Automation. Provider. итемкмдлетпровидер. GetObject \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) для того же пути.</span><span class="sxs-lookup"><span data-stu-id="eec6e-227">It should also accept the type of object that is retrieved by the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the same path.</span></span> <span data-ttu-id="eec6e-228">Метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) может использовать метод [System. Management. Automation. Languageprimitives. ConvertTo \*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) для преобразования типов в нужный тип.</span><span class="sxs-lookup"><span data-stu-id="eec6e-228">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method can use the [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) method to convert types to the desired type.</span></span>

- <span data-ttu-id="eec6e-229">Реализация метода [System. Management. Automation. Provider. контаинеркмдлетпровидер. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) должна вызывать [System. Management. Automation. Provider. кмдлетпровидер. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) и проверять его возвращаемое значение до внесение любых изменений в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="eec6e-229">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="eec6e-230">После вызова метода [System. Management. Automation. Provider. кмдлетпровидер. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) возвращает значение true, метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) должен вызывать [ Метод System. Management. Automation. Provider. Кмдлетпровидер. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) в качестве дополнительной проверки потенциально опасного изменения системы.</span><span class="sxs-lookup"><span data-stu-id="eec6e-230">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-new-item-cmdlet"></a><span data-ttu-id="eec6e-231">Присоединение динамических параметров к командлету New-Item</span><span class="sxs-lookup"><span data-stu-id="eec6e-231">Attaching Dynamic Parameters to the New-Item Cmdlet</span></span>

<span data-ttu-id="eec6e-232">Иногда командлету `New-Item` требуются дополнительные параметры, которые задаются динамически во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="eec6e-232">Sometimes the `New-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="eec6e-233">Чтобы предоставить эти динамические параметры, поставщик контейнера должен реализовать метод [System. Management. автоматизации. Provider. контаинеркмдлетпровидер. невитемдинамикпараметерс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-233">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) method.</span></span> <span data-ttu-id="eec6e-234">Этот метод получает параметры для элемента по указанному пути и возвращает объект со свойствами и полями с атрибутами синтаксического анализа, похожими на класс командлета или [System. Management. Automation. рунтимедефинедпараметердиктионари](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) объектами.</span><span class="sxs-lookup"><span data-stu-id="eec6e-234">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="eec6e-235">Среда выполнения Windows PowerShell использует возвращенный объект для добавления параметров в командлет `New-Item`.</span><span class="sxs-lookup"><span data-stu-id="eec6e-235">The Windows PowerShell runtime uses the returned object to add the parameters to the `New-Item` cmdlet.</span></span>

<span data-ttu-id="eec6e-236">Этот метод не реализуется этим поставщиком.</span><span class="sxs-lookup"><span data-stu-id="eec6e-236">This provider does not implement this method.</span></span> <span data-ttu-id="eec6e-237">Однако приведенный ниже код является реализацией этого метода по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="eec6e-237">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernewitemdynamicparameters](Msh_samplestestcmdlets#testprovidernewitemdynamicparameters)]  -->

## <a name="removing-items"></a><span data-ttu-id="eec6e-238">Удаление элементов</span><span class="sxs-lookup"><span data-stu-id="eec6e-238">Removing Items</span></span>

<span data-ttu-id="eec6e-239">Чтобы удалить элементы, поставщик Windows PowerShell должен переопределить метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) для поддержки вызовов из командлета `Remove-Item`.</span><span class="sxs-lookup"><span data-stu-id="eec6e-239">To remove items, the Windows PowerShell provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method to support calls from the `Remove-Item` cmdlet.</span></span> <span data-ttu-id="eec6e-240">Этот метод удаляет элемент из хранилища данных по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="eec6e-240">This method deletes an item from the data store at the specified path.</span></span> <span data-ttu-id="eec6e-241">Если параметр `recurse` командлета `Remove-Item` имеет значение `true`, метод удаляет все дочерние элементы независимо от их уровня.</span><span class="sxs-lookup"><span data-stu-id="eec6e-241">If the `recurse` parameter of the `Remove-Item` cmdlet is set to `true`, the method removes all child items regardless of their level.</span></span> <span data-ttu-id="eec6e-242">Если параметр имеет значение `false`, метод удаляет только один элемент по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="eec6e-242">If the parameter is set to `false`, the method removes only a single item at the specified path.</span></span>

<span data-ttu-id="eec6e-243">Этот поставщик не поддерживает удаление элементов.</span><span class="sxs-lookup"><span data-stu-id="eec6e-243">This provider does not support item removal.</span></span> <span data-ttu-id="eec6e-244">Однако следующий код является реализацией класса [System. Management. Automation. Provider. контаинеркмдлетпровидер. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem)по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="eec6e-244">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitem](Msh_samplestestcmdlets#testproviderremoveitem)]  -->

#### <a name="things-to-remember-about-implementing-removeitem"></a><span data-ttu-id="eec6e-245">Вопросы, связанные с реализацией RemoveItem</span><span class="sxs-lookup"><span data-stu-id="eec6e-245">Things to Remember About Implementing RemoveItem</span></span>

<span data-ttu-id="eec6e-246">Следующие условия могут применяться к реализации [System. Management. Automation. Provider. контаинеркмдлетпровидер. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="eec6e-246">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="eec6e-247">При определении класса поставщика поставщик контейнера Windows PowerShell может объявлять возможности поставщика Експандвилдкардс, Filter, include или Exclude из перечисления [System. Management. Automation. Provider. провидеркапабилитиес](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-247">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="eec6e-248">В таких случаях реализация метода [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) должна обеспечить соответствие пути, переданного методу, требованиям указанных возможностей.</span><span class="sxs-lookup"><span data-stu-id="eec6e-248">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="eec6e-249">Для этого метод должен получить доступ к соответствующему свойству, например к свойствам [System. Management. Automation. Provider. кмдлетпровидер. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) и [System. Management. Automation. Provider. кмдлетпровидер. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-249">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="eec6e-250">По умолчанию переопределения этого метода не должны удалять объекты, если свойство [System. Management. Automation. Provider. кмдлетпровидер. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) не имеет значение true.</span><span class="sxs-lookup"><span data-stu-id="eec6e-250">By default, overrides of this method should not remove objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to true.</span></span> <span data-ttu-id="eec6e-251">Если указанный путь указывает на контейнер, свойство [System. Management. Automation. Provider. кмдлетпровидер. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) не является обязательным.</span><span class="sxs-lookup"><span data-stu-id="eec6e-251">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="eec6e-252">Реализация [System. Management. Automation. Provider. контаинеркмдлетпровидер. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) отвечает за предотвращение бесконечной рекурсии при наличии циклических ссылок и подобной.</span><span class="sxs-lookup"><span data-stu-id="eec6e-252">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="eec6e-253">Для отражения такого условия должно быть создано соответствующее завершающее исключение.</span><span class="sxs-lookup"><span data-stu-id="eec6e-253">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="eec6e-254">Реализация метода [System. Management. Automation. Provider. контаинеркмдлетпровидер. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) должна вызывать [System. Management. Automation. Provider. кмдлетпровидер. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) и проверять его возвращаемое значение до внесение любых изменений в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="eec6e-254">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="eec6e-255">После вызова метода [System. Management. Automation. Provider. кмдлетпровидер. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) возвращает `true`, метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) должен вызывать [ Метод System. Management. Automation. Provider. Кмдлетпровидер. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) в качестве дополнительной проверки потенциально опасного изменения системы.</span><span class="sxs-lookup"><span data-stu-id="eec6e-255">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-remove-item-cmdlet"></a><span data-ttu-id="eec6e-256">Присоединение динамических параметров к командлету Remove-Item</span><span class="sxs-lookup"><span data-stu-id="eec6e-256">Attaching Dynamic Parameters to the Remove-Item Cmdlet</span></span>

<span data-ttu-id="eec6e-257">Иногда командлету `Remove-Item` требуются дополнительные параметры, которые задаются динамически во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="eec6e-257">Sometimes the `Remove-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="eec6e-258">Чтобы предоставить эти динамические параметры, поставщик контейнера должен реализовать метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. ремовеитемдинамикпараметерс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) для работы с этими параметрами.</span><span class="sxs-lookup"><span data-stu-id="eec6e-258">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="eec6e-259">Этот метод получает динамические параметры для элемента по указанному пути и возвращает объект со свойствами и полями с атрибутами синтаксического анализа, похожими на класс командлета или [System. Management. Automation. рунтимедефинедпараметердиктионари ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)объект.</span><span class="sxs-lookup"><span data-stu-id="eec6e-259">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="eec6e-260">Среда выполнения Windows PowerShell использует возвращенный объект для добавления параметров в командлет `Remove-Item`.</span><span class="sxs-lookup"><span data-stu-id="eec6e-260">The Windows PowerShell runtime uses the returned object to add the parameters to the `Remove-Item` cmdlet.</span></span>

<span data-ttu-id="eec6e-261">Этот метод не реализуется этим поставщиком контейнера.</span><span class="sxs-lookup"><span data-stu-id="eec6e-261">This container provider does not implement this method.</span></span> <span data-ttu-id="eec6e-262">Однако следующий код является реализацией класса [System. Management. Automation. Provider. контаинеркмдлетпровидер. ремовеитемдинамикпараметерс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters)по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="eec6e-262">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters](Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters)]  -->

## <a name="querying-for-child-items"></a><span data-ttu-id="eec6e-263">Запрос дочерних элементов</span><span class="sxs-lookup"><span data-stu-id="eec6e-263">Querying for Child Items</span></span>

<span data-ttu-id="eec6e-264">Чтобы проверить, существуют ли дочерние элементы по указанному пути, поставщик контейнера Windows PowerShell должен переопределить метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. хасчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-264">To check to see if child items exist at the specified path, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="eec6e-265">Этот метод возвращает `true`, если элемент имеет дочерние элементы, и `false` в противном случае.</span><span class="sxs-lookup"><span data-stu-id="eec6e-265">This method returns `true` if the item has children, and `false` otherwise.</span></span> <span data-ttu-id="eec6e-266">Для неопределенного или пустого пути метод считает, что все элементы в хранилище данных являются дочерними, и возвращает `true`.</span><span class="sxs-lookup"><span data-stu-id="eec6e-266">For a null or empty path, the method considers any items in the data store to be children and returns `true`.</span></span>

<span data-ttu-id="eec6e-267">Ниже приведено переопределение для метода [System. Management. Automation. Provider. контаинеркмдлетпровидер. хасчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-267">Here is the override for the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="eec6e-268">При наличии более двух частей пути, созданных вспомогательным методом Чункпас, метод возвращает `false`, так как определены только контейнер базы данных и контейнер таблицы.</span><span class="sxs-lookup"><span data-stu-id="eec6e-268">If there are more than two path parts created by the ChunkPath helper method, the method returns `false`, since only a database container and a table container are defined.</span></span> <span data-ttu-id="eec6e-269">Дополнительные сведения об этом вспомогательном методе см. в описании метода Чункпас в разделе [Создание поставщика элементов Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="eec6e-269">For more information about this helper method, see the ChunkPath method is discussed in [Creating a Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

```csharp
protected override bool HasChildItems( string path )
{
    return false;
} // HasChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L1094-L1097 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-haschilditems"></a><span data-ttu-id="eec6e-270">Вопросы, связанные с реализацией Хасчилдитемс</span><span class="sxs-lookup"><span data-stu-id="eec6e-270">Things to Remember About Implementing HasChildItems</span></span>

<span data-ttu-id="eec6e-271">Следующие условия могут применяться к реализации [System. Management. Automation. Provider. контаинеркмдлетпровидер. хасчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span><span class="sxs-lookup"><span data-stu-id="eec6e-271">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span></span>

- <span data-ttu-id="eec6e-272">Если поставщик контейнеров предоставляет корень, который содержит интересные точки подключения, реализация метода [System. Management. Automation. Provider. контаинеркмдлетпровидер. хасчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) должна возвращать `true`, если значение null или пустое строка передается в качестве пути.</span><span class="sxs-lookup"><span data-stu-id="eec6e-272">If the container provider exposes a root that contains interesting mount points, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method should return `true` when a null or an empty string is passed in for the path.</span></span>

## <a name="copying-items"></a><span data-ttu-id="eec6e-273">Копирование элементов</span><span class="sxs-lookup"><span data-stu-id="eec6e-273">Copying Items</span></span>

<span data-ttu-id="eec6e-274">Для копирования элементов поставщик контейнера должен реализовать метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) для поддержки вызовов из командлета `Copy-Item`.</span><span class="sxs-lookup"><span data-stu-id="eec6e-274">To copy items, the container provider must implement the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method to support calls from the `Copy-Item` cmdlet.</span></span> <span data-ttu-id="eec6e-275">Этот метод копирует элемент данных из расположения, указанного параметром `path` командлета, в расположение, указанное параметром `copyPath`.</span><span class="sxs-lookup"><span data-stu-id="eec6e-275">This method copies a data item from the location indicated by the `path` parameter of the cmdlet to the location indicated by the `copyPath` parameter.</span></span> <span data-ttu-id="eec6e-276">Если указан параметр `recurse`, метод копирует все подконтейнеры.</span><span class="sxs-lookup"><span data-stu-id="eec6e-276">If the `recurse` parameter is specified, the method copies all sub-containers.</span></span> <span data-ttu-id="eec6e-277">Если параметр не указан, метод копирует только один уровень элементов.</span><span class="sxs-lookup"><span data-stu-id="eec6e-277">If the parameter is not specified, the method copies only a single level of items.</span></span>

<span data-ttu-id="eec6e-278">Этот метод не реализуется этим поставщиком.</span><span class="sxs-lookup"><span data-stu-id="eec6e-278">This provider does not implement this method.</span></span> <span data-ttu-id="eec6e-279">Однако следующий код является реализацией класса [System. Management. Automation. Provider. контаинеркмдлетпровидер. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem)по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="eec6e-279">However, the following code is the default implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitem](Msh_samplestestcmdlets#testprovidercopyitem)]  -->

#### <a name="things-to-remember-about-implementing-copyitem"></a><span data-ttu-id="eec6e-280">Вопросы, связанные с реализацией CopyItem</span><span class="sxs-lookup"><span data-stu-id="eec6e-280">Things to Remember About Implementing CopyItem</span></span>

<span data-ttu-id="eec6e-281">Следующие условия могут применяться к реализации [System. Management. Automation. Provider. контаинеркмдлетпровидер. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span><span class="sxs-lookup"><span data-stu-id="eec6e-281">The following conditions may apply to your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span></span>

- <span data-ttu-id="eec6e-282">При определении класса поставщика поставщик контейнера Windows PowerShell может объявлять возможности поставщика Експандвилдкардс, Filter, include или Exclude из перечисления [System. Management. Automation. Provider. провидеркапабилитиес](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-282">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="eec6e-283">В таких случаях реализация метода [System. Management. Automation. Provider. контаинеркмдлетпровидер. жетчилдитемс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) должна обеспечить соответствие пути, переданного методу, требованиям указанных возможностей.</span><span class="sxs-lookup"><span data-stu-id="eec6e-283">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="eec6e-284">Для этого метод должен получить доступ к соответствующему свойству, например к свойствам [System. Management. Automation. Provider. кмдлетпровидер. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) и [System. Management. Automation. Provider. кмдлетпровидер. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="eec6e-284">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="eec6e-285">По умолчанию переопределения этого метода не должны копировать объекты поверх существующих объектов, если свойство [System. Management. Automation. Provider. кмдлетпровидер. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) не имеет значение `true`.</span><span class="sxs-lookup"><span data-stu-id="eec6e-285">By default, overrides of this method should not copy objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="eec6e-286">Например, Поставщик FileSystem не будет копировать к:\темп\абк.ткст в существующий файл к:\абк.ткст, если свойство [System. Management. Automation. Provider. кмдлетпровидер. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) не имеет значение `true`.</span><span class="sxs-lookup"><span data-stu-id="eec6e-286">For example, the FileSystem provider will not copy c:\temp\abc.txt over an existing c:\abc.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="eec6e-287">Если путь, указанный в параметре `copyPath`, существует и указывает на контейнер, свойство [System. Management. Automation. Provider. кмдлетпровидер. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) не требуется.</span><span class="sxs-lookup"><span data-stu-id="eec6e-287">If the path specified in the `copyPath` parameter exists and indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="eec6e-288">В этом случае [System. Management. Automation. Provider. контаинеркмдлетпровидер. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) должен скопировать элемент, указанный параметром `path`, в контейнер, указанный параметром `copyPath` в качестве дочернего.</span><span class="sxs-lookup"><span data-stu-id="eec6e-288">In this case, [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) should copy the item indicated by the `path` parameter to the container indicated by the `copyPath` parameter as a child.</span></span>

- <span data-ttu-id="eec6e-289">Реализация [System. Management. Automation. Provider. контаинеркмдлетпровидер. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) отвечает за предотвращение бесконечной рекурсии при наличии циклических ссылок и подобной.</span><span class="sxs-lookup"><span data-stu-id="eec6e-289">Your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="eec6e-290">Для отражения такого условия должно быть создано соответствующее завершающее исключение.</span><span class="sxs-lookup"><span data-stu-id="eec6e-290">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="eec6e-291">Реализация метода [System. Management. Automation. Provider. контаинеркмдлетпровидер. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) должна вызывать [System. Management. Automation. Provider. кмдлетпровидер. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) и проверять его возвращаемое значение до внесение любых изменений в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="eec6e-291">Your implementation of the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="eec6e-292">После вызова метода [System. Management. Automation. Provider. кмдлетпровидер. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) возвращает значение true, метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) должен вызывать [ Метод System. Management. Automation. Provider. Кмдлетпровидер. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) в качестве дополнительной проверки потенциально опасного изменения системы.</span><span class="sxs-lookup"><span data-stu-id="eec6e-292">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span> <span data-ttu-id="eec6e-293">Дополнительные сведения о вызове этих методов см. в разделе [Rename Items](#renaming-items).</span><span class="sxs-lookup"><span data-stu-id="eec6e-293">For more information about calling these methods, see [Rename Items](#renaming-items).</span></span>

## <a name="attaching-dynamic-parameters-to-the-copy-item-cmdlet"></a><span data-ttu-id="eec6e-294">Присоединение динамических параметров к командлету Copy-Item</span><span class="sxs-lookup"><span data-stu-id="eec6e-294">Attaching Dynamic Parameters to the Copy-Item Cmdlet</span></span>

<span data-ttu-id="eec6e-295">Иногда командлету `Copy-Item` требуются дополнительные параметры, которые задаются динамически во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="eec6e-295">Sometimes the `Copy-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="eec6e-296">Чтобы предоставить эти динамические параметры, поставщик контейнера Windows PowerShell должен реализовать метод [System. Management. Automation. Provider. контаинеркмдлетпровидер. копитемдинамикпараметерс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) для работы с этими параметрами.</span><span class="sxs-lookup"><span data-stu-id="eec6e-296">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="eec6e-297">Этот метод получает параметры для элемента по указанному пути и возвращает объект со свойствами и полями с атрибутами синтаксического анализа, похожими на класс командлета или [System. Management. Automation. рунтимедефинедпараметердиктионари](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) объектами.</span><span class="sxs-lookup"><span data-stu-id="eec6e-297">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="eec6e-298">Среда выполнения Windows PowerShell использует возвращенный объект для добавления параметров в командлет `Copy-Item`.</span><span class="sxs-lookup"><span data-stu-id="eec6e-298">The Windows PowerShell runtime uses the returned object to add the parameters to the `Copy-Item` cmdlet.</span></span>

<span data-ttu-id="eec6e-299">Этот метод не реализуется этим поставщиком.</span><span class="sxs-lookup"><span data-stu-id="eec6e-299">This provider does not implement this method.</span></span> <span data-ttu-id="eec6e-300">Однако следующий код является реализацией класса [System. Management. Automation. Provider. контаинеркмдлетпровидер. копитемдинамикпараметерс \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters)по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="eec6e-300">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters](Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters)]  -->

## <a name="code-sample"></a><span data-ttu-id="eec6e-301">Пример кода</span><span class="sxs-lookup"><span data-stu-id="eec6e-301">Code Sample</span></span>

<span data-ttu-id="eec6e-302">Полный пример кода см. в разделе [пример кода AccessDbProviderSample04](./accessdbprovidersample04-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="eec6e-302">For complete sample code, see [AccessDbProviderSample04 Code Sample](./accessdbprovidersample04-code-sample.md).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="eec6e-303">Создание поставщика Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="eec6e-303">Building the Windows PowerShell Provider</span></span>

<span data-ttu-id="eec6e-304">См. раздел [Регистрация командлетов, поставщиков и ведущих приложений](https://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="eec6e-304">See [How to Register Cmdlets, Providers, and Host Applications](https://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="eec6e-305">Тестирование поставщика Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="eec6e-305">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="eec6e-306">Когда ваш поставщик Windows PowerShell зарегистрирован в Windows PowerShell, его можно проверить, запустив в командной строке поддерживаемые командлеты.</span><span class="sxs-lookup"><span data-stu-id="eec6e-306">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="eec6e-307">Имейте в виду, что в следующем примере выходных данных используется вымышленная БД Access.</span><span class="sxs-lookup"><span data-stu-id="eec6e-307">Be aware that the following example output uses a fictitious Access database.</span></span>

1. <span data-ttu-id="eec6e-308">Выполните командлет `Get-ChildItem`, чтобы получить список дочерних элементов из таблицы Customers в базе данных Access.</span><span class="sxs-lookup"><span data-stu-id="eec6e-308">Run the `Get-ChildItem` cmdlet to retrieve the list of child items from a Customers table in the Access database.</span></span>

   ```powershell
   Get-ChildItem mydb:customers
   ```

   <span data-ttu-id="eec6e-309">Отобразятся следующие выходные данные.</span><span class="sxs-lookup"><span data-stu-id="eec6e-309">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : True
   Data          : System.Data.DataRow
   Name          : Customers
   RowCount      : 91
   Columns       :
   ```

2. <span data-ttu-id="eec6e-310">Выполните командлет `Get-ChildItem` еще раз, чтобы получить данные таблицы.</span><span class="sxs-lookup"><span data-stu-id="eec6e-310">Run the `Get-ChildItem` cmdlet again to retrieve the data of a table.</span></span>

   ```powershell
   (Get-ChildItem mydb:customers).data
   ```

   <span data-ttu-id="eec6e-311">Отобразятся следующие выходные данные.</span><span class="sxs-lookup"><span data-stu-id="eec6e-311">The following output appears.</span></span>

   ```output
   TABLE_CAT   : c:\PS\northwind
   TABLE_SCHEM :
   TABLE_NAME  : Customers
   TABLE_TYPE  : TABLE
   REMARKS     :
   ```

3. <span data-ttu-id="eec6e-312">Теперь используйте командлет `Get-Item` для получения элементов в строке 0 в таблице данных.</span><span class="sxs-lookup"><span data-stu-id="eec6e-312">Now use the `Get-Item` cmdlet to retrieve the items at row 0 in the data table.</span></span>

   ```powershell
   Get-Item mydb:\customers\0
   ```

   <span data-ttu-id="eec6e-313">Отобразятся следующие выходные данные.</span><span class="sxs-lookup"><span data-stu-id="eec6e-313">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers\0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data          : System.Data.DataRow
   RowNumber     : 0
   ```

4. <span data-ttu-id="eec6e-314">Повторно используйте `Get-Item`, чтобы получить данные для элементов в строке 0.</span><span class="sxs-lookup"><span data-stu-id="eec6e-314">Reuse `Get-Item` to retrieve the data for the items in row 0.</span></span>

   ```powershell
   (Get-Item mydb:\customers\0).data
   ```

   <span data-ttu-id="eec6e-315">Отобразятся следующие выходные данные.</span><span class="sxs-lookup"><span data-stu-id="eec6e-315">The following output appears.</span></span>

   ```output
   CustomerID   : 1234
   CompanyName  : Fabrikam
   ContactName  : Eric Gruber
   ContactTitle : President
   Address      : 4567 Main Street
   City         : Buffalo
   Region       : NY
   PostalCode   : 98052
   Country      : USA
   Phone        : (425) 555-0100
   Fax          : (425) 555-0101
   ```

5. <span data-ttu-id="eec6e-316">Теперь используйте командлет `New-Item`, чтобы добавить строку в существующую таблицу.</span><span class="sxs-lookup"><span data-stu-id="eec6e-316">Now use the `New-Item` cmdlet to add a row to an existing table.</span></span> <span data-ttu-id="eec6e-317">Параметр `Path` указывает полный путь к строке и должен указывать номер строки, который больше, чем существующее число строк в таблице.</span><span class="sxs-lookup"><span data-stu-id="eec6e-317">The `Path` parameter specifies the full path to the row, and must indicate a row number that is greater than the existing number of rows in the table.</span></span> <span data-ttu-id="eec6e-318">Параметр `Type` указывает строку, указывающую тип добавляемого элемента.</span><span class="sxs-lookup"><span data-stu-id="eec6e-318">The `Type` parameter indicates "row" to specify that type of item to add.</span></span> <span data-ttu-id="eec6e-319">Наконец, параметр `Value` задает разделенный запятыми список значений столбцов для строки.</span><span class="sxs-lookup"><span data-stu-id="eec6e-319">Finally, the `Value` parameter specifies a comma-delimited list of column values for the row.</span></span>

   ```powershell
   New-Item -Path mydb:\Customers\3 -ItemType "row" -Value "3,CustomerFirstName,CustomerLastName,CustomerEmailAddress,CustomerTitle,CustomerCompany,CustomerPhone, CustomerAddress,CustomerCity,CustomerState,CustomerZip,CustomerCountry"
   ```

6. <span data-ttu-id="eec6e-320">Проверьте правильность операции создания элемента следующим образом.</span><span class="sxs-lookup"><span data-stu-id="eec6e-320">Verify the correctness of the new item operation as follows.</span></span>

   ```none
   PS mydb:\> cd Customers
   PS mydb:\Customers> (Get-Item 3).data
   ```

   <span data-ttu-id="eec6e-321">Отобразятся следующие выходные данные.</span><span class="sxs-lookup"><span data-stu-id="eec6e-321">The following output appears.</span></span>

   ```output
   ID        : 3
   FirstName : Eric
   LastName  : Gruber
   Email     : ericgruber@fabrikam.com
   Title     : President
   Company   : Fabrikam
   WorkPhone : (425) 555-0100
   Address   : 4567 Main Street
   City      : Buffalo
   State     : NY
   Zip       : 98052
   Country   : USA
   ```

## <a name="see-also"></a><span data-ttu-id="eec6e-322">См. также:</span><span class="sxs-lookup"><span data-stu-id="eec6e-322">See Also</span></span>

[<span data-ttu-id="eec6e-323">Создание поставщиков Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="eec6e-323">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="eec6e-324">Разработка поставщика Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="eec6e-324">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="eec6e-325">Реализация поставщика элемента Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="eec6e-325">Implementing an Item Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-item-provider.md)

[<span data-ttu-id="eec6e-326">Реализация поставщика навигации Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="eec6e-326">Implementing a Navigation Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)

[<span data-ttu-id="eec6e-327">Регистрация командлетов, поставщиков и ведущих приложений</span><span class="sxs-lookup"><span data-stu-id="eec6e-327">How to Register Cmdlets, Providers, and Host Applications</span></span>](https://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="eec6e-328">Пакет SDK для Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="eec6e-328">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="eec6e-329">Руководством программиста Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="eec6e-329">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)
