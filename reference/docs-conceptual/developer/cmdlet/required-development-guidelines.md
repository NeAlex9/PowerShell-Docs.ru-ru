---
ms.date: 09/13/2016
ms.topic: reference
title: Обязательные требования к разработке
description: Обязательные требования к разработке
ms.openlocfilehash: 98db075b314eb7f54f2deb56022799d9f830f9ef
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "92655758"
---
# <a name="required-development-guidelines"></a><span data-ttu-id="3dd9c-103">Обязательные требования к разработке</span><span class="sxs-lookup"><span data-stu-id="3dd9c-103">Required Development Guidelines</span></span>

<span data-ttu-id="3dd9c-104">При написании командлетов необходимо следовать приведенным ниже рекомендациям.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-104">The following guidelines must be followed when you write your cmdlets.</span></span> <span data-ttu-id="3dd9c-105">Они разделены на рекомендации по проектированию командлетов и руководств по написанию кода командлета.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-105">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="3dd9c-106">Если не следовать этим рекомендациям, командлеты могут завершиться сбоем, и пользователи могут столкнуться с плохими возможностями при использовании командлетов.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-106">If you do not follow these guidelines, your cmdlets could fail, and your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="in-this-topic"></a><span data-ttu-id="3dd9c-107">В этом разделе</span><span class="sxs-lookup"><span data-stu-id="3dd9c-107">In this Topic</span></span>

### <a name="design-guidelines"></a><span data-ttu-id="3dd9c-108">Рекомендации по разработке</span><span class="sxs-lookup"><span data-stu-id="3dd9c-108">Design Guidelines</span></span>

- [<span data-ttu-id="3dd9c-109">Использовать только утвержденные команды (RD01)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-109">Use Only Approved Verbs (RD01)</span></span>](./required-development-guidelines.md#use-only-approved-verbs-rd01)

- [<span data-ttu-id="3dd9c-110">Имена командлетов: символы, которые не могут быть использованы (RD02)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-110">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>](./required-development-guidelines.md#cmdlet-names-characters-that-cannot-be-used-rd02)

- [<span data-ttu-id="3dd9c-111">Имена параметров, которые нельзя использовать (RD03)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-111">Parameters Names that cannot be Used (RD03)</span></span>](./required-development-guidelines.md#parameters-names-that-cannot-be-used-rd03)

- [<span data-ttu-id="3dd9c-112">Запросы на подтверждение поддержки (RD04)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-112">Support Confirmation Requests (RD04)</span></span>](./required-development-guidelines.md#support-confirmation-requests-rd04)

- [<span data-ttu-id="3dd9c-113">Поддержка параметра Force для интерактивных сеансов (RD05)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-113">Support Force Parameter for Interactive Sessions (RD05)</span></span>](./required-development-guidelines.md#support-force-parameter-for-interactive-sessions-rd05)

- [<span data-ttu-id="3dd9c-114">Объекты вывода документа (RD06)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-114">Document Output Objects (RD06)</span></span>](./required-development-guidelines.md#document-output-objects-rd06)

### <a name="code-guidelines"></a><span data-ttu-id="3dd9c-115">Рекомендации по коду</span><span class="sxs-lookup"><span data-stu-id="3dd9c-115">Code Guidelines</span></span>

- [<span data-ttu-id="3dd9c-116">Наследование от классов командлета или PSCmdlet (RC01)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-116">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>](./required-development-guidelines.md#derive-from-the-cmdlet-or-pscmdlet-classes-rc01)

- [<span data-ttu-id="3dd9c-117">Укажите атрибут командлета (RC02)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-117">Specify the Cmdlet Attribute (RC02)</span></span>](./required-development-guidelines.md#specify-the-cmdlet-attribute-rc02)

- [<span data-ttu-id="3dd9c-118">Переопределение метода обработки ввода (RC03)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-118">Override an Input Processing Method (RC03)</span></span>](./required-development-guidelines.md#override-an-input-processing-method-rc03)

- [<span data-ttu-id="3dd9c-119">Указание атрибута OutputType (RC04)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-119">Specify the OutputType Attribute (RC04)</span></span>](./required-development-guidelines.md#specify-the-outputtype-attribute-rc04)

- [<span data-ttu-id="3dd9c-120">Не сохраняйте дескрипторы для выходных объектов (RC05)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-120">Do Not Retain Handles to Output Objects (RC05)</span></span>](./required-development-guidelines.md#do-not-retain-handles-to-output-objects-rc05)

- [<span data-ttu-id="3dd9c-121">Устойчивая работа с ошибками (RC06)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-121">Handle Errors Robustly (RC06)</span></span>](./required-development-guidelines.md#handle-errors-robustly-rc06)

- [<span data-ttu-id="3dd9c-122">Использование модуля Windows PowerShell для развертывания командлетов (RC07)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-122">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>](./required-development-guidelines.md#use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07)

## <a name="design-guidelines"></a><span data-ttu-id="3dd9c-123">Рекомендации по разработке</span><span class="sxs-lookup"><span data-stu-id="3dd9c-123">Design Guidelines</span></span>

<span data-ttu-id="3dd9c-124">При проектировании командлетов необходимо следовать приведенным ниже рекомендациям, чтобы обеспечить согласованное взаимодействие с пользователем при использовании командлетов и других командлетов.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-124">The following guidelines must be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="3dd9c-125">Если вы нашли рекомендации по проектированию, применимые к вашей ситуации, ознакомьтесь с рекомендациями по написанию кода для аналогичных руководств.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-125">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-only-approved-verbs-rd01"></a><span data-ttu-id="3dd9c-126">Использовать только утвержденные команды (RD01)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-126">Use Only Approved Verbs (RD01)</span></span>

<span data-ttu-id="3dd9c-127">Команда, указанная в атрибуте командлета, должна поступать из распознанного набора команд, предоставляемых Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-127">The verb specified in the Cmdlet attribute must come from the recognized set of verbs provided by Windows PowerShell.</span></span> <span data-ttu-id="3dd9c-128">Он не должен быть одним из запрещенных синонимов.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-128">It must not be one of the prohibited synonyms.</span></span> <span data-ttu-id="3dd9c-129">Используйте константные строки, определенные следующими перечислениями, для указания команд командлета:</span><span class="sxs-lookup"><span data-stu-id="3dd9c-129">Use the constant strings that are defined by the following enumerations to specify cmdlet verbs:</span></span>

- [<span data-ttu-id="3dd9c-130">System.Management.Automation.VerbsCommon</span><span class="sxs-lookup"><span data-stu-id="3dd9c-130">System.Management.Automation.VerbsCommon</span></span>](/dotnet/api/System.Management.Automation.VerbsCommon)

- [<span data-ttu-id="3dd9c-131">System.Management.Automation.VerbsCommunications</span><span class="sxs-lookup"><span data-stu-id="3dd9c-131">System.Management.Automation.VerbsCommunications</span></span>](/dotnet/api/System.Management.Automation.VerbsCommunications)

- [<span data-ttu-id="3dd9c-132">System.Management.Automation.VerbsData</span><span class="sxs-lookup"><span data-stu-id="3dd9c-132">System.Management.Automation.VerbsData</span></span>](/dotnet/api/System.Management.Automation.VerbsData)

- [<span data-ttu-id="3dd9c-133">System.Management.Automation.VerbsDiagnostic</span><span class="sxs-lookup"><span data-stu-id="3dd9c-133">System.Management.Automation.VerbsDiagnostic</span></span>](/dotnet/api/System.Management.Automation.VerbsDiagnostic)

- [<span data-ttu-id="3dd9c-134">System.Management.Automation.VerbsLifeCycle</span><span class="sxs-lookup"><span data-stu-id="3dd9c-134">System.Management.Automation.VerbsLifeCycle</span></span>](/dotnet/api/System.Management.Automation.VerbsLifeCycle)

- [<span data-ttu-id="3dd9c-135">System.Management.Automation.VerbsSecurity</span><span class="sxs-lookup"><span data-stu-id="3dd9c-135">System.Management.Automation.VerbsSecurity</span></span>](/dotnet/api/System.Management.Automation.VerbsSecurity)

- [<span data-ttu-id="3dd9c-136">System.Management.Automation.VerbsOther</span><span class="sxs-lookup"><span data-stu-id="3dd9c-136">System.Management.Automation.VerbsOther</span></span>](/dotnet/api/System.Management.Automation.VerbsOther)

<span data-ttu-id="3dd9c-137">Дополнительные сведения о утвержденных именах команд см. в разделе [команды командлета](./approved-verbs-for-windows-powershell-commands.md).</span><span class="sxs-lookup"><span data-stu-id="3dd9c-137">For more information about the approved verb names, see [Cmdlet Verbs](./approved-verbs-for-windows-powershell-commands.md).</span></span>

<span data-ttu-id="3dd9c-138">Пользователям требуется набор обнаруживаемых и ожидаемых имен командлетов.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-138">Users need a set of discoverable and expected cmdlet names.</span></span> <span data-ttu-id="3dd9c-139">Используйте соответствующую команду, чтобы пользователь мог быстро оценить то, что делает командлет, и легко обнаружить возможности системы.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-139">Use the appropriate verb so that the user can make a quick assessment of what a cmdlet does and to easily discover the capabilities of the system.</span></span> <span data-ttu-id="3dd9c-140">Например, следующая команда командной строки возвращает список всех команд в системе, имена которых начинаются на "Start": `get-command start-*` .</span><span class="sxs-lookup"><span data-stu-id="3dd9c-140">For example, the following command-line command gets a list of all the commands on the system whose names begin with "start": `get-command start-*`.</span></span> <span data-ttu-id="3dd9c-141">Используйте существительные в командлетах, чтобы отличать командлеты от других командлетов.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-141">Use the nouns in your cmdlets to differentiate your cmdlets from other cmdlets.</span></span> <span data-ttu-id="3dd9c-142">Существительное указывает ресурс, в котором будет выполнена операция.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-142">The noun indicates the resource on which the operation will be performed.</span></span> <span data-ttu-id="3dd9c-143">Сама операция представляется командой.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-143">The operation itself is represented by the verb.</span></span>

### <a name="cmdlet-names-characters-that-cannot-be-used-rd02"></a><span data-ttu-id="3dd9c-144">Имена командлетов: символы, которые не могут быть использованы (RD02)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-144">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>

<span data-ttu-id="3dd9c-145">При именовании командлетов не используйте следующие специальные символы.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-145">When you name cmdlets, do not use any of the following special characters.</span></span>

|<span data-ttu-id="3dd9c-146">Символ</span><span class="sxs-lookup"><span data-stu-id="3dd9c-146">Character</span></span>|<span data-ttu-id="3dd9c-147">Имя</span><span class="sxs-lookup"><span data-stu-id="3dd9c-147">Name</span></span>|
|---------------|----------|
|#|<span data-ttu-id="3dd9c-148">знак числа</span><span class="sxs-lookup"><span data-stu-id="3dd9c-148">number sign</span></span>|
|<span data-ttu-id="3dd9c-149">,</span><span class="sxs-lookup"><span data-stu-id="3dd9c-149">,</span></span>|<span data-ttu-id="3dd9c-150">запятая</span><span class="sxs-lookup"><span data-stu-id="3dd9c-150">comma</span></span>|
|<span data-ttu-id="3dd9c-151">()</span><span class="sxs-lookup"><span data-stu-id="3dd9c-151">()</span></span>|<span data-ttu-id="3dd9c-152">круглые скобки</span><span class="sxs-lookup"><span data-stu-id="3dd9c-152">parentheses</span></span>|
|{}|<span data-ttu-id="3dd9c-153">фигурные скобки</span><span class="sxs-lookup"><span data-stu-id="3dd9c-153">braces</span></span>|
|<span data-ttu-id="3dd9c-154">[]</span><span class="sxs-lookup"><span data-stu-id="3dd9c-154">[]</span></span>|<span data-ttu-id="3dd9c-155">квадратных</span><span class="sxs-lookup"><span data-stu-id="3dd9c-155">brackets</span></span>|
|&|<span data-ttu-id="3dd9c-156">знаки</span><span class="sxs-lookup"><span data-stu-id="3dd9c-156">ampersand</span></span>|
|-|<span data-ttu-id="3dd9c-157">дефис **Примечание.**  дефис можно использовать для отделения глагола от существительных, но не может использоваться внутри существительного или внутри команды.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-157">hyphen **Note:**  The hyphen can be used to separate the verb from the noun, but it cannot be used within the noun or within the verb.</span></span>|
|/|<span data-ttu-id="3dd9c-158">знак косой черты</span><span class="sxs-lookup"><span data-stu-id="3dd9c-158">slash mark</span></span>|
|<span data-ttu-id="3dd9c-159">\\| Обратная косая черта</span><span class="sxs-lookup"><span data-stu-id="3dd9c-159">\\|backslash</span></span>|
|$|<span data-ttu-id="3dd9c-160">знак доллара</span><span class="sxs-lookup"><span data-stu-id="3dd9c-160">dollar sign</span></span>|
|^|<span data-ttu-id="3dd9c-161">знак вставки</span><span class="sxs-lookup"><span data-stu-id="3dd9c-161">caret</span></span>|
|<span data-ttu-id="3dd9c-162">;</span><span class="sxs-lookup"><span data-stu-id="3dd9c-162">;</span></span>|<span data-ttu-id="3dd9c-163">точка с запятой</span><span class="sxs-lookup"><span data-stu-id="3dd9c-163">semicolon</span></span>|
|<span data-ttu-id="3dd9c-164">:</span><span class="sxs-lookup"><span data-stu-id="3dd9c-164">:</span></span>|<span data-ttu-id="3dd9c-165">ставит</span><span class="sxs-lookup"><span data-stu-id="3dd9c-165">colon</span></span>|
|<span data-ttu-id="3dd9c-166">"</span><span class="sxs-lookup"><span data-stu-id="3dd9c-166">"</span></span>|<span data-ttu-id="3dd9c-167">двойная кавычка</span><span class="sxs-lookup"><span data-stu-id="3dd9c-167">double quotation mark</span></span>|
|<span data-ttu-id="3dd9c-168">'</span><span class="sxs-lookup"><span data-stu-id="3dd9c-168">'</span></span>|<span data-ttu-id="3dd9c-169">одиночные кавычки</span><span class="sxs-lookup"><span data-stu-id="3dd9c-169">single quotation mark</span></span>|
|<>|<span data-ttu-id="3dd9c-170">угловые скобки</span><span class="sxs-lookup"><span data-stu-id="3dd9c-170">angle brackets</span></span>|
|<span data-ttu-id="3dd9c-171">&#124;</span><span class="sxs-lookup"><span data-stu-id="3dd9c-171">&#124;</span></span>|<span data-ttu-id="3dd9c-172">Вертикальная черта</span><span class="sxs-lookup"><span data-stu-id="3dd9c-172">vertical bar</span></span>|
|<span data-ttu-id="3dd9c-173">?</span><span class="sxs-lookup"><span data-stu-id="3dd9c-173">?</span></span>|<span data-ttu-id="3dd9c-174">вопросительный знак</span><span class="sxs-lookup"><span data-stu-id="3dd9c-174">question mark</span></span>|
|@|<span data-ttu-id="3dd9c-175">знак «коммерческое эт»</span><span class="sxs-lookup"><span data-stu-id="3dd9c-175">at sign</span></span>|
|`|<span data-ttu-id="3dd9c-176">Обратная шкала (ударение)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-176">back tick (grave accent)</span></span>|
|*|<span data-ttu-id="3dd9c-177">звездочка</span><span class="sxs-lookup"><span data-stu-id="3dd9c-177">asterisk</span></span>|
|%|<span data-ttu-id="3dd9c-178">знак процента</span><span class="sxs-lookup"><span data-stu-id="3dd9c-178">percent sign</span></span>|
|+|<span data-ttu-id="3dd9c-179">Знак "плюс"</span><span class="sxs-lookup"><span data-stu-id="3dd9c-179">plus sign</span></span>|
|=|<span data-ttu-id="3dd9c-180">знак равенства</span><span class="sxs-lookup"><span data-stu-id="3dd9c-180">equals sign</span></span>|
|~|<span data-ttu-id="3dd9c-181">символа</span><span class="sxs-lookup"><span data-stu-id="3dd9c-181">tilde</span></span>|

### <a name="parameters-names-that-cannot-be-used-rd03"></a><span data-ttu-id="3dd9c-182">Имена параметров, которые нельзя использовать (RD03)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-182">Parameters Names that cannot be Used (RD03)</span></span>

<span data-ttu-id="3dd9c-183">Windows PowerShell предоставляет общий набор параметров для всех командлетов, а также дополнительные параметры, которые добавляются в конкретных ситуациях.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-183">Windows PowerShell provides a common set a parameters to all cmdlets plus additional parameters that are added in specific situations.</span></span> <span data-ttu-id="3dd9c-184">При проектировании собственных командлетов нельзя использовать следующие имена: Confirm, Debug, ErrorAction, ErrorVariable, rebuffer, of Variable, WarningAction, WarningVariable, WhatIf, UseTransaction и verbose.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-184">When designing your own cmdlets you cannot use the following names: Confirm, Debug, ErrorAction, ErrorVariable, OutBuffer, OutVariable, WarningAction, WarningVariable, WhatIf, UseTransaction, and Verbose.</span></span> <span data-ttu-id="3dd9c-185">Дополнительные сведения об этих параметрах см. в разделе [Общие имена параметров](./common-parameter-names.md).</span><span class="sxs-lookup"><span data-stu-id="3dd9c-185">For more information about these parameters, see [Common Parameter Names](./common-parameter-names.md).</span></span>

### <a name="support-confirmation-requests-rd04"></a><span data-ttu-id="3dd9c-186">Запросы на подтверждение поддержки (RD04)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-186">Support Confirmation Requests (RD04)</span></span>

<span data-ttu-id="3dd9c-187">Для командлетов, выполняющих операцию, которая изменяет систему, они должны вызвать метод [System. Management. Automation. командлет. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) , чтобы запросить подтверждение, а в особых случаях вызвать метод [System. Management. Automation. командлет. ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) .</span><span class="sxs-lookup"><span data-stu-id="3dd9c-187">For cmdlets that perform an operation that modifies the system, they should call the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method to request confirmation, and in special cases call the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method.</span></span> <span data-ttu-id="3dd9c-188">(Метод [System. Management. Automation. командлет. ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) следует вызывать только после вызова метода [System. Management. Automation. командлет. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) .)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-188">(The [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method should be called only after the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method is called.)</span></span>

<span data-ttu-id="3dd9c-189">Для выполнения этих вызовов командлет должен указать, что он поддерживает запросы на подтверждение, установив `SupportsShouldProcess` ключевое слово атрибута командлета.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-189">To make these calls the cmdlet must specify that it supports confirmation requests by setting the `SupportsShouldProcess` keyword of the Cmdlet attribute.</span></span> <span data-ttu-id="3dd9c-190">Дополнительные сведения о задании этого атрибута см. в разделе [объявление атрибута командлета](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="3dd9c-190">For more information about setting this attribute, see [Cmdlet Attribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

> [!NOTE]
> <span data-ttu-id="3dd9c-191">Если атрибут командлета класса командлета указывает, что командлет поддерживает вызовы метода [System. Management. Automation. командлет. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) , и командлет не может вызвать метод [System. Management. Automation. командлет. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) , пользователь может неожиданно изменить систему.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-191">If the Cmdlet attribute of the cmdlet class indicates that the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, and the cmdlet fails to make the call to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, the user could modify the system unexpectedly.</span></span>

<span data-ttu-id="3dd9c-192">Используйте метод [System. Management. Automation. командлет. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) для любых изменений в системе.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-192">Use the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method for any system modification.</span></span> <span data-ttu-id="3dd9c-193">Параметры пользователя и `WhatIf` параметр управляют методом [System. Management. Automation. командлет. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) .</span><span class="sxs-lookup"><span data-stu-id="3dd9c-193">A user preference and the `WhatIf` parameter control the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="3dd9c-194">В отличие от этого, вызов [System. Management. Automation. командлет. ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) выполняет дополнительную проверку потенциально опасных изменений.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-194">In contrast, the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) call performs an additional check for potentially dangerous modifications.</span></span> <span data-ttu-id="3dd9c-195">Этот метод не контролируется ни одним из предпочтений пользователя или `WhatIf` параметром.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-195">This method is not controlled by any user preference or the `WhatIf` parameter.</span></span> <span data-ttu-id="3dd9c-196">Если командлет вызывает метод [System. Management. Automation. командлет. ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) , он должен иметь `Force` параметр, который обходит вызовы этих двух методов и продолжает работу.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-196">If your cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method, it should have a `Force` parameter that bypasses the calls to these two methods and that proceeds with the operation.</span></span> <span data-ttu-id="3dd9c-197">Это важно, так как позволяет использовать командлет в неинтерактивных скриптах и узлах.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-197">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span>

<span data-ttu-id="3dd9c-198">Если командлеты поддерживают эти вызовы, пользователь может определить, следует ли выполнять действие фактически.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-198">If your cmdlets support these calls, the user can determine whether the action should actually be performed.</span></span> <span data-ttu-id="3dd9c-199">Например, командлет [Stop-Process](/powershell/module/microsoft.powershell.management/stop-process) вызывает метод [System. Management. Automation. командлет. ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) перед остановкой набора критически важных процессов, включая процессы System, Winlogon и Spoolsv.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-199">For example, the [Stop-Process](/powershell/module/microsoft.powershell.management/stop-process) cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method before it stops a set of critical processes, including the System, Winlogon, and Spoolsv processes.</span></span>

<span data-ttu-id="3dd9c-200">Дополнительные сведения о поддержке этих методов см. в разделе [запрос подтверждения](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="3dd9c-200">For more information about supporting these methods, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="support-force-parameter-for-interactive-sessions-rd05"></a><span data-ttu-id="3dd9c-201">Поддержка параметра Force для интерактивных сеансов (RD05)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-201">Support Force Parameter for Interactive Sessions (RD05)</span></span>

<span data-ttu-id="3dd9c-202">Если командлет используется в интерактивном режиме, всегда следует использовать параметр Force для переопределения интерактивных действий, таких как запросы или считывание строк ввода.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-202">If your cmdlet is used interactively, always provide a Force parameter to override the interactive actions, such as prompts or reading lines of input).</span></span> <span data-ttu-id="3dd9c-203">Это важно, так как позволяет использовать командлет в неинтерактивных скриптах и узлах.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-203">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span> <span data-ttu-id="3dd9c-204">С помощью интерактивного узла можно реализовать следующие методы.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-204">The following methods can be implemented by an interactive host.</span></span>

- [<span data-ttu-id="3dd9c-205">System. Management. Automation. host. Пшостусеринтерфаце. prompt \*</span><span class="sxs-lookup"><span data-stu-id="3dd9c-205">System.Management.Automation.Host.PSHostUserInterface.Prompt\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.Prompt)

- [<span data-ttu-id="3dd9c-206">System. Management. Automation. host. Пшостусеринтерфаце. Промптфорчоице</span><span class="sxs-lookup"><span data-stu-id="3dd9c-206">System.Management.Automation.Host.Pshostuserinterface.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForChoice)

- [<span data-ttu-id="3dd9c-207">System. Management. Automation. host. Ихостуисуппортсмултиплечоицеселектион. Промптфорчоице</span><span class="sxs-lookup"><span data-stu-id="3dd9c-207">System.Management.Automation.Host.Ihostuisupportsmultiplechoiceselection.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.IHostUISupportsMultipleChoiceSelection.PromptForChoice)

- [<span data-ttu-id="3dd9c-208">System. Management. Automation. host. Пшостусеринтерфаце. PromptForCredential \*</span><span class="sxs-lookup"><span data-stu-id="3dd9c-208">System.Management.Automation.Host.Pshostuserinterface.PromptForCredential\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForCredential)

- [<span data-ttu-id="3dd9c-209">System. Management. Automation. host. Пшостусеринтерфаце. ReadLine \*</span><span class="sxs-lookup"><span data-stu-id="3dd9c-209">System.Management.Automation.Host.Pshostuserinterface.ReadLine\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLine)

- [<span data-ttu-id="3dd9c-210">System. Management. Automation. host. Пшостусеринтерфаце. Реадлинеассекурестринг \*</span><span class="sxs-lookup"><span data-stu-id="3dd9c-210">System.Management.Automation.Host.Pshostuserinterface.ReadLineAsSecureString\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLineAsSecureString)

### <a name="document-output-objects-rd06"></a><span data-ttu-id="3dd9c-211">Объекты вывода документа (RD06)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-211">Document Output Objects (RD06)</span></span>

<span data-ttu-id="3dd9c-212">Windows PowerShell использует объекты, которые записываются в конвейер.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-212">Windows PowerShell uses the objects that are written to the pipeline.</span></span> <span data-ttu-id="3dd9c-213">Чтобы пользователи могли воспользоваться преимуществами объектов, возвращаемых каждым командлетом, необходимо задокументировать возвращаемые объекты, и необходимо задокументировать, для каких элементов возвращенных объектов используется.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-213">In order for users to take advantage of the objects that are returned by each cmdlet, you must document the objects that are returned, and you must document what the members of those returned objects are used for.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="3dd9c-214">Рекомендации по коду</span><span class="sxs-lookup"><span data-stu-id="3dd9c-214">Code Guidelines</span></span>

<span data-ttu-id="3dd9c-215">При написании кода командлета необходимо следовать приведенным ниже рекомендациям.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-215">The following guidelines must be followed when writing cmdlet code.</span></span> <span data-ttu-id="3dd9c-216">Когда вы найдете рекомендации по коду, применимые к вашей ситуации, ознакомьтесь с рекомендациями по проектированию для аналогичных руководств.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-216">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="derive-from-the-cmdlet-or-pscmdlet-classes-rc01"></a><span data-ttu-id="3dd9c-217">Наследование от классов командлета или PSCmdlet (RC01)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-217">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>

<span data-ttu-id="3dd9c-218">Командлет должен быть производным от базового класса [System. Management. Automation. командлет](/dotnet/api/System.Management.Automation.Cmdlet) или [System. Management. Automation. PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) .</span><span class="sxs-lookup"><span data-stu-id="3dd9c-218">A cmdlet must derive from either the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) or [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="3dd9c-219">Командлеты, производные от класса [System. Management. Automation. командлета](/dotnet/api/System.Management.Automation.Cmdlet) , не зависят от среды выполнения Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-219">Cmdlets that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class do not depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="3dd9c-220">Их можно вызывать непосредственно на любом языке платформы Microsoft .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-220">They can be called directly from any Microsoft .NET Framework language.</span></span> <span data-ttu-id="3dd9c-221">Командлеты, производные от класса [System. Management. Automation. PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) , зависят от среды выполнения Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-221">Cmdlets that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="3dd9c-222">Поэтому они выполняются в пределах пространства выполнения.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-222">Therefore, they execute within a runspace.</span></span>

<span data-ttu-id="3dd9c-223">Все классы командлетов, которые реализуются, должны быть открытыми классами.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-223">All cmdlet classes that you implement must be public classes.</span></span> <span data-ttu-id="3dd9c-224">Дополнительные сведения об этих классах командлетов см. в разделе [Общие сведения о командлетах](./cmdlet-overview.md).</span><span class="sxs-lookup"><span data-stu-id="3dd9c-224">For more information about these cmdlet classes, see [Cmdlet Overview](./cmdlet-overview.md).</span></span>

### <a name="specify-the-cmdlet-attribute-rc02"></a><span data-ttu-id="3dd9c-225">Укажите атрибут командлета (RC02)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-225">Specify the Cmdlet Attribute (RC02)</span></span>

<span data-ttu-id="3dd9c-226">Для распознавания командлетом Windows PowerShell его .NET Framework класс должен быть дополнен атрибутом командлета.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-226">For a cmdlet to be recognized by Windows PowerShell, its .NET Framework class must be decorated with the Cmdlet attribute.</span></span> <span data-ttu-id="3dd9c-227">Этот атрибут задает следующие функции командлета.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-227">This attribute specifies the following features of the cmdlet.</span></span>

- <span data-ttu-id="3dd9c-228">Пара «глагол--существительное», определяющая командлет.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-228">The verb-and-noun pair that identifies the cmdlet.</span></span>

- <span data-ttu-id="3dd9c-229">Набор параметров по умолчанию, используемый при указании нескольких наборов параметров.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-229">The default parameter set that is used when multiple parameter sets are specified.</span></span> <span data-ttu-id="3dd9c-230">Набор параметров по умолчанию используется в том случае, если в Windows PowerShell недостаточно сведений для определения используемого набора параметров.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-230">The default parameter set is used when Windows PowerShell does not have enough information to determine which parameter set to use.</span></span>

- <span data-ttu-id="3dd9c-231">Указывает, поддерживает ли командлет вызовы метода [System. Management. Automation. командлета. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) .</span><span class="sxs-lookup"><span data-stu-id="3dd9c-231">Indicates if the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="3dd9c-232">Этот метод выводит сообщение с подтверждением пользователю перед тем, как командлет вносит изменения в систему.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-232">This method displays a confirmation message to the user before the cmdlet makes a change to the system.</span></span> <span data-ttu-id="3dd9c-233">Дополнительные сведения о том, как выполняются запросы на подтверждение, см. в разделе [запрос подтверждения](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="3dd9c-233">For more information about how confirmation requests are made, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

- <span data-ttu-id="3dd9c-234">Указывает уровень влияния (или серьезность) действия, связанного с сообщением подтверждения.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-234">Indicate the impact level (or severity) of the action associated with the confirmation message.</span></span> <span data-ttu-id="3dd9c-235">В большинстве случаев следует использовать значение по умолчанию Medium.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-235">In most cases, the default value of Medium should be used.</span></span> <span data-ttu-id="3dd9c-236">Дополнительные сведения о том, как уровень влияния влияет на запросы подтверждения, отображаемые пользователю, см. в разделе [запрос подтверждения](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="3dd9c-236">For more information about how the impact level affects the confirmation requests that are displayed to the user, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

<span data-ttu-id="3dd9c-237">Дополнительные сведения об объявлении атрибута командлета см. в разделе [объявление CmdletAttribute](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="3dd9c-237">For more information about how to declare the cmdlet attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="override-an-input-processing-method-rc03"></a><span data-ttu-id="3dd9c-238">Переопределение метода обработки ввода (RC03)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-238">Override an Input Processing Method (RC03)</span></span>

<span data-ttu-id="3dd9c-239">Чтобы командлет принимал участие в среде Windows PowerShell, он должен переопределить по крайней мере один из следующих *методов обработки входных данных*.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-239">For the cmdlet to participate in the Windows PowerShell environment, it must override at least one of the following *input processing methods*.</span></span>

<span data-ttu-id="3dd9c-240">[System. Management. Automation. командлет. BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) . Этот метод вызывается один раз и используется для предоставления функций предварительной обработки.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-240">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) This method is called one time, and it is used to provide pre-processing functionality.</span></span>

<span data-ttu-id="3dd9c-241">[System. Management. Automation. командлет. ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) этот метод вызывается несколько раз и используется для предоставления функциональных возможностей записи по записям.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-241">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) This method is called multiple times, and it is used to provide record-by-record functionality.</span></span>

<span data-ttu-id="3dd9c-242">[System. Management. Automation. командлет. EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) . Этот метод вызывается один раз и используется для предоставления функций последующей обработки.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-242">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) This method is called one time, and it is used to provide post-processing functionality.</span></span>

### <a name="specify-the-outputtype-attribute-rc04"></a><span data-ttu-id="3dd9c-243">Указание атрибута OutputType (RC04)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-243">Specify the OutputType Attribute (RC04)</span></span>

<span data-ttu-id="3dd9c-244">Атрибут OutputType (представленный в Windows PowerShell 2,0) указывает тип .NET Framework, возвращаемый командлетом в конвейер.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-244">The OutputType attribute (introduced in Windows PowerShell 2.0) specifies the .NET Framework type that your cmdlet returns to the pipeline.</span></span> <span data-ttu-id="3dd9c-245">Указав тип выходных данных командлетов, вы сделаете объекты, возвращаемые командлетом, более доступными для других командлетов.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-245">By specifying the output type of your cmdlets you make the objects returned by your cmdlet more discoverable by other cmdlets.</span></span> <span data-ttu-id="3dd9c-246">Дополнительные сведения о декорировании класса командлета с помощью этого атрибута см. в разделе [объявление атрибута OutputType](./outputtype-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="3dd9c-246">For more information about decorating the cmdlet class with this attribute, see [OutputType Attribute Declaration](./outputtype-attribute-declaration.md).</span></span>

### <a name="do-not-retain-handles-to-output-objects-rc05"></a><span data-ttu-id="3dd9c-247">Не сохраняйте дескрипторы для выходных объектов (RC05)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-247">Do Not Retain Handles to Output Objects (RC05)</span></span>

<span data-ttu-id="3dd9c-248">Командлет не должен хранить дескрипторы объектов, которые передаются в метод [System. Management. Automation. командлет. WriteObject \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) .</span><span class="sxs-lookup"><span data-stu-id="3dd9c-248">Your cmdlet should not retain any handles to the objects that are passed to the [System.Management.Automation.Cmdlet.WriteObject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="3dd9c-249">Эти объекты передаются следующему командлету в конвейере или используются сценарием.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-249">These objects are passed to the next cmdlet in the pipeline, or they are used by a script.</span></span> <span data-ttu-id="3dd9c-250">При хранении дескрипторов объектов две сущности будут владеть каждым объектом, что вызывает ошибки.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-250">If you retain the handles to the objects, two entities will own each object, which causes errors.</span></span>

### <a name="handle-errors-robustly-rc06"></a><span data-ttu-id="3dd9c-251">Устойчивая работа с ошибками (RC06)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-251">Handle Errors Robustly (RC06)</span></span>

<span data-ttu-id="3dd9c-252">Среда администрирования изначально обнаруживает и вносит важные изменения в систему, которую вы администрировать.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-252">An administration environment inherently detects and makes important changes to the system that you are administering.</span></span> <span data-ttu-id="3dd9c-253">Поэтому крайне важно, чтобы командлеты правильно обрабатывали ошибки.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-253">Therefore, it is vital that cmdlets handle errors correctly.</span></span> <span data-ttu-id="3dd9c-254">Дополнительные сведения о записи об ошибках см. в разделе [отчеты об ошибках Windows PowerShell](./error-reporting-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="3dd9c-254">For more information about error records, see [Windows PowerShell Error Reporting](./error-reporting-concepts.md).</span></span>

- <span data-ttu-id="3dd9c-255">Если ошибка не позволяет командлету продолжить обработку каких-либо записей, это является завершающим ошибкой.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-255">When an error prevents a cmdlet from continuing to process any more records, it is a terminating error.</span></span> <span data-ttu-id="3dd9c-256">Командлет должен вызвать метод [System. Management. Automation. командлет. ThrowTerminatingError \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) , который ссылается на объект [System. Management. Automation. ерроррекорд](/dotnet/api/System.Management.Automation.ErrorRecord) .</span><span class="sxs-lookup"><span data-stu-id="3dd9c-256">The cmdlet must call the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="3dd9c-257">Если в командлете не перехвачено исключение, то среда выполнения Windows PowerShell создает завершающую ошибку, которая содержит меньше информации.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-257">If an exception is not caught by the cmdlet, the Windows PowerShell runtime itself throws a terminating error that contains less information.</span></span>

- <span data-ttu-id="3dd9c-258">Для устранимой ошибки, которая не останавливает операцию над следующей записью, которая поступает из конвейера (например, запись, созданная другим процессом), командлет должен вызвать метод [System. Management. Automation. командлет. WriteError \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) , который ссылается на объект [System. Management. Automation. ерроррекорд](/dotnet/api/System.Management.Automation.ErrorRecord) .</span><span class="sxs-lookup"><span data-stu-id="3dd9c-258">For a non-terminating error that does not stop operation on the next record that is coming from the pipeline (for example, a record produced by a different process), the cmdlet must call the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="3dd9c-259">Примером неустранимой ошибки является ошибка, которая возникает, если не удается завершить определенный процесс.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-259">An example of a non-terminating error is the error that occurs if a particular process fails to stop.</span></span> <span data-ttu-id="3dd9c-260">Вызов метода [System. Management. Automation. командлет. WriteError \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) позволяет пользователю последовательно выполнять запрошенные действия и хранить сведения о конкретных действиях, которые не удалось выполнить.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-260">Calling the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method allows the user to consistently perform the actions requested and to retain the information for particular actions that fail.</span></span> <span data-ttu-id="3dd9c-261">Командлет должен обрабатывать каждую запись как можно независимо.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-261">Your cmdlet should handle each record as independently as possible.</span></span>

- <span data-ttu-id="3dd9c-262">На объект [System. Management](/dotnet/api/System.Management.Automation.ErrorRecord) . Automation. ерроррекорд, на который ссылается метод [System. Management. Automation. командлет. ThrowTerminatingError \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) и [System. Management. Automation. командлет. WriteError \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) , требуется исключение в ядре.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-262">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that is referenced by the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) and [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) methods requires an exception at its core.</span></span> <span data-ttu-id="3dd9c-263">При определении используемого исключения следуйте рекомендациям по проектированию .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-263">Follow the .NET Framework design guidelines when you determine the exception to use.</span></span> <span data-ttu-id="3dd9c-264">Если ошибка семантически аналогична существующему исключению, используйте это исключение или производные от этого исключения.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-264">If the error is semantically the same as an existing exception, use that exception or derive from that exception.</span></span> <span data-ttu-id="3dd9c-265">В противном случае создайте новое исключение или иерархию исключений непосредственно из типа [System. Exception](/dotnet/api/System.Exception) .</span><span class="sxs-lookup"><span data-stu-id="3dd9c-265">Otherwise, derive a new exception or exception hierarchy directly from the [System.Exception](/dotnet/api/System.Exception) type.</span></span>

<span data-ttu-id="3dd9c-266">Объект [System. Management. Automation. ерроррекорд](/dotnet/api/System.Management.Automation.ErrorRecord) также требует категорию ошибок, которая группирует ошибки для пользователя.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-266">An [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object also requires an error category that groups errors for the user.</span></span> <span data-ttu-id="3dd9c-267">Пользователь может просматривать ошибки на основе категории, присвоив `$ErrorView` переменной оболочки значение категоривиев.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-267">The user can view errors based on the category by setting the value of the `$ErrorView` shell variable to CategoryView.</span></span> <span data-ttu-id="3dd9c-268">Возможные категории определяются перечислением [System. Management. Automation. ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) .</span><span class="sxs-lookup"><span data-stu-id="3dd9c-268">The possible categories are defined by the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeration.</span></span>

- <span data-ttu-id="3dd9c-269">Если командлет создает новый поток, и если код, выполняемый в этом потоке, создает необработанное исключение, Windows PowerShell не будет перехватывать ошибку и завершит процесс.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-269">If a cmdlet creates a new thread, and if the code that is running in that thread throws an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span>

- <span data-ttu-id="3dd9c-270">Если у объекта есть код в его деструкторе, который вызывает необработанное исключение, Windows PowerShell не будет перехватывать ошибку и завершит процесс.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-270">If an object has code in its destructor that causes an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span> <span data-ttu-id="3dd9c-271">Это также происходит, если объект вызывает методы Dispose, вызывающие необработанное исключение.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-271">This also occurs if an object calls Dispose methods that cause an unhandled exception.</span></span>

### <a name="use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07"></a><span data-ttu-id="3dd9c-272">Использование модуля Windows PowerShell для развертывания командлетов (RC07)</span><span class="sxs-lookup"><span data-stu-id="3dd9c-272">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>

<span data-ttu-id="3dd9c-273">Создайте модуль Windows PowerShell для упаковки и развертывания командлетов.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-273">Create a Windows PowerShell module to package and deploy your cmdlets.</span></span> <span data-ttu-id="3dd9c-274">Поддержка модулей представлена в Windows PowerShell 2,0.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-274">Support for modules is introduced in Windows PowerShell 2.0.</span></span> <span data-ttu-id="3dd9c-275">Сборки, содержащие классы командлетов, можно использовать непосредственно в виде файлов двоичных модулей (это очень удобно при тестировании командлетов) или создать манифест модуля, который ссылается на сборки командлетов.</span><span class="sxs-lookup"><span data-stu-id="3dd9c-275">You can use the assemblies that contain your cmdlet classes directly as binary module files (this is very useful when testing your cmdlets), or you can create a module manifest that references the cmdlet assemblies.</span></span> <span data-ttu-id="3dd9c-276">(При использовании модулей можно также добавить существующие сборки оснастки). Дополнительные сведения о модулях см. [в разделе Написание модуля Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="3dd9c-276">(You can also add existing snap-in assemblies when using modules.) For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="3dd9c-277">См. также:</span><span class="sxs-lookup"><span data-stu-id="3dd9c-277">See Also</span></span>

[<span data-ttu-id="3dd9c-278">Настоятельные рекомендации по разработке</span><span class="sxs-lookup"><span data-stu-id="3dd9c-278">Strongly Encouraged Development Guidelines</span></span>](./strongly-encouraged-development-guidelines.md)

[<span data-ttu-id="3dd9c-279">Советы по разработке</span><span class="sxs-lookup"><span data-stu-id="3dd9c-279">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

[<span data-ttu-id="3dd9c-280">Запись командлета Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="3dd9c-280">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
