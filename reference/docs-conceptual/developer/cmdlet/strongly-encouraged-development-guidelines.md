---
title: Настоятельно рекомендуем рекомендации по разработке | Документация Майкрософт
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 4d68a8f3-fba0-44c5-97b9-9fc191d269a5
caps.latest.revision: 13
ms.openlocfilehash: 0906d0d37c66b8c1538a0b2e9e0f1ff2fba12ac0
ms.sourcegitcommit: 52a67bcd9d7bf3e8600ea4302d1fa8970ff9c998
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/15/2019
ms.locfileid: "72369343"
---
# <a name="strongly-encouraged-development-guidelines"></a><span data-ttu-id="2113c-102">Настоятельные рекомендации по разработке</span><span class="sxs-lookup"><span data-stu-id="2113c-102">Strongly Encouraged Development Guidelines</span></span>

<span data-ttu-id="2113c-103">В этом разделе описываются рекомендации, которые следует выполнить при написании командлетов.</span><span class="sxs-lookup"><span data-stu-id="2113c-103">This section describes guidelines that you should follow when you write your cmdlets.</span></span> <span data-ttu-id="2113c-104">Они разделены на рекомендации по проектированию командлетов и руководств по написанию кода командлета.</span><span class="sxs-lookup"><span data-stu-id="2113c-104">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="2113c-105">Может оказаться, что эти рекомендации не применимы для каждого сценария.</span><span class="sxs-lookup"><span data-stu-id="2113c-105">You might find that these guidelines are not applicable for every scenario.</span></span> <span data-ttu-id="2113c-106">Однако если они будут применены и вы не следуйте этим рекомендациям, пользователи могут столкнуться с плохими возможностями при использовании командлетов.</span><span class="sxs-lookup"><span data-stu-id="2113c-106">However, if they do apply and you do not follow these guidelines, your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="design-guidelines"></a><span data-ttu-id="2113c-107">Рекомендации по проектированию</span><span class="sxs-lookup"><span data-stu-id="2113c-107">Design Guidelines</span></span>

- [<span data-ttu-id="2113c-108">Использование определенного существительного для имени командлета (SD01)</span><span class="sxs-lookup"><span data-stu-id="2113c-108">Use a Specific Noun for a Cmdlet Name (SD01)</span></span>](./strongly-encouraged-development-guidelines.md#use-a-specific-noun-for-a-cmdlet-name-sd01)

- [<span data-ttu-id="2113c-109">Использовать сценарий Pascal для имен командлетов (SD02)</span><span class="sxs-lookup"><span data-stu-id="2113c-109">Use Pascal Case for Cmdlet Names (SD02)</span></span>](./strongly-encouraged-development-guidelines.md#use-pascal-case-for-cmdlet-names-sd02)

- [<span data-ttu-id="2113c-110">Рекомендации по проектированию параметров (SD03)</span><span class="sxs-lookup"><span data-stu-id="2113c-110">Parameter Design Guidelines (SD03)</span></span>](./strongly-encouraged-development-guidelines.md#parameter-design-guidelines-sd03)

- [<span data-ttu-id="2113c-111">Отправить отзыв пользователю (SD04)</span><span class="sxs-lookup"><span data-stu-id="2113c-111">Provide Feedback to the User (SD04)</span></span>](./strongly-encouraged-development-guidelines.md#provide-feedback-to-the-user-sd04)

- [<span data-ttu-id="2113c-112">Создание файла справки по командлету (SD05)</span><span class="sxs-lookup"><span data-stu-id="2113c-112">Create a Cmdlet Help File (SD05)</span></span>](./strongly-encouraged-development-guidelines.md#create-a-cmdlet-help-file-sd05)

## <a name="code-guidelines"></a><span data-ttu-id="2113c-113">Рекомендации по коду</span><span class="sxs-lookup"><span data-stu-id="2113c-113">Code Guidelines</span></span>

- [<span data-ttu-id="2113c-114">Параметры кодирования (SC01)</span><span class="sxs-lookup"><span data-stu-id="2113c-114">Coding Parameters (SC01)</span></span>](./strongly-encouraged-development-guidelines.md#coding-parameters-sc01)

- [<span data-ttu-id="2113c-115">Поддержка хорошо определенных входных данных конвейера (SC02)</span><span class="sxs-lookup"><span data-stu-id="2113c-115">Support Well Defined Pipeline Input (SC02)</span></span>](./strongly-encouraged-development-guidelines.md#support-well-defined-pipeline-input-sc02)

- [<span data-ttu-id="2113c-116">Запись отдельных записей в конвейер (SC03)</span><span class="sxs-lookup"><span data-stu-id="2113c-116">Write Single Records to the Pipeline (SC03)</span></span>](./strongly-encouraged-development-guidelines.md#write-single-records-to-the-pipeline-sc03)

- [<span data-ttu-id="2113c-117">Сделать командлеты без учета регистра и с сохранением регистра (SC04)</span><span class="sxs-lookup"><span data-stu-id="2113c-117">Make Cmdlets Case-Insensitive and Case-Preserving (SC04)</span></span>](./strongly-encouraged-development-guidelines.md#make-cmdlets-case-insensitive-and-case-preserving-sc04)

## <a name="design-guidelines"></a><span data-ttu-id="2113c-118">Рекомендации по проектированию</span><span class="sxs-lookup"><span data-stu-id="2113c-118">Design Guidelines</span></span>

<span data-ttu-id="2113c-119">При проектировании командлетов необходимо следовать приведенным ниже рекомендациям, чтобы обеспечить согласованное взаимодействие с пользователем при использовании командлетов и других командлетов.</span><span class="sxs-lookup"><span data-stu-id="2113c-119">The following guidelines should be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="2113c-120">Если вы нашли рекомендации по проектированию, применимые к вашей ситуации, ознакомьтесь с рекомендациями по написанию кода для аналогичных руководств.</span><span class="sxs-lookup"><span data-stu-id="2113c-120">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-a-specific-noun-for-a-cmdlet-name-sd01"></a><span data-ttu-id="2113c-121">Использование определенного существительного для имени командлета (SD01)</span><span class="sxs-lookup"><span data-stu-id="2113c-121">Use a Specific Noun for a Cmdlet Name (SD01)</span></span>

<span data-ttu-id="2113c-122">Существительные, используемые в именах командлетов, должны быть очень специфичными, чтобы пользователь мог обнаружить свои командлеты.</span><span class="sxs-lookup"><span data-stu-id="2113c-122">Nouns used in cmdlet naming need to be very specific so that the user can discover your cmdlets.</span></span> <span data-ttu-id="2113c-123">Применяйте универсальные существительные, такие как "Server", с сокращенной версией названия продукта.</span><span class="sxs-lookup"><span data-stu-id="2113c-123">Prefix generic nouns such as "server" with a shortened version of the product name.</span></span> <span data-ttu-id="2113c-124">Например, если имя существительное относится к серверу, на котором работает экземпляр Microsoft SQL Server, используйте существительное, например SQLServer.</span><span class="sxs-lookup"><span data-stu-id="2113c-124">For example, if a noun refers to a server that is running an instance of Microsoft SQL Server, use a noun such as "SQLServer".</span></span> <span data-ttu-id="2113c-125">Сочетание отдельных существительных и краткий список утвержденных команд позволяет пользователю быстро обнаружить и оценить функциональность, избегая дублирования имен командлетов.</span><span class="sxs-lookup"><span data-stu-id="2113c-125">The combination of specific nouns and the short list of approved verbs enable the user to quickly discover and anticipate functionality while avoiding duplication among cmdlet names.</span></span>

<span data-ttu-id="2113c-126">Для улучшения взаимодействия с пользователем существительное, выбранное для имени командлета, должно быть в единственном числе.</span><span class="sxs-lookup"><span data-stu-id="2113c-126">To enhance the user experience, the noun that you choose for a cmdlet name should be singular.</span></span> <span data-ttu-id="2113c-127">Например, используйте имя `Get-Process` вместо **Get-Processes**.</span><span class="sxs-lookup"><span data-stu-id="2113c-127">For example, use the name `Get-Process` instead of **Get-Processes**.</span></span> <span data-ttu-id="2113c-128">Лучше всего следовать этому правилу для всех имен командлетов, даже если командлет будет работать с более чем одним элементом.</span><span class="sxs-lookup"><span data-stu-id="2113c-128">It is best to follow this rule for all cmdlet names, even when a cmdlet is likely to act upon more than one item.</span></span>

### <a name="use-pascal-case-for-cmdlet-names-sd02"></a><span data-ttu-id="2113c-129">Использовать сценарий Pascal для имен командлетов (SD02)</span><span class="sxs-lookup"><span data-stu-id="2113c-129">Use Pascal Case for Cmdlet Names (SD02)</span></span>

<span data-ttu-id="2113c-130">Для имен параметров следует использовать сценарий Pascal.</span><span class="sxs-lookup"><span data-stu-id="2113c-130">Use Pascal case for parameter names.</span></span> <span data-ttu-id="2113c-131">Иными словами, первые буквы глагола и все термины, используемые в существительных, заменяются прописными буквами.</span><span class="sxs-lookup"><span data-stu-id="2113c-131">In other words, capitalize the first letter of verb and all terms used in the noun.</span></span> <span data-ttu-id="2113c-132">Например, "`Clear-ItemProperty`".</span><span class="sxs-lookup"><span data-stu-id="2113c-132">For example, "`Clear-ItemProperty`".</span></span>

### <a name="parameter-design-guidelines-sd03"></a><span data-ttu-id="2113c-133">Рекомендации по проектированию параметров (SD03)</span><span class="sxs-lookup"><span data-stu-id="2113c-133">Parameter Design Guidelines (SD03)</span></span>

<span data-ttu-id="2113c-134">Командлету требуются параметры, которые получают данные, с которыми он должен действовать, а также параметры, которые указывают сведения, используемые для определения характеристик операции.</span><span class="sxs-lookup"><span data-stu-id="2113c-134">A cmdlet needs parameters that receive the data on which it must operate, and parameters that indicate information that is used to determine the characteristics of the operation.</span></span> <span data-ttu-id="2113c-135">Например, командлет может иметь параметр `Name`, который получает данные из конвейера, а командлет может иметь параметр `Force`, чтобы указать, что командлет может принудительно выполнить свою операцию.</span><span class="sxs-lookup"><span data-stu-id="2113c-135">For example, a cmdlet might have a `Name` parameter that receives data from the pipeline, and the cmdlet might have a `Force` parameter to indicate that the cmdlet can be forced to perform its operation.</span></span> <span data-ttu-id="2113c-136">Количество параметров, которые может определить командлет, не ограничено.</span><span class="sxs-lookup"><span data-stu-id="2113c-136">There is no limit to the number of parameters that a cmdlet can define.</span></span>

#### <a name="use-standard-parameter-names"></a><span data-ttu-id="2113c-137">Использовать стандартные имена параметров</span><span class="sxs-lookup"><span data-stu-id="2113c-137">Use Standard Parameter Names</span></span>

<span data-ttu-id="2113c-138">Командлет должен использовать стандартные имена параметров, чтобы пользователь мог быстро определить, что означает конкретный параметр.</span><span class="sxs-lookup"><span data-stu-id="2113c-138">Your cmdlet should use standard parameter names so that the user can quickly determine what a particular parameter means.</span></span> <span data-ttu-id="2113c-139">Если требуется более конкретное имя, используйте стандартное имя параметра, а затем укажите более конкретное имя в качестве псевдонима.</span><span class="sxs-lookup"><span data-stu-id="2113c-139">If a more specific name is required, use a standard parameter name, and then specify a more specific name as an alias.</span></span> <span data-ttu-id="2113c-140">Например, у командлета `Get-Service` есть параметр с универсальным именем (`Name`) и более конкретным псевдонимом (`ServiceName`).</span><span class="sxs-lookup"><span data-stu-id="2113c-140">For example, the `Get-Service` cmdlet has a  parameter that has a generic name (`Name`) and a more specific alias (`ServiceName`).</span></span> <span data-ttu-id="2113c-141">Для указания параметра можно использовать оба условия.</span><span class="sxs-lookup"><span data-stu-id="2113c-141">Both terms can be used to specify the parameter.</span></span>

<span data-ttu-id="2113c-142">Дополнительные сведения об именах параметров и их типах данных см. в разделе [имя параметра командлета и рекомендации по функциональности](./standard-cmdlet-parameter-names-and-types.md).</span><span class="sxs-lookup"><span data-stu-id="2113c-142">For more information about parameter names and their data types, see [Cmdlet Parameter Name and Functionality Guidelines](./standard-cmdlet-parameter-names-and-types.md).</span></span>

#### <a name="use-singular-parameter-names"></a><span data-ttu-id="2113c-143">Использовать имена параметров в единственном числе</span><span class="sxs-lookup"><span data-stu-id="2113c-143">Use Singular Parameter Names</span></span>

<span data-ttu-id="2113c-144">Избегайте использования множественных имен для параметров, значение которых равно одному элементу.</span><span class="sxs-lookup"><span data-stu-id="2113c-144">Avoid using plural names for parameters whose value is a single element.</span></span> <span data-ttu-id="2113c-145">Сюда входят параметры, принимающие массивы или списки, поскольку пользователь может предоставить массив или список только с одним элементом.</span><span class="sxs-lookup"><span data-stu-id="2113c-145">This includes parameters that take arrays or lists because the user might supply an array or list with only one element.</span></span>

<span data-ttu-id="2113c-146">Имена параметров во множественном числе следует использовать только в тех случаях, когда значение параметра всегда является значением с несколькими элементами.</span><span class="sxs-lookup"><span data-stu-id="2113c-146">Plural parameter names should be used only in those cases where the value of the parameter is always a multiple-element value.</span></span> <span data-ttu-id="2113c-147">В этих случаях командлет должен проверить, что указано несколько элементов, и если не задано несколько элементов, командлет должен вывести предупреждение пользователю.</span><span class="sxs-lookup"><span data-stu-id="2113c-147">In these cases, the cmdlet should verify that multiple elements are supplied, and the cmdlet should display a warning to the user if multiple elements are not supplied.</span></span>

#### <a name="use-pascal-case-for-parameter-names"></a><span data-ttu-id="2113c-148">Использовать сценарий Pascal для имен параметров</span><span class="sxs-lookup"><span data-stu-id="2113c-148">Use Pascal Case for Parameter Names</span></span>

<span data-ttu-id="2113c-149">Для имен параметров следует использовать сценарий Pascal.</span><span class="sxs-lookup"><span data-stu-id="2113c-149">Use Pascal case for parameter names.</span></span> <span data-ttu-id="2113c-150">Иными словами, необходимо сделать прописной первую букву каждого слова в имени параметра, включая первую букву имени.</span><span class="sxs-lookup"><span data-stu-id="2113c-150">In other words, capitalize the first letter of each word in the parameter name, including the first letter of the name.</span></span> <span data-ttu-id="2113c-151">Например, имя параметра `ErrorAction` использует правильную прописную букву.</span><span class="sxs-lookup"><span data-stu-id="2113c-151">For example, the parameter name `ErrorAction` uses the correct capitalization.</span></span> <span data-ttu-id="2113c-152">Следующие имена параметров используют неправильные прописные буквы:</span><span class="sxs-lookup"><span data-stu-id="2113c-152">The following parameter names use incorrect capitalization:</span></span>

- `errorAction`

- `erroraction`

#### <a name="parameters-that-take-a-list-of-options"></a><span data-ttu-id="2113c-153">Параметры, которые принимают список параметров</span><span class="sxs-lookup"><span data-stu-id="2113c-153">Parameters That Take a List of Options</span></span>

<span data-ttu-id="2113c-154">Существует два способа создания параметра, значение которого можно выбрать из набора параметров.</span><span class="sxs-lookup"><span data-stu-id="2113c-154">There are two ways to create a parameter whose value can be selected from a set of options.</span></span>

- <span data-ttu-id="2113c-155">Определите тип перечисления (или используйте существующий тип перечисления), который указывает допустимые значения.</span><span class="sxs-lookup"><span data-stu-id="2113c-155">Define an enumeration type (or use an existing enumeration type) that specifies the valid values.</span></span> <span data-ttu-id="2113c-156">Затем используйте тип перечисления для создания параметра этого типа.</span><span class="sxs-lookup"><span data-stu-id="2113c-156">Then, use the enumeration type to create a parameter of that type.</span></span>

- <span data-ttu-id="2113c-157">Добавьте атрибут **Validate** в объявление параметра.</span><span class="sxs-lookup"><span data-stu-id="2113c-157">Add the **ValidateSet** attribute to the parameter declaration.</span></span> <span data-ttu-id="2113c-158">Дополнительные сведения об этом атрибуте см. в разделе [объявление атрибута "Validate](./validateset-attribute-declaration.md)".</span><span class="sxs-lookup"><span data-stu-id="2113c-158">For more information about this attribute, see [ValidateSet Attribute Declaration](./validateset-attribute-declaration.md).</span></span>

#### <a name="use-standard-types-for-parameters"></a><span data-ttu-id="2113c-159">Использовать стандартные типы для параметров</span><span class="sxs-lookup"><span data-stu-id="2113c-159">Use Standard Types for Parameters</span></span>

<span data-ttu-id="2113c-160">Чтобы обеспечить согласованность с другими командлетами, используйте стандартные типы для параметров, если это возможно.</span><span class="sxs-lookup"><span data-stu-id="2113c-160">To ensure consistency with other cmdlets, use standard types for parameters where ever possible.</span></span> <span data-ttu-id="2113c-161">Дополнительные сведения о типах, которые следует использовать для различных параметров, см. в разделе [имена и типы параметров стандартных командлетов](./standard-cmdlet-parameter-names-and-types.md).</span><span class="sxs-lookup"><span data-stu-id="2113c-161">For more information about the types that should be used for different parameter, see [Standard Cmdlet Parameter Names and Types](./standard-cmdlet-parameter-names-and-types.md).</span></span> <span data-ttu-id="2113c-162">В этом разделе приводятся ссылки на несколько разделов, описывающих имена и типы .NET Framework для групп стандартных параметров, таких как "Параметры действия".</span><span class="sxs-lookup"><span data-stu-id="2113c-162">This topic provides links to several topics that describe the names and .NET Framework types for groups of standard parameters, such as the "activity parameters".</span></span>

#### <a name="use-strongly-typed-net-framework-types"></a><span data-ttu-id="2113c-163">Использовать строго типизированные типы .NET Framework</span><span class="sxs-lookup"><span data-stu-id="2113c-163">Use Strongly-Typed .NET Framework Types</span></span>

<span data-ttu-id="2113c-164">Параметры должны быть определены как типы .NET Framework, чтобы обеспечить лучшую проверку параметров.</span><span class="sxs-lookup"><span data-stu-id="2113c-164">Parameters should be defined as .NET Framework types to provide better parameter validation.</span></span> <span data-ttu-id="2113c-165">Например, параметры, которые ограничены одним значением из набора значений, должны быть определены как тип перечисления.</span><span class="sxs-lookup"><span data-stu-id="2113c-165">For example, parameters that are restricted to one value from a set of values should be defined as an enumeration type.</span></span> <span data-ttu-id="2113c-166">Чтобы обеспечить поддержку значения универсального кода ресурса (URI), определите параметр как тип [System. URI](/dotnet/api/System.Uri) .</span><span class="sxs-lookup"><span data-stu-id="2113c-166">To support a Uniform Resource Identifier (URI) value, define the parameter as a [System.Uri](/dotnet/api/System.Uri) type.</span></span> <span data-ttu-id="2113c-167">Избегайте использования основных строковых параметров для всех свойств текста в свободной форме.</span><span class="sxs-lookup"><span data-stu-id="2113c-167">Avoid basic string parameters for all but free-form text properties.</span></span>

#### <a name="use-consistent-parameter-types"></a><span data-ttu-id="2113c-168">Использовать совместимые типы параметров</span><span class="sxs-lookup"><span data-stu-id="2113c-168">Use Consistent Parameter Types</span></span>

<span data-ttu-id="2113c-169">Если один и тот же параметр используется несколькими командлетами, всегда используйте один и тот же тип параметра.</span><span class="sxs-lookup"><span data-stu-id="2113c-169">When the same parameter is used by multiple cmdlets, always use the same parameter type.</span></span>  <span data-ttu-id="2113c-170">Например, если параметр `Process` является типом [System. Int16](/dotnet/api/System.Int16) для одного командлета, не делайте параметр `Process` для другого командлета типа [System. UInt16](/dotnet/api/System.UInt16) .</span><span class="sxs-lookup"><span data-stu-id="2113c-170">For example, if the `Process` parameter is an [System.Int16](/dotnet/api/System.Int16) type for one cmdlet, do not make the `Process` parameter for another cmdlet a [System.Uint16](/dotnet/api/System.UInt16) type.</span></span>

#### <a name="parameters-that-take-true-and-false"></a><span data-ttu-id="2113c-171">Параметры, принимающие значения true и false</span><span class="sxs-lookup"><span data-stu-id="2113c-171">Parameters That Take True and False</span></span>

<span data-ttu-id="2113c-172">Если параметр принимает только `true` и `false`, определите параметр как тип [System. Management. Automation. переключатель](/dotnet/api/System.Management.Automation.SwitchParameter).</span><span class="sxs-lookup"><span data-stu-id="2113c-172">If your parameter takes only `true` and `false`, define the parameter as type [System.Management.Automation.SwitchParameter](/dotnet/api/System.Management.Automation.SwitchParameter).</span></span> <span data-ttu-id="2113c-173">Параметр Switch обрабатывается как `true`, если он указан в команде.</span><span class="sxs-lookup"><span data-stu-id="2113c-173">A switch parameter is treated as `true` when it is specified in a command.</span></span> <span data-ttu-id="2113c-174">Если параметр не включен в команду, Windows PowerShell считает значение параметра равным `false`.</span><span class="sxs-lookup"><span data-stu-id="2113c-174">If the parameter is not included in a command, Windows PowerShell considers the value of the parameter to be `false`.</span></span> <span data-ttu-id="2113c-175">Не определяйте логические параметры.</span><span class="sxs-lookup"><span data-stu-id="2113c-175">Do not define Boolean parameters.</span></span>

<span data-ttu-id="2113c-176">Если параметру необходимо различать 3 значения: $true, $false и "не указано", определите параметр типа Nullable @ no__t-0bool >.</span><span class="sxs-lookup"><span data-stu-id="2113c-176">If your parameter needs to differentiate between 3 values: $true, $false and "unspecified", then define a parameter of type Nullable\<bool>.</span></span>  <span data-ttu-id="2113c-177">Необходимость в 3-неопределенном значении обычно возникает, когда командлет может изменить логическое свойство объекта.</span><span class="sxs-lookup"><span data-stu-id="2113c-177">The need for a 3rd, "unspecified" value typically occurs when the cmdlet can modify a Boolean property of an object.</span></span> <span data-ttu-id="2113c-178">В этом случае "не указано" означает, что не следует изменять текущее значение свойства.</span><span class="sxs-lookup"><span data-stu-id="2113c-178">In this case "unspecified" means to not change the current value of the property.</span></span>

#### <a name="support-arrays-for-parameters"></a><span data-ttu-id="2113c-179">Поддержка массивов параметров</span><span class="sxs-lookup"><span data-stu-id="2113c-179">Support Arrays for Parameters</span></span>

<span data-ttu-id="2113c-180">Часто пользователи должны выполнять одну и ту же операцию с несколькими аргументами.</span><span class="sxs-lookup"><span data-stu-id="2113c-180">Frequently, users must perform the same operation against multiple arguments.</span></span> <span data-ttu-id="2113c-181">Для этих пользователей командлет должен принять массив в качестве входных параметров, чтобы пользователь мог передать аргументы в параметр как переменную Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2113c-181">For these users, a cmdlet should accept an array as parameter input so that a user can pass the arguments into the parameter as a Windows PowerShell variable.</span></span> <span data-ttu-id="2113c-182">Например, командлет [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) использует массив для строк, которые указывают имена получаемых процессов.</span><span class="sxs-lookup"><span data-stu-id="2113c-182">For example, the [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) cmdlet uses an array for the strings that identify the names of the processes to retrieve.</span></span>

#### <a name="support-the-passthru-parameter"></a><span data-ttu-id="2113c-183">Поддержка параметра PassThru</span><span class="sxs-lookup"><span data-stu-id="2113c-183">Support the PassThru Parameter</span></span>

<span data-ttu-id="2113c-184">По умолчанию многие командлеты, которые изменяют систему, такие как командлет « [останавливает-обработать](/powershell/module/Microsoft.PowerShell.Management/Stop-Process) », ведут себя как «приемники» для объектов и не возвращают результат.</span><span class="sxs-lookup"><span data-stu-id="2113c-184">By default, many cmdlets that modify the system, such as the [Stop-Process](/powershell/module/Microsoft.PowerShell.Management/Stop-Process) cmdlet, act as "sinks" for objects and do not return a result.</span></span> <span data-ttu-id="2113c-185">Этот командлет должен реализовать параметр `PassThru`, чтобы принудительно вернуть объект в командлет.</span><span class="sxs-lookup"><span data-stu-id="2113c-185">These cmdlet should implement the `PassThru` parameter to force the cmdlet to return an object.</span></span> <span data-ttu-id="2113c-186">Если указан параметр `PassThru`, командлет возвращает объект, используя вызов метода [System. Management. Automation. командлет. WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) .</span><span class="sxs-lookup"><span data-stu-id="2113c-186">When the `PassThru` parameter is specified, the cmdlet returns an object by using a call to the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="2113c-187">Например, следующая команда останавливает процесс Calc и передает результирующий процесс в конвейер.</span><span class="sxs-lookup"><span data-stu-id="2113c-187">For example, the following command stops the Calc process and passes the resultant process to the pipeline.</span></span>

```powershell
Stop-Process calc -passthru
```

<span data-ttu-id="2113c-188">В большинстве случаев командлеты Add, Set и New должны поддерживать параметр `PassThru`.</span><span class="sxs-lookup"><span data-stu-id="2113c-188">In most cases, Add, Set, and New cmdlets should support a `PassThru` parameter.</span></span>

#### <a name="support-parameter-sets"></a><span data-ttu-id="2113c-189">Поддержка наборов параметров</span><span class="sxs-lookup"><span data-stu-id="2113c-189">Support Parameter Sets</span></span>

<span data-ttu-id="2113c-190">Командлет предназначен для выполнения одной задачи.</span><span class="sxs-lookup"><span data-stu-id="2113c-190">A cmdlet is intended to accomplish a single purpose.</span></span> <span data-ttu-id="2113c-191">Однако часто существует несколько способов описания операции или целевого объекта операции.</span><span class="sxs-lookup"><span data-stu-id="2113c-191">However, there is frequently more than one way to describe the operation or the operation target.</span></span> <span data-ttu-id="2113c-192">Например, процесс может быть идентифицирован по имени, идентификатору или объекту процесса.</span><span class="sxs-lookup"><span data-stu-id="2113c-192">For example, a process might be identified by its name, by its identifier, or by a process object.</span></span> <span data-ttu-id="2113c-193">Командлет должен поддерживать все разумные представления целевых объектов.</span><span class="sxs-lookup"><span data-stu-id="2113c-193">The cmdlet should support all the reasonable representations of its targets.</span></span> <span data-ttu-id="2113c-194">Как правило, командлет удовлетворяет этому требованию, указывая наборы параметров (называемые наборами параметров), которые работают вместе.</span><span class="sxs-lookup"><span data-stu-id="2113c-194">Normally, the cmdlet satisfies this requirement by specifying sets of parameters (referred to as parameter sets) that operate together.</span></span> <span data-ttu-id="2113c-195">Один параметр может принадлежать любому количеству наборов параметров.</span><span class="sxs-lookup"><span data-stu-id="2113c-195">A single parameter can belong to any number of parameter sets.</span></span> <span data-ttu-id="2113c-196">Дополнительные сведения о наборах параметров см. в разделе [наборы параметров командлета](./cmdlet-parameter-sets.md).</span><span class="sxs-lookup"><span data-stu-id="2113c-196">For more information about parameter sets, see [Cmdlet Parameter Sets](./cmdlet-parameter-sets.md).</span></span>

<span data-ttu-id="2113c-197">При указании наборов параметров установите только один параметр в наборе в значение Валуефромпипелине.</span><span class="sxs-lookup"><span data-stu-id="2113c-197">When you specify parameter sets, set only one parameter in the set to ValueFromPipeline.</span></span> <span data-ttu-id="2113c-198">Дополнительные сведения об объявлении атрибута **Parameter** см. в разделе [объявление параметераттрибуте](./parameter-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="2113c-198">For more information about how to declare the **Parameter** attribute, see [ParameterAttribute Declaration](./parameter-attribute-declaration.md).</span></span>

<span data-ttu-id="2113c-199">Если используются наборы параметров, набор параметров по умолчанию определяется атрибутом **командлета** .</span><span class="sxs-lookup"><span data-stu-id="2113c-199">When parameter sets are used, the default parameter set is defined by the **Cmdlet** attribute.</span></span> <span data-ttu-id="2113c-200">Набор параметров по умолчанию должен включать параметры, которые, скорее всего, будут использоваться в интерактивном сеансе Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2113c-200">The default parameter set should include the parameters most likely to be used in an interactive Windows PowerShell session.</span></span> <span data-ttu-id="2113c-201">Дополнительные сведения об объявлении атрибута **командлета** см. в разделе [объявление CmdletAttribute](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="2113c-201">For more information about how to declare the **Cmdlet** attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="provide-feedback-to-the-user-sd04"></a><span data-ttu-id="2113c-202">Отправить отзыв пользователю (SD04)</span><span class="sxs-lookup"><span data-stu-id="2113c-202">Provide Feedback to the User (SD04)</span></span>

<span data-ttu-id="2113c-203">Используйте рекомендации в этом разделе, чтобы отправить отзыв пользователю.</span><span class="sxs-lookup"><span data-stu-id="2113c-203">Use the guidelines in this section to provide feedback to the user.</span></span> <span data-ttu-id="2113c-204">Этот отзыв позволяет пользователю знать, что происходит в системе, и принимать более качественные административные решения.</span><span class="sxs-lookup"><span data-stu-id="2113c-204">This feedback allows the user to be aware of what is occurring in the system and to make better administrative decisions.</span></span>

<span data-ttu-id="2113c-205">Среда выполнения Windows PowerShell позволяет пользователю указать способ управления выходными данными при каждом вызове метода `Write`, задав переменную предпочтения.</span><span class="sxs-lookup"><span data-stu-id="2113c-205">The Windows PowerShell runtime allows a user to specify how to handle output from each call to the `Write` method by setting a preference variable.</span></span> <span data-ttu-id="2113c-206">Пользователь может задать несколько переменных предпочтений, включая переменную, которая определяет, должна ли система отображать информацию и переменную, которая определяет, должна ли система запрашивать пользователя перед дальнейшим действием.</span><span class="sxs-lookup"><span data-stu-id="2113c-206">The user can set several preference variables, including a variable that determines whether the system should display information and a variable that determines whether the system should query the user before taking further action.</span></span>

#### <a name="support-the-writewarning-writeverbose-and-writedebug-methods"></a><span data-ttu-id="2113c-207">Поддержка методов Вритеварнинг, Вритевербосе и Вритедебуг</span><span class="sxs-lookup"><span data-stu-id="2113c-207">Support the WriteWarning, WriteVerbose, and WriteDebug Methods</span></span>

<span data-ttu-id="2113c-208">Командлет должен вызвать метод [System. Management. Automation. командлет. вритеварнинг](/dotnet/api/System.Management.Automation.Cmdlet.WriteWarning) , когда командлет собирается выполнить операцию, которая может иметь непредвиденный результат.</span><span class="sxs-lookup"><span data-stu-id="2113c-208">A cmdlet should call the [System.Management.Automation.Cmdlet.WriteWarning](/dotnet/api/System.Management.Automation.Cmdlet.WriteWarning) method when the cmdlet is about to perform an operation that might have an unintended result.</span></span> <span data-ttu-id="2113c-209">Например, командлет должен вызвать этот метод, если командлет собирается перезаписать файл, доступный только для чтения.</span><span class="sxs-lookup"><span data-stu-id="2113c-209">For example, a cmdlet should call this method if the cmdlet is about to overwrite a read-only file.</span></span>

<span data-ttu-id="2113c-210">Командлет должен вызвать метод [System. Management. Automation. командлет. вритевербосе](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) , когда пользователю нужны некоторые сведения о выполняемом командлете.</span><span class="sxs-lookup"><span data-stu-id="2113c-210">A cmdlet should call the [System.Management.Automation.Cmdlet.WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) method when the user requires some detail about what the cmdlet is doing.</span></span> <span data-ttu-id="2113c-211">Например, командлет должен вызывать эту информацию, если автор командлета полагает, что существуют сценарии, для которых может потребоваться дополнительная информация о выполняемом командлете.</span><span class="sxs-lookup"><span data-stu-id="2113c-211">For example, a cmdlet should call this information if the cmdlet author feels that there are scenarios that might require more information about what the cmdlet is doing.</span></span>

<span data-ttu-id="2113c-212">Командлет должен вызвать метод [System. Management. Automation. командлет. вритедебуг](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) , когда разработчик или специалист по поддержке продукта должен понять, что именно вызвало повреждение операции командлета.</span><span class="sxs-lookup"><span data-stu-id="2113c-212">The cmdlet should call the [System.Management.Automation.Cmdlet.WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) method when a developer or product support engineer must understand what has corrupted the cmdlet operation.</span></span> <span data-ttu-id="2113c-213">Командлету не требуется вызывать метод [System. Management. Automation. командлет. вритедебуг](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) в том же коде, который вызывает метод [System. Management. Automation. командлет. вритевербосе](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) , так как параметр `Debug` представляет и наборы сведений.</span><span class="sxs-lookup"><span data-stu-id="2113c-213">It is not necessary for the cmdlet to call the [System.Management.Automation.Cmdlet.WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) method in the same code that calls the [System.Management.Automation.Cmdlet.WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) method because the `Debug` parameter presents both sets of information.</span></span>

#### <a name="support-writeprogress-for-operations-that-take-a-long-time"></a><span data-ttu-id="2113c-214">Поддержка Вритепрогресс для операций, которые выполняются длительное время</span><span class="sxs-lookup"><span data-stu-id="2113c-214">Support WriteProgress for Operations that take a Long Time</span></span>

<span data-ttu-id="2113c-215">Операции командлета, выполнение которых занимает много времени и которые не могут выполняться в фоновом режиме, должны поддерживать отчеты о ходе выполнения через периодические вызовы метода [System. Management. Automation. командлет. вритепрогресс](/dotnet/api/System.Management.Automation.Cmdlet.WriteProgress) .</span><span class="sxs-lookup"><span data-stu-id="2113c-215">Cmdlet operations that take a long time to complete and that cannot run in the background should support progress reporting through periodic calls to the [System.Management.Automation.Cmdlet.WriteProgress](/dotnet/api/System.Management.Automation.Cmdlet.WriteProgress) method.</span></span>

#### <a name="use-the-host-interfaces"></a><span data-ttu-id="2113c-216">Использование интерфейсов узла</span><span class="sxs-lookup"><span data-stu-id="2113c-216">Use the Host Interfaces</span></span>

<span data-ttu-id="2113c-217">Иногда командлет должен напрямую взаимодействовать с пользователем, а не с помощью различных методов Write или, поддерживаемых классом [System. Management. Automation. командлет](/dotnet/api/System.Management.Automation.Cmdlet) .</span><span class="sxs-lookup"><span data-stu-id="2113c-217">Occasionally, a cmdlet must communicate directly with the user instead of by using the various Write or Should methods supported by the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class.</span></span> <span data-ttu-id="2113c-218">В этом случае командлет должен быть производным от класса [System. Management. Automation. PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) и использовать свойство [System. Management. Automation. PSCmdlet. Host \*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) .</span><span class="sxs-lookup"><span data-stu-id="2113c-218">In this case, the cmdlet should derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class and use the [System.Management.Automation.PSCmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) property.</span></span> <span data-ttu-id="2113c-219">Это свойство поддерживает разные уровни типа связи, включая типы Промптфорчоице, Prompt и ReadLine.</span><span class="sxs-lookup"><span data-stu-id="2113c-219">This property supports different levels of communication type, including the PromptForChoice, Prompt, and WriteLine/ReadLine types.</span></span> <span data-ttu-id="2113c-220">На самом конкретном уровне он также предоставляет способы чтения и записи отдельных ключей и работы с буферами.</span><span class="sxs-lookup"><span data-stu-id="2113c-220">At the most specific level, it also provides ways to read and write individual keys and to deal with buffers.</span></span>

<span data-ttu-id="2113c-221">Если командлет специально не предназначен для создания графического пользовательского интерфейса, он не должен обходить узел с помощью свойства [System. Management. Automation. PSCmdlet. Host \*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) .</span><span class="sxs-lookup"><span data-stu-id="2113c-221">Unless a cmdlet is specifically designed to generate a graphical user interface (GUI), it should not bypass the host by using the [System.Management.Automation.PSCmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) property.</span></span> <span data-ttu-id="2113c-222">Примером командлета, предназначенного для создания графического пользовательского интерфейса, является командлет [Out-GridView](/powershell/module/Microsoft.PowerShell.Utility/Out-GridView) .</span><span class="sxs-lookup"><span data-stu-id="2113c-222">An example of a cmdlet that is designed to generate a GUI is the [Out-GridView](/powershell/module/Microsoft.PowerShell.Utility/Out-GridView) cmdlet.</span></span>

> [!NOTE]
> <span data-ttu-id="2113c-223">Командлеты не должны использовать API [System. Console](/dotnet/api/System.Console) .</span><span class="sxs-lookup"><span data-stu-id="2113c-223">Cmdlets should not use the [System.Console](/dotnet/api/System.Console) API.</span></span>

### <a name="create-a-cmdlet-help-file-sd05"></a><span data-ttu-id="2113c-224">Создание файла справки по командлету (SD05)</span><span class="sxs-lookup"><span data-stu-id="2113c-224">Create a Cmdlet Help File (SD05)</span></span>

<span data-ttu-id="2113c-225">Для каждой сборки командлета создайте файл Help. XML, содержащий сведения о командлете.</span><span class="sxs-lookup"><span data-stu-id="2113c-225">For each cmdlet assembly, create a Help.xml file that contains information about the cmdlet.</span></span> <span data-ttu-id="2113c-226">Эти сведения включают описание командлета, описания параметров командлета, примеры использования командлета и многое другое.</span><span class="sxs-lookup"><span data-stu-id="2113c-226">This information includes a description of the cmdlet, descriptions of the cmdlet's parameters, examples of the cmdlet's use, and more.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="2113c-227">Рекомендации по коду</span><span class="sxs-lookup"><span data-stu-id="2113c-227">Code Guidelines</span></span>

<span data-ttu-id="2113c-228">При написании командлетов необходимо следовать приведенным ниже рекомендациям, чтобы обеспечить согласованное взаимодействие с пользователем при использовании командлетов и других командлетов.</span><span class="sxs-lookup"><span data-stu-id="2113c-228">The following guidelines should be followed when coding cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="2113c-229">Когда вы найдете рекомендации по коду, применимые к вашей ситуации, ознакомьтесь с рекомендациями по проектированию для аналогичных руководств.</span><span class="sxs-lookup"><span data-stu-id="2113c-229">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="coding-parameters-sc01"></a><span data-ttu-id="2113c-230">Параметры кодирования (SC01)</span><span class="sxs-lookup"><span data-stu-id="2113c-230">Coding Parameters (SC01)</span></span>

<span data-ttu-id="2113c-231">Определите параметр, объявив открытое свойство класса командлета, дополненного атрибутом **Parameter** .</span><span class="sxs-lookup"><span data-stu-id="2113c-231">Define a parameter by declaring a public property of the cmdlet class that is decorated with the **Parameter** attribute.</span></span> <span data-ttu-id="2113c-232">Параметры не обязательно должны быть статическими членами производного класса .NET Framework для командлета.</span><span class="sxs-lookup"><span data-stu-id="2113c-232">Parameters do not have to be static members of the derived .NET Framework class for the cmdlet.</span></span> <span data-ttu-id="2113c-233">Дополнительные сведения об объявлении атрибута **Parameter** см. в разделе [объявление атрибута параметра](./parameter-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="2113c-233">For more information about how to declare the **Parameter** attribute, see [Parameter Attribute Declaration](./parameter-attribute-declaration.md).</span></span>

#### <a name="support-windows-powershell-paths"></a><span data-ttu-id="2113c-234">Поддержка путей Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2113c-234">Support Windows PowerShell Paths</span></span>

<span data-ttu-id="2113c-235">Путь Windows PowerShell — это механизм нормализации доступа к пространствам имен.</span><span class="sxs-lookup"><span data-stu-id="2113c-235">The Windows PowerShell path is the mechanism for normalizing access to namespaces.</span></span> <span data-ttu-id="2113c-236">При назначении пути Windows PowerShell параметру в командлете пользователь может определить пользовательский "диск", который будет выступать в качестве ярлыка для определенного пути.</span><span class="sxs-lookup"><span data-stu-id="2113c-236">When you assign a Windows PowerShell path to a parameter in the cmdlet, the user can define a custom "drive" that acts as a shortcut to a specific path.</span></span> <span data-ttu-id="2113c-237">Когда пользователь указывает такой диск, хранимые данные, такие как данные в реестре, можно использовать согласованным образом.</span><span class="sxs-lookup"><span data-stu-id="2113c-237">When a user designates such a drive, stored data, such as data in the Registry, can be used in a consistent way.</span></span>

<span data-ttu-id="2113c-238">Если командлет позволяет пользователю указать файл или источник данных, он должен определить параметр типа [System. String](/dotnet/api/System.String).</span><span class="sxs-lookup"><span data-stu-id="2113c-238">If your cmdlet allows the user to specify a file or a data source, it should define a parameter of type [System.String](/dotnet/api/System.String).</span></span> <span data-ttu-id="2113c-239">Если поддерживается более одного диска, тип должен быть массивом.</span><span class="sxs-lookup"><span data-stu-id="2113c-239">If more than one drive is supported, the type should be an array.</span></span> <span data-ttu-id="2113c-240">Имя параметра должно быть `Path` с псевдонимом `PSPath`.</span><span class="sxs-lookup"><span data-stu-id="2113c-240">The name of the parameter should be `Path`, with an alias of `PSPath`.</span></span> <span data-ttu-id="2113c-241">Кроме того, параметр `Path` должен поддерживать подстановочные знаки.</span><span class="sxs-lookup"><span data-stu-id="2113c-241">Additionally, the `Path` parameter should support wildcard characters.</span></span> <span data-ttu-id="2113c-242">Если поддержка символов-шаблонов не требуется, определите параметр `LiteralPath`.</span><span class="sxs-lookup"><span data-stu-id="2113c-242">If support for wildcard characters is not required, define a `LiteralPath` parameter.</span></span>

<span data-ttu-id="2113c-243">Если данные, которые командлет считывает или записывают, должны быть файлом, командлет должен принять входные данные пути Windows PowerShell, а командлет должен использовать свойство [System. Management. Automation. sessionState. Path](/dotnet/api/System.Management.Automation.SessionState.Path) , чтобы преобразовать пути Windows PowerShell в пути, распознаваемые файловой системой.</span><span class="sxs-lookup"><span data-stu-id="2113c-243">If the data that the cmdlet reads or writes has to be a file, the cmdlet should accept Windows PowerShell path input, and the cmdlet should use the [System.Management.Automation.Sessionstate.Path](/dotnet/api/System.Management.Automation.SessionState.Path) property to translate the Windows PowerShell paths into paths that the file system recognizes.</span></span> <span data-ttu-id="2113c-244">К конкретным механизмам относятся следующие методы.</span><span class="sxs-lookup"><span data-stu-id="2113c-244">The specific mechanisms include the following methods:</span></span>

- [<span data-ttu-id="2113c-245">System. Management. Automation. PSCmdlet. Жетресолведпровидерпасфромпспас</span><span class="sxs-lookup"><span data-stu-id="2113c-245">System.Management.Automation.PSCmdlet.GetResolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PSCmdlet.GetResolvedProviderPathFromPSPath)

- [<span data-ttu-id="2113c-246">System. Management. Automation. PSCmdlet. Жетунресолведпровидерпасфромпспас</span><span class="sxs-lookup"><span data-stu-id="2113c-246">System.Management.Automation.PSCmdlet.GetUnresolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PSCmdlet.GetUnresolvedProviderPathFromPSPath)

- [<span data-ttu-id="2113c-247">System. Management. Automation. Пасинтринсикс. Жетресолведпровидерпасфромпспас</span><span class="sxs-lookup"><span data-stu-id="2113c-247">System.Management.Automation.PathIntrinsics.GetResolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PathIntrinsics.GetResolvedProviderPathFromPSPath)

- [<span data-ttu-id="2113c-248">System. Management. Automation. Пасинтринсикс. Жетунресолведпровидерпасфромпспас</span><span class="sxs-lookup"><span data-stu-id="2113c-248">System.Management.Automation.PathIntrinsics.GetUnresolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PathIntrinsics.GetUnresolvedProviderPathFromPSPath)

<span data-ttu-id="2113c-249">Если данные, считываемые или записываемые командлетом, являются только набором строк, а не файлом, командлет должен использовать сведения о содержимом поставщика (`Content` Member) для чтения и записи.</span><span class="sxs-lookup"><span data-stu-id="2113c-249">If the data that the cmdlet reads or writes is only a set of strings instead of a file, the cmdlet should use the provider content information (`Content` member) to read and write.</span></span> <span data-ttu-id="2113c-250">Эти сведения получаются из свойства [System. Management. Automation. Provider. кмдлетпровидер. инвокепровидер](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.InvokeProvider) .</span><span class="sxs-lookup"><span data-stu-id="2113c-250">This information is obtained from the [System.Management.Automation.Provider.CmdletProvider.InvokeProvider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.InvokeProvider) property.</span></span> <span data-ttu-id="2113c-251">Эти механизмы позволяют другим хранилищам данных принимать участие в чтении и записи данных.</span><span class="sxs-lookup"><span data-stu-id="2113c-251">These mechanisms allow other data stores to participate in the reading and writing of data.</span></span>

#### <a name="support-wildcard-characters"></a><span data-ttu-id="2113c-252">Поддержка подстановочных знаков</span><span class="sxs-lookup"><span data-stu-id="2113c-252">Support Wildcard Characters</span></span>

<span data-ttu-id="2113c-253">По возможности командлет должен поддерживать подстановочные знаки.</span><span class="sxs-lookup"><span data-stu-id="2113c-253">A cmdlet should support wildcard characters if possible.</span></span> <span data-ttu-id="2113c-254">Поддержка подстановочных знаков выполняется во многих местах командлета (особенно когда параметр принимает строку для указания одного объекта из набора объектов).</span><span class="sxs-lookup"><span data-stu-id="2113c-254">Support for wildcard characters occurs in many places in a cmdlet (especially when a parameter takes a string to identify one object from a set of objects).</span></span> <span data-ttu-id="2113c-255">Например, командлет «Sample **-proc** » из [учебника стоппрок](./stopproc-tutorial.md) определяет параметр `Name` для обработки строк, представляющих имена процессов.</span><span class="sxs-lookup"><span data-stu-id="2113c-255">For example, the sample **Stop-Proc** cmdlet from the [StopProc Tutorial](./stopproc-tutorial.md) defines a `Name` parameter to handle strings that represent process names.</span></span> <span data-ttu-id="2113c-256">Этот параметр поддерживает подстановочные знаки, чтобы пользователь мог легко указать процессы для их завершения.</span><span class="sxs-lookup"><span data-stu-id="2113c-256">This parameter supports wildcard characters so that the user can easily specify the processes to stop.</span></span>

<span data-ttu-id="2113c-257">Если доступна поддержка подстановочных знаков, операция командлета обычно создает массив.</span><span class="sxs-lookup"><span data-stu-id="2113c-257">When support for wildcard characters is available, a cmdlet operation usually produces an array.</span></span> <span data-ttu-id="2113c-258">Иногда не имеет смысла поддерживать массив, поскольку пользователь может использовать только один элемент за раз.</span><span class="sxs-lookup"><span data-stu-id="2113c-258">Occasionally, it does not make sense to support an array because the user might use only a single item at a time.</span></span> <span data-ttu-id="2113c-259">Например, командлету [Set-Location](/powershell/module/Microsoft.PowerShell.Management/Set-Location) не требуется поддерживать массив, поскольку пользователь устанавливает только одно расположение.</span><span class="sxs-lookup"><span data-stu-id="2113c-259">For example, the [Set-Location](/powershell/module/Microsoft.PowerShell.Management/Set-Location) cmdlet does not need to support an array because the user is setting only a single location.</span></span> <span data-ttu-id="2113c-260">В этом случае командлет по-прежнему поддерживает подстановочные знаки, но обеспечивает разрешение в одном месте.</span><span class="sxs-lookup"><span data-stu-id="2113c-260">In this instance, the cmdlet still supports wildcard characters, but it forces resolution to a single location.</span></span>

<span data-ttu-id="2113c-261">Дополнительные сведения о шаблонах символов-шаблонов см. [в разделе Поддержка подстановочных знаков в параметрах командлета](./supporting-wildcard-characters-in-cmdlet-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="2113c-261">For more information about wildcard-character patterns, see [Supporting Wildcard Characters in Cmdlet Parameters](./supporting-wildcard-characters-in-cmdlet-parameters.md).</span></span>

#### <a name="defining-objects"></a><span data-ttu-id="2113c-262">Определение объектов</span><span class="sxs-lookup"><span data-stu-id="2113c-262">Defining Objects</span></span>

<span data-ttu-id="2113c-263">В этом разделе содержатся рекомендации по определению объектов для командлетов и расширению существующих объектов.</span><span class="sxs-lookup"><span data-stu-id="2113c-263">This section contains guidelines for defining objects for cmdlets and for extending existing objects.</span></span>

##### <a name="define-standard-members"></a><span data-ttu-id="2113c-264">Определение стандартных членов</span><span class="sxs-lookup"><span data-stu-id="2113c-264">Define Standard Members</span></span>

<span data-ttu-id="2113c-265">Определите стандартные члены для расширения типа объекта в файле пользовательских типов. ps1xml (используйте файл Windows PowerShell Types. ps1xml в качестве шаблона).</span><span class="sxs-lookup"><span data-stu-id="2113c-265">Define standard members to extend an object type in a custom Types.ps1xml file (use the Windows PowerShell Types.ps1xml file as a template).</span></span> <span data-ttu-id="2113c-266">Стандартные члены определяются узлом с именем Псстандардмемберс.</span><span class="sxs-lookup"><span data-stu-id="2113c-266">Standard members are defined by a node with the name PSStandardMembers.</span></span> <span data-ttu-id="2113c-267">Эти определения позволяют другим командлетам и среде выполнения Windows PowerShell работать с объектом согласованным образом.</span><span class="sxs-lookup"><span data-stu-id="2113c-267">These definitions allow other cmdlets and the Windows PowerShell runtime to work with your object in a consistent way.</span></span>

##### <a name="define-objectmembers-to-be-used-as-parameters"></a><span data-ttu-id="2113c-268">Определить Обжектмемберс для использования в качестве параметров</span><span class="sxs-lookup"><span data-stu-id="2113c-268">Define ObjectMembers to Be Used as Parameters</span></span>

<span data-ttu-id="2113c-269">При проектировании объекта для командлета убедитесь, что его члены сопоставляются непосредственно с параметрами командлетов, которые будут его использовать.</span><span class="sxs-lookup"><span data-stu-id="2113c-269">If you are designing an object for a cmdlet, ensure that its members map directly to the parameters of the cmdlets that will use it.</span></span> <span data-ttu-id="2113c-270">Это сопоставление позволяет легко отправлять объект в конвейер и передавать его из одного командлета в другой.</span><span class="sxs-lookup"><span data-stu-id="2113c-270">This mapping allows the object to be easily sent to the pipeline and to be passed from one cmdlet to another.</span></span>

<span data-ttu-id="2113c-271">Существующие .NET Framework объекты, возвращаемые командлетами, часто не имеют некоторых важных или удобных элементов, необходимых разработчику или пользователю скрипта.</span><span class="sxs-lookup"><span data-stu-id="2113c-271">Preexisting .NET Framework objects that are returned by cmdlets are frequently missing some important or convenient members that are needed by the script developer or user.</span></span> <span data-ttu-id="2113c-272">Эти отсутствующие элементы могут быть особенно важны для вывода и для создания правильных имен членов, чтобы объект мог быть правильно передан в конвейер.</span><span class="sxs-lookup"><span data-stu-id="2113c-272">These missing members can be particularly important for display and for creating the correct member names so that the object can be correctly passed to the pipeline.</span></span> <span data-ttu-id="2113c-273">Создайте файл Custom Types. ps1xml, чтобы документировать эти необходимые элементы.</span><span class="sxs-lookup"><span data-stu-id="2113c-273">Create a custom Types.ps1xml file to document these required members.</span></span> <span data-ttu-id="2113c-274">При создании этого файла рекомендуется использовать следующее соглашение об именовании: *< Your_Product_Name >* . Types. ps1xml.</span><span class="sxs-lookup"><span data-stu-id="2113c-274">When you create this file, we recommend the following naming convention: *<Your_Product_Name>*.Types.ps1xml.</span></span>

<span data-ttu-id="2113c-275">Например, можно добавить свойство скрипта `Mode` в тип [System. IO. FileInfo](/dotnet/api/System.IO.FileInfo) для более четкого представления атрибутов файла.</span><span class="sxs-lookup"><span data-stu-id="2113c-275">For example, you could add a `Mode` script property to the [System.IO.FileInfo](/dotnet/api/System.IO.FileInfo) type to display the attributes of a file more clearly.</span></span> <span data-ttu-id="2113c-276">Кроме того, можно добавить свойство псевдонима `Count` в тип [System. Array](/dotnet/api/System.Array) , чтобы обеспечить единообразное использование имени этого свойства (вместо `Length`).</span><span class="sxs-lookup"><span data-stu-id="2113c-276">Additionally, you could add a `Count` alias property to the [System.Array](/dotnet/api/System.Array) type to allow the consistent use of that property name (instead of `Length`).</span></span>

##### <a name="implement-the-icomparable-interface"></a><span data-ttu-id="2113c-277">Реализация интерфейса IComparable</span><span class="sxs-lookup"><span data-stu-id="2113c-277">Implement the IComparable Interface</span></span>

<span data-ttu-id="2113c-278">Реализуйте интерфейс [System. IComparable](/dotnet/api/System.IComparable) для всех выходных объектов.</span><span class="sxs-lookup"><span data-stu-id="2113c-278">Implement a [System.IComparable](/dotnet/api/System.IComparable) interface on all output objects.</span></span> <span data-ttu-id="2113c-279">Это позволяет легко передавать выходные объекты в различные командлеты сортировки и анализа.</span><span class="sxs-lookup"><span data-stu-id="2113c-279">This allows the output objects to be easily piped to various sorting and analysis cmdlets.</span></span>

##### <a name="update-display-information"></a><span data-ttu-id="2113c-280">Обновить отображаемые сведения</span><span class="sxs-lookup"><span data-stu-id="2113c-280">Update Display Information</span></span>

<span data-ttu-id="2113c-281">Если отображение объекта не предоставляет ожидаемых результатов, создайте пользовательское *> @no__t 1YourProductName*. Файл Format. ps1xml для этого объекта.</span><span class="sxs-lookup"><span data-stu-id="2113c-281">If the display for an object does not provide the expected results, create a custom *\<YourProductName>*.Format.ps1xml file for that object.</span></span>

### <a name="support-well-defined-pipeline-input-sc02"></a><span data-ttu-id="2113c-282">Поддержка хорошо определенных входных данных конвейера (SC02)</span><span class="sxs-lookup"><span data-stu-id="2113c-282">Support Well Defined Pipeline Input (SC02)</span></span>

#### <a name="implement-for-the-middle-of-a-pipeline"></a><span data-ttu-id="2113c-283">Реализация для середины конвейера</span><span class="sxs-lookup"><span data-stu-id="2113c-283">Implement for the Middle of a Pipeline</span></span>

<span data-ttu-id="2113c-284">Реализуйте командлет, предполагая, что он будет вызываться из середины конвейера (то есть другие командлеты создадут свои входные данные или занимают его выходные данные).</span><span class="sxs-lookup"><span data-stu-id="2113c-284">Implement a cmdlet assuming that it will be called from the middle of a pipeline (that is, other cmdlets will produce its input or consume its output).</span></span> <span data-ttu-id="2113c-285">Например, можно предположить, что командлет `Get-Process`, поскольку он создает данные, используется только в качестве первого командлета в конвейере.</span><span class="sxs-lookup"><span data-stu-id="2113c-285">For example, you might assume that the `Get-Process` cmdlet, because it generates data, is used only as the first cmdlet in a pipeline.</span></span> <span data-ttu-id="2113c-286">Однако поскольку этот командлет предназначен для середины конвейера, этот командлет позволяет предыдущим командлетам или данным в конвейере указать процессы для извлечения.</span><span class="sxs-lookup"><span data-stu-id="2113c-286">However, because this cmdlet is designed for the middle of a pipeline, this cmdlet allows previous cmdlets or data in the pipeline to specify the processes to retrieve.</span></span>

#### <a name="support-input-from-the-pipeline"></a><span data-ttu-id="2113c-287">Поддержка входных данных из конвейера</span><span class="sxs-lookup"><span data-stu-id="2113c-287">Support Input from the Pipeline</span></span>

<span data-ttu-id="2113c-288">В каждом наборе параметров для командлета включите по крайней мере один параметр, который поддерживает входные данные из конвейера.</span><span class="sxs-lookup"><span data-stu-id="2113c-288">In each parameter set for a cmdlet, include at least one parameter that supports input from the pipeline.</span></span> <span data-ttu-id="2113c-289">Поддержка входных данных конвейера позволяет пользователю получить данные или объекты, отправить их в правильный набор параметров и передать результаты непосредственно в командлет.</span><span class="sxs-lookup"><span data-stu-id="2113c-289">Support for pipeline input allows the user to retrieve data or objects, to send them to the correct parameter set, and to pass the results directly to a cmdlet.</span></span>

<span data-ttu-id="2113c-290">Параметр принимает входные данные из конвейера, если атрибут **Parameter** включает ключевое слово `ValueFromPipeline`, атрибут `ValueFromPipelineByPropertyName` или оба ключевого слова в его объявлении.</span><span class="sxs-lookup"><span data-stu-id="2113c-290">A parameter accepts input from the pipeline if the **Parameter** attribute includes the `ValueFromPipeline` keyword, the `ValueFromPipelineByPropertyName` keyword attribute, or both keywords in its  declaration.</span></span> <span data-ttu-id="2113c-291">Если ни один из параметров в наборе параметров не поддерживает ключевые слова `ValueFromPipeline` или `ValueFromPipelineByPropertyName`, командлет не может иметь смысла помещать после другого командлета, так как он игнорирует любые входные данные конвейера.</span><span class="sxs-lookup"><span data-stu-id="2113c-291">If none of the parameters in a parameter set support the `ValueFromPipeline` or `ValueFromPipelineByPropertyName` keywords, the cmdlet cannot meaningfully be placed after another cmdlet because it will ignore any pipeline input.</span></span>

#### <a name="support-the-processrecord-method"></a><span data-ttu-id="2113c-292">Поддержка метода ProcessRecord</span><span class="sxs-lookup"><span data-stu-id="2113c-292">Support the ProcessRecord Method</span></span>

<span data-ttu-id="2113c-293">Чтобы принять все записи из предыдущего командлета в конвейере, командлет должен реализовать метод [System. Management. Automation. командлет. ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) .</span><span class="sxs-lookup"><span data-stu-id="2113c-293">To accept all the records from the preceding cmdlet in the pipeline, your cmdlet must implement the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method.</span></span> <span data-ttu-id="2113c-294">Windows PowerShell вызывает этот метод несколько раз, по одному разу для каждой записи, которая отправляется в командлет.</span><span class="sxs-lookup"><span data-stu-id="2113c-294">Windows PowerShell calls this method multiple times, once for every record that is sent to your cmdlet.</span></span>

### <a name="write-single-records-to-the-pipeline-sc03"></a><span data-ttu-id="2113c-295">Запись отдельных записей в конвейер (SC03)</span><span class="sxs-lookup"><span data-stu-id="2113c-295">Write Single Records to the Pipeline (SC03)</span></span>

<span data-ttu-id="2113c-296">Когда командлет возвращает объекты, командлет должен записывать объекты непосредственно по мере их создания.</span><span class="sxs-lookup"><span data-stu-id="2113c-296">When a cmdlet returns objects, the cmdlet should write the objects immediately as they are generated.</span></span> <span data-ttu-id="2113c-297">Командлет не должен удерживать их для того, чтобы буферизовать их в Объединенном массиве.</span><span class="sxs-lookup"><span data-stu-id="2113c-297">The cmdlet should not hold them in order to buffer them into a combined array.</span></span> <span data-ttu-id="2113c-298">Командлеты, получающие эти объекты в качестве входных данных, смогут обрабатывать, отображать или обрабатывать и отображать выходные объекты без задержки.</span><span class="sxs-lookup"><span data-stu-id="2113c-298">The cmdlets that receive the objects as input will then be able to process, display, or process and display the output objects without delay.</span></span> <span data-ttu-id="2113c-299">Командлет, создающий выходные объекты по одному за раз, должен вызвать метод [System. Management. Automation. командлет. WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) .</span><span class="sxs-lookup"><span data-stu-id="2113c-299">A cmdlet that generates output objects one at a time should call the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="2113c-300">Командлет, создающий выходные объекты в пакетах (например, так как базовый API возвращает массив выходных объектов), должен вызывать метод [System. Management. Automation. командлет. WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) со вторым параметром, имеющим значение `true`.</span><span class="sxs-lookup"><span data-stu-id="2113c-300">A cmdlet that generates output objects in batches (for example, because an underlying API returns an array of output objects) should call the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) Method with its second parameter set to `true`.</span></span>

### <a name="make-cmdlets-case-insensitive-and-case-preserving-sc04"></a><span data-ttu-id="2113c-301">Сделать командлеты без учета регистра и с сохранением регистра (SC04)</span><span class="sxs-lookup"><span data-stu-id="2113c-301">Make Cmdlets Case-Insensitive and Case-Preserving (SC04)</span></span>

<span data-ttu-id="2113c-302">По умолчанию Windows PowerShell не учитывает регистр.</span><span class="sxs-lookup"><span data-stu-id="2113c-302">By default, Windows PowerShell itself is case-insensitive.</span></span> <span data-ttu-id="2113c-303">Тем не менее, поскольку он работает с множеством уже существующих систем, Windows PowerShell сохраняет регистр для простоты работы и совместимости.</span><span class="sxs-lookup"><span data-stu-id="2113c-303">However, because it deals with many preexisting systems, Windows PowerShell does preserve case for ease of operation and compatibility.</span></span> <span data-ttu-id="2113c-304">Иными словами, если символ указан в прописных буквах, Windows PowerShell сохранит его в прописных буквах.</span><span class="sxs-lookup"><span data-stu-id="2113c-304">In other words, if a character is supplied in uppercase letters, Windows PowerShell keeps it in uppercase letters.</span></span> <span data-ttu-id="2113c-305">Чтобы системы работали правильно, командлет должен следовать этому соглашению.</span><span class="sxs-lookup"><span data-stu-id="2113c-305">For systems to work well, a cmdlet needs to follow this convention.</span></span> <span data-ttu-id="2113c-306">Если это возможно, оно должно выполняться без учета регистра.</span><span class="sxs-lookup"><span data-stu-id="2113c-306">If possible, it should operate in a case-insensitive way.</span></span> <span data-ttu-id="2113c-307">Однако он должен сохранить исходный регистр для командлетов, которые происходят позже в команде или в конвейере.</span><span class="sxs-lookup"><span data-stu-id="2113c-307">It should, however, preserve the original case for cmdlets that occur later in a command or in the pipeline.</span></span>

## <a name="see-also"></a><span data-ttu-id="2113c-308">См. также:</span><span class="sxs-lookup"><span data-stu-id="2113c-308">See Also</span></span>

[<span data-ttu-id="2113c-309">Необходимые рекомендации по разработке</span><span class="sxs-lookup"><span data-stu-id="2113c-309">Required Development Guidelines</span></span>](./required-development-guidelines.md)

[<span data-ttu-id="2113c-310">Рекомендации по разработке рекомендаций</span><span class="sxs-lookup"><span data-stu-id="2113c-310">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

[<span data-ttu-id="2113c-311">Запись командлета Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2113c-311">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
