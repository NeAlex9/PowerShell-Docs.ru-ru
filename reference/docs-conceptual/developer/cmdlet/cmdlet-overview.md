---
ms.date: 06/11/2020
ms.topic: reference
title: Общие сведения о командлетах
description: Общие сведения о командлетах
ms.openlocfilehash: ed3082e1a821bb9643ea2eef13b7348eb48488e4
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "92653231"
---
# <a name="cmdlet-overview"></a><span data-ttu-id="bed3a-103">Общие сведения о командлетах</span><span class="sxs-lookup"><span data-stu-id="bed3a-103">Cmdlet Overview</span></span>

<span data-ttu-id="bed3a-104">Командлет — это упрощенная команда, используемая в среде PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bed3a-104">A cmdlet is a lightweight command that is used in the PowerShell environment.</span></span> <span data-ttu-id="bed3a-105">Среда выполнения PowerShell вызывает эти командлеты в контексте скриптов автоматизации, предоставленных в командной строке.</span><span class="sxs-lookup"><span data-stu-id="bed3a-105">The PowerShell runtime invokes these cmdlets within the context of automation scripts that are provided at the command line.</span></span> <span data-ttu-id="bed3a-106">Среда выполнения PowerShell также вызывает их программно с помощью API-интерфейсов PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bed3a-106">The PowerShell runtime also invokes them programmatically through PowerShell APIs.</span></span>

## <a name="cmdlets"></a><span data-ttu-id="bed3a-107">Командлеты</span><span class="sxs-lookup"><span data-stu-id="bed3a-107">Cmdlets</span></span>

<span data-ttu-id="bed3a-108">Командлеты выполняют действие и обычно возвращают объект Microsoft .NET в следующую команду в конвейере.</span><span class="sxs-lookup"><span data-stu-id="bed3a-108">Cmdlets perform an action and typically return a Microsoft .NET object to the next command in the pipeline.</span></span> <span data-ttu-id="bed3a-109">Командлет — это одна команда, которая участвует в семантике конвейера PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bed3a-109">A cmdlet is a single command that participates in the pipeline semantics of PowerShell.</span></span>
<span data-ttu-id="bed3a-110">Сюда входят двоичные командлеты (C#), расширенные функции скриптов, CDXML и рабочие процессы.</span><span class="sxs-lookup"><span data-stu-id="bed3a-110">This includes binary (C#) cmdlets, advanced script functions, CDXML, and Workflows.</span></span>

<span data-ttu-id="bed3a-111">В этой документации по пакету SDK описывается создание двоичных командлетов, написанных на языке C#.</span><span class="sxs-lookup"><span data-stu-id="bed3a-111">This SDK documentation describes how to create binary cmdlets written in C#.</span></span> <span data-ttu-id="bed3a-112">Дополнительные сведения о командлетах на основе сценариев см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="bed3a-112">For information about script-based cmdlets, see:</span></span>

- [<span data-ttu-id="bed3a-113">about_Functions_Advanced</span><span class="sxs-lookup"><span data-stu-id="bed3a-113">about_Functions_Advanced</span></span>](/powershell/module/microsoft.powershell.core/about/about_functions_advanced)
- [<span data-ttu-id="bed3a-114">about_Functions_CmdletBindingAttribute</span><span class="sxs-lookup"><span data-stu-id="bed3a-114">about_Functions_CmdletBindingAttribute</span></span>](/powershell/module/microsoft.powershell.core/about/about_functions_cmdletbindingattribute)
- [<span data-ttu-id="bed3a-115">about_Functions_Advanced_Methods</span><span class="sxs-lookup"><span data-stu-id="bed3a-115">about_Functions_Advanced_Methods</span></span>](/powershell/module/microsoft.powershell.core/about/about_functions_advanced_methods)

<span data-ttu-id="bed3a-116">Чтобы создать двоичный командлет, необходимо реализовать класс командлета, производный от одного из двух специализированных базовых классов командлетов.</span><span class="sxs-lookup"><span data-stu-id="bed3a-116">To create a binary cmdlet, you must implement a cmdlet class that derives from one of two specialized cmdlet base classes.</span></span> <span data-ttu-id="bed3a-117">Производный класс должен:</span><span class="sxs-lookup"><span data-stu-id="bed3a-117">The derived class must:</span></span>

- <span data-ttu-id="bed3a-118">Объявите атрибут, который идентифицирует производный класс в качестве командлета.</span><span class="sxs-lookup"><span data-stu-id="bed3a-118">Declare an attribute that identifies the derived class as a cmdlet.</span></span>
- <span data-ttu-id="bed3a-119">Определите открытые свойства, снабженные атрибутами, которые определяют открытые свойства в качестве параметров командлета.</span><span class="sxs-lookup"><span data-stu-id="bed3a-119">Define public properties that are decorated with attributes that identify the public properties as cmdlet parameters.</span></span>
- <span data-ttu-id="bed3a-120">Переопределите один или несколько методов обработки ввода для обработки записей.</span><span class="sxs-lookup"><span data-stu-id="bed3a-120">Override one or more of the input processing methods to process records.</span></span>

<span data-ttu-id="bed3a-121">Сборку, содержащую класс, можно загрузить напрямую с помощью командлета [Import-Module](/powershell/module/microsoft.powershell.core/import-module) . также можно создать ведущее приложение, которое загружает сборку с помощью [System.Management.Automation.Runspaces.IniAPI тиалсессионстате](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) .</span><span class="sxs-lookup"><span data-stu-id="bed3a-121">You can load the assembly that contains the class directly by using the [Import-Module](/powershell/module/microsoft.powershell.core/import-module) cmdlet, or you can create a host application that loads the assembly by using the [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API.</span></span> <span data-ttu-id="bed3a-122">Оба метода предоставляют программный и доступ командной строки к функциональности командлета.</span><span class="sxs-lookup"><span data-stu-id="bed3a-122">Both methods provide programmatic and command-line access to the functionality of the cmdlet.</span></span>

## <a name="cmdlet-terms"></a><span data-ttu-id="bed3a-123">Условия для командлетов</span><span class="sxs-lookup"><span data-stu-id="bed3a-123">Cmdlet Terms</span></span>

<span data-ttu-id="bed3a-124">В документации по командлету PowerShell часто используются следующие термины:</span><span class="sxs-lookup"><span data-stu-id="bed3a-124">The following terms are used frequently in the PowerShell cmdlet documentation:</span></span>

### <a name="cmdlet-attribute"></a><span data-ttu-id="bed3a-125">Атрибут командлета</span><span class="sxs-lookup"><span data-stu-id="bed3a-125">Cmdlet attribute</span></span>

<span data-ttu-id="bed3a-126">Атрибут .NET, используемый для объявления класса командлета в качестве командлета.</span><span class="sxs-lookup"><span data-stu-id="bed3a-126">A .NET attribute that is used to declare a cmdlet class as a cmdlet.</span></span> <span data-ttu-id="bed3a-127">Хотя PowerShell использует несколько других атрибутов, которые являются необязательными, атрибут командлета является обязательным.</span><span class="sxs-lookup"><span data-stu-id="bed3a-127">Although PowerShell uses several other attributes that are optional, the Cmdlet attribute is required.</span></span> <span data-ttu-id="bed3a-128">Дополнительные сведения об этом атрибуте см. в разделе [объявление атрибута командлета](cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="bed3a-128">For more information about this attribute, see [Cmdlet Attribute Declaration](cmdlet-attribute-declaration.md).</span></span>

### <a name="cmdlet-parameter"></a><span data-ttu-id="bed3a-129">Параметр командлета</span><span class="sxs-lookup"><span data-stu-id="bed3a-129">Cmdlet parameter</span></span>

<span data-ttu-id="bed3a-130">Открытые свойства, определяющие параметры, доступные пользователю или приложению, запускающему командлет.</span><span class="sxs-lookup"><span data-stu-id="bed3a-130">The public properties that define the parameters that are available to the user or to the application that is running the cmdlet.</span></span> <span data-ttu-id="bed3a-131">Командлеты могут иметь обязательные параметры, именованные, позиционированные и *переключатели* .</span><span class="sxs-lookup"><span data-stu-id="bed3a-131">Cmdlets can have required, named, positional, and *switch* parameters.</span></span> <span data-ttu-id="bed3a-132">Параметры переключателя позволяют определить параметры, которые оцениваются, только если в вызове указаны параметры.</span><span class="sxs-lookup"><span data-stu-id="bed3a-132">Switch parameters allow you to define parameters that are evaluated only if the parameters are specified in the call.</span></span> <span data-ttu-id="bed3a-133">Дополнительные сведения о различных типах параметров см. в разделе [параметры командлета](cmdlet-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="bed3a-133">For more information about the different types of parameters, see [Cmdlet Parameters](cmdlet-parameters.md).</span></span>

### <a name="parameter-set"></a><span data-ttu-id="bed3a-134">Набор параметров</span><span class="sxs-lookup"><span data-stu-id="bed3a-134">Parameter set</span></span>

<span data-ttu-id="bed3a-135">Группа параметров, которые можно использовать в одной команде для выполнения определенного действия.</span><span class="sxs-lookup"><span data-stu-id="bed3a-135">A group of parameters that can be used in the same command to perform a specific action.</span></span> <span data-ttu-id="bed3a-136">Командлет может иметь несколько наборов параметров, но каждый набор параметров должен иметь по крайней мере один уникальный параметр.</span><span class="sxs-lookup"><span data-stu-id="bed3a-136">A cmdlet can have multiple parameter sets, but each parameter set must have at least one parameter that is unique.</span></span> <span data-ttu-id="bed3a-137">Хорошая разработка командлетов настоятельно предполагает, что уникальный параметр также является обязательным параметром.</span><span class="sxs-lookup"><span data-stu-id="bed3a-137">Good cmdlet design strongly suggests that the unique parameter also be a required parameter.</span></span>
<span data-ttu-id="bed3a-138">Дополнительные сведения о наборах параметров см. в разделе [наборы параметров командлета](cmdlet-parameter-sets.md).</span><span class="sxs-lookup"><span data-stu-id="bed3a-138">For more information about parameter sets, see [Cmdlet Parameter Sets](cmdlet-parameter-sets.md).</span></span>

### <a name="dynamic-parameter"></a><span data-ttu-id="bed3a-139">Динамический параметр</span><span class="sxs-lookup"><span data-stu-id="bed3a-139">Dynamic parameter</span></span>

<span data-ttu-id="bed3a-140">Параметр, добавляемый в командлет во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="bed3a-140">A parameter that is added to the cmdlet at runtime.</span></span> <span data-ttu-id="bed3a-141">Как правило, динамические параметры добавляются в командлет, если для другого параметра задано конкретное значение.</span><span class="sxs-lookup"><span data-stu-id="bed3a-141">Typically, the dynamic parameters are added to the cmdlet when another parameter is set to a specific value.</span></span> <span data-ttu-id="bed3a-142">Дополнительные сведения о динамических параметрах см. в разделе [динамические параметры командлета](cmdlet-dynamic-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="bed3a-142">For more information about dynamic parameters, see [Cmdlet Dynamic Parameters](cmdlet-dynamic-parameters.md).</span></span>

### <a name="input-processing-methods"></a><span data-ttu-id="bed3a-143">Методы обработки входных данных</span><span class="sxs-lookup"><span data-stu-id="bed3a-143">Input processing methods</span></span>

<span data-ttu-id="bed3a-144">Класс [System. Management. Automation. командлет](/dotnet/api/System.Management.Automation.Cmdlet) предоставляет следующие виртуальные методы, используемые для обработки записей.</span><span class="sxs-lookup"><span data-stu-id="bed3a-144">The [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class provides the following virtual methods that are used to process records.</span></span> <span data-ttu-id="bed3a-145">Все производные классы командлетов должны переопределять один или несколько первых трех методов:</span><span class="sxs-lookup"><span data-stu-id="bed3a-145">All the derived cmdlet classes must override one or more of the first three methods:</span></span>

- <span data-ttu-id="bed3a-146">[System. Management. Automation. командлет. BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing): используется для предоставления необязательных одноразовых функций предварительной обработки для командлета.</span><span class="sxs-lookup"><span data-stu-id="bed3a-146">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing): Used to provide optional one-time, pre-processing functionality for the cmdlet.</span></span>
- <span data-ttu-id="bed3a-147">[System. Management. Automation. командлет. ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord): используется для предоставления функций обработки записей по записям для командлета.</span><span class="sxs-lookup"><span data-stu-id="bed3a-147">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord): Used to provide record-by-record processing functionality for the cmdlet.</span></span> <span data-ttu-id="bed3a-148">Метод [System. Management. Automation. командлет. ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) может вызываться любое количество раз, в зависимости от входных данных командлета.</span><span class="sxs-lookup"><span data-stu-id="bed3a-148">The [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method might be called any number of times, or not at all, depending on the input of the cmdlet.</span></span>
- <span data-ttu-id="bed3a-149">[System. Management. Automation. командлет. EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing): используется для предоставления необязательных одноразовых функций последующей обработки для командлета.</span><span class="sxs-lookup"><span data-stu-id="bed3a-149">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing): Used to provide optional one-time, post-processing functionality for the cmdlet.</span></span>
- <span data-ttu-id="bed3a-150">[System. Management. Automation. командлет. StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing): используется для остановки обработки при асинхронной остановке командлета пользователем (например, при нажатии клавиши <kbd>CTRL</kbd> + <kbd>C</kbd>).</span><span class="sxs-lookup"><span data-stu-id="bed3a-150">[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing): Used to stop processing when the user stops the cmdlet asynchronously (for example, by pressing <kbd>CTRL</kbd>+<kbd>C</kbd>).</span></span>

<span data-ttu-id="bed3a-151">Дополнительные сведения об этих методах см. в разделе [методы обработки входных данных командлета](./cmdlet-input-processing-methods.md).</span><span class="sxs-lookup"><span data-stu-id="bed3a-151">For more information about these methods, see [Cmdlet Input Processing Methods](./cmdlet-input-processing-methods.md).</span></span>

<span data-ttu-id="bed3a-152">При реализации командлета необходимо переопределить хотя бы один из этих методов обработки ввода.</span><span class="sxs-lookup"><span data-stu-id="bed3a-152">When you implement a cmdlet, you must override at least one of these input processing methods.</span></span>
<span data-ttu-id="bed3a-153">Как правило, метод **ProcessRecord ()** является переопределяемым методом, поскольку он вызывается для каждой записи, обрабатываемой командлетом.</span><span class="sxs-lookup"><span data-stu-id="bed3a-153">Typically, the **ProcessRecord()** is the method that you override because it is called for every record that the cmdlet processes.</span></span> <span data-ttu-id="bed3a-154">В отличие от этого, метод **BeginProcessing ()** и метод **EndProcessing ()** вызываются один раз для выполнения предварительной обработки или последующей обработки записей.</span><span class="sxs-lookup"><span data-stu-id="bed3a-154">In contrast, the **BeginProcessing()** method and the **EndProcessing()** method are called one time to perform pre-processing or post-processing of the records.</span></span> <span data-ttu-id="bed3a-155">Дополнительные сведения об этих методах см. в разделе [методы обработки входных данных](cmdlet-input-processing-methods.md).</span><span class="sxs-lookup"><span data-stu-id="bed3a-155">For more information about these methods, see [Input Processing Methods](cmdlet-input-processing-methods.md).</span></span>

### <a name="shouldprocess-feature"></a><span data-ttu-id="bed3a-156">Функция ShouldProcess</span><span class="sxs-lookup"><span data-stu-id="bed3a-156">ShouldProcess feature</span></span>

<span data-ttu-id="bed3a-157">PowerShell позволяет создавать командлеты, предлагающие пользователю отправить отзыв, прежде чем командлет вносит изменения в систему.</span><span class="sxs-lookup"><span data-stu-id="bed3a-157">PowerShell allows you to create cmdlets that prompt the user for feedback before the cmdlet makes a change to the system.</span></span> <span data-ttu-id="bed3a-158">Чтобы использовать эту функцию, командлет должен объявить, что он поддерживает эту `ShouldProcess` функцию при объявлении атрибута командлета, и командлет должен вызвать методы [System. Management. Automation. командлет. ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) и [System. Management. Automation. командлет. ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) из метода обработки ввода.</span><span class="sxs-lookup"><span data-stu-id="bed3a-158">To use this feature, the cmdlet must declare that it supports the `ShouldProcess` feature when you declare the Cmdlet attribute, and the cmdlet must call the [System.Management.Automation.Cmdlet.ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) and [System.Management.Automation.Cmdlet.ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) methods from within an input processing method.</span></span> <span data-ttu-id="bed3a-159">Дополнительные сведения о поддержке функций см. в `ShouldProcess` разделе [запрос подтверждения](requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="bed3a-159">For more information about how to support the `ShouldProcess` functionality, see [Requesting Confirmation](requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="transaction"></a><span data-ttu-id="bed3a-160">Транзакция</span><span class="sxs-lookup"><span data-stu-id="bed3a-160">Transaction</span></span>

<span data-ttu-id="bed3a-161">Логическая группа команд, обрабатываемых как одна задача.</span><span class="sxs-lookup"><span data-stu-id="bed3a-161">A logical group of commands that are treated as a single task.</span></span> <span data-ttu-id="bed3a-162">Задача автоматически завершается ошибкой, если любая команда в группе завершается ошибкой, и пользователь может принять или отклонить действия, выполненные внутри транзакции.</span><span class="sxs-lookup"><span data-stu-id="bed3a-162">The task automatically fails if any command in the group fails, and the user has the choice to accept or reject the actions performed within the transaction.</span></span> <span data-ttu-id="bed3a-163">Чтобы принять участие в транзакции, командлет должен объявить, что он поддерживает транзакции при объявлении атрибута командлета.</span><span class="sxs-lookup"><span data-stu-id="bed3a-163">To participate in a transaction, the cmdlet must declare that it supports transactions when the Cmdlet attribute is declared.</span></span> <span data-ttu-id="bed3a-164">Поддержка транзакций появилась в Windows PowerShell 2,0.</span><span class="sxs-lookup"><span data-stu-id="bed3a-164">Support for transactions was introduced in Windows PowerShell 2.0.</span></span> <span data-ttu-id="bed3a-165">Дополнительные сведения о транзакциях см. [в разделе Поддержка транзакций](how-to-support-transactions.md).</span><span class="sxs-lookup"><span data-stu-id="bed3a-165">For more information about transactions, see [How to Support Transactions](how-to-support-transactions.md).</span></span>

## <a name="how-cmdlets-differ-from-commands"></a><span data-ttu-id="bed3a-166">Отличия командлетов от команд</span><span class="sxs-lookup"><span data-stu-id="bed3a-166">How Cmdlets Differ from Commands</span></span>

<span data-ttu-id="bed3a-167">Командлеты отличаются от команд в других средах командной оболочки следующими способами.</span><span class="sxs-lookup"><span data-stu-id="bed3a-167">Cmdlets differ from commands in other command-shell environments in the following ways:</span></span>

- <span data-ttu-id="bed3a-168">Командлеты являются экземплярами классов .NET; они не являются изолированными исполняемыми файлами.</span><span class="sxs-lookup"><span data-stu-id="bed3a-168">Cmdlets are instances of .NET classes; they are not stand-alone executables.</span></span>
- <span data-ttu-id="bed3a-169">Командлеты можно создавать с помощью нескольких десятков строк кода.</span><span class="sxs-lookup"><span data-stu-id="bed3a-169">Cmdlets can be created from as few as a dozen lines of code.</span></span>
- <span data-ttu-id="bed3a-170">Командлеты обычно не выполняют собственный синтаксический анализ, представление ошибок или форматирование выходных данных.</span><span class="sxs-lookup"><span data-stu-id="bed3a-170">Cmdlets do not generally do their own parsing, error presentation, or output formatting.</span></span> <span data-ttu-id="bed3a-171">Синтаксический анализ, представление ошибок и форматирование вывода обрабатываются средой выполнения PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bed3a-171">Parsing, error presentation, and output formatting are handled by the PowerShell runtime.</span></span>
- <span data-ttu-id="bed3a-172">Командлеты обрабатывают входные объекты из конвейера, а не из потоков текста, а командлеты обычно доставляют объекты в конвейер в качестве выходных данных.</span><span class="sxs-lookup"><span data-stu-id="bed3a-172">Cmdlets process input objects from the pipeline rather than from streams of text, and cmdlets typically deliver objects as output to the pipeline.</span></span>
- <span data-ttu-id="bed3a-173">Командлеты ориентированы на записи, так как они обрабатывают один объект за раз.</span><span class="sxs-lookup"><span data-stu-id="bed3a-173">Cmdlets are record-oriented because they process a single object at a time.</span></span>

## <a name="cmdlet-base-classes"></a><span data-ttu-id="bed3a-174">Базовые классы командлетов</span><span class="sxs-lookup"><span data-stu-id="bed3a-174">Cmdlet Base Classes</span></span>

<span data-ttu-id="bed3a-175">Windows PowerShell поддерживает командлеты, которые являются производными от следующих двух базовых классов.</span><span class="sxs-lookup"><span data-stu-id="bed3a-175">Windows PowerShell supports cmdlets that are derived from the following two base classes.</span></span>

- <span data-ttu-id="bed3a-176">Большинство командлетов основаны на классах .NET, производных от базового класса [System. Management. Automation. командлет](/dotnet/api/System.Management.Automation.Cmdlet) .</span><span class="sxs-lookup"><span data-stu-id="bed3a-176">Most cmdlets are based on .NET classes that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) base class.</span></span>
  <span data-ttu-id="bed3a-177">Наследование от этого класса позволяет командлету использовать минимальный набор зависимостей в среде выполнения Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bed3a-177">Deriving from this class allows a cmdlet to use the minimum set of dependencies on the Windows PowerShell runtime.</span></span> <span data-ttu-id="bed3a-178">Это имеет два преимущества.</span><span class="sxs-lookup"><span data-stu-id="bed3a-178">This has two benefits.</span></span> <span data-ttu-id="bed3a-179">Первое преимущество заключается в том, что объекты командлетов меньше, и, скорее всего, изменения в среде выполнения PowerShell подвергаются меньшему.</span><span class="sxs-lookup"><span data-stu-id="bed3a-179">The first benefit is that the cmdlet objects are smaller, and you are less likely to be affected by changes to the PowerShell runtime.</span></span> <span data-ttu-id="bed3a-180">Второе преимущество заключается в том, что при необходимости можно напрямую создать экземпляр объекта командлета, а затем вызвать его напрямую, а не вызывать его через среду выполнения PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bed3a-180">The second benefit is that, if you have to, you can directly create an instance of the cmdlet object and then invoke it directly instead of invoking it through the PowerShell runtime.</span></span>

- <span data-ttu-id="bed3a-181">Более сложные командлеты основаны на классах .NET, производных от базового класса [System. Management. Automation. PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) .</span><span class="sxs-lookup"><span data-stu-id="bed3a-181">The more-complex cmdlets are based on .NET classes that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="bed3a-182">Наследование от этого класса обеспечивает гораздо больший доступ к среде выполнения PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bed3a-182">Deriving from this class gives you much more access to the PowerShell runtime.</span></span> <span data-ttu-id="bed3a-183">Этот доступ позволяет командлету вызывать скрипты, получать доступ к поставщикам и получать доступ к текущему состоянию сеанса.</span><span class="sxs-lookup"><span data-stu-id="bed3a-183">This access allows your cmdlet to call scripts, to access providers, and to access the current session state.</span></span>
  <span data-ttu-id="bed3a-184">(Для доступа к текущему состоянию сеанса вы получаете и устанавливаете переменные сеанса и настройки.) Однако наследование от этого класса увеличивает размер объекта командлета, и это означает, что командлет более тесно связан с текущей версией среды выполнения PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bed3a-184">(To access the current session state, you get and set session variables and preferences.) However, deriving from this class increases the size of the cmdlet object, and it means that your cmdlet is more tightly coupled to the current version of the PowerShell runtime.</span></span>

<span data-ttu-id="bed3a-185">Как правило, если вам не нужен расширенный доступ к среде выполнения PowerShell, необходимо создать производный от класса [System. Management. Automation. командлет](/dotnet/api/System.Management.Automation.Cmdlet) .</span><span class="sxs-lookup"><span data-stu-id="bed3a-185">In general, unless you need the extended access to the PowerShell runtime, you should derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class.</span></span>
<span data-ttu-id="bed3a-186">Однако среда выполнения PowerShell имеет широкие возможности ведения журнала для выполнения командлетов.</span><span class="sxs-lookup"><span data-stu-id="bed3a-186">However, the PowerShell runtime has extensive logging capabilities for the execution of cmdlets.</span></span> <span data-ttu-id="bed3a-187">Если модель аудита зависит от этого журнала, можно предотвратить выполнение командлета из другого командлета, производя от класса [System. Management. Automation. PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) .</span><span class="sxs-lookup"><span data-stu-id="bed3a-187">If your auditing model depends on this logging, you can prevent the execution of your cmdlet from within another cmdlet by deriving from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class.</span></span>

## <a name="cmdlet-attributes"></a><span data-ttu-id="bed3a-188">Атрибуты командлета</span><span class="sxs-lookup"><span data-stu-id="bed3a-188">Cmdlet Attributes</span></span>

<span data-ttu-id="bed3a-189">PowerShell определяет несколько атрибутов .NET, которые используются для управления командлетами и для указания общих функциональных возможностей, предоставляемых PowerShell, которые могут потребоваться для командлета.</span><span class="sxs-lookup"><span data-stu-id="bed3a-189">PowerShell defines several .NET attributes that are used to manage cmdlets and to specify common functionality that is provided by PowerShell and that might be required by the cmdlet.</span></span> <span data-ttu-id="bed3a-190">Например, атрибуты используются для обозначения класса в качестве командлета, для указания параметров командлета и для запроса проверки входных данных, чтобы разработчикам командлета не применяли эту функциональность в своем коде командлета.</span><span class="sxs-lookup"><span data-stu-id="bed3a-190">For example, attributes are used to designate a class as a cmdlet, to specify the parameters of the cmdlet, and to request the validation of input so that cmdlet developers do not have to implement that functionality in their cmdlet code.</span></span> <span data-ttu-id="bed3a-191">Дополнительные сведения об атрибутах см. в разделе [атрибуты PowerShell](./cmdlet-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="bed3a-191">For more information about attributes, see [PowerShell Attributes](./cmdlet-attributes.md).</span></span>

## <a name="cmdlet-names"></a><span data-ttu-id="bed3a-192">Имена командлетов</span><span class="sxs-lookup"><span data-stu-id="bed3a-192">Cmdlet Names</span></span>

<span data-ttu-id="bed3a-193">PowerShell использует пару имен глагол-и-существительное для командлетов Name.</span><span class="sxs-lookup"><span data-stu-id="bed3a-193">PowerShell uses a verb-and-noun name pair to name cmdlets.</span></span> <span data-ttu-id="bed3a-194">Например, командлет, `Get-Command` включенный в PowerShell, используется для получения всех командлетов, зарегистрированных в командной оболочке.</span><span class="sxs-lookup"><span data-stu-id="bed3a-194">For example, the `Get-Command` cmdlet included in PowerShell is used to get all the cmdlets that are registered in the command shell.</span></span> <span data-ttu-id="bed3a-195">Команда определяет действие, выполняемое командлетом, а существительное определяет ресурс, в котором командлет выполняет свое действие.</span><span class="sxs-lookup"><span data-stu-id="bed3a-195">The verb identifies the action that the cmdlet performs, and the noun identifies the resource on which the cmdlet performs its action.</span></span>

<span data-ttu-id="bed3a-196">Эти имена указываются при объявлении класса .NET в качестве командлета.</span><span class="sxs-lookup"><span data-stu-id="bed3a-196">These names are specified when the .NET class is declared as a cmdlet.</span></span> <span data-ttu-id="bed3a-197">Дополнительные сведения об объявлении класса .NET в качестве командлета см. в разделе [объявление атрибута командлета](./cmdlet-class-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="bed3a-197">For more information about how to declare a .NET class as a cmdlet, see [Cmdlet Attribute Declaration](./cmdlet-class-declaration.md).</span></span>

## <a name="writing-cmdlet-code"></a><span data-ttu-id="bed3a-198">Написание кода командлета</span><span class="sxs-lookup"><span data-stu-id="bed3a-198">Writing Cmdlet Code</span></span>

<span data-ttu-id="bed3a-199">В этом документе представлены два способа определения способа написания кода командлета.</span><span class="sxs-lookup"><span data-stu-id="bed3a-199">This document provides two ways to discover how cmdlet code is written.</span></span> <span data-ttu-id="bed3a-200">Если вы предпочитаете Просмотреть код без подробного объяснения, см. [примеры кода командлета](./examples-of-cmdlet-code.md).</span><span class="sxs-lookup"><span data-stu-id="bed3a-200">If you prefer to see the code without much explanation, see [Examples of Cmdlet Code](./examples-of-cmdlet-code.md).</span></span> <span data-ttu-id="bed3a-201">Если вы предпочитаете более подробное описание кода, см. статью учебник по [процедурам](./getproc-tutorial.md) [Стоппрок](./stopproc-tutorial.md)или руководства [селектстр](./selectstr-tutorial.md) .</span><span class="sxs-lookup"><span data-stu-id="bed3a-201">If you prefer more explanation about the code, see the [GetProc Tutorial](./getproc-tutorial.md), [StopProc Tutorial](./stopproc-tutorial.md), or [SelectStr Tutorial](./selectstr-tutorial.md) topics.</span></span>

<span data-ttu-id="bed3a-202">Дополнительные сведения о рекомендациях по написанию командлетов см. в разделе [рекомендации по разработке командлетов](./cmdlet-development-guidelines.md).</span><span class="sxs-lookup"><span data-stu-id="bed3a-202">For more information about the guidelines for writing cmdlets, see [Cmdlet Development Guidelines](./cmdlet-development-guidelines.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="bed3a-203">См. также:</span><span class="sxs-lookup"><span data-stu-id="bed3a-203">See Also</span></span>

[<span data-ttu-id="bed3a-204">Основные понятия командлетов PowerShell</span><span class="sxs-lookup"><span data-stu-id="bed3a-204">PowerShell Cmdlet Concepts</span></span>](./windows-powershell-cmdlet-concepts.md)

[<span data-ttu-id="bed3a-205">Написание командлета PowerShell</span><span class="sxs-lookup"><span data-stu-id="bed3a-205">Writing a PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)

[<span data-ttu-id="bed3a-206">Пакет SDK для PowerShell</span><span class="sxs-lookup"><span data-stu-id="bed3a-206">PowerShell SDK</span></span>](../windows-powershell-reference.md)
