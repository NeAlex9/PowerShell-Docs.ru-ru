---
ms.date: 09/13/2016
ms.topic: reference
title: Отчеты об ошибках командлета
description: Отчеты об ошибках командлета
ms.openlocfilehash: f06cf98183d56249080623895bd1f5a3e070cefd
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "92653414"
---
# <a name="cmdlet-error-reporting"></a><span data-ttu-id="96ef2-103">Отчеты об ошибках командлетов</span><span class="sxs-lookup"><span data-stu-id="96ef2-103">Cmdlet error reporting</span></span>

<span data-ttu-id="96ef2-104">Командлеты должны сообщать об ошибках по-разному в зависимости от того, завершаются ли ошибки ошибками или неустранимыми ошибками.</span><span class="sxs-lookup"><span data-stu-id="96ef2-104">Cmdlets should report errors differently depending on whether the errors are terminating errors or nonterminating errors.</span></span> <span data-ttu-id="96ef2-105">Завершающие ошибки — это ошибки, вызывающие немедленное завершение конвейера, или ошибки, возникающие, если нет причин продолжать обработку.</span><span class="sxs-lookup"><span data-stu-id="96ef2-105">Terminating errors are errors that cause the pipeline to be terminated immediately, or errors that occur when there's no reason to continue processing.</span></span> <span data-ttu-id="96ef2-106">Неустранимые ошибки — это ошибки, сообщающие о текущем состоянии ошибки, но командлет может продолжать обрабатывать входные объекты.</span><span class="sxs-lookup"><span data-stu-id="96ef2-106">Nonterminating errors are those errors that report a current error condition, but the cmdlet can continue to process input objects.</span></span> <span data-ttu-id="96ef2-107">В случае неустранимых ошибок пользователь обычно получает извещение о проблеме, но командлет продолжит обрабатывать следующий входной объект.</span><span class="sxs-lookup"><span data-stu-id="96ef2-107">With nonterminating errors, the user is typically notified of the problem, but the cmdlet continues to process the next input object.</span></span>

## <a name="terminating-and-nonterminating-errors"></a><span data-ttu-id="96ef2-108">Завершение и неустранимые ошибки</span><span class="sxs-lookup"><span data-stu-id="96ef2-108">Terminating and nonterminating errors</span></span>

<span data-ttu-id="96ef2-109">Чтобы определить, является ли условие ошибки завершающим ошибкой или неустранимой ошибкой, можно использовать следующие рекомендации.</span><span class="sxs-lookup"><span data-stu-id="96ef2-109">The following guidelines can be used to determine if an error condition is a terminating error or a nonterminating error.</span></span>

- <span data-ttu-id="96ef2-110">Не мешает ли командлету успешно обрабатывать любые дальнейшие входные объекты?</span><span class="sxs-lookup"><span data-stu-id="96ef2-110">Does the error condition prevent your cmdlet from successfully processing any further input objects?</span></span> <span data-ttu-id="96ef2-111">Если это так, это Неустранимая ошибка.</span><span class="sxs-lookup"><span data-stu-id="96ef2-111">If so, this is a terminating error.</span></span>

- <span data-ttu-id="96ef2-112">Условие ошибки, связанное с определенным входным объектом или подмножеством входных объектов?</span><span class="sxs-lookup"><span data-stu-id="96ef2-112">Is the error condition related to a specific input object or a subset of input objects?</span></span> <span data-ttu-id="96ef2-113">Если да, это Неустранимая ошибка.</span><span class="sxs-lookup"><span data-stu-id="96ef2-113">If so, this is a nonterminating error.</span></span>

- <span data-ttu-id="96ef2-114">Принимает ли командлет несколько входных объектов, что может привести к успешности обработки другого входного объекта?</span><span class="sxs-lookup"><span data-stu-id="96ef2-114">Does the cmdlet accept multiple input objects, such that processing may succeed on another input object?</span></span> <span data-ttu-id="96ef2-115">Если да, это Неустранимая ошибка.</span><span class="sxs-lookup"><span data-stu-id="96ef2-115">If so, this is a nonterminating error.</span></span>

- <span data-ttu-id="96ef2-116">Командлеты, которые могут принимать несколько входных объектов, должны определить, какие из них завершаются, а какие — нет, даже если конкретная ситуация относится только к одному входному объекту.</span><span class="sxs-lookup"><span data-stu-id="96ef2-116">Cmdlets that can accept multiple input objects should decide between what are terminating and nonterminating errors, even when a particular situation applies to only a single input object.</span></span>

- <span data-ttu-id="96ef2-117">Командлеты могут получать любое количество входных объектов и отправлять любое количество объектов Success или Error перед вызовом завершающего исключения.</span><span class="sxs-lookup"><span data-stu-id="96ef2-117">Cmdlets can receive any number of input objects and send any number of success or error objects before throwing a terminating exception.</span></span> <span data-ttu-id="96ef2-118">Между числом полученных входных объектов и количеством отправленных объектов Success и Error не связано никаких отношений.</span><span class="sxs-lookup"><span data-stu-id="96ef2-118">There's no relationship between the number of input objects received and the number of success and error objects sent.</span></span>

- <span data-ttu-id="96ef2-119">Командлеты, которые могут принимать только 0-1 входных объектов и создавать только объекты вывода 0-1, должны обрабатывать ошибки как прерывающие работу и создавать завершающие исключения.</span><span class="sxs-lookup"><span data-stu-id="96ef2-119">Cmdlets that can accept only 0-1 input objects and generate only 0-1 output objects should treat errors as terminating errors and generate terminating exceptions.</span></span>

## <a name="reporting-nonterminating-errors"></a><span data-ttu-id="96ef2-120">Сообщает о неустранимых ошибках</span><span class="sxs-lookup"><span data-stu-id="96ef2-120">Reporting nonterminating errors</span></span>

<span data-ttu-id="96ef2-121">Отчеты о незавершающей ошибке всегда должны быть выполнены в реализации командлета метода [System. Management. Automation. командлет. BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) , метода [System. Management. Automation. командлет. ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) или метода [System. Management. Automation. командлет. EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) .</span><span class="sxs-lookup"><span data-stu-id="96ef2-121">The reporting of a nonterminating error should always be done within the cmdlet's implementation of the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) method, the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method, or the [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) method.</span></span> <span data-ttu-id="96ef2-122">Эти типы ошибок выводятся путем вызова метода [System. Management. Automation. командлета. WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) , который, в свою очередь, отправляет запись об ошибке в поток ошибок.</span><span class="sxs-lookup"><span data-stu-id="96ef2-122">These types of errors are reported by calling the [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method that in turn sends an error record to the error stream.</span></span>

## <a name="reporting-terminating-errors"></a><span data-ttu-id="96ef2-123">Создание отчетов о прекращении ошибок</span><span class="sxs-lookup"><span data-stu-id="96ef2-123">Reporting terminating errors</span></span>

<span data-ttu-id="96ef2-124">Для завершения ошибок выдаются исключения или вызывается метод [System. Management. Automation. командлет. ThrowTerminatingError](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) .</span><span class="sxs-lookup"><span data-stu-id="96ef2-124">Terminating errors are reported by throwing exceptions or by calling the [System.Management.Automation.Cmdlet.ThrowTerminatingError](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) method.</span></span> <span data-ttu-id="96ef2-125">Имейте в виду, что командлеты также могут перехватывать и воссоздавать исключения, такие как **OutOfMemory**, однако они не требуют повторных порождения исключений, так как среда выполнения PowerShell также будет перехватывать их.</span><span class="sxs-lookup"><span data-stu-id="96ef2-125">Be aware that cmdlets can also catch and rethrow exceptions such as **OutOfMemory**, however, they aren't required to rethrow exceptions as the PowerShell runtime will catch them as well.</span></span>

<span data-ttu-id="96ef2-126">Можно также определить собственные исключения для проблем, характерных для конкретной ситуации, или добавить дополнительные сведения к существующему исключению с помощью записи об ошибке.</span><span class="sxs-lookup"><span data-stu-id="96ef2-126">You can also define your own exceptions for issues specific to your situation, or add additional information to an existing exception using its error record.</span></span>

## <a name="error-records"></a><span data-ttu-id="96ef2-127">Записи об ошибках</span><span class="sxs-lookup"><span data-stu-id="96ef2-127">Error records</span></span>

<span data-ttu-id="96ef2-128">PowerShell описывает неустранимую ошибку в объектах [System. Management. Automation. ерроррекорд](/dotnet/api/System.Management.Automation.ErrorRecord) .</span><span class="sxs-lookup"><span data-stu-id="96ef2-128">PowerShell describes a nonterminating error condition with [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) objects.</span></span> <span data-ttu-id="96ef2-129">Каждый объект предоставляет сведения о категории ошибок, дополнительный целевой объект и сведения о состоянии ошибки.</span><span class="sxs-lookup"><span data-stu-id="96ef2-129">Each object provides error category information, an optional target object, and details about the error condition.</span></span>

### <a name="error-identifiers"></a><span data-ttu-id="96ef2-130">Идентификаторы ошибок</span><span class="sxs-lookup"><span data-stu-id="96ef2-130">Error identifiers</span></span>

<span data-ttu-id="96ef2-131">Идентификатор ошибки представляет собой простую строку, определяющую условие ошибки в командлете.</span><span class="sxs-lookup"><span data-stu-id="96ef2-131">The error identifier is a simple string that identifies the error condition within the cmdlet.</span></span>
<span data-ttu-id="96ef2-132">PowerShell объединяет этот идентификатор с идентификатором командлета, чтобы создать полный идентификатор ошибки, который можно использовать позже при фильтрации потоков ошибок или ошибок ведения журнала, при ответе на определенные ошибки или с другими действиями, специфичными для пользователя.</span><span class="sxs-lookup"><span data-stu-id="96ef2-132">PowerShell combines this identifier with a cmdlet identifier to create a fully qualified error identifier that can be used later when filtering error streams or logging errors, when responding to specific errors, or with other user-specific activities.</span></span>

<span data-ttu-id="96ef2-133">При указании идентификаторов ошибок следует следовать приведенным ниже рекомендациям.</span><span class="sxs-lookup"><span data-stu-id="96ef2-133">The following guidelines should be followed when specifying error identifiers:</span></span>

- <span data-ttu-id="96ef2-134">Присвойте разные идентификаторы ошибок различным путям кода.</span><span class="sxs-lookup"><span data-stu-id="96ef2-134">Assign different, highly specific, error identifiers to different code paths.</span></span> <span data-ttu-id="96ef2-135">Каждый путь кода, вызывающий [System. Management. Automation. командлет. WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) или [System. Management. Automation. командлет. ThrowTerminatingError](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) , должен иметь собственный идентификатор ошибки.</span><span class="sxs-lookup"><span data-stu-id="96ef2-135">Each code path that calls [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.ThrowTerminatingError](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) should have its own error identifier.</span></span>

- <span data-ttu-id="96ef2-136">Идентификаторы ошибок должны быть уникальными для типов исключений среды CLR как для завершающих, так и для неустранимых ошибок.</span><span class="sxs-lookup"><span data-stu-id="96ef2-136">Error identifiers should be unique to Common Language Runtime (CLR) exception types for both terminating and nonterminating errors.</span></span>

- <span data-ttu-id="96ef2-137">Не меняйте семантику идентификатора ошибки между версиями командлета или поставщика PowerShell.</span><span class="sxs-lookup"><span data-stu-id="96ef2-137">Don't change the semantics of an error identifier between versions of your cmdlet or PowerShell provider.</span></span> <span data-ttu-id="96ef2-138">После установки семантики идентификатора ошибки она должна оставаться постоянной в течение жизненного цикла командлета.</span><span class="sxs-lookup"><span data-stu-id="96ef2-138">After the semantics of an error identifier is established, it should remain constant throughout the lifecycle of your cmdlet.</span></span>

- <span data-ttu-id="96ef2-139">Для завершения ошибок используйте уникальный идентификатор ошибки для конкретного типа исключения CLR.</span><span class="sxs-lookup"><span data-stu-id="96ef2-139">For terminating errors, use a unique error identifier for a particular CLR exception type.</span></span> <span data-ttu-id="96ef2-140">Если тип исключения изменяется, используйте новый идентификатор ошибки.</span><span class="sxs-lookup"><span data-stu-id="96ef2-140">If the exception type changes, use a new error identifier.</span></span>

- <span data-ttu-id="96ef2-141">Для неустранимых ошибок используйте конкретный идентификатор ошибки для конкретного входного объекта.</span><span class="sxs-lookup"><span data-stu-id="96ef2-141">For nonterminating errors, use a specific error identifier for a specific input object.</span></span>

- <span data-ttu-id="96ef2-142">Выберите текст для идентификатора, который кратко соответствует сообщению об ошибке.</span><span class="sxs-lookup"><span data-stu-id="96ef2-142">Choose text for the identifier that tersely corresponds to the error being reported.</span></span> <span data-ttu-id="96ef2-143">Не используйте пробелы или знаки препинания.</span><span class="sxs-lookup"><span data-stu-id="96ef2-143">Don't use white space or punctuation.</span></span>

- <span data-ttu-id="96ef2-144">Не создавайте идентификаторы ошибок, которые не воспроизводимы.</span><span class="sxs-lookup"><span data-stu-id="96ef2-144">Don't generate error identifiers that aren't reproducible.</span></span> <span data-ttu-id="96ef2-145">Например, не создавайте идентификаторы, включающие идентификатор процесса.</span><span class="sxs-lookup"><span data-stu-id="96ef2-145">For example, don't generate identifiers that include a process identifier.</span></span> <span data-ttu-id="96ef2-146">Идентификаторы ошибок полезны только в том случае, если они соответствуют идентификаторам, которые видят другие пользователи, испытывающие одну и ту же проблему.</span><span class="sxs-lookup"><span data-stu-id="96ef2-146">Error identifiers are useful only when they correspond to identifiers that are seen by other users who are experiencing the same problem.</span></span>

### <a name="error-categories"></a><span data-ttu-id="96ef2-147">Категории ошибок</span><span class="sxs-lookup"><span data-stu-id="96ef2-147">Error categories</span></span>

<span data-ttu-id="96ef2-148">Категории ошибок используются для группирования ошибок пользователя.</span><span class="sxs-lookup"><span data-stu-id="96ef2-148">Error categories are used to group errors for the user.</span></span> <span data-ttu-id="96ef2-149">PowerShell определяет эти категории и командлеты, и поставщики PowerShell должны выбирать между ними при создании записи об ошибке.</span><span class="sxs-lookup"><span data-stu-id="96ef2-149">PowerShell defines these categories and cmdlets and PowerShell providers must choose between them when generating the error record.</span></span>

<span data-ttu-id="96ef2-150">Описание доступных категорий ошибок см. в описании перечисления [System. Management. Automation. ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) .</span><span class="sxs-lookup"><span data-stu-id="96ef2-150">For a description of the error categories that are available, see the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeration.</span></span> <span data-ttu-id="96ef2-151">В общем случае следует избегать использования **ошибок**, **ундефинедеррор** и **Общая ошибка** везде, где это возможно.</span><span class="sxs-lookup"><span data-stu-id="96ef2-151">In general, you should avoid using **NoError**, **UndefinedError**, and **GenericError** whenever possible.</span></span>

<span data-ttu-id="96ef2-152">Пользователи могут просматривать ошибки на основе категории, если для них задано значение `$ErrorView` **категоривиев**.</span><span class="sxs-lookup"><span data-stu-id="96ef2-152">Users can view errors based on category when they set `$ErrorView` to **CategoryView**.</span></span>

## <a name="see-also"></a><span data-ttu-id="96ef2-153">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="96ef2-153">See also</span></span>

[<span data-ttu-id="96ef2-154">Общие сведения о командлетах</span><span class="sxs-lookup"><span data-stu-id="96ef2-154">Cmdlet Overview</span></span>](./cmdlet-overview.md)

[<span data-ttu-id="96ef2-155">Типы выходных данных командлета</span><span class="sxs-lookup"><span data-stu-id="96ef2-155">Types of Cmdlet Output</span></span>](./types-of-cmdlet-output.md)

[<span data-ttu-id="96ef2-156">Справочник по Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="96ef2-156">Windows PowerShell Reference</span></span>](../windows-powershell-reference.md)
