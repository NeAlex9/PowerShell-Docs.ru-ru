---
title: Написание справки по сценариям и функциям PowerShell | Документация Майкрософт
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 859a6e22-75b1-43d4-ba62-62c107803b37
caps.latest.revision: 7
ms.openlocfilehash: af989fb2eeba6b68f2e3e6506f3f60d5be6f7d8a
ms.sourcegitcommit: 52a67bcd9d7bf3e8600ea4302d1fa8970ff9c998
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/15/2019
ms.locfileid: "72367723"
---
# <a name="writing-help-for-powershell-scripts-and-functions"></a>Написание справки по сценариям и функциям PowerShell

Сценарии и функции PowerShell должны быть полностью документированы при совместном использовании с другими пользователями.
Командлет `Get-Help` отображает разделы справки по сценариям и функциям в том же формате, в котором отображается справка для командлетов, и все параметры `Get-Help` работают с разделами справки по сценариям и функциям.

Скрипты PowerShell могут включать раздел справки о скрипте и разделах справки по каждой из функций в сценарии.
Функции, которые совместно используются независимо от скриптов, могут включать собственные разделы справки.

В этом документе описывается формат и правильное размещение разделов справки, а также приводятся рекомендации по содержимому.

## <a name="types-of-script-and-function-help"></a>Типы сценариев и справки по функциям

### <a name="comment-based-help"></a>Справка на основе комментариев
Раздел справки, описывающий скрипт или функцию, можно реализовать в виде набора комментариев в скрипте или функции.
При написании справки на основе комментариев для сценария и функций в сценарии Обратите внимание на правила размещения справки на основе комментариев.
Размещение определяет, должен ли командлет `Get-Help` связывать раздел справки с скриптом или функцией.
Дополнительные сведения о создании разделов справки на основе комментариев см. в разделе [about_Comment_Based_Help](/powershell/module/microsoft.powershell.core/about/about_comment_based_help).

### <a name="xml-based-command-help"></a>Справка по командам на основе XML
Раздел справки, описывающий скрипт или функцию, можно реализовать в XML-файле, который использует схему справки по командам.
Чтобы связать скрипт или функцию с XML-файлом, используйте ключевое слово комментария `ExternalHelp`, за которым следует путь и имя XML-файла.

При наличии ключевого слова комментария `ExternalHelp` оно имеет приоритет над справкой на основе комментариев, даже если `Get-Help` не удается найти файл справки, соответствующий значению ключевого слова `ExternalHelp`.

### <a name="online-help"></a>Справка в Интернете
Вы можете опубликовать разделы справки в Интернете, а затем направить `Get-Help`, чтобы открыть разделы.
Дополнительные сведения о создании разделов справки на основе комментариев см. в разделе [поддержка справки в Интернете](../module/supporting-online-help.md).

Нет установленного метода для написания концептуальных разделов («About») для сценариев и функций.
Тем не менее вы можете публиковать разделы справки в Интернете, чтобы получить список разделов и их URL-адресов в разделе «связанные ссылки» в справке по командам.

## <a name="content-considerations-for-script-and-function-help"></a>Рекомендации по содержимому для справки по скриптам и функциям

- Если вы создаете краткий раздел справки, содержащий лишь несколько доступных разделов справки, обязательно включите в него четкие описания параметров сценария или функции. Также включите один или два примера команд в раздел "примеры", даже если вы решили опустить описания примеров.

- Во всех описаниях используйте команду в качестве скрипта или функции. Эти сведения помогают пользователю понять и управлять командой.

  Например, в следующем подробном описании указано, что команда New-Topic является сценарием. Это напоминает пользователям, что им нужно указать путь и полное имя при их запуске.

  > "Сценарий создания раздела создает пустую концептуальную тему для каждого имени раздела во входном файле..."

  В следующем подробном описании указано, что `Disable-PSRemoting` является функцией. Эта информация особенно полезна пользователям, когда сеанс включает несколько команд с одинаковым именем, некоторые из которых могут быть скрыты командой с более высоким приоритетом.

  > Функция `Disable-PSRemoting` отключает все конфигурации сеансов на локальном компьютере...

- В разделе справки по скрипту Объясните, как использовать скрипт в целом. Если вы также создаете разделы справки для функций в сценарии, запишите эти функции в разделе справки по скрипту и включите ссылки на разделы справки по функциям в разделе связанные ссылки раздела справки по скриптам. И наоборот, если функция является частью скрипта, объясните в справке по функциям роль, которую функция играет в скрипте и как ее можно использовать независимо. Затем перечислите разделы справки по сценариям в разделе "связанные ссылки" раздела справки по функциям.

- При написании примеров для раздела справки по сценарию не забудьте включить путь к файлу сценария в команде example. Это напоминает пользователям, что необходимо явно указать путь, даже если скрипт находится в текущем каталоге.

- В разделе справки по функциям Напомним пользователям о том, что функция существует только в текущем сеансе, и, чтобы использовать ее в других сеансах, необходимо добавить ее или добавить в профиль PowerShell.

- `Get-Help` отображает раздел справки для скрипта или функции только в том случае, если файл скрипта и файлы разделов справки сохраняются в соответствующих расположениях. Поэтому нецелесообразно включать инструкции по установке PowerShell, а также сохранению или установке скрипта или функции в разделе справки по сценариям или функциям. Вместо этого включите все инструкции по установке в документ, используемый для распространения скрипта или функции.

## <a name="see-also"></a>См. также:

[Написание разделов справки на основе комментариев](./writing-comment-based-help-topics.md)
