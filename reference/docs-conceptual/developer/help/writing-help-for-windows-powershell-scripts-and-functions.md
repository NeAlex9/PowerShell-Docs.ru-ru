---
ms.date: 09/13/2016
ms.topic: reference
title: Написание справки по сценариям и функциям PowerShell
description: Написание справки по сценариям и функциям PowerShell
ms.openlocfilehash: f72742e2a131f41ba8ffdcec4901c7c3ea1da1ad
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "92654642"
---
# <a name="writing-help-for-powershell-scripts-and-functions"></a><span data-ttu-id="563f9-103">Написание справки по сценариям и функциям PowerShell</span><span class="sxs-lookup"><span data-stu-id="563f9-103">Writing Help for PowerShell Scripts and Functions</span></span>

<span data-ttu-id="563f9-104">Сценарии и функции PowerShell должны быть полностью документированы при совместном использовании с другими пользователями.</span><span class="sxs-lookup"><span data-stu-id="563f9-104">PowerShell scripts and functions should be fully documented whenever they are shared with others.</span></span>
<span data-ttu-id="563f9-105">`Get-Help`Командлет отображает разделы справки по сценариям и функциям в том же формате, в котором отображается справка для командлетов, и все `Get-Help` параметры работают с разделами справки по сценариям и функциям.</span><span class="sxs-lookup"><span data-stu-id="563f9-105">The `Get-Help` cmdlet displays the script and function help topics in the same format as it displays help for cmdlets, and all of the `Get-Help` parameters work on script and function help topics.</span></span>

<span data-ttu-id="563f9-106">Скрипты PowerShell могут включать раздел справки о скрипте и разделах справки по каждой из функций в сценарии.</span><span class="sxs-lookup"><span data-stu-id="563f9-106">PowerShell scripts can include a help topic about the script and help topics about each functions in the script.</span></span> <span data-ttu-id="563f9-107">Функции, которые совместно используются независимо от скриптов, могут включать собственные разделы справки.</span><span class="sxs-lookup"><span data-stu-id="563f9-107">Functions that are shared independently of scripts can include their own help topics.</span></span>

<span data-ttu-id="563f9-108">В этом документе описывается формат и правильное размещение разделов справки, а также приводятся рекомендации по содержимому.</span><span class="sxs-lookup"><span data-stu-id="563f9-108">This document explains the format and correct placement of the help topics, and it suggests guidelines for the content.</span></span>

## <a name="types-of-script-and-function-help"></a><span data-ttu-id="563f9-109">Типы сценариев и справки по функциям</span><span class="sxs-lookup"><span data-stu-id="563f9-109">Types of Script and Function Help</span></span>

### <a name="comment-based-help"></a><span data-ttu-id="563f9-110">Справка на основе комментариев</span><span class="sxs-lookup"><span data-stu-id="563f9-110">Comment-Based Help</span></span>

<span data-ttu-id="563f9-111">Раздел справки, описывающий скрипт или функцию, можно реализовать в виде набора комментариев в скрипте или функции.</span><span class="sxs-lookup"><span data-stu-id="563f9-111">The help topic that describes a script or function can be implemented as a set of comments within the script or function.</span></span> <span data-ttu-id="563f9-112">При написании справки на основе комментариев для сценария и функций в сценарии Обратите внимание на правила размещения справки на основе комментариев.</span><span class="sxs-lookup"><span data-stu-id="563f9-112">When writing comment-based help for a script and for functions in a script, pay careful attention to the rules for placing the comment-based help.</span></span> <span data-ttu-id="563f9-113">Размещение определяет, связывает ли `Get-Help` командлет раздел справки со сценарием или функцией.</span><span class="sxs-lookup"><span data-stu-id="563f9-113">The placement determines whether the `Get-Help` cmdlet associates the help topic with the script or a function.</span></span> <span data-ttu-id="563f9-114">Дополнительные сведения о создании разделов справки на основе комментариев см. в разделе [about_Comment_Based_Help](/powershell/module/microsoft.powershell.core/about/about_comment_based_help).</span><span class="sxs-lookup"><span data-stu-id="563f9-114">For more information about writing comment-based help topics, see [about_Comment_Based_Help](/powershell/module/microsoft.powershell.core/about/about_comment_based_help).</span></span>

### <a name="xml-based-command-help"></a><span data-ttu-id="563f9-115">Справка по командам XML-Based</span><span class="sxs-lookup"><span data-stu-id="563f9-115">XML-Based Command Help</span></span>

<span data-ttu-id="563f9-116">Раздел справки, описывающий скрипт или функцию, можно реализовать в XML-файле, который использует схему справки по командам.</span><span class="sxs-lookup"><span data-stu-id="563f9-116">The help topic that describes a script or function can be implemented in an XML file that uses the command help schema.</span></span> <span data-ttu-id="563f9-117">Чтобы связать скрипт или функцию с XML-файлом, используйте `ExternalHelp` ключевое слово Comment, за которым следует путь и имя XML-файла.</span><span class="sxs-lookup"><span data-stu-id="563f9-117">To associate the script or function with the XML file, use the `ExternalHelp` comment keyword followed by the path and name of the XML file.</span></span>

<span data-ttu-id="563f9-118">При `ExternalHelp` наличии ключевого слова Comment оно имеет приоритет над справкой на основе комментариев, даже если `Get-Help` не удается найти файл справки, соответствующий значению `ExternalHelp` ключевого слова.</span><span class="sxs-lookup"><span data-stu-id="563f9-118">When the `ExternalHelp` comment keyword is present, it takes precedence over comment-based help, even when `Get-Help` cannot find a help file that matches the value of the `ExternalHelp` keyword.</span></span>

### <a name="online-help"></a><span data-ttu-id="563f9-119">Справка в Интернете</span><span class="sxs-lookup"><span data-stu-id="563f9-119">Online Help</span></span>

<span data-ttu-id="563f9-120">Вы можете публиковать разделы справки в Интернете, а затем напрямую `Get-Help` открывать разделы.</span><span class="sxs-lookup"><span data-stu-id="563f9-120">You can post your help topics on the internet and then direct `Get-Help` to open the topics.</span></span> <span data-ttu-id="563f9-121">Дополнительные сведения о создании разделов справки на основе комментариев см. в разделе [поддержка справки в Интернете](../module/supporting-online-help.md).</span><span class="sxs-lookup"><span data-stu-id="563f9-121">For more information about writing comment-based help topics, see [Supporting Online Help](../module/supporting-online-help.md).</span></span>

<span data-ttu-id="563f9-122">Нет установленного метода для написания концептуальных разделов («About») для сценариев и функций.</span><span class="sxs-lookup"><span data-stu-id="563f9-122">There is no established method for writing conceptual ("About") topics for scripts and functions.</span></span>
<span data-ttu-id="563f9-123">Тем не менее вы можете публиковать разделы справки в Интернете, чтобы получить список разделов и их URL-адресов в разделе «связанные ссылки» в справке по командам.</span><span class="sxs-lookup"><span data-stu-id="563f9-123">However, you can post conceptual topics on the internet list the topics and their URLs in the Related Links section of a command help topic.</span></span>

## <a name="content-considerations-for-script-and-function-help"></a><span data-ttu-id="563f9-124">Рекомендации по содержимому для справки по скриптам и функциям</span><span class="sxs-lookup"><span data-stu-id="563f9-124">Content Considerations for Script and Function Help</span></span>

- <span data-ttu-id="563f9-125">Если вы создаете краткий раздел справки, содержащий лишь несколько доступных разделов справки, обязательно включите в него четкие описания параметров сценария или функции.</span><span class="sxs-lookup"><span data-stu-id="563f9-125">If you are writing a very brief help topic with only a few of the available command help sections, be sure to include clear descriptions of the script or function parameters.</span></span> <span data-ttu-id="563f9-126">Также включите один или два примера команд в раздел "примеры", даже если вы решили опустить описания примеров.</span><span class="sxs-lookup"><span data-stu-id="563f9-126">Also include one or two sample commands in the examples section, even if you decide to omit example descriptions.</span></span>

- <span data-ttu-id="563f9-127">Во всех описаниях используйте команду в качестве скрипта или функции.</span><span class="sxs-lookup"><span data-stu-id="563f9-127">In all descriptions, refer to the command as a script or function.</span></span> <span data-ttu-id="563f9-128">Эти сведения помогают пользователю понять и управлять командой.</span><span class="sxs-lookup"><span data-stu-id="563f9-128">This information helps the user to understand and manage the command.</span></span>

  <span data-ttu-id="563f9-129">Например, в следующем подробном описании указано, что команда New-Topic является сценарием.</span><span class="sxs-lookup"><span data-stu-id="563f9-129">For example, the following detailed description states that the New-Topic command is a script.</span></span>
  <span data-ttu-id="563f9-130">Это напоминает пользователям, что им нужно указать путь и полное имя при их запуске.</span><span class="sxs-lookup"><span data-stu-id="563f9-130">This reminds users that they need to specify the path and full name when they run it.</span></span>

  > <span data-ttu-id="563f9-131">"Сценарий New-Topic создает пустую концептуальную тему для каждого имени раздела во входном файле..."</span><span class="sxs-lookup"><span data-stu-id="563f9-131">"The New-Topic script creates a blank conceptual topic for each topic name in the input file..."</span></span>

  <span data-ttu-id="563f9-132">В следующем подробном описании указано, что `Disable-PSRemoting` является функцией.</span><span class="sxs-lookup"><span data-stu-id="563f9-132">The following detailed description states that `Disable-PSRemoting` is a function.</span></span> <span data-ttu-id="563f9-133">Эта информация особенно полезна пользователям, когда сеанс включает несколько команд с одинаковым именем, некоторые из которых могут быть скрыты командой с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="563f9-133">This information is particularly useful to users when the session includes multiple commands with the same name, some of which might be hidden by a command with higher precedence.</span></span>

  > <span data-ttu-id="563f9-134">`Disable-PSRemoting`Функция отключает все конфигурации сеансов на локальном компьютере...</span><span class="sxs-lookup"><span data-stu-id="563f9-134">The `Disable-PSRemoting` function disables all session configurations on the local computer...</span></span>

- <span data-ttu-id="563f9-135">В разделе справки по скрипту Объясните, как использовать скрипт в целом.</span><span class="sxs-lookup"><span data-stu-id="563f9-135">In a script help topic, explain how to use the script as a whole.</span></span> <span data-ttu-id="563f9-136">Если вы также создаете разделы справки для функций в сценарии, запишите эти функции в разделе справки по скрипту и включите ссылки на разделы справки по функциям в разделе связанные ссылки раздела справки по скриптам.</span><span class="sxs-lookup"><span data-stu-id="563f9-136">If you are also writing help topics for functions in the script, mention the functions in your script help topic and include references to the function help topics in the Related Links section of the script help topic.</span></span>
  <span data-ttu-id="563f9-137">И наоборот, если функция является частью скрипта, объясните в справке по функциям роль, которую функция играет в скрипте и как ее можно использовать независимо.</span><span class="sxs-lookup"><span data-stu-id="563f9-137">Conversely, when a function is part of a script, explain in the function help topic the role that the function plays in the script and how it might be used independently.</span></span> <span data-ttu-id="563f9-138">Затем перечислите разделы справки по сценариям в разделе "связанные ссылки" раздела справки по функциям.</span><span class="sxs-lookup"><span data-stu-id="563f9-138">Then list the script help topic in the Related Links section of the function help topic.</span></span>

- <span data-ttu-id="563f9-139">При написании примеров для раздела справки по сценарию не забудьте включить путь к файлу сценария в команде example.</span><span class="sxs-lookup"><span data-stu-id="563f9-139">When writing examples for a script help topic, be sure to include the path to the script file in the example command.</span></span> <span data-ttu-id="563f9-140">Это напоминает пользователям, что необходимо явно указать путь, даже если скрипт находится в текущем каталоге.</span><span class="sxs-lookup"><span data-stu-id="563f9-140">This reminds users that they must specify the path explicitly, even when the script is in the current directory.</span></span>

- <span data-ttu-id="563f9-141">В разделе справки по функциям Напомним пользователям о том, что функция существует только в текущем сеансе, и, чтобы использовать ее в других сеансах, необходимо добавить ее или добавить в профиль PowerShell.</span><span class="sxs-lookup"><span data-stu-id="563f9-141">In a function help topic, remind users that the function exists only in the current session and, to use it in other sessions, they need to add it, or add it a PowerShell profile.</span></span>

- <span data-ttu-id="563f9-142">`Get-Help` Отображает раздел справки для скрипта или функции только в том случае, если файл скрипта и файлы разделов справки сохраняются в нужных расположениях.</span><span class="sxs-lookup"><span data-stu-id="563f9-142">`Get-Help` displays the help topic for a script or function only when the script file and help topic files are saved in the correct locations.</span></span> <span data-ttu-id="563f9-143">Поэтому нецелесообразно включать инструкции по установке PowerShell, а также сохранению или установке скрипта или функции в разделе справки по сценариям или функциям.</span><span class="sxs-lookup"><span data-stu-id="563f9-143">Therefore, it is not useful to include instructions for installing PowerShell, or saving or installing the script or function in a script or function help topic.</span></span> <span data-ttu-id="563f9-144">Вместо этого включите все инструкции по установке в документ, используемый для распространения скрипта или функции.</span><span class="sxs-lookup"><span data-stu-id="563f9-144">Instead, include any installation instructions in the document that you use to distribute the script or function.</span></span>

## <a name="see-also"></a><span data-ttu-id="563f9-145">См. также:</span><span class="sxs-lookup"><span data-stu-id="563f9-145">See Also</span></span>

[<span data-ttu-id="563f9-146">Написание разделов справки на основе комментариев</span><span class="sxs-lookup"><span data-stu-id="563f9-146">Writing Comment-Based Help Topics</span></span>](./writing-comment-based-help-topics.md)
