---
ms.date: 09/13/2016
ms.topic: reference
title: Как работает обновляемая справка
description: Как работает обновляемая справка
ms.openlocfilehash: c0d2413a27b661cdb9a12fa8a0beae5dee8a21b4
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "92667612"
---
# <a name="how-updatable-help-works"></a>Как работает обновляемая справка

В этом разделе объясняется, как обновляемая Справка обрабатывает файл HelpInfo XML и CAB-файлы для каждого модуля и устанавливает обновленную справку для пользователей.

## <a name="the-update-help-process"></a>Процесс Update-Help

В следующем списке описываются действия командлета [Update-Help](/powershell/module/Microsoft.PowerShell.Core/Update-Help) , когда пользователь выполняет команду, чтобы обновить файлы справки для модуля в определенном языке и региональных ПАРАМЕТРАХ пользовательского интерфейса.

1. `Update-Help` Получает удаленный XML-файл HelpInfo из расположения, указанного значением ключа **HelpInfoURI** в манифесте модуля, и проверяет файл на соответствие схеме. (Для просмотра схемы см. [HELPINFO XML Schema](./helpinfo-xml-schema.md).) Затем `Update-Help` ищет локальный XML-файл HelpInfo для модуля в каталоге Module на компьютере пользователя.

1. `Update-Help` Сравнивает номер версии файлов справки для указанного языка и региональных параметров пользовательского интерфейса в файлах удаленного и локального HelpInfo XML-файлов для модуля. Если номер версии на удаленном файле больше, чем номер версии в локальном файле, или если отсутствует локальный XML-файл HelpInfo для модуля, `Update-Help` готовится к скачиванию новых файлов справки.

1. `Update-Help` выбирает CAB-файл для модуля из расположения, указанного элементом **хелпконтентури** в файле удаленного HelpInfo XML. Для обнаружения CAB-файла в нем используются имя модуля, GUID модуля и язык и региональные параметры пользовательского интерфейса.

1. `Update-Help` скачивает CAB-файл, выполняет его распаковку, проверяет файлы содержимого справки и сохраняет файлы содержимого справки в подкаталоге, зависящем от языка, в каталоге модуля на компьютере пользователя.

1. `Update-Help` создает локальный XML-файл HelpInfo путем копирования удаленного XML-файла HelpInfo. Он изменяет локальный XML-файл HelpInfo таким образом, чтобы он включал элементы только для файла CAB, который он установил.
   Затем он сохраняет локальный XML-файл HelpInfo в каталоге Module и завершает обновление.

## <a name="the-save-help-process"></a>Процесс Save-Help

В следующем списке описываются действия командлетов [Save-Help](/powershell/module/Microsoft.PowerShell.Core/Save-Help) и [Update-Help](/powershell/module/Microsoft.PowerShell.Core/Update-Help) , когда пользователь запускает команды для обновления файлов справки в общей папке, а затем использует эти файлы для обновления файлов справки на компьютере пользователя.

`Save-Help`Командлет выполняет следующие действия в ответ на команду сохранения файлов справки для модуля в общей папке, указанной параметром **DestinationPath** .

1. `Save-Help` Получает удаленный XML-файл HelpInfo из расположения, указанного значением ключа **HelpInfoURI** в манифесте модуля, и проверяет файл на соответствие схеме. (Для просмотра схемы см. [HELPINFO XML Schema](./helpinfo-xml-schema.md).) Затем `Save-Help` ищет локальный XML-файл HelpInfo в каталоге, указанном параметром **DestinationPath** в `Save-Help` команде.

1. `Save-Help` Сравнивает номер версии файлов справки для указанного языка и региональных параметров пользовательского интерфейса в файлах удаленного и локального HelpInfo XML-файлов для модуля. Если номер версии на удаленном файле больше, чем номер версии в локальном файле, или если отсутствует локальный XML-файл HelpInfo для модуля в каталоге **DestinationPath** , `Save-Help` готовится к скачиванию новых файлов справки.

1. `Save-Help` выбирает CAB-файл для модуля из расположения, указанного элементом **хелпконтентури** в файле удаленного HelpInfo XML. Для обнаружения CAB-файла в нем используются имя модуля, GUID модуля и язык и региональные параметры пользовательского интерфейса.

1. `Save-Help` скачивает CAB-файл и сохраняет его в каталоге **DestinationPath** . (Он не создает подкаталоги для конкретного языка.)

1. `Save-Help` создает локальный XML-файл HelpInfo путем копирования удаленного XML-файла HelpInfo. Он изменяет локальный XML-файл HelpInfo таким образом, что он включает элементы только для сохраненного файла CAB.
   Затем он сохраняет локальный XML-файл HelpInfo в каталоге **DestinationPath** и завершает обновление.

   `Update-Help`Командлет выполняет следующие действия в ответ на команду обновления файлов справки на компьютере пользователя из файлов в общей папке, заданной параметром **SourcePath** .

1. `Update-Help` Получает удаленный XML-файл HelpInfo из каталога **SourcePath** . Затем он ищет локальный XML-файл HelpInfo в каталоге Module на компьютере пользователя.

1. `Update-Help` Сравнивает номер версии файлов справки для указанного языка и региональных параметров пользовательского интерфейса в файлах удаленного и локального HelpInfo XML-файлов для модуля. Если номер версии удаленного файла больше, чем номер версии локального файла, или если отсутствует локальный XML-файл HelpInfo, `Update-Help` готовится к установке новых файлов справки.

1. `Update-Help` выбирает CAB-файл для модуля из каталога **SourcePath** . Для обнаружения CAB-файла в нем используются имя модуля, GUID модуля и язык и региональные параметры пользовательского интерфейса.

1. `Update-Help` Распаковать CAB-файл, проверит файлы содержимого справки и сохранит файлы содержимого справки в подкаталоге, зависящем от языка, в каталоге модуля на компьютере пользователя.

1. `Update-Help` создает локальный XML-файл HelpInfo путем копирования удаленного XML-файла HelpInfo. Он изменяет локальный XML-файл HelpInfo таким образом, чтобы он включал элементы только для файла CAB, который он установил.
   Затем он сохраняет локальный XML-файл HelpInfo в каталоге Module и завершает обновление.
