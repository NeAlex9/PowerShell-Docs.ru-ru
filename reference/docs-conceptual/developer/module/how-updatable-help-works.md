---
title: Как работает обновляемая Справка | Документация Майкрософт
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 7674636e-a0f2-4587-bfc5-dd3e6ce5489e
caps.latest.revision: 6
ms.openlocfilehash: 5b6ae54ee6c843996c875189b6ee553be5e4f614
ms.sourcegitcommit: 52a67bcd9d7bf3e8600ea4302d1fa8970ff9c998
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/15/2019
ms.locfileid: "72367083"
---
# <a name="how-updatable-help-works"></a>Как работает обновляемая справка

В этом разделе объясняется, как обновляемая Справка обрабатывает файл HelpInfo XML и CAB-файлы для каждого модуля и устанавливает обновленную справку для пользователей.

## <a name="the-update-help-process"></a>Процесс обновления и справки

В следующем списке описываются действия командлета [Update-Help](/powershell/module/Microsoft.PowerShell.Core/Update-Help) , когда пользователь выполняет команду, чтобы обновить файлы справки для модуля в определенном языке и региональных ПАРАМЕТРАХ пользовательского интерфейса.

1. `Update-Help` получает удаленный XML-файл HelpInfo из расположения, указанного значением ключа **HelpInfoURI** в манифесте модуля, и проверяет файл на соответствие схеме. (Для просмотра схемы см. [HELPINFO XML Schema](./helpinfo-xml-schema.md).) Затем `Update-Help` ищет локальный XML-файл HelpInfo для модуля в каталоге Module на компьютере пользователя.

2. `Update-Help` сравнивает номер версии файлов справки для указанного языка и региональных параметров пользовательского интерфейса в файлах удаленного и локального HelpInfo XML-файлов для модуля. Если номер версии удаленного файла больше, чем номер версии в локальном файле, или если отсутствует локальный XML-файл HelpInfo для модуля, `Update-Help` готовится к скачиванию новых файлов справки.

3. `Update-Help` — файл CAB для модуля из расположения, указанного в элементе **хелпконтентури** в УДАЛЕННОМ XML-файле HelpInfo. Для обнаружения CAB-файла в нем используются имя модуля, GUID модуля и язык и региональные параметры пользовательского интерфейса.

4. `Update-Help` скачивает файл CAB, распаковать его, проверит файлы содержимого справки и сохранит файлы содержимого справки в подкаталоге, зависящем от языка, в каталоге модуля на компьютере пользователя.

5. `Update-Help` создает локальный XML-файл HelpInfo путем копирования удаленного XML-файла HelpInfo. Он изменяет локальный XML-файл HelpInfo таким образом, чтобы он включал элементы только для файла CAB, который он установил. Затем он сохраняет локальный XML-файл HelpInfo в каталоге Module и завершает обновление.

## <a name="the-save-help-process"></a>Процесс сохранения справки

В следующем списке описываются действия командлетов [Save-Help](/powershell/module/Microsoft.PowerShell.Core/Save-Help) и [Update-Help](/powershell/module/Microsoft.PowerShell.Core/Update-Help) , когда пользователь запускает команды для обновления файлов справки в общей папке, а затем использует эти файлы для обновления файлов справки на компьютере пользователя.

Командлет `Save-Help` выполняет следующие действия в ответ на команду сохранения файлов справки для модуля в общей папке, указанной параметром **DestinationPath** .

1. `Save-Help` получает удаленный XML-файл HelpInfo из расположения, указанного значением ключа **HelpInfoURI** в манифесте модуля, и проверяет файл на соответствие схеме. (Для просмотра схемы см. [HELPINFO XML Schema](./helpinfo-xml-schema.md).) Затем `Save-Help` ищет локальный XML-файл HelpInfo в каталоге, указанном параметром **DestinationPath** в команде `Save-Help`.

2. `Save-Help` сравнивает номер версии файлов справки для указанного языка и региональных параметров пользовательского интерфейса в файлах удаленного и локального HelpInfo XML-файлов для модуля. Если номер версии на удаленном файле больше, чем номер версии в локальном файле, или если отсутствует локальный XML-файл HelpInfo для модуля в каталоге **DestinationPath** , `Save-Help` готовится к скачиванию новых файлов справки.

3. `Save-Help` — файл CAB для модуля из расположения, указанного в элементе **хелпконтентури** в УДАЛЕННОМ XML-файле HelpInfo. Для обнаружения CAB-файла в нем используются имя модуля, GUID модуля и язык и региональные параметры пользовательского интерфейса.

4. `Save-Help` — загружает CAB-файл и сохраняет его в каталоге **DestinationPath** . (Он не создает подкаталоги для конкретного языка.)

5. `Save-Help` создает локальный XML-файл HelpInfo путем копирования удаленного XML-файла HelpInfo. Он изменяет локальный XML-файл HelpInfo таким образом, что он включает элементы только для сохраненного файла CAB. Затем он сохраняет локальный XML-файл HelpInfo в каталоге **DestinationPath** и завершает обновление.

   Командлет `Update-Help` выполняет следующие действия в ответ на команду обновления файлов справки на компьютере пользователя из файлов в общей папке, заданной параметром **SourcePath** .

1. `Update-Help` получает удаленный XML-файл HelpInfo из каталога **SourcePath** . Затем он ищет локальный XML-файл HelpInfo в каталоге Module на компьютере пользователя.

2. `Update-Help` сравнивает номер версии файлов справки для указанного языка и региональных параметров пользовательского интерфейса в файлах удаленного и локального HelpInfo XML-файлов для модуля. Если номер версии на удаленном файле больше, чем номер версии локального файла, или если локальный XML-файл HelpInfo отсутствует, `Update-Help` готовится к установке новых файлов справки.

3. `Update-Help` — файл CAB для модуля из каталога **SourcePath** . Для обнаружения CAB-файла в нем используются имя модуля, GUID модуля и язык и региональные параметры пользовательского интерфейса.

4. `Update-Help` выполнит распаковку файла CAB, проверит файлы содержимого справки и сохранит файлы содержимого справки в подкаталоге, зависящем от языка, в каталоге модуля на компьютере пользователя.

5. `Update-Help` создает локальный XML-файл HelpInfo путем копирования удаленного XML-файла HelpInfo. Он изменяет локальный XML-файл HelpInfo таким образом, чтобы он включал элементы только для файла CAB, который он установил. Затем он сохраняет локальный XML-файл HelpInfo в каталоге Module и завершает обновление.