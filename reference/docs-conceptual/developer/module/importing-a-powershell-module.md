---
title: Импорт модуля PowerShell | Документация Майкрософт
ms.date: 02/03/2020
ms.openlocfilehash: 8cd1938d0a7b49b4a594753d8ce5ebe60625025d
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2020
ms.locfileid: "87784883"
---
# <a name="importing-a-powershell-module"></a><span data-ttu-id="87ab1-102">Импорт модуля PowerShell</span><span class="sxs-lookup"><span data-stu-id="87ab1-102">Importing a PowerShell Module</span></span>

<span data-ttu-id="87ab1-103">После установки модуля в системе может потребоваться импортировать модуль.</span><span class="sxs-lookup"><span data-stu-id="87ab1-103">Once you have installed a module on a system, you will likely want to import the module.</span></span> <span data-ttu-id="87ab1-104">Импорт — это процесс, который загружает модуль в активную память, чтобы пользователь мог получить доступ к этому модулю в сеансе PowerShell.</span><span class="sxs-lookup"><span data-stu-id="87ab1-104">Importing is the process that loads the module into active memory, so that a user can access that module in their PowerShell session.</span></span> <span data-ttu-id="87ab1-105">В PowerShell 2,0 можно импортировать недавно установленный модуль PowerShell с помощью вызова командлета [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) .</span><span class="sxs-lookup"><span data-stu-id="87ab1-105">In PowerShell 2.0, you can import a newly-installed PowerShell module with a call to [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet.</span></span> <span data-ttu-id="87ab1-106">В PowerShell 3,0 PowerShell может неявно импортировать модуль, когда пользователь вызывает одну из функций или командлетов в модуле.</span><span class="sxs-lookup"><span data-stu-id="87ab1-106">In PowerShell 3.0, PowerShell is able to implicitly import a module when one of the functions or cmdlets in the module is called by a user.</span></span> <span data-ttu-id="87ab1-107">Обратите внимание, что в обеих версиях предполагается, что модуль устанавливается в расположение, где PowerShell может его найти. Дополнительные сведения см. [в разделе Установка модуля PowerShell](./installing-a-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="87ab1-107">Note that both versions assume that you install your module in a location where PowerShell is able to find it; for more information, see [Installing a PowerShell Module](./installing-a-powershell-module.md).</span></span>
<span data-ttu-id="87ab1-108">Манифест модуля можно использовать для ограничения экспортируемых частей модуля, и можно использовать параметры `Import-Module` вызова, чтобы ограничить импортируемые части.</span><span class="sxs-lookup"><span data-stu-id="87ab1-108">You can use a module manifest to restrict what parts of your module are exported, and you can use parameters of the `Import-Module` call to restrict what parts are imported.</span></span>

## <a name="importing-a-snap-in-powershell-10"></a><span data-ttu-id="87ab1-109">Импорт оснастки (PowerShell 1,0)</span><span class="sxs-lookup"><span data-stu-id="87ab1-109">Importing a Snap-In (PowerShell 1.0)</span></span>

<span data-ttu-id="87ab1-110">Модули не существовали в PowerShell 1,0. вместо этого необходимо было зарегистрировать и использовать оснастки. Однако мы не рекомендуем использовать эту технологию на этом этапе, так как модули обычно проще устанавливать и импортировать.</span><span class="sxs-lookup"><span data-stu-id="87ab1-110">Modules did not exist in PowerShell 1.0: instead, you had to register and use snap-ins. However, it is not recommended that you use this technology at this point, as modules are generally easier to install and import.</span></span> <span data-ttu-id="87ab1-111">Дополнительные сведения см. в разделе [Создание оснастки Windows PowerShell](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span><span class="sxs-lookup"><span data-stu-id="87ab1-111">For more information, see [How to Create a Windows PowerShell Snap-in](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span></span>

## <a name="importing-a-module-with-import-module-powershell-20"></a><span data-ttu-id="87ab1-112">Импорт модуля с помощью Import-Module (PowerShell 2,0)</span><span class="sxs-lookup"><span data-stu-id="87ab1-112">Importing a Module with Import-Module (PowerShell 2.0)</span></span>

<span data-ttu-id="87ab1-113">Для импорта модулей в PowerShell 2,0 используется командлет [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) с соответствующим именем.</span><span class="sxs-lookup"><span data-stu-id="87ab1-113">PowerShell 2.0 uses the appropriately-named [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to import modules.</span></span> <span data-ttu-id="87ab1-114">При запуске этого командлета Windows PowerShell ищет указанный модуль в каталогах, указанных в `PSModulePath` переменной.</span><span class="sxs-lookup"><span data-stu-id="87ab1-114">When this cmdlet is run, Windows PowerShell searches for the specified module within the directories specified in the `PSModulePath` variable.</span></span> <span data-ttu-id="87ab1-115">При обнаружении указанного каталога Windows PowerShell ищет файлы в следующем порядке: файлы манифеста модуля (. PSD1), файлы модулей скриптов (. PSM1), двоичные файлы модулей (. dll).</span><span class="sxs-lookup"><span data-stu-id="87ab1-115">When the specified directory is found, Windows PowerShell searches for files in the following order: module manifest files (.psd1), script module files (.psm1), binary module files (.dll).</span></span> <span data-ttu-id="87ab1-116">Дополнительные сведения о добавлении каталогов в поиск см. в разделе [изменение пути установки PSModulePath](./modifying-the-psmodulepath-installation-path.md).</span><span class="sxs-lookup"><span data-stu-id="87ab1-116">For more information about adding directories to the search, see [Modifying the PSModulePath Installation Path](./modifying-the-psmodulepath-installation-path.md).</span></span>
<span data-ttu-id="87ab1-117">В следующем примере кода показано, как импортировать модуль:</span><span class="sxs-lookup"><span data-stu-id="87ab1-117">The following code describes how to import a module:</span></span>

```powershell
Import-Module myModule
```

<span data-ttu-id="87ab1-118">Если предположить, что она была размещена в `PSModulePath` , PowerShell загрузит myModule в активную память.</span><span class="sxs-lookup"><span data-stu-id="87ab1-118">Assuming that myModule was located in the `PSModulePath`, PowerShell would load myModule into active memory.</span></span> <span data-ttu-id="87ab1-119">Если она не была расположена по `PSModulePath` пути, можно по-прежнему указать PowerShell, где его найти:</span><span class="sxs-lookup"><span data-stu-id="87ab1-119">If myModule was not located on a `PSModulePath` path, you could still explicitly tell PowerShell where to find it:</span></span>

```powershell
Import-Module -Name C:\myRandomDirectory\myModule -Verbose
```

<span data-ttu-id="87ab1-120">Можно также использовать параметр, `-Verbose` чтобы определить, что экспортируется из модуля и что импортируется в активную память.</span><span class="sxs-lookup"><span data-stu-id="87ab1-120">You can also use the `-Verbose` parameter to identify what is being exported out of the module, and what is being imported into active memory.</span></span> <span data-ttu-id="87ab1-121">Экспорт и импорт ограничивают содержимое, доступное пользователю. разница заключается в том, кто управляет видимостью.</span><span class="sxs-lookup"><span data-stu-id="87ab1-121">Both exports and imports restrict what is exposed to the user: the difference is who is controlling the visibility.</span></span> <span data-ttu-id="87ab1-122">По сути, экспорты управляются кодом внутри модуля.</span><span class="sxs-lookup"><span data-stu-id="87ab1-122">Essentially, exports are controlled by code within the module.</span></span> <span data-ttu-id="87ab1-123">В отличие от этого, управление импортом осуществляется с помощью `Import-Module` вызова.</span><span class="sxs-lookup"><span data-stu-id="87ab1-123">In contrast, imports are controlled by the `Import-Module` call.</span></span> <span data-ttu-id="87ab1-124">Дополнительные сведения см. в разделе **запрещение импортируемых элементов**ниже.</span><span class="sxs-lookup"><span data-stu-id="87ab1-124">For more information, see **Restricting Members That Are Imported**, below.</span></span>

## <a name="implicitly-importing-a-module-powershell-30"></a><span data-ttu-id="87ab1-125">Неявный импорт модуля (PowerShell 3,0)</span><span class="sxs-lookup"><span data-stu-id="87ab1-125">Implicitly Importing a Module (PowerShell 3.0)</span></span>

<span data-ttu-id="87ab1-126">Начиная с Windows PowerShell 3.0, модули импортируются автоматически, когда любой командлет или любая функция из модуля используются в команде.</span><span class="sxs-lookup"><span data-stu-id="87ab1-126">Beginning in Windows PowerShell 3.0, modules are imported automatically when any cmdlet or function in the module is used in a command.</span></span> <span data-ttu-id="87ab1-127">Эта функция работает для любого модуля в каталоге, который входит в значение переменной среды **PSModulePath** .</span><span class="sxs-lookup"><span data-stu-id="87ab1-127">This feature works on any module in a directory that this included in the value of the **PSModulePath** environment variable.</span></span> <span data-ttu-id="87ab1-128">Если вы не сохраните модуль по действительному пути, вы по-прежнему можете загрузить их с помощью явного параметра [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) , описанного выше.</span><span class="sxs-lookup"><span data-stu-id="87ab1-128">If you do not save your module on a valid path however, you can still load them using the explicit [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) option, described above.</span></span>

<span data-ttu-id="87ab1-129">Следующие действия активируют автоматический импорт модуля, также известный как "Автоматическая загрузка модуля".</span><span class="sxs-lookup"><span data-stu-id="87ab1-129">The following actions trigger automatic importing of a module, also known as "module auto-loading."</span></span>

- <span data-ttu-id="87ab1-130">Использование командлета в команде.</span><span class="sxs-lookup"><span data-stu-id="87ab1-130">Using a cmdlet in a command.</span></span> <span data-ttu-id="87ab1-131">Например, при вводе `Get-ExecutionPolicy` импортируется модуль Microsoft. PowerShell. Security, содержащий `Get-ExecutionPolicy` командлет.</span><span class="sxs-lookup"><span data-stu-id="87ab1-131">For example, typing `Get-ExecutionPolicy` imports the Microsoft.PowerShell.Security module that contains the `Get-ExecutionPolicy` cmdlet.</span></span>

- <span data-ttu-id="87ab1-132">Использование командлета [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) для получения команды.</span><span class="sxs-lookup"><span data-stu-id="87ab1-132">Using the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet to get the command.</span></span> <span data-ttu-id="87ab1-133">Например, при вводе `Get-Command Get-JobTrigger` импортируется модуль **PSScheduledJob** , содержащий `Get-JobTrigger` командлет.</span><span class="sxs-lookup"><span data-stu-id="87ab1-133">For example, typing `Get-Command Get-JobTrigger` imports the **PSScheduledJob** module that contains the `Get-JobTrigger` cmdlet.</span></span> <span data-ttu-id="87ab1-134">`Get-Command`Команда, содержащая подстановочные знаки, считается обнаружением и не инициирует импорт модуля.</span><span class="sxs-lookup"><span data-stu-id="87ab1-134">A `Get-Command` command that includes wildcard characters is considered to be discovery and does not trigger importing of a module.</span></span>

- <span data-ttu-id="87ab1-135">Использование командлета [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) для получения справки по командлету.</span><span class="sxs-lookup"><span data-stu-id="87ab1-135">Using the [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) cmdlet to get help for a cmdlet.</span></span> <span data-ttu-id="87ab1-136">Например, при вводе `Get-Help Get-WinEvent` импортируется модуль Microsoft. PowerShell. Diagnostics, содержащий `Get-WinEvent` командлет.</span><span class="sxs-lookup"><span data-stu-id="87ab1-136">For example, typing `Get-Help Get-WinEvent` imports the Microsoft.PowerShell.Diagnostics module that contains the `Get-WinEvent` cmdlet.</span></span>

<span data-ttu-id="87ab1-137">Для поддержки автоматического импорта модулей `Get-Command` командлет получает все командлеты и функции во всех установленных модулях, даже если модуль не импортируется в сеанс.</span><span class="sxs-lookup"><span data-stu-id="87ab1-137">To support automatic importing of modules, the `Get-Command` cmdlet gets all cmdlets and functions in all installed modules, even if the module is not imported into the session.</span></span> <span data-ttu-id="87ab1-138">Дополнительные сведения см. в разделе справки по командлету [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) .</span><span class="sxs-lookup"><span data-stu-id="87ab1-138">For more information, see the help topic for the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet.</span></span>

## <a name="the-importing-process"></a><span data-ttu-id="87ab1-139">Процесс импорта</span><span class="sxs-lookup"><span data-stu-id="87ab1-139">The Importing Process</span></span>

<span data-ttu-id="87ab1-140">При импорте модуля для модуля создается новое состояние сеанса, а в памяти создается объект [System. Management. Automation. PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) .</span><span class="sxs-lookup"><span data-stu-id="87ab1-140">When a module is imported, a new session state is created for the module, and a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object is created in memory.</span></span> <span data-ttu-id="87ab1-141">Состояние сеанса создается для каждого импортируемого модуля (включая корневой модуль и все вложенные модули).</span><span class="sxs-lookup"><span data-stu-id="87ab1-141">A session-state is created for each module that is imported (this includes the root module and any nested modules).</span></span> <span data-ttu-id="87ab1-142">Элементы, экспортированные из корневого модуля, включая все элементы, экспортированные в корневой модуль любыми вложенными модулями, затем импортируются в состояние сеанса вызывающего.</span><span class="sxs-lookup"><span data-stu-id="87ab1-142">The members that are exported from the root module, including any members that were exported to the root module by any nested modules, are then imported into the caller's session state.</span></span>

<span data-ttu-id="87ab1-143">Метаданные элементов, экспортированных из модуля, имеют свойство ModuleName.</span><span class="sxs-lookup"><span data-stu-id="87ab1-143">The metadata of members that are exported from a module have a ModuleName property.</span></span> <span data-ttu-id="87ab1-144">Это свойство заполняется именем модуля, в котором они были экспортированы.</span><span class="sxs-lookup"><span data-stu-id="87ab1-144">This property is populated with the name of the module that exported them.</span></span>

> [!WARNING]
> <span data-ttu-id="87ab1-145">Если имя экспортированного элемента использует неутвержденную команду или если имя члена использует ограниченные символы, то при выполнении командлета [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) отображается предупреждение.</span><span class="sxs-lookup"><span data-stu-id="87ab1-145">If the name of an exported member uses an unapproved verb or if the name of the member uses restricted characters, a warning is displayed when the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet is run.</span></span>

<span data-ttu-id="87ab1-146">По умолчанию командлет [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) не возвращает ни одного объекта в конвейер.</span><span class="sxs-lookup"><span data-stu-id="87ab1-146">By default, the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet does not return any objects to the pipeline.</span></span> <span data-ttu-id="87ab1-147">Однако командлет поддерживает параметр **PassThru** , который можно использовать для возврата объекта [System. Management. Automation. PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) для каждого импортируемого модуля.</span><span class="sxs-lookup"><span data-stu-id="87ab1-147">However, the cmdlet supports a **PassThru** parameter that can be used to return a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object for each module that is imported.</span></span> <span data-ttu-id="87ab1-148">Для отправки выходных данных на узел Пользователи должны запустить командлет [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) .</span><span class="sxs-lookup"><span data-stu-id="87ab1-148">To send output to the host, users should run the [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet.</span></span>

## <a name="restricting--the-members-that-are-imported"></a><span data-ttu-id="87ab1-149">Ограничьте импортируемые элементы</span><span class="sxs-lookup"><span data-stu-id="87ab1-149">Restricting  the Members That Are Imported</span></span>

<span data-ttu-id="87ab1-150">При импорте модуля с помощью командлета [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) по умолчанию все экспортированные элементы модуля импортируются в сеанс, включая все команды, экспортированные в модуль вложенным модулем.</span><span class="sxs-lookup"><span data-stu-id="87ab1-150">When a module is imported by using the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet, by default, all exported module members are imported into the session, including any commands exported to the module by a nested module.</span></span> <span data-ttu-id="87ab1-151">По умолчанию переменные и псевдонимы не экспортируются.</span><span class="sxs-lookup"><span data-stu-id="87ab1-151">By default, variables and aliases are not exported.</span></span> <span data-ttu-id="87ab1-152">Чтобы ограничить экспортируемые элементы, используйте [манифест модуля](./how-to-write-a-powershell-module-manifest.md).</span><span class="sxs-lookup"><span data-stu-id="87ab1-152">To restrict the members that are exported, use a [module manifest](./how-to-write-a-powershell-module-manifest.md).</span></span>
<span data-ttu-id="87ab1-153">Чтобы ограничить импортируемые элементы, используйте следующие параметры `Import-Module` командлета.</span><span class="sxs-lookup"><span data-stu-id="87ab1-153">To restrict the members that are imported, use the following parameters of the `Import-Module` cmdlet.</span></span>

- <span data-ttu-id="87ab1-154">**Функция**: этот параметр разрешает экспорт экспортируемых функций.</span><span class="sxs-lookup"><span data-stu-id="87ab1-154">**Function**: This parameter restricts the functions that are exported.</span></span> <span data-ttu-id="87ab1-155">(Если вы используете манифест модуля, см. раздел FunctionsToExport Key.)</span><span class="sxs-lookup"><span data-stu-id="87ab1-155">(If you are using a module manifest, see the FunctionsToExport key.)</span></span>

- <span data-ttu-id="87ab1-156">\`**Командлет**. Этот параметр позволяет ограничивать экспортируемые командлеты (если вы используете манифест модуля, см. раздел CmdletsToExport).</span><span class="sxs-lookup"><span data-stu-id="87ab1-156">\`**Cmdlet**: This parameter restricts the cmdlets that are exported (If you are using a module manifest, see the CmdletsToExport key.)</span></span>

- <span data-ttu-id="87ab1-157">**Переменная**. Этот параметр позволяет ограничивать экспортируемые переменные (если используется манифест модуля, см. раздел вариаблестоекспорт).</span><span class="sxs-lookup"><span data-stu-id="87ab1-157">**Variable**: This parameter restricts the variables that are exported (If you are using a module manifest, see the VariablesToExport key.)</span></span>

- <span data-ttu-id="87ab1-158">**Псевдоним**. Этот параметр позволяет ограничивать экспортируемые псевдонимы (если вы используете манифест модуля, см. раздел алиасестоекспорт).</span><span class="sxs-lookup"><span data-stu-id="87ab1-158">**Alias**: This parameter restricts the aliases that are exported (If you are using a module manifest, see the AliasesToExport key.)</span></span>

## <a name="see-also"></a><span data-ttu-id="87ab1-159">См. также</span><span class="sxs-lookup"><span data-stu-id="87ab1-159">See Also</span></span>

[<span data-ttu-id="87ab1-160">Написание модуля Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="87ab1-160">Writing a Windows PowerShell Module</span></span>](./writing-a-windows-powershell-module.md)
