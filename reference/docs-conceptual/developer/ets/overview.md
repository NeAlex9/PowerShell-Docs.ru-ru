---
ms.date: 07/09/2020
ms.topic: reference
title: Общие сведения о системе расширенного типа
description: Общие сведения о системе расширенного типа
ms.openlocfilehash: f4a789f779fa8a52f0fe524abff7ec3311e93b6c
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "92655720"
---
# <a name="extended-type-system-overview"></a>Общие сведения о системе расширенного типа

PowerShell использует объект **PSObject** для расширения типов объектов двумя способами. Во-первых, объект **PSObject** предоставляет способ отображения различных представлений конкретных типов объектов. Это называется отображением адаптированного представления объекта. Во-вторых, объект **PSObject** предоставляет способ добавления элементов в существующий объект. В сочетании с заключением существующего объекта, называемого базовым объектом, объект **PSObject** предоставляет расширенную систему типов (ETS), которую разработчики скриптов и командлетов могут использовать для управления объектами .NET в оболочке.

## <a name="cmdlet-and-script-development-issues"></a>Вопросы разработки командлетов и сценариев

ETS устраняет две фундаментальные проблемы:

Во первых, некоторые объекты .NET не имеют необходимого поведения по умолчанию для работы в качестве данных между командлетами.

- Некоторые объекты .NET — это "META" объекты (например, объекты WMI, объекты ADO и объекты XML), члены которых описывают содержащиеся в них данные. Однако в среде скриптов это данные, которые наиболее интересны, а не описание содержащихся данных. ETS устраняет эту проблему, представляя представление о адаптерах, которые адаптируют базовый объект .NET в соответствии с ожидаемой семантикой по умолчанию.
- Некоторые члены объектов .NET имеют неодинаковое имя, предоставляют недостаточный набор открытых членов или предоставляют недостаточные возможности. ETS устраняет эту проблему, представляя возможность расширить объект .NET с помощью дополнительных членов.

Во-вторых, язык сценариев PowerShell не имеет _типа_ , что переменная не должна объявляться с определенным типом. Это значит, что переменные, создаваемые разработчиком скрипта, относятся к _типу_ сущности. Однако система PowerShell называется «управляемой на основе типов» в том, что она зависит от наличия имени типа для выполнения базовых операций, таких как вывод результатов или сортировка.

Поэтому разработчик скриптов должен иметь возможность указать тип одной из своих переменных и создать собственный набор динамически типизированных объектов, которые содержат свойства и методы и могут участвовать в системе на основе типов. ETS решает эту проблему, предоставляя общий объект для языка сценариев, который имеет возможность динамического состояния своего типа и динамически добавлять элементы.

По сути, ETS устраняет проблему, упомянутую ранее, предоставляя объект **PSObject** , который выступает в качестве основы для доступа к объектам из языка сценариев и предоставляет стандартную абстракцию для разработчика командлетов.

### <a name="cmdlet-developers"></a>Разработчики командлетов

Для разработчиков командлетов ETS предоставляет следующую поддержку:

- Абстракции для работы с объектами в универсальном виде с помощью объекта **PSObject** . ETS также позволяет детализировать предыдущие абстракции, если это необходимо.
- Механизмы создания поведения по умолчанию для форматирования, сортировки, сериализации и других системных манипуляций с типом объектов, используя хорошо известный набор расширенных элементов.
- Средства для работы с любым объектом с использованием той же семантики, что и язык скрипта, использующего объект LanguagePrimitives.
- Средства для динамического "типа" хэш-таблицы, чтобы оставшаяся часть системы могла эффективно работать с ней.

### <a name="script-developers"></a>Разработчики скриптов

Для разработчиков скриптов ETS предоставляет следующую поддержку:

- Возможность ссылаться на любой базовый тип объекта с помощью того же синтаксиса ( `$a.x` ).
- Возможность доступа за пределами абстракции, предоставляемой объектом **PSObject** (например, доступ только к адаптированным элементам или доступ к самому базовому объекту).
- Возможность определять хорошо известные члены, управляющие форматированием, сортировкой, сериализацией и другими манипуляциями экземпляра или типа объекта.
- Средства для именования объекта в качестве определенного типа и, таким образом, управляют наследованием его членов на основе типа.
- Возможность добавлять, удалять и изменять расширенные члены.
- Возможность управлять самим объектом **PSObject** , если это необходимо.

## <a name="the-psobject-class"></a>Класс PSObject

Объект **PSObject** является основанием для доступа ко всем объектам из языка сценариев и предоставляет стандартную абстракцию для разработчика командлета. Он содержит базовый объект (объект .NET) и все члены экземпляров (члены, в частности, расширенные элементы, которые находятся в определенном экземпляре объекта, но не обязательно для других объектов того же типа). В зависимости от типа базового объекта объект **PSObject** может также предоставлять явный и неявный доступ к адаптированным членам, а также к любым расширенным членам на основе типов.

Объект **PSObject** предоставляет следующие механизмы:

- Возможность создания **PSObject** с базовым объектом или без него.
- Возможность доступа ко всем элементам каждого сконструированного объекта **PSObject** через общий алгоритм поиска и возможность переопределения этого алгоритма при необходимости.
- Возможность получать и устанавливать имена типов сконструированных объектов **PSObject** таким образом, чтобы скрипты и командлеты могли ссылаться на похожие объекты **PSObject** по одному имени типа, независимо от типа их базового объекта.

### <a name="how-to-construct-a-psobject"></a>Создание типа PSObject

В следующем списке описаны способы создания объекта **PSObject** .

- При вызове конструктора **PSObject** . #ctor создается новый объект **PSObject** с базовым объектом PSCustomObject. Базовый объект этого типа указывает, что объект **PSObject** не имеет осмысленного базового объекта. Тем не менее объект **PSObject** с этим типом базового объекта предоставляет контейнер свойств, который разработчики командлетов могут найти полезными, добавив расширенные члены.

Разработчики также могут указать тип object-name, который позволяет этому объекту совместно использовать свои расширенные члены с другими объектами **PSObject** с тем же именем типа.

- Вызов конструктора **PSObject** . #ctor (System. Object) создает новый объект **PSObject** с базовым объектом типа System. Object.

  В этом случае имя типа для созданного объекта является коллекцией производной иерархии базового объекта. Например, имя типа для **PSObject** , которое содержит процессинфо базовый объект, должно включать следующие имена:

  - System.Diagnostics.Process
  - System. ComponentModel. Component
  - System.MarshalByRefObject
  - System.Object

- Вызов **PSObject** . Метод Аспсобжект (System. Object) создает новый объект **PSObject** на основе заданного объекта.

  Если переданный объект имеет тип System. Object, указанный объект используется в качестве базового объекта для нового объекта **PSObject** . Если указанный объект уже является объектом **PSObject** , переданный объект возвращается как имеет значение.

### <a name="base-adapted-and-extended-members"></a>Базовые, адаптированные и расширенные члены

По сути, ETS использует следующие термины для отображения связи между исходными элементами базового объекта и этими элементами, добавленными PowerShell. Дополнительные сведения о конкретных типах элементов, используемых объектом **PSObject** , см. в разделе [класс PSObject](/dotnet/api/system.management.automation.psobject).

#### <a name="base-object-members"></a>Члены базового объекта

Если базовый объект указан при конструировании объектов **PSObject** , то члены базового объекта становятся доступными через свойство Members.

#### <a name="adapted-members"></a>Адаптированные члены

Если базовый объект является мета-объектом, который содержит данные в универсальном формате, свойства которых описывают их содержащиеся в них данные, ETS адаптирует эти объекты к представлению, которое обеспечивает прямой доступ к данным через адаптированные члены объекта **PSObject** . Доступ к адаптированным членам и членам базового объекта осуществляется через свойство Members.

#### <a name="extended-members"></a>Расширенные члены

Помимо членов, доступных из базового объекта или этих адаптированных элементов, созданных PowerShell, параметр **PSObject** может также определять расширенные члены, расширяющие исходный базовый объект с дополнительной информацией, полезной в среде сценариев.

Например, все основные командлеты, предоставляемые PowerShell, такие как командлеты Get-Content и Set-Content, принимают параметр path. Чтобы эти командлеты и другие могли работать с объектами различных типов, элемент Path можно добавить к этим объектам, чтобы все они заработали свои данные обычным образом. Этот расширенный элемент Path гарантирует, что командлеты будут работать со всеми этими типами, несмотря на то, что в базовом классе может отсутствовать элемент пути.

Доступ к расширенным членам, адаптированным членам и членам базового объекта осуществляется через свойство Members.
