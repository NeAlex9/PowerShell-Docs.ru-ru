---
title: Общие сведения о системе расширенного типа
ms.date: 07/09/2020
ms.openlocfilehash: 5c190f0d9b852a4b5658227085092f33d71453c9
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2020
ms.locfileid: "87786226"
---
# <a name="extended-type-system-overview"></a><span data-ttu-id="aa3b0-102">Общие сведения о системе расширенного типа</span><span class="sxs-lookup"><span data-stu-id="aa3b0-102">Extended Type System Overview</span></span>

<span data-ttu-id="aa3b0-103">PowerShell использует объект **PSObject** для расширения типов объектов двумя способами.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-103">PowerShell uses its **PSObject** object to extend the types of objects in two ways.</span></span> <span data-ttu-id="aa3b0-104">Во-первых, объект **PSObject** предоставляет способ отображения различных представлений конкретных типов объектов.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-104">First, the **PSObject** object provides a way to show different views of specific object types.</span></span> <span data-ttu-id="aa3b0-105">Это называется отображением адаптированного представления объекта.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-105">This is referred to as showing an adapted view of an object.</span></span> <span data-ttu-id="aa3b0-106">Во-вторых, объект **PSObject** предоставляет способ добавления элементов в существующий объект.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-106">Second, the **PSObject** object provides a way to add members to existing object.</span></span> <span data-ttu-id="aa3b0-107">В сочетании с заключением существующего объекта, называемого базовым объектом, объект **PSObject** предоставляет расширенную систему типов (ETS), которую разработчики скриптов и командлетов могут использовать для управления объектами .NET в оболочке.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-107">Together, by wrapping an existing object, referred to as the base object, the **PSObject** object provides an extended type system (ETS) that script and cmdlet developers can use to manipulate .NET objects within the shell.</span></span>

## <a name="cmdlet-and-script-development-issues"></a><span data-ttu-id="aa3b0-108">Вопросы разработки командлетов и сценариев</span><span class="sxs-lookup"><span data-stu-id="aa3b0-108">Cmdlet and Script Development Issues</span></span>

<span data-ttu-id="aa3b0-109">ETS устраняет две фундаментальные проблемы:</span><span class="sxs-lookup"><span data-stu-id="aa3b0-109">ETS resolves two fundamental issues:</span></span>

<span data-ttu-id="aa3b0-110">Во первых, некоторые объекты .NET не имеют необходимого поведения по умолчанию для работы в качестве данных между командлетами.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-110">First, some .NET Objects do not have the necessary default behavior for acting as the data between cmdlets.</span></span>

- <span data-ttu-id="aa3b0-111">Некоторые объекты .NET — это "META" объекты (например, объекты WMI, объекты ADO и объекты XML), члены которых описывают содержащиеся в них данные.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-111">Some .NET objects are "meta" objects (for example: WMI Objects, ADO objects, and XML objects) whose members describe the data they contain.</span></span> <span data-ttu-id="aa3b0-112">Однако в среде скриптов это данные, которые наиболее интересны, а не описание содержащихся данных.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-112">However, in a scripting environment it is the contained data that is most interesting, not the description of the contained data.</span></span> <span data-ttu-id="aa3b0-113">ETS устраняет эту проблему, представляя представление о адаптерах, которые адаптируют базовый объект .NET в соответствии с ожидаемой семантикой по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-113">ETS resolves this issue by introducing the notion of Adapters that adapt the underlying .NET object to have the expected default semantics.</span></span>
- <span data-ttu-id="aa3b0-114">Некоторые члены объектов .NET имеют неодинаковое имя, предоставляют недостаточный набор открытых членов или предоставляют недостаточные возможности.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-114">Some .NET Object members are inconsistently named, provide an insufficient set of public members, or provide insufficient capability.</span></span> <span data-ttu-id="aa3b0-115">ETS устраняет эту проблему, представляя возможность расширить объект .NET с помощью дополнительных членов.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-115">ETS resolves this issue by introducing the ability to extend the .NET object with additional members.</span></span>

<span data-ttu-id="aa3b0-116">Во-вторых, язык сценариев PowerShell не имеет _типа_ , что переменная не должна объявляться с определенным типом.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-116">Second, the PowerShell scripting language is _typeless_ in that a variable does not need to be declared of a particular type.</span></span> <span data-ttu-id="aa3b0-117">Это значит, что переменные, создаваемые разработчиком скрипта, относятся к _типу_сущности.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-117">That is, the variables a script developer creates are by nature _typeless_.</span></span> <span data-ttu-id="aa3b0-118">Однако система PowerShell называется «управляемой на основе типов» в том, что она зависит от наличия имени типа для выполнения базовых операций, таких как вывод результатов или сортировка.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-118">However, the PowerShell system is "type-driven" in that it depends on having a type name to operate against for basic operations such as outputting results or sorting.</span></span>

<span data-ttu-id="aa3b0-119">Поэтому разработчик скриптов должен иметь возможность указать тип одной из своих переменных и создать собственный набор динамически типизированных объектов, которые содержат свойства и методы и могут участвовать в системе на основе типов.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-119">Therefore a script developer must have the ability to state the type of one of their variables and build up their own set of dynamically typed "objects" that contain properties and methods and can participate in the type-driven system.</span></span> <span data-ttu-id="aa3b0-120">ETS решает эту проблему, предоставляя общий объект для языка сценариев, который имеет возможность динамического состояния своего типа и динамически добавлять элементы.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-120">ETS solves this problem by providing a common object for the scripting language that has the ability to state its type dynamically and to add members dynamically.</span></span>

<span data-ttu-id="aa3b0-121">По сути, ETS устраняет проблему, упомянутую ранее, предоставляя объект **PSObject** , который выступает в качестве основы для доступа к объектам из языка сценариев и предоставляет стандартную абстракцию для разработчика командлетов.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-121">Fundamentally, ETS resolves the issue mentioned previously by providing the **PSObject** object, which acts as the basis of all object access from the scripting language and provides a standard abstraction for the cmdlet developer.</span></span>

### <a name="cmdlet-developers"></a><span data-ttu-id="aa3b0-122">Разработчики командлетов</span><span class="sxs-lookup"><span data-stu-id="aa3b0-122">Cmdlet Developers</span></span>

<span data-ttu-id="aa3b0-123">Для разработчиков командлетов ETS предоставляет следующую поддержку:</span><span class="sxs-lookup"><span data-stu-id="aa3b0-123">For the cmdlet developers, ETS provides the following support:</span></span>

- <span data-ttu-id="aa3b0-124">Абстракции для работы с объектами в универсальном виде с помощью объекта **PSObject** .</span><span class="sxs-lookup"><span data-stu-id="aa3b0-124">The abstractions to work against objects in a generic way using the **PSObject** object.</span></span> <span data-ttu-id="aa3b0-125">ETS также позволяет детализировать предыдущие абстракции, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-125">ETS also provides the ability to drill past these abstractions if required.</span></span>
- <span data-ttu-id="aa3b0-126">Механизмы создания поведения по умолчанию для форматирования, сортировки, сериализации и других системных манипуляций с типом объектов, используя хорошо известный набор расширенных элементов.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-126">The mechanisms to create a default behavior for formatting, sorting, serialization, and other system manipulations of their object type using a well-known set of extended members.</span></span>
- <span data-ttu-id="aa3b0-127">Средства для работы с любым объектом с использованием той же семантики, что и язык скрипта, использующего объект LanguagePrimitives.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-127">The means to operate against any object using the same semantics as the script language using a LanguagePrimitives object.</span></span>
- <span data-ttu-id="aa3b0-128">Средства для динамического "типа" хэш-таблицы, чтобы оставшаяся часть системы могла эффективно работать с ней.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-128">The means to dynamically "type" a hash table so that the rest of the system can operate against it effectively.</span></span>

### <a name="script-developers"></a><span data-ttu-id="aa3b0-129">Разработчики скриптов</span><span class="sxs-lookup"><span data-stu-id="aa3b0-129">Script Developers</span></span>

<span data-ttu-id="aa3b0-130">Для разработчиков скриптов ETS предоставляет следующую поддержку:</span><span class="sxs-lookup"><span data-stu-id="aa3b0-130">For the script developers, ETS provides the following support:</span></span>

- <span data-ttu-id="aa3b0-131">Возможность ссылаться на любой базовый тип объекта с помощью того же синтаксиса ( `$a.x` ).</span><span class="sxs-lookup"><span data-stu-id="aa3b0-131">The ability to reference any underlying object type using the same syntax (`$a.x`).</span></span>
- <span data-ttu-id="aa3b0-132">Возможность доступа за пределами абстракции, предоставляемой объектом **PSObject** (например, доступ только к адаптированным элементам или доступ к самому базовому объекту).</span><span class="sxs-lookup"><span data-stu-id="aa3b0-132">The ability to access beyond the abstraction provided by the **PSObject** object (such as accessing only adapted members, or accessing the base object itself).</span></span>
- <span data-ttu-id="aa3b0-133">Возможность определять хорошо известные члены, управляющие форматированием, сортировкой, сериализацией и другими манипуляциями экземпляра или типа объекта.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-133">The ability to define well-known members that control the formatting, sorting, serialization, and other manipulations of an object instance or type.</span></span>
- <span data-ttu-id="aa3b0-134">Средства для именования объекта в качестве определенного типа и, таким образом, управляют наследованием его членов на основе типа.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-134">The means to name an object as a specific type and thus control the inheritance of its type-based members.</span></span>
- <span data-ttu-id="aa3b0-135">Возможность добавлять, удалять и изменять расширенные члены.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-135">The ability to add, remove, and modify extended members.</span></span>
- <span data-ttu-id="aa3b0-136">Возможность управлять самим объектом **PSObject** , если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-136">The ability to manipulate the **PSObject** object itself if required.</span></span>

## <a name="the-psobject-class"></a><span data-ttu-id="aa3b0-137">Класс PSObject</span><span class="sxs-lookup"><span data-stu-id="aa3b0-137">The PSObject class</span></span>

<span data-ttu-id="aa3b0-138">Объект **PSObject** является основанием для доступа ко всем объектам из языка сценариев и предоставляет стандартную абстракцию для разработчика командлета.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-138">The **PSObject** object is the basis of all object access from the scripting language and provides a standard abstraction for the cmdlet developer.</span></span> <span data-ttu-id="aa3b0-139">Он содержит базовый объект (объект .NET) и все члены экземпляров (члены, в частности, расширенные элементы, которые находятся в определенном экземпляре объекта, но не обязательно для других объектов того же типа).</span><span class="sxs-lookup"><span data-stu-id="aa3b0-139">It contains a base-object (a .NET object) and any instance members (members, specifically extended members, that are present on a particular object instance while not necessarily on other objects of the same type).</span></span> <span data-ttu-id="aa3b0-140">В зависимости от типа базового объекта объект **PSObject** может также предоставлять явный и неявный доступ к адаптированным членам, а также к любым расширенным членам на основе типов.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-140">Depending on the type of the base-object, the **PSObject** object might also provide implicit and explicit access to adapted members as well as any type-based extended members.</span></span>

<span data-ttu-id="aa3b0-141">Объект **PSObject** предоставляет следующие механизмы:</span><span class="sxs-lookup"><span data-stu-id="aa3b0-141">The **PSObject** object provides the following mechanisms:</span></span>

- <span data-ttu-id="aa3b0-142">Возможность создания **PSObject** с базовым объектом или без него.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-142">The ability to construct an **PSObject** with or without a base-object.</span></span>
- <span data-ttu-id="aa3b0-143">Возможность доступа ко всем элементам каждого сконструированного объекта **PSObject** через общий алгоритм поиска и возможность переопределения этого алгоритма при необходимости.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-143">The ability to access of all members of each constructed **PSObject** object through a common lookup algorithm and the ability to override that algorithm when required.</span></span>
- <span data-ttu-id="aa3b0-144">Возможность получать и устанавливать имена типов сконструированных объектов **PSObject** таким образом, чтобы скрипты и командлеты могли ссылаться на похожие объекты **PSObject** по одному имени типа, независимо от типа их базового объекта.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-144">The ability to get and set the type-names of the constructed **PSObject** objects so that scripts and cmdlets can reference similar **PSObject** objects by the same type-name, regardless of the type of their base-object.</span></span>

### <a name="how-to-construct-a-psobject"></a><span data-ttu-id="aa3b0-145">Создание типа PSObject</span><span class="sxs-lookup"><span data-stu-id="aa3b0-145">How to Construct a PSObject</span></span>

<span data-ttu-id="aa3b0-146">В следующем списке описаны способы создания объекта **PSObject** .</span><span class="sxs-lookup"><span data-stu-id="aa3b0-146">The following list describes ways to create a **PSObject** object:</span></span>

- <span data-ttu-id="aa3b0-147">При вызове конструктора **PSObject** . #ctor создается новый объект **PSObject** с базовым объектом PSCustomObject.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-147">Calling the **PSObject** .#ctor constructor creates a new **PSObject** object with a base-object of PSCustomObject.</span></span> <span data-ttu-id="aa3b0-148">Базовый объект этого типа указывает, что объект **PSObject** не имеет осмысленного базового объекта.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-148">A base-object of this type indicates that the **PSObject** object has no meaningful base-object.</span></span> <span data-ttu-id="aa3b0-149">Тем не менее объект **PSObject** с этим типом базового объекта предоставляет контейнер свойств, который разработчики командлетов могут найти полезными, добавив расширенные члены.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-149">However, a **PSObject** object with this type of base-object does provide a property bag that cmdlet developers can find helpful by adding extended-members.</span></span>

<span data-ttu-id="aa3b0-150">Разработчики также могут указать тип object-name, который позволяет этому объекту совместно использовать свои расширенные члены с другими объектами **PSObject** с тем же именем типа.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-150">Developers can also specify the object type-name, which allows this object to share its extended-members with other **PSObject** objects of the same type-name.</span></span>

- <span data-ttu-id="aa3b0-151">Вызов конструктора **PSObject** . #ctor (System. Object) создает новый объект **PSObject** с базовым объектом типа System. Object.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-151">Calling the **PSObject** .#ctor(System.Object) constructor creates a new **PSObject** object with a base-object of type System.Object.</span></span>

  <span data-ttu-id="aa3b0-152">В этом случае имя типа для созданного объекта является коллекцией производной иерархии базового объекта.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-152">In this case, the type-name for the created object is a collection of the derivation hierarchy of the base-object.</span></span> <span data-ttu-id="aa3b0-153">Например, имя типа для **PSObject** , которое содержит процессинфо базовый объект, должно включать следующие имена:</span><span class="sxs-lookup"><span data-stu-id="aa3b0-153">For example, the type-name for the **PSObject** that contains a ProcessInfo base-object would include the following names:</span></span>

  - <span data-ttu-id="aa3b0-154">System.Diagnostics.Process</span><span class="sxs-lookup"><span data-stu-id="aa3b0-154">System.Diagnostics.Process</span></span>
  - <span data-ttu-id="aa3b0-155">System. ComponentModel. Component</span><span class="sxs-lookup"><span data-stu-id="aa3b0-155">System.ComponentModel.Component</span></span>
  - <span data-ttu-id="aa3b0-156">System.MarshalByRefObject</span><span class="sxs-lookup"><span data-stu-id="aa3b0-156">System.MarshalByRefObject</span></span>
  - <span data-ttu-id="aa3b0-157">System.Object</span><span class="sxs-lookup"><span data-stu-id="aa3b0-157">System.Object</span></span>

- <span data-ttu-id="aa3b0-158">Вызов **PSObject** . Метод Аспсобжект (System. Object) создает новый объект **PSObject** на основе заданного объекта.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-158">Calling the **PSObject** .AsPSObject(System.Object) method creates a new **PSObject** object based on a supplied object.</span></span>

  <span data-ttu-id="aa3b0-159">Если переданный объект имеет тип System. Object, указанный объект используется в качестве базового объекта для нового объекта **PSObject** .</span><span class="sxs-lookup"><span data-stu-id="aa3b0-159">If the supplied object is of type System.Object, the supplied object is used as the base-object for the new **PSObject** object.</span></span> <span data-ttu-id="aa3b0-160">Если указанный объект уже является объектом **PSObject** , переданный объект возвращается как имеет значение.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-160">If the supplied object is already an **PSObject** object, the supplied object is returned as is.</span></span>

### <a name="base-adapted-and-extended-members"></a><span data-ttu-id="aa3b0-161">Базовые, адаптированные и расширенные члены</span><span class="sxs-lookup"><span data-stu-id="aa3b0-161">Base, adapted, and extended members</span></span>

<span data-ttu-id="aa3b0-162">По сути, ETS использует следующие термины для отображения связи между исходными элементами базового объекта и этими элементами, добавленными PowerShell.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-162">Conceptually, ETS uses the following terms to show the relationship between the original members of the base-object and those members added by PowerShell.</span></span> <span data-ttu-id="aa3b0-163">Дополнительные сведения о конкретных типах элементов, используемых объектом **PSObject** , см. в разделе [класс PSObject](/dotnet/api/system.management.automation.psobject).</span><span class="sxs-lookup"><span data-stu-id="aa3b0-163">For more information about the specific types of members that are used by the **PSObject** object, see [PSObject class](/dotnet/api/system.management.automation.psobject).</span></span>

#### <a name="base-object-members"></a><span data-ttu-id="aa3b0-164">Члены базового объекта</span><span class="sxs-lookup"><span data-stu-id="aa3b0-164">Base-object members</span></span>

<span data-ttu-id="aa3b0-165">Если базовый объект указан при конструировании объектов **PSObject** , то члены базового объекта становятся доступными через свойство Members.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-165">If the base-object is specified when constructing the **PSObject** objects, then the members of the base-object are made available through the Members property.</span></span>

#### <a name="adapted-members"></a><span data-ttu-id="aa3b0-166">Адаптированные члены</span><span class="sxs-lookup"><span data-stu-id="aa3b0-166">Adapted members</span></span>

<span data-ttu-id="aa3b0-167">Если базовый объект является мета-объектом, который содержит данные в универсальном формате, свойства которых описывают их содержащиеся в них данные, ETS адаптирует эти объекты к представлению, которое обеспечивает прямой доступ к данным через адаптированные члены объекта **PSObject** .</span><span class="sxs-lookup"><span data-stu-id="aa3b0-167">When a base-object is a meta-object, one that contains data in a generic fashion whose properties "describe" their contained data, ETS adapts those objects to a view that allows for direct access to the data through adapted members of the **PSObject** object.</span></span> <span data-ttu-id="aa3b0-168">Доступ к адаптированным членам и членам базового объекта осуществляется через свойство Members.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-168">Adapted members and base-object members are accessed through the Members property.</span></span>

#### <a name="extended-members"></a><span data-ttu-id="aa3b0-169">Расширенные члены</span><span class="sxs-lookup"><span data-stu-id="aa3b0-169">Extended members</span></span>

<span data-ttu-id="aa3b0-170">Помимо членов, доступных из базового объекта или этих адаптированных элементов, созданных PowerShell, параметр **PSObject** может также определять расширенные члены, расширяющие исходный базовый объект с дополнительной информацией, полезной в среде сценариев.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-170">In addition to the members made available from the base-object or those adapted members created by PowerShell, an **PSObject** may also define extended members that extend the original base-object with additional information that is useful in the scripting environment.</span></span>

<span data-ttu-id="aa3b0-171">Например, все основные командлеты, предоставляемые PowerShell, такие как командлеты Get-Content и Set-Content, принимают параметр path.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-171">For example, all the core cmdlets provided by PowerShell, such as the Get-Content and Set-Content cmdlets, take a path parameter.</span></span> <span data-ttu-id="aa3b0-172">Чтобы эти командлеты и другие могли работать с объектами различных типов, элемент Path можно добавить к этим объектам, чтобы все они заработали свои данные обычным образом.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-172">To ensure that these cmdlets, and others, can work against objects of different types, a Path member can be added to those objects so that they all state their information in a common way.</span></span> <span data-ttu-id="aa3b0-173">Этот расширенный элемент Path гарантирует, что командлеты будут работать со всеми этими типами, несмотря на то, что в базовом классе может отсутствовать элемент пути.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-173">This extended Path member ensures that the cmdlets can work against all those types even though there base class might not have a Path member.</span></span>

<span data-ttu-id="aa3b0-174">Доступ к расширенным членам, адаптированным членам и членам базового объекта осуществляется через свойство Members.</span><span class="sxs-lookup"><span data-stu-id="aa3b0-174">Extended members, adapted members, and base-object members are all accessed through the Members property.</span></span>
