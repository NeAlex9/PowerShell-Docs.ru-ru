---
ms.date: 05/22/2020
keywords: powershell,командлет
title: Что такое PowerShell?
description: В этой статье представлены общие сведения о среде сценариев PowerShell и ее возможностях.
ms.openlocfilehash: 91fc580af9a3adf43a24c40b4aaf3f1843882705
ms.sourcegitcommit: 9080316e3ca4f11d83067b41351531672b667b7a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/24/2020
ms.locfileid: "92500782"
---
# <a name="what-is-powershell"></a>Что такое PowerShell?

PowerShell — это кроссплатформенная система для автоматизации задач и управления конфигурацией, состоящая из оболочки командной строки и языка сценариев. В отличие от большинства оболочек, которые принимают и возвращают текст, PowerShell построена на основе общеязыковой среды выполнения (CLR) .NET и принимает и возвращает объекты .NET. Это фундаментальное отличие, которое подразумевает использование совершенно новых средств и методов автоматизации.

<!-- removing images until we can get replacements
:::row:::
   :::column span="":::
      Windows
      [![PowerShell on Windows](media/overview/windows-desktop-660.gif)](media/overview/windows-desktop.gif#lightbox)
      [Install on Windows](install/installing-powershell-core-on-windows.md)
   :::column-end:::
   :::column span="":::
      Linux
      [![PowerShell on Linux](media/overview/linux-desktop-660.gif)](media/overview/linux-desktop.gif#lightbox)
      [Install on Linux](install/installing-powershell-core-on-linux.md)
   :::column-end:::
   :::column span="":::
      macOS
      [![PowerShell on macOS](media/overview/macos-desktop-660.gif)](media/overview/macos-desktop.gif#lightbox)
      [Install on macOS](install/installing-powershell-core-on-macos.md)
   :::column-end:::
:::row-end:::
-->

## <a name="output-is-object-based"></a>Выходные данные являются объектно-ориентированными

В отличие от средств распространенных интерфейсов командной строки командлеты PowerShell предназначены для работы с объектами.
Объект — это не просто набор отображаемых на экране символов, а структурированные данные. Выходные данные команды всегда содержат дополнительную информацию, которую при необходимости можно использовать.

Если раньше вы использовали средства обработки текста для работы с данными, вы поймете, что в PowerShell они применяются иначе. В большинстве случаев для получения определенных сведений средства обработки текста не нужны. Стандартный синтаксис объекта PowerShell позволяет получить прямой доступ к фрагментам данных.

## <a name="the-command-family-is-extensible"></a>Семейство команд является расширяемым

Такие интерфейсы, как `cmd.exe`, не позволяют расширять набор встроенных команд напрямую. Вы можете создавать внешние программы командной строки, выполняемые в `cmd.exe`. Но у этих внешних программ нет служб, таких как интеграция справки. Интерфейс `cmd.exe` не будет автоматически знать, что эти внешние программы являются действительными командами.

Команды в PowerShell называются _командлетами_ . Каждый командлет можно применять отдельно, но наиболее эффективным является их совместное использование для выполнения сложных задач. Как и многие другие оболочки, PowerShell предоставляет доступ к файловой системе на компьютере. _Поставщики_ PowerShell позволяют обращаться к другим хранилищам данных, например к реестру и хранилищам сертификатов, так же легко, как и к файловой системе.

Вы можете создавать собственные командлеты и модули функций, используя сценарии или скомпилированный код. Модули могут добавлять командлеты и поставщики в оболочку. PowerShell также поддерживает сценарии, аналогичные сценариям оболочки UNIX и пакетным файлам `cmd.exe`.

## <a name="support-for-command-aliases"></a>Поддержка псевдонимов команд.

PowerShell поддерживает псевдонимы для вызова команд с помощью альтернативных имен. Благодаря наличию псевдонимов пользователи с опытом работы с другими оболочками могут использовать уже известные им распространенные имена команд для выполнения схожих операций в PowerShell.

Механизм псевдонимов заключается в связывании нового имени с определенной командой. Например, в PowerShell есть внутренняя функция с именем `Clear-Host`, которая очищает командное окно. Вы можете ввести в командной строке псевдоним `cls` или `clear`. PowerShell интерпретирует эти псевдонимы и запускает функцию `Clear-Host`.

Это помогает пользователям изучать PowerShell. Большинство пользователей `cmd.exe` и Unix применяют большой репертуар команд, которые они уже помнят наизусть. Их эквиваленты в PowerShell могут возвращать отличающиеся результаты. Но эти результаты достаточно схожи, чтобы пользователи могли работать, не зная имя соответствующей команды PowerShell. Другой трудностью при освоении новой командной оболочки является "мышечная память". Если вы много лет использовали `cmd.exe`, вы можете по привычке ввести команду `cls` для очистки экрана. Если псевдоним для `Clear-Host` не настроен, вы получите сообщение об ошибке и не будете знать, как очистить экран.

## <a name="powershell-handles-console-input-and-display"></a>PowerShell обрабатывает ввод и отображение данных в консоли

Когда вы вводите команду, PowerShell всегда обрабатывает входные данные командной строки напрямую. PowerShell также форматирует выходные данные, отображаемые на экране. Это важно, так как нагрузка, требуемая для обработки каждого командлета, сокращается, и действия выполняются аналогичным образом независимо от используемого командлета. Разработчикам командлетов не нужно писать код для синтаксического анализа аргументов командной строки или форматирования выходных данных.

Традиционные программы командной строки используют собственные схемы для запроса и отображения справки. Некоторые программы командной строки используют `/?` для показа справки, а другие используют `-?`, `/H` или даже `//`. Некоторые отображают справку в окне графического пользовательского интерфейса, а не в окне консоли. Если введен неправильный параметр, средство может проигнорировать ошибку и автоматически начать выполнение задачи.
Поскольку PowerShell автоматически анализирует и обрабатывает командную строку, параметр `-?` всегда означает "показать справку по этой команде".

> [!NOTE]
> Когда вы запускаете в PowerShell графическое приложение, для него открывается окно.
> PowerShell вмешивается в процесс только при обработке заданных вами в командной строке входных данных или при возврате выходных данных приложения в окно консоли. На внутреннюю работу приложения система не влияет.

## <a name="powershell-has-a-pipeline"></a>PowerShell включает конвейер

Пожалуй, конвейеры являются наиболее полезной концепцией в интерфейсах командной строки. При правильном использовании конвейеры упрощают работу со сложными командами и отслеживание потока выполнения. Каждая команда в конвейере передает свои выходные данные, элемент за элементом, следующей команде. Команды обрабатывают только один объект за раз. Это снижает потребление ресурсов и позволяет получать выходные данные немедленно.

Эта нотация конвейера похожа на нотацию, которая используется в других оболочках. На первый взгляд не совсем понятно, чем отличаются конвейеры в PowerShell. Хотя вы видите на экране текст, PowerShell передает по конвейеру между командами не текст, а объекты.

Например, вы можете использовать командлет `Out-Host` для принудительного постраничного отображения выходных данных из другой команды. На экране эти данные будут показаны как обычный текст, разбитый на страницы:

```powershell
Get-ChildItem | Out-Host -Paging
```

```Output
    Directory: /mnt/c/Git/PS-Docs/PowerShell-Docs/reference/7.0/Microsoft.PowerShell.Core

Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d----          05/22/2020    08:30                About
-----          05/20/2020    14:36           9044 Add-History.md
-----          05/20/2020    14:36          12227 Clear-History.md
-----          05/20/2020    14:36           3566 Clear-Host.md
-----          05/20/2020    14:36          29087 Connect-PSSession.md
-----          05/20/2020    14:36           5705 Debug-Job.md
-----          05/20/2020    14:36           3515 Disable-ExperimentalFeature.md
-----          05/20/2020    14:36          25531 Disable-PSRemoting.md
-----          05/20/2020    14:36           7852 Disable-PSSessionConfiguration.md
-----          05/20/2020    14:36          25355 Disconnect-PSSession.md
-----          05/20/2020    14:36           3491 Enable-ExperimentalFeature.md
-----          05/20/2020    14:36          13310 Enable-PSRemoting.md
-----          05/20/2020    14:36           8401 Enable-PSSessionConfiguration.md
-----          05/20/2020    14:36           9531 Enter-PSHostProcess.md
...
<SPACE> next page; <CR> next line; Q quit
```

Разбиение на страницы также снижает потребление ресурсов ЦП, так обработку продолжает командлет `Out-Host`, когда он получает всю страницу для отображения. Командлет, стоящий в конвейере выше, приостанавливает выполнение, пока не будет готова следующая страница выходных данных.

### <a name="objects-in-the-pipeline"></a>Объекты в конвейере

При запуске командлета в PowerShell вы видите выходные данные в виде текста — именно так в окне консоли и должны отображаться объекты. В текстовом представлении могут отображаться не все свойства выводимого объекта.

Например, рассмотрим командлет `Get-Location`. Эти выходные данные в виде текста содержат сводную информацию, а не полное представление объекта, возвращаемого командлетом `Get-Location`. Процесс, который форматирует данные для отображения на экране, добавляет к выходным данным заголовок.

```powershell
Get-Location
```

```Output
Path
----
C:\
```

При передаче выходных данных по конвейеру в командлет `Get-Member` отображаются сведения об объекте, возвращаемом `Get-Location`.

```powershell
Get-Location | Get-Member
```

```Output
   TypeName: System.Management.Automation.PathInfo

Name         MemberType Definition
----         ---------- ----------
Equals       Method     bool Equals(System.Object obj)
GetHashCode  Method     int GetHashCode()
GetType      Method     type GetType()
ToString     Method     string ToString()
Drive        Property   System.Management.Automation.PSDriveInfo Drive {get;}
Path         Property   string Path {get;}
Provider     Property   System.Management.Automation.ProviderInfo Provider {get;}
ProviderPath Property   string ProviderPath {get;}
```

Командлет `Get-Location` возвращает объект **PathInfo** , который содержит текущий путь и другие сведения.

## <a name="built-in-help-system"></a>Встроенная система справки

PowerShell включает подробные справочные статьи, подобные `man`-страницам Unix, которые поясняют понятия PowerShell и синтаксис команд. Эти статьи можно отобразить в командной строке с помощью командлета [Get-Help][] или открыть в актуальной версии документации PowerShell в Интернете.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о PowerShell см. в разделе **Изучение PowerShell** этого сайта.

<!-- link references -->

[Get-Help]: /powershell/module/microsoft.powershell.core/Get-Help
