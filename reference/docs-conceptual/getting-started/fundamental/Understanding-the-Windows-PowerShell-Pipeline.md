---
ms.date: 06/05/2017
keywords: powershell,командлет
title: Общие сведения о конвейере Windows PowerShell
ms.assetid: 6be50926-7943-4ef7-9499-4490d72a63fb
ms.openlocfilehash: c3f1d17432cf3a77c0f5ecae137a4233a28a19d7
ms.sourcegitcommit: cf195b090b3223fa4917206dfec7f0b603873cdf
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2018
ms.locfileid: "30951075"
---
# <a name="understanding-the-windows-powershell-pipeline"></a>Общие сведения о конвейере Windows PowerShell
Конвейер участвует в работе практически всех аспектов Windows PowerShell. Хотя вы видите текст на экране, Windows PowerShell не передает текст между командами. Вместо этого он передает объекты.

Нотация, используемая для конвейеров, аналогична нотации в других оболочках, поэтому на первый взгляд нововведения Windows PowerShell могут остаться незамеченными. Например, если вы используете командлет **Out-Host** для принудительного постраничного отображения выходных данных из другой команды, на экране они имеют вид обычного текста, разбитого на страницы.

```
PS> Get-ChildItem -Path C:\WINDOWS\System32 | Out-Host -Paging

    Directory: Microsoft.Windows PowerShell.Core\FileSystem::C:\WINDOWS\system32

Mode                LastWriteTime     Length Name
----                -------------     ------ ----
-a---        2005-10-22  11:04 PM        315 $winnt$.inf
-a---        2004-08-04   8:00 AM      68608 access.cpl
-a---        2004-08-04   8:00 AM      64512 acctres.dll
-a---        2004-08-04   8:00 AM     183808 accwiz.exe
-a---        2004-08-04   8:00 AM      61952 acelpdec.ax
-a---        2004-08-04   8:00 AM     129536 acledit.dll
-a---        2004-08-04   8:00 AM     114688 aclui.dll
-a---        2004-08-04   8:00 AM     194048 activeds.dll
-a---        2004-08-04   8:00 AM     111104 activeds.tlb
-a---        2004-08-04   8:00 AM       4096 actmovie.exe
-a---        2004-08-04   8:00 AM     101888 actxprxy.dll
-a---        2003-02-21   6:50 PM     143150 admgmt.msc
-a---        2006-01-25   3:35 PM      53760 admparse.dll
<SPACE> next page; <CR> next line; Q quit
...
```

Команду Out-Host -Paging удобно использовать при наличии длинных выходных данных, которые нужно отображать медленно. Это особенно полезно, если операция потребляет много ресурсов ЦП. Так как обработка передается в командлет Out-Host, когда в нем готова целая страница для отображения, командлеты, расположенные перед ним в конвейере, прекращают работу, пока не станет доступна следующая страница выходных данных. Это можно увидеть, используя диспетчер задач Windows для наблюдения за использованием Windows PowerShell ЦП и памяти.

Выполните следующую команду: **Get-ChildItem C:\\Windows -Recurse**. Сравните использование ЦП и памяти с этой командой: **Get-ChildItem C:\\Windows -Recurse | Out-Host -Paging**. На экране отображается текст, однако это вызвано тем, что объекты в окне консоли необходимо представлять в виде текста. Это просто представление того, что действительно происходит внутри Windows PowerShell. Рассмотрим, например, командлет Get-Location. Если ввести **Get-Location**, когда текущим расположением является корень диска C, отображаются следующие выходные данные:

```
PS> Get-Location

Path
----
C:\
```

Если Windows PowerShell передал текст по конвейеру, при выполнении такой команды, как **Get-Location | Out-Host**, из **Get-Location** в **Out-Host** передается набор знаков в порядке их отображения на экране. Другими словами, если бы вы пропустили информацию заголовка, **Out-Host** сначала получает знак "**C"**, затем знак "**:"**, а затем знак "**\\"**. Командлет **Out-Host** не может определить, какое значение следует сопоставить с выходными знаками командлета **Get-Location**.

Для взаимодействия команд в конвейере Windows PowerShell использует объекты, а не текст. С точки зрения пользователя объекты упаковывают связанные данные в форму, которая упрощает обработку информации единым блоком и извлечение нужных элементов.

Команда **Get-Location** не возвращает текст, содержащий текущий путь. Она возвращает пакет данных, называемый объектом **PathInfo**, который содержит текущий путь и другую информацию. После этого командлет **Out-Host** отправляет объект **PathInfo** на экран, а Windows PowerShell решает, какие сведения и каким образом следует отобразить, основываясь на правилах форматирования.

На самом деле выходные данные заголовка из командлета **Get-Location** добавляются только в конце процесса — во время форматирования данных для вывода на экран. На экране отображаются сводные сведения, а не полное представление выходного объекта.

Учитывая, что команда Windows PowerShell может выводить больше сведений, чем отображается в окне консоли, как можно получить непоказанные элементы? Как просмотреть дополнительные данные? И что делать, если требуется просмотреть данные в формате, отличном от стандартного для Windows PowerShell?

В оставшейся части этой главы описано, как определить структуру конкретных объектов Windows PowerShell, выбирая определенные элементы и форматируя их для упрощения отображения, и как отправить эти сведения в альтернативные расположения вывода, такие как файлы и принтеры.