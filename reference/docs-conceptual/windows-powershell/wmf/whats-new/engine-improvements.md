---
ms.date: 06/12/2017
ms.topic: conceptual
keywords: wmf,powershell,установка
title: Усовершенствования подсистемы PowerShell в WMF 5.1
ms.openlocfilehash: cccfcf8872ac60e0902669bcc797d0ed250317ba
ms.sourcegitcommit: 2aec310ad0c0b048400cb56f6fa64c1e554c812a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/23/2020
ms.locfileid: "83808940"
---
# <a name="powershell-engine-improvements"></a>Усовершенствования подсистемы PowerShell

В WMF 5.1 были реализованы перечисленные ниже улучшения основной подсистемы PowerShell.

## <a name="performance"></a>Производительность

Производительность улучшена в некоторых важных аспектах:

- Запуск
- Передача данных по конвейеру в такие командлеты, как `ForEach-Object` и `Where-Object`, выполняется примерно на 50 % быстрее.

Примеры некоторых улучшений (результаты могут различаться в зависимости от оборудования):

| Сценарий | Время в версии 5.0 (мс) | Время в версии 5.1 (мс) |
| -------- | :---------------: | :---------------: |
| `powershell -command "echo 1"` | 900 | 250 |
| Самый первый запуск PowerShell: `powershell -command "Unknown-Command"` | 30 000 | 13 000 |
| Построение кэша анализа команд: `powershell -command "Unknown-Command"` | 7000 | 520 |
| <code>1..1000000 &#124; % { }</code> | 1400 | 750 |

> [!NOTE]
> Одно из изменений, связанных с запуском, может повлиять на некоторые неподдерживаемые сценарии. PowerShell больше не считывает файлы `$pshome\*.ps1xml` — эти файлы были преобразованы в C# во избежание накладных расходов (файловых и ресурсов ЦП), связанных с обработкой XML-файлов. Эти файлы по-прежнему существуют для поддержки параллельно установленной версии 2, поэтому изменение их содержимого сказывается только на версии 2, но не на версии 5. Обратите внимание на то, что изменение содержимого этих файлов никогда не поддерживалось.

Еще одним явным изменением является то, как PowerShell кэширует экспортируемые команды и другую информацию для модулей, установленных в системе. Ранее этот кэш хранился в каталоге `$env:LOCALAPPDATA\Microsoft\Windows\PowerShell\CommandAnalysis`. В WMF 5.1 этот кэш является отдельным файлом `$env:LOCALAPPDATA\Microsoft\Windows\PowerShell\ModuleAnalysisCache`. Дополнительные сведения см. в статье [Кэш анализа модуля](release-notes.md#module-analysis-cache).
