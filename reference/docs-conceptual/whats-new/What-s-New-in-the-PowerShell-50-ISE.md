---
ms.date: 06/05/2017
keywords: powershell,командлет
title: Новые возможности интегрированной среды сценариев PowerShell версии 5.0
ms.assetid: 38648d47-7c27-4b37-a40e-ad29948519c2
ms.openlocfilehash: 35b825cfa6ea720d0af3537c5d1b16c5ececb701
ms.sourcegitcommit: cf195b090b3223fa4917206dfec7f0b603873cdf
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2018
ms.locfileid: "30953588"
---
# <a name="what39s-new-in-the-windows-powershell-ise"></a>Новые возможности в интегрированной среде сценариев Windows PowerShell
В этой статье описаны новые и обновленные функции, представленные в разных версиях интегрированной среды сценариев Windows PowerShell.

## <a name="feature-description"></a>Описание компонента
Интегрированная среда сценариев Windows PowerShell — это ведущее приложение, позволяющее писать, выполнять и тестировать сценарии и модули в удобной среде с графическим интерфейсом. Такие важные возможности, как цветовая разметка синтаксиса, автозаполнение по нажатию клавиши TAB, визуальная отладка, совместимость с Юникодом и контекстная справка делают работу со сценариями более удобной.

Общие сведения об интегрированной среде сценариев Windows PowerShell см. в статье [Общие сведения об интегрированной среде сценариев Windows PowerShell](https://technet.microsoft.com/library/3c1892c2-bf84-4cb6-af26-1f453be9e671).

## <a name="new-and-changed-functionality-in-windows-powershell-ise"></a>Новые и измененные функции в интегрированной среде сценариев Windows PowerShell
Следующая таблица содержит новые и измененные функции для этого выпуска интегрированной среды сценариев Windows PowerShell в Windows PowerShell.

|Компонент или функция|Интегрированная среда сценариев Windows PowerShell 4.0|Интегрированная среда сценариев Windows PowerShell 3.0|Интегрированная среда сценариев Windows PowerShell 2.0|
|--------------------------|-----------------------------------------------|-----------------------------------------------|-----------------------------------------------|
|**[IntelliSense](#intellisense)**|X|X||
|**[Фрагменты кода](#snippets)**|X|X||
|**[Дополнительные средства](#add-on-tools)**|X|X||
|**[Перезапуск диспетчера и автосохранение](#restart-manager-and-auto-save)**|X|X||
|**[Список недавно использовавшихся элементов](#most-recently-used-list)**|X|X||
|**[Область консоли](#console-pane)**|X|X||
|**[Параметры командной строки](#command-line-switches)**|X|X||
|**[Новые возможности редактора](#new-editor-features)**|X|X||
|**[Новое окно справки](#new-help-viewer-window)**|X|X||
|**[Командлет Show-Command](#show-command-cmdlet)**|X|X||

### <a name="intellisense"></a>IntelliSense
**Добавлен в интегрированной среде сценариев 3.0**

IntelliSense — это средство для автоматического дополнения, являющееся частью интегрированной среды сценариев Windows PowerShell. По мере набора IntelliSense отображает активные меню с подходящими командлетами, параметрами, значениями параметров, файлами и папками.

**Какой эффект дает это изменение?**

С появлением IntelliSense в интегрированной среде сценариев Windows PowerShell стало удобнее находить командлеты и проверять синтаксис при создании сценариев. Интегрированная среда сценариев Windows PowerShell позволяет также изучать Windows PowerShell при создании новых сценариев.

**Что работает иначе?**

При вводе командлетов в интегрированной среде сценариев Windows PowerShell 3.0 или более поздней версии отображается прокручиваемое и активное меню, позволяющее просмотреть и выбрать соответствующие команды.

### <a name="snippets"></a>Фрагменты
**Добавлен в интегрированной среде сценариев 3.0**

*Фрагменты* — это короткие участки кода Windows PowerShell, которые можно легко вставить в сценарии, создаваемые в интегрированной среде сценариев Windows PowerShell. Интегрированная среда сценариев Windows PowerShell включает стандартный набор фрагментов. При работе в интегрированной среде сценариев Windows PowerShell можно добавлять фрагменты кода с помощью командлета **New-Snippet**.

**Какой эффект дает это изменение?**

С помощью фрагментов можно быстро составлять и создавать сценарии для автоматизации среды.

**Что работает иначе?**

Чтобы использовать фрагменты кода в Windows PowerShell 3.0 или более поздней версии, выберите команду **Запустить фрагменты** в меню **Правка** или нажмите сочетание клавиш **CTRL+J**.

### <a name="add-on-tools"></a>Дополнительные средства
**Добавлено в PowerShell 3.0**

Интегрированная среда сценариев Windows PowerShell теперь поддерживает дополнительные компоненты — элементы управления Windows Presentation Foundation (WPF), которые добавляются с помощью объектной модели. Дополнительные компоненты могут отображаться в вертикальной или горизонтальной области внутри консоли. Если область содержит несколько дополнительных средств, они отображаются на вкладках. Можно также добавлять и удалять дополнительные средства сторонних производителей. Дополнительные сведения об импорте и экспорте дополнительных компонентов см. в статье [Операции интегрированной среды сценариев Windows PowerShell](http://technet.microsoft.com/library/cc732148.aspx).

**Какой эффект дает это изменение?**

Дополнительные компоненты позволяют расширить и настроить интегрированную среду сценариев Windows PowerShell с помощью средств, способных улучшить работу со сценариями или добавить в нее функциональные возможности.

**Что работает иначе?**

Интегрированная среда сценариев Windows PowerShell 3.0 и более поздних версий содержит дополнительный компонент **Команды**. Компонент **Команды** позволяет параллельно просматривать командлеты и справку для них в областях **Сценарий** и **Консоль**.

Другие дополнительные средства можно найти с помощью команды **Перейти на сайт дополнительных компонентов** в меню **Дополнительные компоненты**.

### <a name="restart-manager-and-auto-save"></a>Перезапуск диспетчера и автосохранение
**Добавлено в PowerShell 3.0**

Интегрированная среда сценариев Windows PowerShell теперь автоматически сохраняет открытые сценарии в отдельном расположении каждые две минуты.  Если интегрированная среда сценариев Windows PowerShell прекращает работать или перезагружается операционная система, то при повторном запуске интегрированной среды сценариев Windows PowerShell сценарии, открытые во время последнего сеанса, восстанавливаются, даже если они не были сохранены.

Чтобы изменить интервал автоматического сохранения, выполните в области консоли следующую команду: **$psise.Options.AutoSaveMinuteInterval**.

**Какой эффект дает это изменение?**

Теперь в интегрированной среде сценариев Windows PowerShell можно работать, зная, что в случае неожиданной перезагрузки открытые сценарии сохраняются автоматически.

**Что работает иначе?**

Интегрированная среда сценариев Windows PowerShell 2.0 не сохраняет сценарии автоматически в случае перезагрузки.

### <a name="most-recently-used-list"></a>Список недавно использовавшихся элементов
**Добавлено в PowerShell 3.0**

Интегрированная среда сценариев Windows PowerShell теперь содержит список недавно использовавшихся файлов. При открытии файла в интегрированной среде сценариев Windows PowerShell он добавляется в список недавно использованных элементов в меню **Файл**.

Чтобы изменить число файлов в списке недавно использованных элементов, выполните следующую команду в области консоли: **$psise.Options.MruCount**.

**Какой эффект дает это изменение?**

Список недавно использованных элементов упрощает доступ к файлам.

**Что работает иначе?**

В интегрированной среде сценариев Windows PowerShell 2.0 нет списка недавно использованных элементов.

### <a name="console-pane"></a>Область консоли
**Добавлено в PowerShell 3.0**

Области команд и вывода, которые были разделены в первом выпуске интегрированной среды сценариев Windows PowerShell, объединены теперь в одну область консоли. Область консоли аналогична по функциональности и внешнему виду типовой консоли Windows PowerShell, но отличается рядом усовершенствований, которые перечислены ниже (многие из них описаны в этой статье).

- Цветовая разметка синтаксиса вводимого текста (но не выводимого текста), включая синтаксис XML

- IntelliSense

- Соответствие скобок

- Индикация ошибок

- Полная поддержка Юникода

- Контекстная справка по нажатию клавиши **F1**

- Контекстно-зависимая справка командлета Show-Command по нажатию клавиш **CTRL+F1**

- Поддержка наборов сложных знаков и написания справа налево

- Поддержка шрифтов

- Масштабирование

- Режимы выделения строки и блока

- Сохранение введенного содержимого в командной строке при нажатии пользователем клавиши **СТРЕЛКА ВВЕРХ** для просмотра истории в консоли

**Какой эффект дает это изменение?**

Эти изменения в области консоли делают работу со сценариями более согласованной с интерфейсом консоли.

**Что работает иначе?**

Интегрированная среда сценариев Windows PowerShell 2.0 имеет отдельные области команд и вывода.

### <a name="command-line-switches"></a>Параметры командной строки
**Добавлено в PowerShell 3.0**

При запуске интегрированной среды сценариев Windows PowerShell из командной строки (для этого введите **powershell_ise.exe** в командной строке) можно указывать следующие новые параметры.

- *-NoProfile*: запускает интегрированную среду сценариев Windows PowerShell без выполнения **$profile**.

- *-Help*: отображает окно справки.

- *-mta*: интегрированная среда сценариев Windows PowerShell запускается в режиме многопотокового подразделения. По умолчанию для интегрированной среды сценариев Windows PowerShell используется режим однопотокового подразделения (он задается с помощью параметра *-sta*).

**Какой эффект дает это изменение?**

Добавление этих параметров командной строки позволяет управлять средой, в которой выполняется интегрированная среда сценариев Windows PowerShell.

**Что работает иначе?**

Интегрированная среда сценариев Windows PowerShell 2.0 не распознает эти параметры командной строки.

### <a name="new-editor-features"></a>Новые возможности редактора
**Добавлено в PowerShell 3.0**

Другие возможности редактирования в интегрированной среде сценариев Windows PowerShell:

- **Цветовая разметка синтаксиса XML**. Теперь в интегрированной среде сценариев Windows PowerShell синтаксис XML выделяется цветами, как в Windows PowerShell.

- **Парные фигурные скобки**. В интегрированной среде сценариев Windows PowerShell реализованы контроль соответствия и подсветка скобок (например, команда **Перейти к совпадению** или сочетание клавиш **CTRL+]** позволяют найти закрывающую скобку, если выделена открывающая скобка).

- **Режим структуры**. Область сценариев теперь поддерживает режим структуры, который позволяет сворачивать и разворачивать фрагменты кода, щелкая знаки "минус" или "плюс" на левом поле. Обозначить начало и конец сворачиваемого фрагмента кода можно с помощью скобок или тегов **#region** и **#endregion**. Чтобы развернуть или свернуть все области, нажмите сочетание клавиш **CTRL+M**.

- **Перетаскивание текста при правке**. Теперь интегрированная среда сценариев Windows PowerShell поддерживает перетаскивание текста при правке. Можно выбрать любой блок текста и перетащить его в другое место в редакторе или консоли. Если при перетаскивании удерживать нажатой клавишу CTRL, текст копируется в новое расположение. В этой, а также в предыдущей версии интегрированной среды сценариев Windows PowerShell при перетаскивании файла в интегрированную среду сценариев Windows PowerShell этот файл открывается.

- **Отображение ошибок анализа**. Ошибки анализа подчеркиваются красным цветом. При наведении указателя мыши на подчеркнутую ошибку отображается подсказка, поясняющая суть обнаруженной проблемы.

- **Масштаб**. Устанавливать масштаб отображения содержимого консоли в процентах можно с помощью ползунка масштаба (в правом нижнем углу окна интегрированной среды сценариев Windows PowerShell) или путем ввода команды **$psise.options.Zoom** в области консоли.

- **Копирование и вставка форматированного текста**. Теперь при копировании в буфер обмена интегрированной среды сценариев Windows PowerShell сохраняется исходное начертание, размер и цвет шрифта выделенного текста.

- **Выделение блока**. Блок текста можно выделить, удерживая клавишу ALT при выделении текста мышью в области сценариев или нажимая сочетание клавиш **ALT+SHIFT+СТРЕЛКА**.

**Какой эффект дает это изменение?**

Дополнительные возможности редактирования помогают получить более согласованную и эффективную среду редактирования.

**Что работает иначе?**

Эти усовершенствования редактирования отсутствовали в интегрированной среде сценариев Windows PowerShell 2.0.

### <a name="new-help-viewer-window"></a>Новое окно справки
**Добавлено в PowerShell 3.0**

Если нажать клавишу **F1**, когда курсор находится внутри командлета или выделена часть командлета, в новом окне справки откроется контекстная справка по выделенному командлету. Чтобы вывести описательные разделы справки Windows PowerShell, введите команду **operators** в области консоли, а затем нажмите клавишу **F1**.

Прежде чем пользоваться этой функцией, загрузите последнюю версию разделов справки Windows PowerShell с веб-сайта Майкрософт. Разделы справки проще всего скачать, выполнив командлет **Update-Help** в области консоли при запуске интегрированной среды сценариев Windows PowerShell от имени администратора.

Где указать, откуда именно берется справка, вызываемая клавишей **F1**. В разделе **Другие параметры** на вкладке **Общие параметры** в меню **Сервис**/**Параметры** можно установить или снять флажок **Использовать локальную справку вместо справки в Интернете**. Если этот флажок установлен, клиент ищет справку по командлету в скачанных файлах, находящихся в папке модулей.  Если флажок снят, клиент ищет справку в библиотеке TechNet.

**Какой эффект дает это изменение?**

Получение контекстной справки без выхода из командлета или сценария делает обучение более удобным.

**Что работает иначе?**

При нажатии клавиши F1 в предыдущих версиях интегрированной среды сценариев Windows PowerShell открывался файл справки с локального компьютера. В интегрированной среде сценариев Windows PowerShell 3.0 и более поздних версий открывшееся окно содержит справку, поддерживающую поиск и настройку. Это новая справка по интегрированной среде сценариев Windows PowerShell ISE 3.0, в Windows PowerShell 3.0 появилась обновленная справка.

### <a name="show-command-cmdlet"></a>Командлет Show-Command
**Добавлено в PowerShell 3.0**

Командлет **Show-Command** позволяет составить или выполнить командлет или функцию, заполнив графическую форму. Эта форма дает пользователям возможность работать с Windows PowerShell в графической среде. Кроме того, командлет **Show-Command** позволяет опытным программистам быстро создавать графические интерфейсы на основе Windows PowerShell.

**Какой эффект дает это изменение?**

Используя командлет **Show-Command** в сценариях Windows PowerShell, вы можете предоставить пользователям привычную графическую среду. Кроме того, командлет **Show-Command** поможет новичкам освоить Windows PowerShell.

**Что работает иначе?**

Командлет Show-Command появился в версии 3.0 интегрированной среды сценариев Windows PowerShell.

## <a name="see-also"></a>См. также:
Дополнительные сведения об интегрированной среде сценариев в Windows PowerShell см. по следующим ссылкам.

- [Обзор интегрированной среды сценариев Windows PowerShell](../getting-started/fundamental/exploring-the-windows-powershell-ise.md)
- [Интегрированная среда сценариев на вики-сайте TechNet](http://social.technet.microsoft.com/wiki/search/searchresults.aspx?q=ISE)
- [Центр сценариев](http://technet.microsoft.com/scriptcenter/default)