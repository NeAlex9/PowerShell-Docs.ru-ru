---
ms.date: 09/06/2019
keywords: powershell,командлет
title: Новые возможности интегрированной среды сценариев PowerShell 5.0
ms.openlocfilehash: 8f15e99c5a6ae33aeae9bd33eb0cf58fb27e3b90
ms.sourcegitcommit: 6545c60578f7745be015111052fd7769f8289296
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "74416648"
---
# <a name="whats-new-in-the-windows-powershell-50-ise"></a>Новые возможности интегрированной среды сценариев Windows PowerShell 5.0

В этой статье описаны новые и обновленные функции, представленные в версии 5.0 интегрированной среды сценариев (ISE) Windows PowerShell.

> [!NOTE]
> Функции для ISE PowerShell больше не разрабатываются. Как компонент доставки Windows эта среда по-прежнему официально поддерживается для внесения наиболее важных исправлений, связанных с безопасностью и обслуживанием.
> Пока что мы не планируем удалять ISE из Windows.
>
> ISE не поддерживается в PowerShell версии 6 и более поздних версиях. Пользователям, которые ищут замену ISE, следует использовать [Visual Studio Code](https://code.visualstudio.com/) с расширением [PowerShell](https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell).

## <a name="feature-description"></a>Описание компонента

Интегрированная среда сценариев Windows PowerShell — это ведущее приложение, позволяющее писать, выполнять и тестировать сценарии и модули в удобной среде с графическим интерфейсом. Такие важные возможности, как цветовая разметка синтаксиса, автозаполнение по нажатию клавиши TAB, визуальная отладка, совместимость с Юникодом и контекстная справка делают работу со сценариями более удобной.

Дополнительные сведения см. в обзорной статье об [интегрированной среде сценариев Windows PowerShell](../components/ise/Introducing-the-Windows-PowerShell-ISE.md).

Следующая таблица содержит новые и измененные функции для этого выпуска интегрированной среды сценариев Windows PowerShell в Windows PowerShell.

## <a name="intellisense"></a>технология IntelliSense

> Добавлен в интегрированной среде сценариев 3.0

IntelliSense — это средство для автоматического дополнения, являющееся частью интегрированной среды сценариев Windows PowerShell.
По мере набора IntelliSense отображает активные меню с подходящими командлетами, параметрами, значениями параметров, файлами и папками.

**Какой эффект дает это изменение?**

С появлением IntelliSense в интегрированной среде сценариев Windows PowerShell стало удобнее находить командлеты и проверять синтаксис при создании скриптов. Интегрированная среда сценариев Windows PowerShell позволяет также изучать Windows PowerShell при создании новых сценариев.

**Что работает иначе?**

При вводе командлетов в интегрированной среде сценариев Windows PowerShell отображается прокручиваемое и активное меню, позволяющее просматривать и выбирать соответствующие команды.

## <a name="snippets"></a>Фрагменты кода

> Добавлен в интегрированной среде сценариев 3.0

*Фрагменты* — это короткие участки кода Windows PowerShell, которые можно легко вставить в сценарии, создаваемые в интегрированной среде сценариев Windows PowerShell. Интегрированная среда сценариев Windows PowerShell включает стандартный набор фрагментов. При работе в интегрированной среде сценариев Windows PowerShell можно добавлять фрагменты кода с помощью командлета `New-Snippet`.

**Какой эффект дает это изменение?**

С помощью фрагментов можно быстро составлять и создавать сценарии для автоматизации среды.

**Что работает иначе?**

Чтобы использовать фрагменты кода в Windows PowerShell версии 3.0 и выше, щелкните **Запустить фрагменты** в меню **Правка** или нажмите клавиши <kbd>CTRL</kbd>+<kbd>J</kbd>.

## <a name="add-on-tools"></a>Дополнительные средства

> Добавлено в PowerShell 3.0

Интегрированная среда сценариев Windows PowerShell теперь поддерживает надстройки с использованием объектной модели. Эти надстройки являются элементами управления Windows Presentation Foundation (WPF), отображаемыми в консоли виде вертикальной или горизонтальной панели. Если область содержит несколько дополнительных средств, они отображаются на вкладках. Можно также добавлять и удалять дополнительные средства сторонних производителей. Дополнительные сведения см. в статье о [предназначении объектной модели интегрированной среды сценариев Windows PowerShell](../components/ise/object-model/Purpose-of-the-Windows-PowerShell-ISE-Scripting-Object-Model.md).

**Какой эффект дает это изменение?**

Дополнительные компоненты позволяют расширить и настроить интегрированную среду сценариев Windows PowerShell с помощью средств для оптимизации работы со скриптами.

**Что работает иначе?**

Интегрированная среда сценариев Windows PowerShell 3.0 и более поздних версий содержит дополнительный компонент **Команды**. Компонент **Команды** позволяет параллельно просматривать командлеты и справку для них в областях **Сценарий** и **Консоль**.

Другие дополнительные средства можно найти с помощью команды **Перейти на сайт дополнительных компонентов** в меню **Дополнительные компоненты**.

## <a name="restart-manager-and-auto-save"></a>Перезапуск диспетчера и автосохранение

> Добавлено в PowerShell 3.0

Интегрированная среда сценариев Windows PowerShell теперь автоматически сохраняет открытые сценарии в отдельном расположении каждые две минуты. При перезагрузке или перезапуске интегрированной среды сценариев Windows PowerShell после аварийного завершения работы скрипты, которые были открыты в предыдущем сеансе, восстанавливаются, даже если они не были сохранены.

Чтобы изменить интервал автоматического сохранения, в консоли выполните команду `$psise.Options.AutoSaveMinuteInterval`.

**Какой эффект дает это изменение?**

Теперь в интегрированной среде сценариев Windows PowerShell можно работать, зная, что открытые скрипты сохраняются автоматически.

**Что работает иначе?**

В интегрированной среде сценариев Windows PowerShell 2.0 скрипты не сохраняются автоматически.

## <a name="most-recently-used-list"></a>Список недавно использовавшихся элементов

> Добавлено в PowerShell 3.0

Интегрированная среда сценариев Windows PowerShell теперь содержит список недавно использовавшихся файлов. При открытии файла в интегрированной среде сценариев Windows PowerShell он добавляется в список недавно использованных элементов в меню **Файл**.

Чтобы изменить число файлов в списке недавно использованных элементов, в консоли выполните команду `$psise.Options.MruCount`.

**Какой эффект дает это изменение?**

Список недавно использованных элементов упрощает доступ к файлам.

**Что работает иначе?**

В интегрированной среде сценариев Windows PowerShell 2.0 нет списка недавно использованных элементов.

## <a name="console-pane"></a>Область консоли

> Добавлено в PowerShell 3.0

Области команд и вывода, которые были разделены в первом выпуске интегрированной среды сценариев Windows PowerShell, объединены теперь в одну область консоли. Область консоли аналогична по функциональности и внешнему виду стандартной консоли Windows PowerShell, но отличается рядом усовершенствований, которые перечислены ниже.

- Цветовая разметка синтаксиса вводимого текста (но не выводимого текста), включая синтаксис XML
- технология IntelliSense
- Соответствие скобок
- Индикация ошибок
- Полная поддержка Юникода
- Контекстная справка по нажатию клавиши <kbd>F1</kbd>
- Контекстно-зависимая справка командлета Show-Command, вызываемая с помощью клавиш <kbd>CTRL</kbd>+<kbd>F1</kbd>.
- Поддержка наборов сложных знаков и написания справа налево
- Поддержка шрифтов
- Zoom
- Режимы выделения строки и блока
- Сохранение введенного содержимого в командной строке с помощью клавиши <kbd>СТРЕЛКА ВВЕРХ</kbd> для просмотра истории в консоли.

**Какой эффект дает это изменение?**

Эти изменения в области консоли делают работу со сценариями более согласованной с интерфейсом консоли.

**Что работает иначе?**

Интегрированная среда сценариев Windows PowerShell 2.0 имеет отдельные области команд и вывода.

## <a name="command-line-switches"></a>Параметры командной строки

> Добавлено в PowerShell 3.0

При запуске интегрированной среды сценариев Windows PowerShell из командной строки (для этого введите **powershell_ise.exe** в командной строке) можно указывать следующие новые параметры.

- `-NoProfile`: запускает интегрированную среду сценариев Windows PowerShell без выполнения `$profile`.
- `-Help`: отображает окно справки.
- `-mta`: интегрированная среда сценариев Windows PowerShell запускается в режиме многопотокового подразделения. По умолчанию для интегрированной среды сценариев Windows PowerShell используется режим однопоточного подразделения (он задается с помощью параметра `-sta`).

**Какой эффект дает это изменение?**

Добавление этих параметров командной строки позволяет управлять средой, в которой выполняется интегрированная среда сценариев Windows PowerShell.

**Что работает иначе?**

Интегрированная среда сценариев Windows PowerShell 2.0 не распознает эти параметры командной строки.

## <a name="new-editor-features"></a>Новые возможности редактора

> Добавлено в PowerShell 3.0

Другие возможности редактирования в интегрированной среде сценариев Windows PowerShell:

- **Цветовая разметка синтаксиса XML**. Теперь в интегрированной среде сценариев Windows PowerShell синтаксис XML выделяется цветами, как в Windows PowerShell.
- **Парные фигурные скобки**. В интегрированной среде сценариев Windows PowerShell реализованы контроль соответствия и подсветка скобок (например, команда **Перейти к совпадению** или клавиши <kbd>CTRL</kbd>+<kbd>]</kbd> позволяют найти закрывающую скобку, если выделена открывающая скобка).
- **Режим структуры**. Область сценариев теперь поддерживает режим структуры, который позволяет сворачивать и разворачивать фрагменты кода, щелкая знаки "минус" или "плюс" на левом поле. Обозначить начало и конец сворачиваемого фрагмента кода можно с помощью скобок или тегов `#region` и `#endregion`. Чтобы развернуть или свернуть все области, нажмите клавиши <kbd>CTRL</kbd>+<kbd>M</kbd>.
- **Перетаскивание текста при правке**. Теперь интегрированная среда сценариев Windows PowerShell поддерживает перетаскивание текста при правке. Можно выбрать любой блок текста и перетащить его в другое место в редакторе или консоли. Если при перетаскивании удерживать нажатой клавишу <kbd>CTRL</kbd>, текст копируется в новое расположение. В этой версии интегрированной среды сценариев Windows PowerShell при перетаскивании файла в интегрированную среду сценариев Windows PowerShell этот файл открывается.
- **Отображение ошибок анализа**. Ошибки анализа подчеркиваются красным цветом. При наведении указателя мыши на подчеркнутую ошибку отображается подсказка, поясняющая суть обнаруженной проблемы.
- **Масштаб**. Устанавливать масштаб отображения содержимого консоли в процентах можно с помощью соответствующего ползунка (в правом нижнем углу окна интегрированной среды сценариев Windows PowerShell) или команды `$psise.options.Zoom` в области консоли.
- **Копирование и вставка форматированного текста**. Теперь при копировании в буфер обмена интегрированной среды сценариев Windows PowerShell сохраняется исходное начертание, размер и цвет шрифта выделенного текста.
- **Выделение блока**. Можно выделить блок текста, удерживая клавишу <kbd>ALT</kbd> при выделении текста мышью в области сценариев или нажимая клавиши <kbd>ALT</kbd>+<kbd>SHIFT</kbd>+<kbd>СТРЕЛКА</kbd>.

**Какой эффект дает это изменение?**

Дополнительные возможности редактирования помогают получить более согласованную и эффективную среду редактирования.

**Что работает иначе?**

Эти усовершенствования редактирования отсутствовали в интегрированной среде сценариев Windows PowerShell 2.0.

## <a name="new-help-viewer-window"></a>Новое окно справки

> Добавлено в PowerShell 3.0

Если нажать клавишу <kbd>F1</kbd>, когда курсор находится внутри командлета или выделена часть командлета, в новом окне справки откроется контекстная справка по выделенному командлету. Чтобы вывести раздел справки **О программе** в Windows PowerShell, введите команду `operators` в области консоли, а затем нажмите клавишу <kbd>F1</kbd>.

Прежде чем пользоваться этой функцией, загрузите последнюю версию разделов справки Windows PowerShell с веб-сайта Майкрософт. Разделы справки проще всего скачать, выполнив командлет `Update-Help` в области консоли при запуске интегрированной среды сценариев Windows PowerShell от имени администратора.

Где указать, откуда именно берется справка, вызываемая клавишей <kbd>F1</kbd>. В разделе **Другие параметры** на вкладке **Общие параметры** в меню **Сервис**/**Параметры** можно установить или снять флажок **Использовать локальную справку вместо справки в Интернете**. Если этот флажок установлен, клиент ищет справку по командлету в скачанных файлах, находящихся в папке модулей. Если флажок не установлен, клиент ищет справку в Интернете.

**Какой эффект дает это изменение?**

Получение контекстной справки без выхода из командлета или скрипта делает обучение более удобным.

**Что работает иначе?**

При нажатии клавиши <kbd>F1</kbd> в предыдущих версиях интегрированной среды сценариев Windows PowerShell открывался файл справки с локального компьютера. В интегрированной среде сценариев Windows PowerShell 3.0 и более поздних версий открывшееся окно содержит справку, поддерживающую поиск и настройку. Это новая справка по интегрированной среде сценариев Windows PowerShell ISE 3.0, в Windows PowerShell 3.0 появилась обновленная справка.

## <a name="show-command-cmdlet"></a>Командлет Show-Command

> Добавлено в PowerShell 3.0

Командлет `Show-Command` позволяет создать или выполнить командлет или функцию, заполнив графическую форму. Эта форма дает пользователям возможность работать с Windows PowerShell в графической среде.
Кроме того, командлет `Show-Command` позволяет опытным программистам быстро создавать графические интерфейсы на основе Windows PowerShell.

**Какой эффект дает это изменение?**

Используя командлет `Show-Command` в скриптах Windows PowerShell, вы можете предоставить пользователям привычную графическую среду. Кроме того, `Show-Command` помогает новичкам осваивать Windows PowerShell.

**Что работает иначе?**

Командлет `Show-Command` впервые появился в интегрированной среде сценариев Windows PowerShell 3.0.

## <a name="see-also"></a>См. также раздел

См. дополнительные сведения об [использовании интегрированной среды сценариев Windows PowerShell](../components/ise/exploring-the-windows-powershell-ise.md).
