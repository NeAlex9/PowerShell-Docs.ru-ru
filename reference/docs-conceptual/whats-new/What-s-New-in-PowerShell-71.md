---
title: Новые возможности PowerShell 7.1
description: Новые возможности и изменения в PowerShell 7.1
ms.date: 11/11/2020
ms.openlocfilehash: 5596d3ca69f5d8ea47f01ff0915e6fa33c1c463f
ms.sourcegitcommit: fb1a4bc4b249afd3513663de2e1ba3025d63467e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/14/2020
ms.locfileid: "94625726"
---
# <a name="whats-new-in-powershell-71"></a>Новые возможности PowerShell 7.1

PowerShell 7.1 — это кроссплатформенный (Windows, macOS и Linux) выпуск PowerShell с открытым кодом, который предназначен для управления разнородными средами и гибридным облаком.

Основываясь на фундаменте, заложенном в PowerShell 7.0, мы уделили больше внимания проблемам сообщества и реализовали ряд усовершенствований и исправлений. Мы стремимся поддерживать высокую стабильность и производительность платформы PowerShell.

Кроме того, PowerShell 7.1 включает версию PSReadLine 2.1.0. В ней реализована прогнозная технология IntelliSense. Дополнительные сведения о прогнозной технологии IntelliSense см. в [объявлении](https://devblogs.microsoft.com/powershell/announcing-psreadline-2-1-with-predictive-intellisense/), опубликованном в блоге PowerShell.

## <a name="where-can-i-install-powershell"></a>Где можно установить PowerShell?

<!-- TODO: Update list of OS below - make sure this is consistent across all docs -->

PowerShell 7.1 сейчас поддерживает следующие 64-разрядные операционные системы:

- Windows 8.1 и 10 (включая ARM64);
- Windows Server 2012 R2, 2016, 2019 и Semi-Annual Channel (SAC);
- Ubuntu 16.04, 18.04 и 20.04 (включая ARM64);
- Ubuntu 19.10 (через snap-пакет);
- Debian 9 и 10;
- CentOS и RHEL 7 и 8;
- Fedora 32
- Alpine 3.11 и более поздних версий (включая ARM64);
- macOS 10.13 или более поздней версии

Кроме того, обеспечена поддержка сообщества для:

- Arch Linux
- Raspbian Linux
- Kali Linux

Более актуальные сведения о поддерживаемых операционных системах и жизненном цикле поддержки см. в статье [Жизненный цикл поддержки PowerShell](/powershell/scripting/powershell-support-lifecycle).

Версия PowerShell 7.1 опубликована в Microsoft Store. Этот выпуск PowerShell можно найти на веб-сайте [Microsoft Store](https://www.microsoft.com/store/apps/9MZ1SNWT0N5D) или в приложении Store в ОС Windows.

Пакет Microsoft Store обеспечивает следующие преимущества:

- автоматические обновления, встроенные в основной механизм Windows 10;
- интеграция с другими механизмами распространения программного обеспечения, такими как Intune и SCCM.

> [!NOTE]
> Параметры конфигурации системного уровня, хранящиеся в `$PSHOME`, нельзя изменить. Это относится и к конфигурации WSMAN. Это означает, что вы не сможете подключать удаленные сеансы к установкам PowerShell на основе хранилища. Поддерживаются конфигурации уровня пользователя и удаленное взаимодействие по SSH.

Обратитесь к инструкциям по установке для своей операционной системы:

- [Windows](/powershell/scripting/install/installing-powershell-core-on-windows)
- [macOS](/powershell/scripting/install/installing-powershell-core-on-macos)
- [Linux](/powershell/scripting/install/installing-powershell-core-on-linux)

Кроме того, PowerShell 7.1 поддерживает выпуски Debian и Ubuntu для ARM32 и ARM64, а также Alpine Linux для ARM64.

Сообщество также предоставило пакеты для [Arch](https://aur.archlinux.org/packages/powershell/) и Kali Linux, хотя они не поддерживаются официально.

> [!NOTE]
> Debian 10+, CentOS 8+, Ubuntu 20.04, Alpine и ARM сейчас не поддерживают удаленное взаимодействие WinRM. Подробные сведения о настройке удаленного взаимодействия на основе SSH см. в статье [Удаленное взаимодействие с PowerShell через SSH](/powershell/scripting/learn/remoting/ssh-remoting-in-powershell-core).

## <a name="running-powershell-71"></a>Запуск PowerShell 7.1

PowerShell 7.1 устанавливается в новом каталоге и работает параллельно с Windows PowerShell 5.1.
PowerShell 7.1 устанавливается как обновление на месте взамен PowerShell 6.x или PowerShell 7.0.

- PowerShell 7.1 устанавливается в папке `%programfiles%\PowerShell\7`.
- Папка `%programfiles%\PowerShell\7` добавляется в переменную `$env:PATH`.

Пакеты установщика PowerShell 7.1 обновляют предыдущие версии PowerShell Core 6.x.

- PowerShell Core 6.x в Windows: каталог `%programfiles%\PowerShell\6` заменяется каталогом `%programfiles%\PowerShell\7`.
- Linux: каталог `/opt/microsoft/powershell/6` заменяется каталогом `/opt/microsoft/powershell/7`.
- macOS: каталог `/usr/local/microsoft/powershell/6` заменяется каталогом `/usr/local/microsoft/powershell/7`.

> [!NOTE]
> В Windows PowerShell исполняемый файл для запуска PowerShell называется `powershell.exe`. В версии 6 и более поздних имя исполняемого файла было изменено для поддержки параллельного выполнения. Новый исполняемый файл для запуска PowerShell 7.1 называется `pwsh.exe`. Предварительные сборки сохраняются как `pwsh-preview` (а не `pwsh`) в каталоге 7-preview.

## <a name="breaking-changes-and-improvements"></a>Критические изменения и улучшения

Последние сведения об изменениях и улучшениях см. в файле [CHANGELOG](https://github.com/PowerShell/PowerShell/tree/master/CHANGELOG) в репозитории GitHub.

### <a name="breaking-changes"></a>Критические изменения

<!-- TODO: Add descriptions for each breaking change - this might need to be a separate article that we link to -->

- Исправлено ошибочное значение `$false` для `$?` при записи собственной команды в `stderr` (#13395).
- Параметр `-FromUnixTime` переименован в `-UnixTimeSeconds` в `Get-Date`, чтобы разрешить ввод времени в формате Unix (#13084) (отдельная благодарность @aetos382!).
- Теперь `$ErrorActionPreference` не влияет на выходные данные `stderr` собственных команд (#13361).
- Разрешено переопределять явно заданным именованным параметром аналогичный параметр из сплаттинга хэш-таблицы (#13162)
- Параметр переключателя `-Qualifier` теперь не зависит от позиции в `Split-Path` (#12960) (отдельная благодарность @yecril71pl!).
- Рабочий каталог разрешается для `Start-Process` как литеральный путь, если он не указан (#11946) (отдельная благодарность @NoMoreFood!).
- Параметр `-OutFile` теперь ведет себя в веб-командлетах как `-LiteralPath` (#11701) (отдельная благодарность @iSazonov!).
- Исправлена привязка параметра строки для числовых литералов `BigInteger`(#11634) (отдельная благодарность @vexx32!).
- В Windows `Start-Process` позволяет создать среду процесса со всеми переменными среды из текущего сеанса, а при использовании `-UseNewEnvironment` создается новая среда процесса по умолчанию (#10830) (отдельная благодарность @iSazonov!).
- Возвращаемый в `PSObject` результат не переносится при преобразовании ScriptBlock в делегат (#10619).
- Используется инвариантное преобразование строк языка и региональных параметров для оператора `-replace` (#10954) (отдельная благодарность @iSazonov!).

### <a name="experimental-features"></a>Экспериментальные возможности

Дополнительные сведения см. в статье об [использовании экспериментальных функций](../learn/experimental-features.md).

- Компонент `PSNullConditionalOperators` выведен из списка в экспериментальных (#13529).
- Компонент `PSUnixFileStat` выведен из списка в экспериментальных.
- Во все командлеты `*-PSBreakpoint` добавлен параметр `-Runspace` (#10492) (отдельная благодарность @KirkMunro!).
- Добавлена функция `PSNativePSPathResolution` для поддержки передачи `PSPath` в нативные команды (#12386).
- Используется инвариантное преобразование строк языка и региональных параметров для оператора `-replace` (#10954) (отдельная благодарность @iSazonov!).
- Добавлена функция `PSSubsystemPluginModel` для поддержки будущих подключаемых модулей прогнозной технологии IntelliSense.

### <a name="general-cmdlet-updates-and-fixes"></a>Общие обновления и исправления командлетов

- Поступает предупреждение, если `ConvertTo-Json` превышает значение `-Depth` (#13692).
- Исправлена ситуация, при которой сообщение об исключении содержало только ``"`n"`` в среде Windows (#13684).
- `CONOUT$` и `CONIN$` распознаются как зарезервированные имена устройств (#13508) (отдельная благодарность @davidreis97!).
- Исправлен параметр `ConciseView` для интерактивной расширенной функции при записи ошибки (#13623).
- Добавлена поддержка `TLS` 1.3 в веб-командлетах (#13409) (отдельная благодарность @iSazonov!).
- Добавлена проверка значений NULL для `args` в `CommandLineParser` (#13451) (отдельная благодарность @iSazonov!).
- Добавлена обработка точек повторного анализа для приложений Microsoft Store (#13481) (отдельная благодарность @iSazonov!).
- Используется поле, если свойство не существует для `ObRoot` при применении PowerShell Direct к контейнеру (#13375) (отдельная благодарность @hemisphera!).
- Подавляются устаревшие предупреждения `UTF-7` (#13484).
- Устраняются множественные перечисления экземпляра `IEnumerable<Expression>` в `Compiler.cs` (#13491).
- В `Add-Type -OutputType` удалена поддержка `ConsoleApplication` и `WindowsApplication` (#13440).
- Создаются предупреждения, если в качестве кодировки указано значение `UTF-7` (#13430).
- Исправлено сообщение об ошибке при отсутствии целевого объекта для новой символьной ссылки (#13085) (отдельная благодарность @yecril71pl!).
- Параметр `args` теперь не допускает значения NULL в общедоступных API `ConsoleHost` (#13429).
- Добавлено отсутствующее удаление для `CancellationTokenSource` (#13420) (отдельная благодарность @Youssef1313!).
- Исправлено неверное отображение `Get-Help`, если параметр поддерживает подстановочные знаки (#13353) (отдельная благодарность @ThomasNieto!).
- Обновлена справка в `pwsh` для параметра `-InputFormat` (#13355) (отдельная благодарность @sethvs!).
- Объявляется лицензия MIT для файлов, скопированных из Roslyn (#13305) (отдельная благодарность @xtqqczze!).
- Улучшено поведение приведения `BigInteger` (#12629) (отдельная благодарность @vexx32!).
- Исправлено поведение `Get-Acl -LiteralPath "HKLM:Software\Classes\*"` (#13107) (отдельная благодарность @Shriram0908!).
- В интерфейс посетителя и класс добавлен метод `DefaultVisit` (#13258).
- Исправлен конфликтующий сокращенный вариант параметра `-s` (STA) для `pwsh` (#13262) (отдельная благодарность @iSazonov!).
- В `Read-Host -MaskInput` теперь используется существующий путь `SecureString`, но результат возвращается в виде обычного текста (#13256).
- .NET 5.0 теперь поддерживает удаление `ComEnumerator` в виде COM-объектов с помощью `IEnumerator` (#13259).
- Используется временный личный путь при запуске пространства выполнения, если не определена переменная среды HOME (#13239).
- В `Invoke-Command` внесено исправление для отслеживания рекурсивного вызова одной исторической записи (#13197).
- В исполняемом файле `pwsh` изменен префикс переключения `-inputformat` с `-in` на `-inp`, чтобы устранить конфликт с `-interactive` (#13205) (отдельная благодарность @iSazonov!).
- Обрабатывается путь файловой системы WSL при анализе зоны безопасности файла (#13120).
- Другие параметры сделаны обязательными в `Split-Path` (#13150) (отдельная благодарность @kvprasoon!).
- Используется новый значок Fluent Design для PowerShell 7 (#13100) (отдельная благодарность @sarthakmalik!).
- Внесено исправление в `Move-Item` для поддержки перемещений между подключениями в UNIX (#13044).
- Внесено исправление в `NullReferenceException` в `CommandSearcher.GetNextCmdlet` (#12659) (отдельная благодарность @powercode!).
- `NullReferenceException` запрещается в командлетах на компьютерах UNIX с активными тестовыми обработчиками (#12651) (отдельная благодарность @vexx32!)
- Исправлена проблема в `Select-Object`, из-за которой члены `Hashtable` (например, `Keys`) невозможно было использовать с `-Property` или `-ExpandProperty` (#11097) (отдельная благодарность @vexx32!).
- Исправлен конфликтующий сокращенный вариант параметра `-w` для pwsh (#12945).
- Переименован файл ресурсов `CimCmdlet` (#12955) (отдельная благодарность @iSazonov!).
- Устранено использование `Test-Path` в `ConciseView` (#12778).
- Предложение условия `default` оператора switch помечено как ключевое слово (#10487) (отдельная благодарность @msftrncs!).
- В командлет `Test-Json` добавлен параметр `SchemaFile`  (#11934) (отдельная благодарность @beatcracker!).
- Возвращены параметры поставщика сертификатов (#10622) (отдельная благодарность @iSazonov!).
- Исправлено поведение `New-Item`, чтобы создавать символьную ссылку на относительный целевой путь (#12797) (отдельная благодарность @iSazonov!).
- В Process добавлено свойство `CommandLine` (#12288) (отдельная благодарность @iSazonov!).
- В `Read-Host` добавлен параметр `-MaskInput` (#10908) (отдельная благодарность @davinci26!).
- Изменено поведение `CimCmdlets` для использования `AliasAttribute` (#12617) (отдельная благодарность @thlac!).
- Исправлен неверный индекс в строке формата для ParameterBinderBase (#12630) (отдельная благодарность @powercode!).
- Свойство `CommandInfo` скопировано в `Command.Clone()` (#12301) (отдельная благодарность @TylerLeonhardt!).
- В `Compare-Object` применяется `-IncludeEqual`, если указано `-ExcludeDifferent` (#12317) (отдельная благодарность @davidseibel!).
- Внесены изменения в `Get-FileHash`, чтобы закрывать дескрипторы файлов перед записью выходных данных (#12474) (отдельная благодарность @HumanEquivalentUnit!).
- Исправлено некорректное сообщение об исключении в операторе `-replace` (#12388) (отдельная благодарность @jackdcasey!).
- Исправлена загрузка модулей `WinCompat`, чтобы обрабатывать модули PowerShell 7 с более высоким приоритетом (#12269).
- Реализовано повторное использование пространства выполнения `ForEach-Object -Parallel` (#12122).
- Внесены исправления `Get-Service`, чтобы коллекция не изменялась при перечислении (#11851) (отдельная благодарность @NextTurn!).
- Добавлена очистка именованного канала IPC при выходе из PowerShell (#12187).
- Исправлено регулярное выражение для обнаружения `<img />` в веб-командлетах (#12099) (отдельная благодарность @vexx32!).
- Разрешены более короткие подписанные шестнадцатеричные литералы с соответствующими суффиксами типов (#11844) (отдельная благодарность @vexx32!).
- Обновлено поведение параметра `UseNewEnvironment` в командлете `Start-Process` в Windows (#10830) (отдельная благодарность @iSazonov!).
- В команду `Get-Random` добавлен переключатель `-Shuffle` (#11093) (отдельная благодарность @eugenesmlv!).
- Добавлена совместимость `GetWindowsPowerShellModulePath` с несколькими установками PS (#12280).
- Внесены исправления в `Start-Job` для работы в системах, где Windows PowerShell не зарегистрирован в качестве оболочки по умолчанию (#12296).
- Указание псевдонима и `-Syntax` для `Get-Command` возвращает синтаксис команд с псевдонимами (#10784) (отдельная благодарность @ChrisLGardner!).
- Обеспечена работоспособность командлетов CSV при использовании `-AsNeeded` и неполной строки (#12281) (отдельная благодарность @iSazonov!).
- В локальных вызовах не требуется `-PowerShellVersion 5.1`, чтобы у `Get-FormatData` была возможность просматривать все данные формата. (#11270) (отдельная благодарность @mklement0!).
- Добавлена поддержка `UTF-32` с обратным порядком байтов (#11947) (отдельная благодарность @NoMoreFood!).
- Устранено возможное состояние гонки, которое приводит к утечке объектов PowerShell в `ForEach-Object -Parallel` (#12227).
- В `Get-Date` добавлена функция `-FromUnixTime`, чтобы разрешить ввод времени в формате Unix (#12179) (отдельная благодарность @jackdcasey!).
- Изменены цвета фона и переднего плана по умолчанию, чтобы улучшить контрастность (#11455) (отдельная благодарность @rkeithhill!).
- Внесены исправления в `foreach -parallel` для ситуации, когда текущий диск недоступен (#12197).
- Устранен перенос возвращаемого результата в `PSObject` при преобразовании `ScriptBlock` в `delegate` (#10619).
- Ошибки разрешения DNS не записываются в `Test-Connection -Quiet` (#12204) (отдельная благодарность @vexx32!).
- Используются выделенные потоки для чтения перенаправленных выходных данных и потоков ошибок из дочернего процесса для внепроцессных заданий (#11713).
- Устранена проблема порядка предпочтения операторов в коде модуля привязки (#12075) (отдельная благодарность @DamirAinullin!).
- Исправлена проблема `NullReferenceException`, возникающая при привязке общих параметров с типом `ActionPreference` (#12124).
- Исправлено форматирование по умолчанию для десериализованных `MatchInfo` (#11728) (отдельная благодарность @iSazonov!).
- Используются асинхронные потоки в `Invoke-RestMethod` (#11095) (отдельная благодарность @iSazonov!).
- Решена проблема с обнаружением UTF-8 в `Get-Content -Tail` (#11899) (отдельная благодарность @NoMoreFood!).
- `IOException` обрабатывается в `Get-FileHash` (#11944) (отдельная благодарность @iSazonov!).
- В строке ресурса реализовано изменение `PowerShell Core` на `PowerShell` (#11928) (отдельная благодарность @alexandair!).
- Реализован возврат `MainWindowTitle` в `PSHostProcessInfo` (#11885) (отдельная благодарность @iSazonov!).
- Внесены прочие незначительные обновления для совместимости Windows (#11980).
- Внесены исправления в `ConciseView` для разбиения `PositionMessage` с помощью `[Environment]::NewLine` (#12010).
- Удалено ограничение сетевого прыжка для интерактивных сеансов (#11920).
- Внесены исправления в `NullReferenceException` в `SuspendStoppingPipeline()` и `RestoreStoppingPipeline()` (#11870) (отдельная благодарность @iSazonov!).
- GUID для `FormatViewDefinition` `InstanceId` создается автоматически, если он не указан (#11896).
- Исправлена проблема с `ConciseView` в ситуации, когда сообщение об ошибке длиннее, чем ширина окна, и не содержит пробелов (#11880).
- Разрешен межплатформенный удаленный обмен ключами `CAPI-compatible` (#11185) (отдельная благодарность @silijon!).
- Исправлено сообщение об ошибке (#11862) (отдельная благодарность @NextTurn!).
- Внесены исправления в `ConciseView` с учетом ситуации, в которой нет консоли для получения ширины (#11784).
- Внесены обновления в `CmsCommands` для использования хранилища, а не поставщика сертификатов (#11643) (отдельная благодарность @mikeTWC1984!).
- Обеспечена возможность работы `pwsh` в системах Windows, где недоступны `mpr.dll` и STA (#11748).
- Проведен рефакторинг и внедрение `Restart-Computer` для `Un*x` и macOS (#11319).
- Добавлена реализация `Stop-Computer` для Linux и macOS (#11151).
- Исправлена функция `help` для проверки доступности `less` перед началом использования (#11737).
- Внесены обновления в `PSPath` в `certificate_format_ps1.xml` (#11603) (отдельная благодарность @xtqqczze!).
- Изменено регулярное выражение для соответствия типам отношений без кавычек в заголовке Link (#11711) (отдельная благодарность @Marusyk!).
- Исправлено сообщение об ошибке, возникающее при удалении символьных ссылок (#11331).
- Пользовательский тип `Selected.*` для объекта `PSCustomObject` в `Select-Object` теперь добавляется однократно (#11548) (отдельная благодарность @iSazonov!).
- Добавлена функция `-AsUTC` в командлет `Get-Date` (#11611).
- Исправлено поведение группировки для логических значений в `Format-Hex` (#11587) (отдельная благодарность @vexx32!).
- Теперь `Test-Connection` всегда использует контекст синхронизации по умолчанию для отправки запросов проверки связи (#11517).
- Исправлены сообщения об ошибках при запуске (#11473) (отдельная благодарность @iSazonov!).
- В веб-командлетах игнорируются заголовки со значениями NULL (#11424) (отдельная благодарность @iSazonov!).
- Восстановлена проверка для удаления задания `Invoke-Command`. (#11388)
- Отменено изменение "Обновить форматировщик, чтобы не записывать новые строки при пустом содержимом (#11193)" (#11342) (отдельная благодарность @iSazonov!).
- Разрешение для `CompleteInput` возвращать результаты из `ArgumentCompleter`, если `AST` или скрипт имеют совпадающие описания функций (#10574) (отдельная благодарность @M1kep!).
- Обновлен форматировщик, чтобы новые строки не записывались при отсутствии содержимого (#11193).

<!-- TODO: add more general contributor thank you listing -->
