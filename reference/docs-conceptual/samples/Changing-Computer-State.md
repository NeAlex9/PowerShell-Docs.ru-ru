---
ms.date: 12/23/2019
keywords: powershell,командлет
title: Изменение состояния компьютера
ms.openlocfilehash: 9278df55ba027134a61c8ed4e89b5b839d460b29
ms.sourcegitcommit: 6545c60578f7745be015111052fd7769f8289296
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "75736919"
---
# <a name="changing-computer-state"></a>Изменение состояния компьютера

Чтобы вернуть компьютер в исходное состояние в PowerShell, используйте стандартную программу командной строки, инструментарий WMI или класс CIM.
Хотя PowerShell используется только для запуска программы, сведения об изменении состояния электропитания для компьютера в PowerShell иллюстрируют некоторые важные особенности работы с внешними средствами в PowerShell.

## <a name="locking-a-computer"></a>Блокировка компьютера

Единственным способом непосредственной блокировки компьютера с помощью стандартных средств является вызов функции **LockWorkstation()** в **user32.dll**:

```powershell
rundll32.exe user32.dll,LockWorkStation
```

Эта команда немедленно блокирует рабочую станцию. Она использует **rundll32.exe**, который запускает библиотеки DLL Windows (и сохраняет их библиотеки для многократного использования), чтобы запустить `user32.dll` — библиотеку функций управления Windows.

Если рабочая станция блокируется при включенном быстром переключении пользователей, например в Windows XP, компьютер отображает экран входа в систему вместо того, чтобы запустить заставку текущего пользователя.

Чтобы завершить работу конкретных сеансов на сервере терминалов, используйте программу командной строки **tsshutdn.exe**.

## <a name="logging-off-the-current-session"></a>Выход из текущего сеанса

Выйти из сеанса в локальной системе можно несколькими способами. Самый простой заключается в использовании программы командной строки удаленного рабочего стола или служб терминалов — **logoff.exe** (для получения дополнительных сведений введите `logoff /?` в командной строке PowerShell). Чтобы выйти из текущего активного сеанса, введите `logoff` без аргументов.

Можно также использовать средство **shutdown.exe** с параметром выхода:

```powershell
shutdown.exe -l
```

Еще один вариант — использование инструментария WMI. Класс **Win32_OperatingSystem** имеет метод **Shutdown**.
Вызов метода с флагом 0 инициирует выход из системы:

Дополнительные сведения о методе **Shutdown** класса Win32_OperatingSystem см. в [этой статье](/windows/win32/cimwin32prov/shutdown-method-in-class-win32-operatingsystem).

```powershell
Get-CimInstance -Classname Win32_OperatingSystem | Invoke-CimMethod -MethodName Shutdown
```

## <a name="shutting-down-or-restarting-a-computer"></a>Завершение работы или перезапуск компьютера

Завершение работы и перезапуск компьютеров обычно относятся к схожим типам задач. Средства, завершающие работу компьютера, обычно также перезапускают его и наоборот. Есть два варианта непосредственной перезагрузки компьютера из PowerShell. Используйте **tsshutdn.exe** или **shutdown.exe** с соответствующими аргументами. Подробные сведения об использовании можно получить, запустив `tsshutdn.exe /?` или `shutdown.exe /?`.

Операции завершения работы и перезапуска можно также выполнять непосредственно из PowerShell.

Чтобы завершить работу компьютера, используйте команду Stop-Computer.

```powershell
Stop-Computer
```

Чтобы перезапустить операционную систему, используйте команду Restart-Computer.

```powershell
Restart-Computer
```

Чтобы выполнить немедленную перезагрузку компьютера, используйте параметр -Force.

```powershell
Restart-Computer -Force
```
