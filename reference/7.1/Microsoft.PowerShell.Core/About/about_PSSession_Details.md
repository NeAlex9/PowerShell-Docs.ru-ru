---
description: Содержит подробные сведения о сеансах PowerShell и роли, которые они играют в удаленных командах.
keywords: powershell,командлет
Locale: en-US
ms.date: 06/09/2017
online version: https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_pssession_details?view=powershell-7.1&WT.mc_id=ps-gethelp
schema: 2.0.0
title: about_PSSession_Details
ms.openlocfilehash: 3d6ac25d7f8cac3d0b38cf921382e9a7aaeaf3d6
ms.sourcegitcommit: f874dc1d4236e06a3df195d179f59e0a7d9f8436
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2020
ms.locfileid: "93232666"
---
# <a name="about-pssession-details"></a>Сведения о PSSession

## <a name="short-description"></a>Краткое описание
Содержит подробные сведения о сеансах PowerShell и роли, которые они играют в удаленных командах.

## <a name="long-description"></a>Полное описание

Сеанс — это среда, в которой выполняется PowerShell. Сеанс создается при каждом запуске PowerShell. Вы можете создать дополнительные сеансы с именем "сеансы PowerShell" или "PSSession" на компьютере или на другом компьютере.

В отличие от сеансов, создаваемых PowerShell, вы управляете созданными PSSession и управляете ими.

PSSession играет важную роль в удаленном расчете. При создании сеанса PSSession, подключенного к удаленному компьютеру, PowerShell устанавливает постоянное подключение к удаленному компьютеру для поддержки сеанса PSSession. Сеанс PSSession можно использовать для выполнения ряда команд, функций и скриптов, которые совместно используют данные.

В этом разделе содержатся подробные сведения о сеансах и PSSession в PowerShell. Основные сведения о задачах, которые можно выполнять с сеансами, см. в разделе [about_PSSessions](about_PSSessions.md).

## <a name="about-sessions"></a>О сеансах

Технически, сеанс — это среда выполнения, в которой выполняется PowerShell. Каждый сеанс включает в себя экземпляр компонента System. Management. Automation, а также ведущее приложение, в котором выполняется PowerShell. Узел может быть знакомой консолью PowerShell или другой программой, запускающей команды, например Cmd.exe, или программу, созданную для размещения PowerShell, например интегрированную среду сценариев (ISE) Windows PowerShell. С точки зрения Windows, сеанс — это процесс Windows на целевом компьютере.

Каждый сеанс настраивается независимо друг от друга. Он включает собственные свойства, собственную политику выполнения и собственные профили. Среда, существующая при создании сеанса, сохраняется в течение времени существования даже при изменении среды на компьютере. Все сеансы создаются в глобальной области, даже в сеансах, создаваемых в скрипте.

Одновременно можно запустить только одну команду (или конвейер команд) в сеансе. Вторая команда выполняется синхронно (по одной за раз), когда первая команда завершается с задержкой до четырех минут. Вторая команда выполняется асинхронно (параллельно).

## <a name="about-pssessions"></a>О PSSession

Сеанс создается каждый раз при запуске PowerShell. И PowerShell создает временные сеансы для выполнения отдельных команд.
Однако можно также создать сеансы (называемые "сеансами PowerShell" или "PSSession"), которыми вы управляете и управляете.

PSSession являются критически важными для удаленных команд. Если используется параметр **ComputerName** `Invoke-Command` `Enter-PSSession` командлетов или, то PowerShell создает временный сеанс для выполнения команды, а затем закрывает сеанс сразу после выполнения команды или интерактивного сеанса.

Однако при использовании `New-PSSession` командлета для создания сеанса PSSession PowerShell устанавливает постоянный сеанс на удаленном компьютере, на котором можно запустить несколько команд или интерактивных сеансов. Создаваемый PSSession остается открытым и доступен для использования до тех пор, пока вы не удалите их или не закроете сеанс, в котором они были созданы.

При создании сеанса PSSession на удаленном компьютере система создает процесс PowerShell на удаленном компьютере и устанавливает подключение с локального компьютера к процессу на удаленном компьютере. При создании сеанса PSSession на локальном компьютере на локальном компьютере создаются и новый процесс, и подключения.

## <a name="when-do-i-need-a-pssession"></a>Когда требуется PSSession?

`Invoke-Command` `Enter-PSSession` Командлеты и имеют параметры **ComputerName** и **Session** . Для выполнения удаленной команды можно использовать один из них.

Параметр **ComputerName** используется для выполнения одной команды или ряда несвязанных команд на одном или нескольких компьютерах.

Для выполнения команд, которые совместно используют данные, требуется постоянное подключение к удаленному компьютеру. В этом случае создайте PSSession, а затем используйте параметр **Session** для выполнения команд в PSSession.

Многие другие командлеты, которые получают данные с удаленных компьютеров, таких как `Get-Process` ,, `Get-Service` и, `Get-EventLog` `Get-WmiObject` имеют только параметр **ComputerName** . Они используют технологии, отличные от удаленного взаимодействия PowerShell для удаленного сбора данных. У этих командлетов нет параметра **сеанса** , но можно использовать `Invoke-Command` командлет для выполнения этих команд в PSSession.

## <a name="how-do-i-create-a-pssession"></a>Как создать сеанс PSSession?

Чтобы создать сеанс PSSession, используйте `New-PSSession` командлет. С помощью можно `New-PSSession` создать сеанс PSSession на локальном или удаленном компьютере.

## <a name="can-i-create-a-pssession-on-any-computer"></a>Можно ли создать сеанс PSSession на любом компьютере?

Чтобы создать сеанс PSSession, подключенный к удаленному компьютеру, необходимо настроить на нем удаленное взаимодействие в PowerShell. Текущий пользователь должен быть членом группы "Администраторы" на удаленном компьютере, либо текущий пользователь должен иметь возможность предоставить учетные данные члена группы "Администраторы". Дополнительные сведения см. в разделе [about_Remote_Requirements](about_Remote_Requirements.md).

## <a name="can-i-see-my-pssessions-in-other-sessions"></a>Можно ли видеть мои PSSession в других сеансах?

Начиная с Windows PowerShell 3,0, параметр **ComputerName** `Get-PSSession` командлета получает PSSession, созданный на указанных удаленных компьютерах.

Активные PSSession хранятся на удаленном компьютере (на стороне сервера), и их можно получить из любого сеанса на любом компьютере.

Например, если сеанс PSSession создается с компьютера Server01 на компьютере Server02, а затем переключается на компьютер Server03, для получения сеанса можно использовать следующую команду:

```powershell
Get-PSSession -ComputerName Server02
```

Даже при отключении от сеанса сеанс сохраняется на удаленном компьютере до тех пор, пока вы не удалите его или не истечет время ожидания.

В Windows PowerShell 2,0 можно получить только PSSession, созданные в текущем сеансе. Вы не можете получить PSSession, созданный в других сеансах.

Дополнительные сведения см. в разделе [Get-PSSession](xref:Microsoft.PowerShell.Core.Get-PSSession).

## <a name="can-i-see-the-pssessions-that-others-have-created-on-my-computer"></a>Можно ли увидеть PSSession, созданные другими пользователями на Мой компьютер?

Вы можете получать и управлять только PSSession, которые были созданы другими пользователями, только если вы можете указать учетные данные пользователя, создавшего сеанс PSSession, или конфигурацию сеанса, которую использует PSSession, включая учетные данные запуска от имени. В противном случае можно получить, подключиться к, использовать и управлять только созданными PSSession.

## <a name="can-i-connect-to-a-pssession-from-a-different-computer"></a>Можно ли подключиться к сеансу PSSession с другого компьютера?

Начиная с Windows PowerShell 3,0, PSSession не зависят от сеансов, в которых они были созданы. Активные PSSession хранятся на компьютере на удаленном или "серверном" подключении.

Командлет можно использовать `Disconnect-PSSession` для отключения от PSSession. Сеанс PSSession отключен от локального сеанса, но сохраняется на удаленном компьютере.
Команды продолжают выполняться в отключенном сеансе PSSession. Вы можете закрыть PowerShell и завершить работу исходного компьютера, не прерывая сеанс PSSession.

Затем, даже ч, можно использовать `Get-PSSession` командлет, чтобы получить PSSession и `Connect-PSSession` командлет для подключения к сеансу PSSession из нового сеанса на другом компьютере.

Дополнительные сведения см. в разделе [about_Remote_Disconnected_Sessions](about_Remote_Disconnected_Sessions.md).

## <a name="what-happens-to-my-pssession-if-my-computer-stops"></a>Что происходит с моим сеансом PSSession, если Мой компьютер останавливается?

Отключенные PSSession не зависят от сеансов, в которых они были созданы. При отключении сеанса PSSession и последующем закрытии исходного компьютера сеанс PSSession сохраняется на удаленном компьютере.

Кроме того, PowerShell пытается восстановить активные PSSession, которые были отключены непреднамеренно, например перезагрузку компьютера, временный сбой питания или перерыв в работе сети. PowerShell пытается сохранить или восстановить сеанс PSSession в открытом состоянии, если исходный сеанс по-прежнему доступен, или в отключенном состоянии, если это не так.

"Активный" сеанс PSSession — это один из команд, выполняющий команды. Если сеанс PSSession подключен (не отключен) и команды выполняются в сеансе PSSession при закрытии подключенного сеанса, то PowerShell пытается сохранить сеанс PSSession на удаленном компьютере. Однако если в PSSession не выполняется ни одной команды, PowerShell закрывает сеанс PSSession при закрытии подключенного сеанса.

Дополнительные сведения см. в разделе [about_Remote_Disconnected_Sessions](about_Remote_Disconnected_Sessions.md).

## <a name="can-i-run-a-background-job-in-a-pssession"></a>Можно ли запустить фоновое задание в PSSession?

Да. Фоновое задание — это команда, которая выполняется асинхронно в фоновом режиме без взаимодействия с текущим сеансом. При отправке команды для запуска задания команда возвращает объект задания, но задание будет продолжать выполняться в фоновом режиме, пока оно не будет завершено.

Чтобы запустить фоновое задание на локальном компьютере, используйте `Start-Job` команду.
Фоновое задание можно запустить во временном подключении (с помощью параметра **ComputerName** ) или в PSSession (с помощью параметра **сеанса** ).

Чтобы запустить фоновое задание на удаленном компьютере, используйте `Invoke-Command` командлет с параметром **AsJob** или используйте `Invoke-Command` командлет для выполнения `Start-Job` команды на удаленном компьютере. При использовании параметра **AsJob** можно использовать параметры **ComputerName** или **Session** .

При использовании `Invoke-Command` для выполнения `Start-Job` команды необходимо выполнить команду в PSSession. Если используется параметр **ComputerName** , то при возврате объекта задания PowerShell завершает соединение, а задание прерывается.

См. дополнительные сведения о [заданиях](about_Jobs.md).

## <a name="can-i-run-an-interactive-session"></a>Можно ли запустить интерактивный сеанс?

Да. Чтобы запустить интерактивный сеанс с удаленным компьютером, используйте `Enter-PSSession` командлет. В интерактивном сеансе вводимые команды выполняются на удаленном компьютере, как если бы они были введены непосредственно на удаленном компьютере.

Интерактивный сеанс можно запустить во временном сеансе (с помощью параметра **ComputerName** ) или в PSSession (с помощью параметра **сеанса** ).
Если используется сеанс PSSession, то сеанс PSSession оставляет данные из предыдущих команд, а сеанс PSSession оставляет все данные, созданные во время интерактивного сеанса, для использования в последующих командах.

После завершения интерактивного сеанса сеанс PSSession остается открытым и доступен для использования.

Дополнительные сведения см. в статье [Ввод-PSSession](xref:Microsoft.PowerShell.Core.Enter-PSSession) и [Exit-PSSession](xref:Microsoft.PowerShell.Core.Exit-PSSession).

## <a name="must-i-delete-the-pssessions"></a>Нужно ли удалить PSSession?

Да. PSSession — это процесс, который является автономной средой, использующей память и другие ресурсы, даже если вы не используете ее. По завершении работы с PSSession удалите его. Если вы создаете несколько PSSession, закройте те из них, которые не используются, и обслуживайте только те из них, которые сейчас используются.

Чтобы удалить PSSession, используйте `Remove-PSSession` командлет. Он удаляет PSSession и освобождает все ресурсы, которые они использовали.

Можно также использовать параметр **IdleTimeOut** параметра, `New-PSSessionOption` чтобы закрыть бездействующий сеанс PSSession через указанный интервал. Дополнительные сведения см. в разделе [New-PSSessionOption](xref:Microsoft.PowerShell.Core.New-PSSessionOption).

Если объект PSSession сохраняется в переменной, а затем удаляется сеанс PSSession или истекает время ожидания, переменная по-прежнему содержит объект PSSession, но сеанс PSSession неактивен и не может быть использован или восстановлен.

## <a name="are-all-sessions-and-pssessions-alike"></a>Являются ли все сеансы и PSSession одинаковыми?

Нет. Разработчики могут создавать пользовательские сеансы, включающие только выбранные поставщики и командлеты. Если команда работает в одном сеансе, но не в другой, это может быть вызвано тем, что сеанс ограничен.

## <a name="see-also"></a>См. также:

[about_Jobs](about_Jobs.md)

[about_PSSessions](about_PSSessions.md)

[about_Remote](about_Remote.md)

[about_Remote_Disconnected_Sessions](about_Remote_Disconnected_Sessions.md)

[about_Remote_Requirements](about_Remote_Requirements.md)

[Invoke-Command](xref:Microsoft.PowerShell.Core.Invoke-Command)

[Enter-PSSession](xref:Microsoft.PowerShell.Core.Enter-PSSession)

[Exit-PSSession;](xref:Microsoft.PowerShell.Core.Exit-PSSession)

[Get-PSSession](xref:Microsoft.PowerShell.Core.Get-PSSession)

[New-PSSession](xref:Microsoft.PowerShell.Core.New-PSSession)

[Remove-PSSession](xref:Microsoft.PowerShell.Core.Remove-PSSession)

