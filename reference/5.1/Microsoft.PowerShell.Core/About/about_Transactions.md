---
description: Описывает, как управлять транзакционными операциями в PowerShell.
keywords: powershell,командлет
Locale: en-US
ms.date: 01/03/2018
online version: https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_transactions?view=powershell-5.1&WT.mc_id=ps-gethelp
schema: 2.0.0
title: о транзакциях
ms.openlocfilehash: 522e0f727754b0b0153571039f3bf3966d0abf20
ms.sourcegitcommit: f874dc1d4236e06a3df195d179f59e0a7d9f8436
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2020
ms.locfileid: "93231905"
---
# <a name="about-transactions"></a>О транзакциях

## <a name="short-description"></a>КРАТКОЕ ОПИСАНИЕ

Описывает, как управлять транзакционными операциями в PowerShell.

## <a name="long-description"></a>ПОДРОБНОЕ ОПИСАНИЕ

Транзакции поддерживаются в PowerShell, начиная с PowerShell 2,0. Эта функция позволяет запустить транзакцию, указать команды, которые являются частью транзакции, а также выполнить фиксацию или откат транзакции.

## <a name="about-transactions"></a>О ТРАНЗАКЦИЯХ

В PowerShell транзакция представляет собой набор из одной или нескольких команд, управляемых как логические устройства. Транзакция может быть завершена ("фиксируется"), которая изменяет данные, затронутые транзакцией. Или транзакция может быть полностью отменена («откат»), чтобы затронутые данные не изменялись транзакцией.

Так как команды в транзакции управляются как единое целое, фиксируются либо все команды, либо выполняется откат всех команд.

Транзакции широко используются при обработке данных, что особенно важно в операциях базы данных и финансовых транзакциях. Транзакции чаще всего используются, когда наихудший сценарий для набора команд не так, что все они завершаются сбоем, но некоторые команды были выполнены успешно, в то время как другие завершаются сбоем, что может привести к повреждению, ложным или неинтерпретируемому состоянию, который трудно восстановить.

## <a name="transaction-cmdlets"></a>КОМАНДЛЕТЫ ТРАНЗАКЦИЙ

PowerShell включает несколько командлетов, предназначенных для управления транзакциями.

- Start-Transaction: запускает новую транзакцию.
- Use-Transaction: добавляет в транзакцию команду или выражение. Команда должна использовать объекты с поддержкой транзакций.
- Отменить-Transaction: откатывает транзакцию, чтобы данные не изменялись транзакцией.
- Complete — Transaction: фиксирует транзакцию. Изменились данные, затронутые транзакцией.
- Get-Transaction: получает сведения об активной транзакции.

Для списка командлетов транзакций введите:

```powershell
get-command *transaction
```

Для получения подробных сведений о командлетах введите:

```powershell
get-help use-transaction -detailed
```

## <a name="transaction-enabled-elements"></a>ЭЛЕМЕНТЫ С ПОДДЕРЖКОЙ ТРАНЗАКЦИЙ

Для участия в транзакции оба командлета и поставщик должны поддерживать транзакции. Эта функция встроена в объекты, затрагиваемые транзакцией.

Поставщик реестра PowerShell поддерживает транзакции в Windows Vista. Объект TransactedString (Microsoft. PowerShell. Commands. Management. TransactedString) работает с любой операционной системой, в которой выполняется PowerShell.

Другие поставщики PowerShell могут поддерживать транзакции. Чтобы найти в сеансе поставщики PowerShell, которые поддерживают транзакции, используйте следующую команду, чтобы найти значение Transactions в свойстве capabilities поставщиков:

```powershell
get-psprovider | where {$_.Capabilities -like "*transactions*"}
```

Дополнительные сведения о поставщике см. в справке поставщика. Чтобы получить справку поставщика, введите:

```
get-help <provider-name>
```

Например, чтобы получить справку для поставщика Registry, введите:

```powershell
get-help registry
```

## <a name="the-usetransaction-parameter"></a>ПАРАМЕТР USETRANSACTION

Командлеты, которые могут поддерживать транзакции, имеют параметр UseTransaction. Этот параметр включает команду в активную транзакцию. Можно использовать полное имя параметра или его псевдоним "усеткс".

Параметр может использоваться только в том случае, если сеанс содержит активную транзакцию. При вводе команды с параметром UseTransaction при отсутствии активной транзакции команда завершается ошибкой.

Чтобы найти командлеты с параметром UseTransaction, введите:

```powershell
get-help * -parameter UseTransaction
```

В PowerShell Core все командлеты, предназначенные для работы с поставщиками PowerShell, поддерживают транзакции. В результате можно использовать командлеты поставщика для управления транзакциями.

Дополнительные сведения о поставщиках PowerShell см. в разделе [about_Providers](about_Providers.md).

## <a name="the-transaction-object"></a>ОБЪЕКТ TRANSACTION

Транзакции представлены в PowerShell объектом транзакции, System. Management. Automation. Transaction.

Ниже приводится описание свойств объекта.

- RollbackPreference: содержит параметры отката, заданные для текущей транзакции. Можно задать параметр отката при использовании Start-Transaction для запуска транзакции.

  Параметр отката определяет условия, при которых транзакция автоматически откатывается. Допустимые значения: Error, Терминатинжеррор и Never. Значение по умолчанию — Error.

- Состояние: содержит текущее состояние транзакции. Допустимые значения: Active, COMMITTED и откат.

- Субскриберкаунт: содержит число подписчиков на транзакцию. Подписчик добавляется в транзакцию при запуске транзакции во время выполнения другой транзакции. Число подписчиков уменьшается, когда подписчик фиксирует транзакцию.

## <a name="active-transactions"></a>АКТИВНЫЕ ТРАНЗАКЦИИ

В PowerShell в каждый момент времени активна только одна транзакция, и вы можете управлять только активной транзакцией. Одновременно может выполняться несколько транзакций в одном сеансе, но активна только самая последняя начальная транзакция.

В результате при использовании командлетов Transaction нельзя указать конкретную транзакцию. Команды всегда применяются к активной транзакции.

Это наиболее очевидно в работе командлета Get-Transaction. При вводе команды Get-Transaction Get-Transaction всегда получает только один объект транзакции. Этот объект представляет собой объект, представляющий активную транзакцию.

Для управления другой транзакцией необходимо сначала завершить активную транзакцию, заменив ее или выполнив ее откат. При этом предыдущая транзакция автоматически активизируется. Транзакции становятся активными в порядке, в котором они запускаются, чтобы последняя начальная транзакция всегда была активной.

## <a name="subscribers-and-independent-transactions"></a>ПОДПИСЧИКИ И НЕЗАВИСИМЫЕ ТРАНЗАКЦИИ

Если вы запускаете транзакцию во время выполнения другой транзакции, по умолчанию PowerShell не запускает новую транзакцию. Вместо этого он добавляет "Подписчик" к текущей транзакции.

Если транзакция имеет несколько подписчиков, одна команда Undo-Transaction в любой точке выполняет откат всей транзакции для всех подписчиков. Однако для фиксации транзакции необходимо ввести команду Complete-Transaction для каждого подписчика.

Чтобы узнать число подписчиков на транзакцию, проверьте свойство Субскриберкаунт объекта Transaction. Например, следующая команда использует командлет Get-Transaction для получения значения свойства Субскриберкаунт активной транзакции:

```powershell
(Get-Transaction).SubscriberCount
```

Добавление подписчика является поведением по умолчанию, так как большинство транзакций, запущенных во время выполнения другой транзакции, связаны с исходной транзакцией. В типичной модели скрипт, содержащий транзакцию, вызывает вспомогательный скрипт, который содержит собственную транзакцию. Поскольку транзакции связаны, они должны быть откатываются или зафиксированы как единое целое.

Однако можно запустить транзакцию, которая не зависит от текущей транзакции, с помощью независимого параметра командлета Start-Transaction.

При запуске независимой транзакции Start-Transaction создает новый объект транзакции, а новая транзакция превращается в активную транзакцию.
Независимая транзакция может быть зафиксирована или отменена без влияния на исходную транзакцию.

После завершения независимой транзакции (фиксация или откат) исходная транзакция снова становится активной.

## <a name="changing-data"></a>ИЗМЕНЕНИЕ ДАННЫХ

При использовании транзакций для изменения данных данные, затрагиваемые транзакцией, не изменяются, пока транзакция не будет зафиксирована. Однако одни и те же данные могут быть изменены командами, не входящими в транзакцию.

Учитывайте это при использовании транзакций для управления общими данными.
Как правило, базы данных имеют механизмы, которые блокируют данные во время работы, предотвращая их изменение другими пользователями, а также другими командами, сценариями и функциями.

Однако блокировка является компонентом базы данных. Он не связан с транзакциями. При работе в файловой системе с поддержкой транзакций или другом хранилище данных можно изменить данные во время выполнения транзакции.

## <a name="examples"></a>Примеры

В примерах этого раздела используется поставщик реестра PowerShell, и предполагается, что вы знакомы с ним. Для получения сведений о поставщике реестра введите «Get-Help Registry».

### <a name="example-1-committing-a-transaction"></a>ПРИМЕР 1. ФИКСАЦИЯ ТРАНЗАКЦИИ

Чтобы создать транзакцию, используйте командлет Start-Transaction. Следующая команда запускает транзакцию с параметрами по умолчанию.

```powershell
start-transaction
```

Чтобы включить команды в транзакцию, используйте параметр UseTransaction командлета. По умолчанию команды не включаются в транзакцию,

Например, следующая команда, которая задает текущее расположение в программном ключе диска HKCU:, не включается в транзакцию.

```powershell
cd hkcu:\Software
```

Следующая команда, создающая ключ MyCompany, использует параметр UseTransaction командлета New-Item для включения команды в активную транзакцию.

```powershell
new-item MyCompany -UseTransaction
```

Команда возвращает объект, представляющий новый ключ, но поскольку команда является частью транзакции, реестр еще не изменен.

```
Hive: HKEY_CURRENT_USER\Software

SKC  VC Name                           Property
---  -- ----                           --------
  0   0 MyCompany                      {}
```

Чтобы зафиксировать транзакцию, используйте командлет Complete-Transaction. Так как он всегда влияет на активную транзакцию, нельзя указать транзакцию.

```powershell
complete-transaction
```

В результате ключ MyCompany добавляется в реестр.

```powershell
dir m*
```

```output
Hive: HKEY_CURRENT_USER\software

SKC  VC Name                           Property
---  -- ----                           --------
 83   1 Microsoft                      {(default)}
  0   0 MyCompany                      {}
```

### <a name="example-2-rolling-back-a-transaction"></a>ПРИМЕР 2. ОТКАТ ТРАНЗАКЦИИ

Чтобы создать транзакцию, используйте командлет Start-Transaction. Следующая команда запускает транзакцию с параметрами по умолчанию.

```powershell
start-transaction
```

Следующая команда, создающая ключ Мйосеркомпани, использует параметр UseTransaction командлета New-Item для включения команды в активную транзакцию.

```powershell
new-item MyOtherCompany -UseTransaction
```

Команда возвращает объект, представляющий новый ключ, но поскольку команда является частью транзакции, реестр еще не изменен.

```
Hive: HKEY_CURRENT_USER\Software

SKC  VC Name                           Property
---  -- ----                           --------
  0   0 MyOtherCompany                 {}
```

Для отката транзакции используйте командлет Undo-Transaction. Так как он всегда влияет на активную транзакцию, транзакция не указывается.

```powershell
Undo-transaction
```

В результате ключ Мйосеркомпани не добавляется в реестр.

```powershell
dir m*
```

```output
Hive: HKEY_CURRENT_USER\software

SKC  VC Name                           Property
---  -- ----                           --------
 83   1 Microsoft                      {(default)}
  0   0 MyCompany                      {}
```

### <a name="example-3-previewing-a-transaction"></a>ПРИМЕР 3. ПРЕДВАРИТЕЛЬНЫЙ ПРОСМОТР ТРАНЗАКЦИИ

Как правило, команды, используемые в данных изменения транзакции. Однако команды, получающие данные, полезны и в транзакции, так как они получают данные внутри транзакции. Это обеспечивает предварительный просмотр изменений, которые могут привести к сбою транзакции.

В следующем примере показано, как использовать команду Get-ChildItem (псевдоним — Dir) для предварительного просмотра изменений в транзакции.

Следующая команда запускает транзакцию.

```powershell
start-transaction
```

Следующая команда использует командлет New-ItemProperty, чтобы добавить запись реестра MyKey в ключ MyCompany. Команда использует параметр UseTransaction для включения команды в транзакцию.

```powershell
new-itemproperty -path MyCompany -Name MyKey -value 123 -UseTransaction
```

Команда возвращает объект, представляющий новую запись реестра, но запись реестра не изменяется.

```
MyKey
-----
123
```

Чтобы получить элементы, которые в данный момент находятся в реестре, используйте команду Get-ChildItem (DIR) без параметра UseTransaction. Следующая команда возвращает элементы, которые начинаются с "M".

```powershell
dir m*
```

Результат показывает, что в ключ MyCompany еще не было добавлено ни одной записи.

```output
Hive: HKEY_CURRENT_USER\Software

SKC  VC Name                           Property
---  -- ----                           --------
 83   1 Microsoft                      {(default)}
  0   0 MyCompany                      {}
```

Чтобы просмотреть результат фиксации транзакции, введите команду Get-ChildItem ("Dir") с параметром UseTransaction. Эта команда содержит представление данных в рамках транзакции.

```powershell
dir m* -useTransaction
```

Результат показывает, что если транзакция зафиксирована, в ключ MyCompany будет добавлена запись MyKey.

```output
Hive: HKEY_CURRENT_USER\Software

SKC  VC Name                           Property
---  -- ----                           --------
 83   1 Microsoft                      {(default)}
  0   1 MyCompany                      {MyKey}
```

### <a name="example-4-combining-transacted-and-non-transacted-commands"></a>ПРИМЕР 4. ОБЪЕДИНЕНИЕ ТРАНЗАКЦИОННЫХ И НЕТРАНЗАКЦИОННЫХ КОМАНД

Во время транзакции можно вводить нетранзакционные команды. Нетранзакционные команды влияют на данные немедленно, но они не влияют на транзакцию.
Следующая команда запускает транзакцию в разделе реестра HKCU: \ Software.

```powershell
start-transaction
```

Следующие три команды используют командлет New-Item для добавления разделов в реестр.
Первая и третья команды используют параметр UseTransaction для включения команд в транзакцию. Вторая команда пропускает параметр. Так как Вторая команда не включена в транзакцию, она вступает в силу немедленно.

```powershell
new-item MyCompany1 -UseTransaction
new-item MyCompany2
new-item MyCompany3 -UseTransaction
```

Чтобы просмотреть текущее состояние реестра, используйте команду Get-ChildItem (DIR) без параметра UseTransaction. Эта команда возвращает элементы, которые начинаются с "M".

```powershell
dir m*
```

Результат показывает, что ключ MyCompany2 добавляется в реестр, но ключи MyCompany1 и MyCompany3, которые являются частью транзакции, не добавляются.

```output
Hive: HKEY_CURRENT_USER\Software

SKC  VC Name                           Property
---  -- ----                           --------
 83   1 Microsoft                      {(default)}
  0    0 MyCompany2                     {}
```

Следующая команда фиксирует транзакцию.

```powershell
complete-transaction
```

Теперь ключи, добавленные как часть транзакции, отображаются в реестре.

```powershell
dir m*
```

```output
Hive: HKEY_CURRENT_USER\Software

SKC  VC Name                           Property
---  -- ----                           --------
83   1 Microsoft                      {(default)}
0    0 MyCompany1                     {}
0    0 MyCompany2                     {}
0    0 MyCompany3                     {}
```

### <a name="example-5-using-automatic-rollback"></a>ПРИМЕР 5. ИСПОЛЬЗОВАНИЕ АВТОМАТИЧЕСКОГО ОТКАТА

Если команда в транзакции создает ошибку какого-либо типа, то транзакция автоматически откатывается.

Это поведение по умолчанию предназначено для скриптов, выполняющих транзакции. Обычно сценарии хорошо тестируются и включают логику обработки ошибок, поэтому ошибки не ожидаются и должны завершать транзакцию.

Первая команда запускает транзакцию в разделе реестра HKCU: \ Software.

```powershell
start-transaction
```

Следующая команда добавляет ключ MyCompany в реестр с помощью командлета New-Item. Команда использует параметр UseTransaction (псевдоним — "усеткс") для включения команды в транзакцию.

```powershell
New-Item MyCompany -UseTX
```

Так как ключ MyCompany уже существует в реестре, команда завершается ошибкой и выполняется откат транзакции.

```output
New-Item : A key at this path already exists
At line:1 char:9
+ new-item <<<<  MyCompany -usetx
```

Команда Get-Transaction подтверждает, что транзакция была отменена и Субскриберкаунт имеет значение 0.

```output
RollbackPreference   SubscriberCount   Status
------------------   ---------------   ------
Error                0                 RolledBack
```

### <a name="example-6-changing-the-rollback-preference"></a>ПРИМЕР 6. ИЗМЕНЕНИЕ НАСТРОЕК ОТКАТА

Если требуется, чтобы транзакция была более отказоустойчивой, можно использовать параметр RollbackPreference Start-Transaction для изменения предпочтения.

Следующая команда запускает транзакцию с предпочтением отката "никогда".

```powershell
start-transaction -rollbackpreference Never
```

В этом случае, если выполнение команды завершается неудачно, транзакция не будет автоматически отменена.

```powershell
New-Item MyCompany -UseTX
```

```output
New-Item : A key at this path already exists
At line:1 char:9
+ new-item <<<<  MyCompany -usetx
```

Так как транзакция все еще активна, можно повторно отправить команду в рамках транзакции.

```powershell
New-Item MyOtherCompany -UseTX
```

### <a name="example-7-using-the-use-transaction-cmdlet"></a>ПРИМЕР 7. ИСПОЛЬЗОВАНИЕ КОМАНДЛЕТА USE-TRANSACTION

Командлет Use-Transaction позволяет выполнять прямые сценарии для объектов платформы Microsoft .NET Framework с поддержкой транзакций. Use-Transaction принимает блок скрипта, который может содержать только команды и выражения, использующие объекты .NET Framework с поддержкой транзакций, например экземпляры класса Microsoft. PowerShell. Commands. Management. TransactedString.

Следующая команда запускает транзакцию.

```powershell
start-transaction
```

Следующая команда New-Object создает экземпляр класса TransactedString и сохраняет его в переменной $t.

```powershell
$t = New-Object Microsoft.PowerShell.Commands.Management.TransactedString
```

Следующая команда использует метод Append объекта TransactedString для добавления текста в строку. Так как команда не является частью транзакции, изменение вступает в силу немедленно.

```powershell
$t.append("Windows")
```

Следующая команда использует один и тот же метод Append для добавления текста, но добавляет текст как часть транзакции. Команда заключается в фигурные скобки и задается в качестве значения параметра ScriptBlock командлета Use-Transaction. Параметр UseTransaction (Усеткс) является обязательным.

```powershell
use-transaction {$t.append(" PowerShell")} -usetx
```

Чтобы просмотреть текущее содержимое транзакционной строки в $t, используйте метод ToString объекта TransactedString.

```powershell
$t.tostring()
```

Выходные данные показывают, что действуют только изменения, не относящиеся к транзакции.

```output
Windows
```

Чтобы просмотреть текущее содержимое транзакционной строки в $t в рамках транзакции, внедрите выражение в команду Use-Transaction.

```powershell
use-transaction {$s.tostring()} -usetx
```

В выходных данных отображается представление транзакций.

```output
PowerShell
```

Следующая команда фиксирует транзакцию.

```powershell
complete-transaction
```

Чтобы просмотреть последнюю строку:

```
$t.tostring()
PowerShell
```

### <a name="example-8-managing-multi-subscriber-transactions"></a>ПРИМЕР 8. УПРАВЛЕНИЕ ТРАНЗАКЦИЯМИ С НЕСКОЛЬКИМИ ПОДПИСЧИКАМИ

При запуске транзакции во время выполнения другой транзакции PowerShell по умолчанию не создает вторую транзакцию. Вместо этого он добавляет подписчика в текущую транзакцию.

В этом примере показано, как просматривать транзакцию с несколькими подписчиками и управлять ею.

Начните с запуска транзакции в разделе HKCU: \ программный ключ.

```powershell
start-transaction
```

Следующая команда использует команду Get-Transaction для получения активной транзакции.

```powershell
get-transaction
```

В результате отображается объект, представляющий активную транзакцию.

```output
RollbackPreference   SubscriberCount   Status
------------------   ---------------   ------
Error                1                 Active
```

Следующая команда добавляет ключ MyCompany в реестр. Команда использует параметр UseTransaction для включения команды в транзакцию.

```powershell
new-item MyCompany -UseTransaction
```

Следующая команда запускает транзакцию с помощью команды Start-Transaction. Хотя эта команда введена в командной строке, этот сценарий, скорее всего, будет выполняться при выполнении скрипта, содержащего транзакцию.

```powershell
start-transaction
```

Команда Get-Transaction показывает, что число подписчиков в объекте транзакции увеличивается. Теперь значение равно 2.

```output
RollbackPreference   SubscriberCount   Status
------------------   ---------------   ------
Error                2                 Active
```

Следующая команда использует командлет New-ItemProperty, чтобы добавить запись реестра MyKey в ключ MyCompany. Он использует параметр UseTransaction для включения команды в транзакцию.

```powershell
new-itemproperty -path MyCompany -name MyKey -UseTransaction
```

Ключ MyCompany не существует в реестре, но эта команда выполняется, так как две команды являются частью одной транзакции.

Следующая команда фиксирует транзакцию. При откате транзакции будет выполнен откат транзакции для всех подписчиков.

```powershell
complete-transaction
```

Команда Get-Transaction показывает, что число подписчиков в объекте транзакции равно 1, но значение Status по-прежнему активно (не зафиксировано).

```output
RollbackPreference   SubscriberCount   Status
------------------   ---------------   ------
Error                1                 Active
```

Чтобы завершить фиксацию транзакции, введите вторую команду завершения транзакции. Чтобы зафиксировать транзакцию с несколькими подписчиками, необходимо ввести одну команду Complete-Transaction для каждой команды Start-Transaction.

```powershell
complete-transaction
```

Другая команда Get-Transaction показывает, что транзакция была зафиксирована.

```output
RollbackPreference   SubscriberCount   Status
------------------   ---------------   ------
Error                0                 Committed
```

### <a name="example-9-managing-independent-transactions"></a>ПРИМЕР 9. УПРАВЛЕНИЕ НЕЗАВИСИМЫМИ ТРАНЗАКЦИЯМИ

При запуске транзакции во время выполнения другой транзакции можно использовать независимый параметр Start-Transaction, чтобы создать новую транзакцию независимо от исходной транзакции.

После этого Start-Transaction создает новый объект Transaction и делает новую транзакцию активной транзакцией.

Начните с запуска транзакции в ключе HKCU: \\ Software.

```powershell
start-transaction
```

Следующая команда использует команду Get-Transaction для получения активной транзакции.

```powershell
get-transaction
```

В результате отображается объект, представляющий активную транзакцию.

```output
RollbackPreference   SubscriberCount   Status
------------------   ---------------   ------
Error                1                 Active
```

Следующая команда добавляет раздел реестра MyCompany в состав транзакции. Для включения команды в активную транзакцию используется параметр UseTransaction (Усеткс).

```powershell
new-item MyCompany -use
```

Следующая команда запускает новую транзакцию. Команда использует независимый параметр, чтобы указать, что эта транзакция не является подписчиком активной транзакции.

```powershell
start-transaction -independent
```

При создании независимой транзакции новая транзакция (самая последняя созданная) превращается в активную транзакцию. Для получения активной транзакции можно использовать команду Get-Transaction.

```powershell
get-transaction
```

Обратите внимание, что Субскриберкаунт транзакции — 1, что означает, что нет других подписчиков и что транзакция является новой.

```output
RollbackPreference   SubscriberCount   Status
------------------   ---------------   ------
Error                1                 Active
```

Новая транзакция должна быть завершена (зафиксирована или отменена), прежде чем можно будет управлять исходной транзакцией.

Следующая команда добавляет ключ Мйосеркомпани в реестр. Для включения команды в активную транзакцию используется параметр UseTransaction (Усеткс).

```powershell
new-item MyOtherCompany -usetx
```

Теперь выполните откат транзакции. Если имеется одна транзакция с двумя подписчиками, откат транзакции приведет к откату всей транзакции для всех подписчиков.

Однако, поскольку эти транзакции независимы, откат самой последней транзакции отменяет изменения в реестре и делает исходную транзакцию активной транзакцией.

```powershell
undo-transaction
```

Команда Get-Transaction подтверждает, что исходная транзакция по-прежнему активна в сеансе.

```powershell
get-transaction
```

```output
RollbackPreference   SubscriberCount   Status
------------------   ---------------   ------
Error                1                 Active
```

Следующая команда фиксирует активную транзакцию.

```powershell
complete-transaction
```

Команда Get-ChildItem показывает, что реестр был изменен.

```powershell
dir m*
```

```output
Hive: HKEY_CURRENT_USER\Software

SKC  VC Name                           Property
---  -- ----                           --------
 83   1 Microsoft                      {(default)}
  0   0 MyCompany                      {}
```

## <a name="see-also"></a>СМ. ТАКЖЕ

[Start-Transaction](xref:Microsoft.PowerShell.Management.Start-Transaction)

[Get-Transaction](xref:Microsoft.PowerShell.Management.Get-Transaction)

[Complete-Transaction](xref:Microsoft.PowerShell.Management.Complete-Transaction)

[Undo-Transaction](xref:Microsoft.PowerShell.Management.Undo-Transaction)

[Use-Transaction](xref:Microsoft.PowerShell.Management.Use-Transaction)

[Get-PSProvider](xref:Microsoft.PowerShell.Management.Get-PSProvider)

[Get-ChildItem](xref:Microsoft.PowerShell.Management.Get-ChildItem)

[about_Providers](about_Providers.md)
