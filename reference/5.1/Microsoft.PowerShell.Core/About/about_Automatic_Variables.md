---
description: Описывает переменные, в которых хранятся сведения о состоянии для PowerShell. Эти переменные создаются и обслуживаются с помощью PowerShell.
keywords: powershell,командлет
Locale: en-US
ms.date: 08/14/2020
online version: https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_automatic_variables?view=powershell-5.1&WT.mc_id=ps-gethelp
schema: 2.0.0
title: about_Automatic_Variables
ms.openlocfilehash: d56e844bd10dfffabb1d2cfd75bcfe113724a334
ms.sourcegitcommit: f874dc1d4236e06a3df195d179f59e0a7d9f8436
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2020
ms.locfileid: "93232074"
---
# <a name="about-automatic-variables"></a>Сведения об автоматических переменных

## <a name="short-description"></a>Краткое описание

Описывает переменные, в которых хранятся сведения о состоянии для PowerShell. Эти переменные создаются и обслуживаются с помощью PowerShell.

## <a name="long-description"></a>Подробное описание

По сути, эти переменные считаются доступны только для чтения. Несмотря на то, что они **могут** быть записаны в, для обратной совместимости их **не следует** записывать в.

Ниже приведен список автоматических переменных в PowerShell.

### <a name=""></a>$$

Содержит последний токен в последней строке, полученной сеансом.

### <a name=""></a>$?

Содержит состояние выполнения последней команды. Он содержит **значение true** , если последняя команда выполнена успешно, и **значение false** в случае сбоя.

Для командлетов и расширенных функций, выполняемых на нескольких этапах конвейера, например в обоих `process` `end` блоках и, вызов `this.WriteError()` или `$PSCmdlet.WriteError()` соответственно в любой точке будет иметь значение `$?` **false** , как `this.ThrowTerminatingError()` и `$PSCmdlet.ThrowTerminatingError()` .

`Write-Error`Командлет всегда задает `$?` **значение false** сразу после выполнения, но не имеет значения `$?` **false** для вызывающей ее функции:

```powershell
function Test-WriteError
{
    Write-Error "Bad"
    $? # $false
}

Test-WriteError
$? # $true
```

Для последней цели `$PSCmdlet.WriteError()` следует использовать вместо него.

Для собственных команд (исполняемых файлов) `$?` имеет значение **true** , если `$LASTEXITCODE` равно 0, и значение **false** , если `$LASTEXITCODE` — любое другое значение.

> [!NOTE]
> До тех пор пока PowerShell 7, содержащий оператор в круглых скобках `(...)` , синтаксисе части выражения `$(...)` или выражении массива `@(...)` , всегда сбрасывается `$?` в **значение true** , чтобы `(Write-Error)` Показать `$?` **значение true**.
> Это было изменено в PowerShell 7, поэтому `$?` всегда будет отражать фактическое успешное выполнение последней команды в этих выражениях.

### <a name=""></a>$^

Содержит первый маркер в последней строке, полученной сеансом.

### <a name="_"></a>$_

Эквивалентно `$PSItem`. Содержит текущий объект в объекте конвейера. Эту переменную можно использовать в командах, выполняющих действия с каждым объектом или на выбранных объектах в конвейере.

### <a name="args"></a>$args

Содержит массив значений для необъявленных параметров, которые передаются в функцию, скрипт или блок скрипта. При создании функции можно объявить параметры с помощью `param` ключевого слова или путем добавления разделенного запятыми списка параметров в круглые скобки после имени функции.

В действии события `$Args` переменная содержит объекты, представляющие аргументы события обрабатываемого события. Эта переменная заполняется только в `Action` блоке команды регистрации события.
Значение этой переменной также можно найти в свойстве **саурцеаргс** объекта **PSEventArgs** , который `Get-Event` возвращает.

### <a name="consolefilename"></a>$ConsoleFileName

Содержит путь к файлу консоли ( `.psc1` ), который использовался в последнее время в сеансе. Эта переменная заполняется при запуске PowerShell с параметром **PSConsoleFile** или при использовании `Export-Console` командлета для экспорта имен оснасток в файл консоли.

При использовании `Export-Console` командлета без параметров он автоматически обновляет файл консоли, который использовался в последнее время в сеансе. Эту автоматическую переменную можно использовать для определения того, какой файл будет обновлен.

### <a name="error"></a>$Error

Содержит массив объектов Error, которые представляют последние ошибки.
Самая последняя ошибка — первый объект Error в массиве `$Error[0]` .

Чтобы предотвратить добавление ошибки в `$Error` массив, используйте общий параметр **ErrorAction** со значением **Ignore**. См. сведения в разделе [about_CommonParameters](about_CommonParameters.md).

### <a name="event"></a>$Event

Содержит объект **PSEventArgs** , представляющий обрабатываемое событие. Эта переменная заполняется только в `Action` блоке команды регистрации событий, например `Register-ObjectEvent` . Значением этой переменной является тот же объект, который `Get-Event` возвращает командлет. Таким образом, можно использовать свойства `Event` переменной, например `$Event.TimeGenerated` , в `Action` блоке скрипта.

### <a name="eventargs"></a>$EventArgs

Содержит объект, представляющий первый аргумент события, производный от **EventArgs** обрабатываемого события. Эта переменная заполняется только в `Action` блоке команды регистрации события.
Значение этой переменной также можно найти в свойстве **саурцеевентаргс** объекта **PSEventArgs** , который `Get-Event` возвращает.

### <a name="eventsubscriber"></a>$EventSubscriber

Содержит объект **псевентсубскрибер** , представляющий подписчика на событие обрабатываемого события. Эта переменная заполняется только в `Action` блоке команды регистрации события. Значением этой переменной является тот же объект, который `Get-EventSubscriber` возвращает командлет.

### <a name="executioncontext"></a>$ExecutionContext

Содержит объект **енгинеинтринсикс** , представляющий контекст выполнения узла PowerShell. Эту переменную можно использовать для поиска объектов выполнения, доступных для командлетов.

### <a name="false"></a>$false

Содержит **значение false**. Эту переменную можно использовать для представления значения **false** в командах и скриптах вместо использования строки false. Строка может интерпретироваться как **истинная** , если она преобразуется в непустую строку или не имеет нулевого целого числа.

### <a name="foreach"></a>$foreach

Содержит перечислитель (а не результирующие значения) цикла [foreach](about_ForEach.md) . `$ForEach`Переменная существует только во время `ForEach` выполнения цикла; она удаляется после завершения цикла.

Перечислители содержат свойства и методы, которые можно использовать для получения значений циклов и изменения текущей итерации цикла. Дополнительные сведения см. [в разделе Использование перечислителей](#using-enumerators).

### <a name="home"></a>$HOME

Содержит полный путь к домашнему каталогу пользователя. Эта переменная эквивалентна `"$env:homedrive$env:homepath"` переменным среды Windows, обычно `C:\Users\<UserName>` .

### <a name="host"></a>$Host

Содержит объект, представляющий текущее ведущее приложение для PowerShell. Эту переменную можно использовать для представления текущего узла в командах или для отображения или изменения свойств узла, например `$Host.version` или `$Host.CurrentCulture` `$host.ui.rawui.setbackgroundcolor("Red")` .

### <a name="input"></a>$input

Содержит перечислитель, перечисляющий все входные данные, передаваемые в функцию. `$input`Переменная доступна только для функций и блоков скриптов (которые являются неименованными функциями).

- В функции без `Begin` `Process` блока, или `End` `$input` переменная перечисляет коллекцию всех входных данных для функции.

- В `Begin` блоке `$input` переменная не содержит данных.

- В `Process` блоке `$input` переменная содержит объект, который в настоящее время находится в конвейере.

- В `End` блоке `$input` переменная перечисляет коллекцию всех входных данных для функции.

  > [!NOTE]
  > Нельзя использовать `$input` переменную внутри блока Process и End блока в одной и той же функции или блоке скрипта.

Поскольку `$input` является перечислителем, доступ к любому из его свойств приводит к тому, что он `$input` больше не будет доступен. `$input`Для повторного использования свойств можно сохранить в другой переменной `$input` .

Перечислители содержат свойства и методы, которые можно использовать для получения значений циклов и изменения текущей итерации цикла. Дополнительные сведения см. [в разделе Использование перечислителей](#using-enumerators).


### <a name="lastexitcode"></a>$LastExitCode

Содержит код выхода последней запущенной программы Windows.

### <a name="matches"></a>$Matches

`Matches`Переменная работает с `-match` `-notmatch` операторами и.
Когда вы отправляете скалярные входные данные в `-match` `-notmatch` оператор OR и один из них обнаруживает совпадение, он возвращает логическое значение и заполняет `$Matches` автоматическую переменную хэш-таблицей всех совпадающих строковых значений. `$Matches`Кроме того, хэш-таблица может быть заполнена с помощью захватов при использовании регулярных выражений с `-match` оператором.

Дополнительные сведения об `-match` операторе см. в разделе [about_Comparison_Operators](about_comparison_operators.md). Дополнительные сведения о регулярных выражениях см. в разделе [about_Regular_Expressions](about_Regular_Expressions.md).

### <a name="myinvocation"></a>$MyInvocation

Содержит сведения о текущей команде, такие как имя, параметры, значения параметров и сведения о том, как команда была запущена, вызвана или вызвана, например имя скрипта, вызвавшего текущую команду.

`$MyInvocation` заполняется только для скриптов, функций и блоков скриптов. Можно использовать сведения в объекте **System. Management. Automation. инвокатионинфо** , которые `$MyInvocation` возвращают в текущем скрипте, например путь и имя файла скрипта ( `$MyInvocation.MyCommand.Path` ) или имя функции ( `$MyInvocation.MyCommand.Name` ) для определения текущей команды. Это особенно полезно для поиска имени текущего скрипта.

Начиная с PowerShell 3,0, `MyInvocation` содержит следующие новые свойства.

| Свойство      | Описание                                         |
| ------------- | --------------------------------------------------- |
| **PSScriptRoot**  | Содержит полный путь к скрипту, который вызывается   |
|               | Текущая команда. Значение этого свойства равно  |
|               | заполняется только в том случае, если вызывающий объект является сценарием.         |
| **пскоммандпас** | Содержит полный путь и имя файла скрипта  |
|               | , вызвавший текущую команду. Значение этого |
|               | заполняется только в том случае, если вызывающий объект является     |
|               | .                                             |

В отличие от `$PSScriptRoot` `$PSCommandPath` автоматических переменных, свойства **PSScriptRoot** и **пскоммандпас** `$MyInvocation` автоматических переменных содержат сведения о вызывающем элементе или вызове скрипта, а не текущем скрипте.

### <a name="nestedpromptlevel"></a>$NestedPromptLevel

Содержит текущий уровень запросов. Значение 0 указывает на исходный уровень запроса. Значение увеличивается при вводе вложенного уровня и уменьшается при его выходе.

Например, при использовании метода PowerShell представляет собой вложенную командную строку `$Host.EnterNestedPrompt` . PowerShell также предоставляет вложенную командную строку при достижении точки останова в отладчике PowerShell.

При вводе вложенного запроса PowerShell приостанавливает текущую команду, сохраняет контекст выполнения и увеличивает значение `$NestedPromptLevel` переменной. Чтобы создать дополнительные вложенные командные подсказки (до 128) или вернуться к исходной командной строке, выполните команду или введите `exit` .

`$NestedPromptLevel`Переменная помогает контролировать уровень запросов. Можно создать альтернативную командную строку PowerShell, которая включает это значение, чтобы она всегда была видимой.

### <a name="null"></a>$null

`$null` — Это автоматическая переменная, которая содержит значение **null** или пустую переменную. Эту переменную можно использовать для представления отсутствующего или неопределенного значения в командах и скриптах.

PowerShell обрабатывает `$null` как объект со значением, то есть как явный заполнитель, поэтому можно использовать `$null` для представления пустого значения в ряде значений.

Например, если `$null` включен в коллекцию, то он считается одним из объектов.

```powershell
$a = "one", $null, "three"
$a.count
```

```Output
3
```

При `$null` передаче переменной в `ForEach-Object` командлет создается значение для `$null` , точно так же, как и для других объектов.

```powershell
"one", $null, "three" | ForEach-Object { "Hello " + $_}
```

```Output
Hello one
Hello
Hello three
```

В результате нельзя использовать, `$null` чтобы **не указывать значение параметра**. Значение параметра `$null` переопределяет значение параметра по умолчанию.

Однако, поскольку PowerShell обрабатывает `$null` переменную как заполнитель, ее можно использовать в сценариях, подобных следующим, что не будет работать, если `$null` они были пропущены.

```powershell
$calendar = @($null, $null, "Meeting", $null, $null, "Team Lunch", $null)
$days = "Sunday","Monday","Tuesday","Wednesday","Thursday",
        "Friday","Saturday"
$currentDay = 0
foreach($day in $calendar)
{
    if($day -ne $null)
    {
        "Appointment on $($days[$currentDay]): $day"
    }

    $currentDay++
}
```

```Output
Appointment on Tuesday: Meeting
Appointment on Friday: Team lunch
```

### <a name="pid"></a>$PID

Содержит идентификатор процесса (PID) процесса, в котором размещается текущий сеанс PowerShell.

### <a name="profile"></a>$PROFILE

Содержит полный путь к профилю PowerShell для текущего пользователя и текущего ведущего приложения. Эту переменную можно использовать для представления профиля в командах. Например, вы можете использовать его в команде, чтобы определить, был ли создан профиль:

```powershell
Test-Path $PROFILE
```

Вы также можете использовать его в команде для создания профиля:

```powershell
New-Item -ItemType file -Path $PROFILE -Force
```

Его можно использовать в команде, чтобы открыть профиль в **notepad.exe** :

```powershell
notepad.exe $PROFILE
```

### <a name="psboundparameters"></a>$PSBoundParameters

Содержит словарь параметров, которые передаются в скрипт или функцию, а также их текущие значения. Эта переменная имеет значение только в области, где объявляются параметры, например скрипт или функция. Его можно использовать для вывода или изменения текущих значений параметров, а также для передачи значений параметров другому сценарию или функции.

В этом примере функция **Test2** передает в `$PSBoundParameters` функцию **test1** . `$PSBoundParameters`Отображаются в формате **ключа** и **значения**.

```powershell
function Test1 {
   param($a, $b)

   # Display the parameters in dictionary format.
   $PSBoundParameters
}

function Test2 {
   param($a, $b)

   # Run the Test1 function with $a and $b.
   Test1 @PSBoundParameters
}
```

```powershell
Test2 -a Power -b Shell
```

```Output
Key   Value
---   -----
a     Power
b     Shell
```

### <a name="pscmdlet"></a>$PSCmdlet

Содержит объект, представляющий выполняемый командлет или расширенную функцию.

Можно использовать свойства и методы объекта в командлете или коде функции для реагирования на условия использования. Например, свойство **параметерсетнаме** содержит имя используемого набора параметров, а метод **ShouldProcess** динамически добавляет параметры **WhatIf** и **Confirm** в командлет.

Дополнительные сведения об `$PSCmdlet` автоматической переменной см. в разделе [about_Functions_CmdletBindingAttribute](about_Functions_CmdletBindingAttribute.md) и [about_Functions_Advanced](about_Functions_Advanced.md).

### <a name="pscommandpath"></a>$PSCommandPath

Содержит полный путь и имя файла скрипта, который выполняется. Эта переменная допустима во всех скриптах.

### <a name="psculture"></a>$PSCulture

Содержит имя языка и региональных параметров, используемых в данный момент в операционной системе. Язык и региональные параметры определяют формат отображаемых элементов, таких как числа, денежные единицы и даты, и хранятся в объекте **System. Globalization. CultureInfo** . Используется `Get-Culture` для вывода языка и региональных параметров компьютера. `$PSCulture` содержит значение свойства **Name** .

### <a name="psdebugcontext"></a>$PSDebugContext

Во время отладки эта переменная содержит сведения о среде отладки. В противном случае он содержит значение **null** . В результате его можно использовать, чтобы указать, имеет ли отладчик элемент управления. При заполнении он содержит объект **псдебугконтекст** с **точками останова** и свойствами **инвокатионинфо** . Свойство **инвокатионинфо** имеет несколько полезных свойств, включая свойство **Location** . Свойство **Location** указывает путь отлаживаемого скрипта.

### <a name="pshome"></a>$PSHOME

Содержит полный путь к каталогу установки PowerShell (обычно `$env:windir\System32\PowerShell\v1.0` в системах Windows). Эту переменную можно использовать в путях файлов PowerShell. Например, следующая команда выполняет поиск в основных разделах справки по **переменной** Word:

```powershell
Select-String -Pattern Variable -Path $pshome\*.txt
```

### <a name="psitem"></a>$PSItem

Эквивалентно `$_`. Содержит текущий объект в объекте конвейера. Эту переменную можно использовать в командах, выполняющих действия с каждым объектом или на выбранных объектах в конвейере.

### <a name="psscriptroot"></a>$PSScriptRoot

Содержит каталог, из которого выполняется скрипт.

В PowerShell 2,0 эта переменная допустима только в модулях скриптов ( `.psm1` ).
Начиная с PowerShell 3,0, он действителен во всех скриптах.

### <a name="pssenderinfo"></a>$PSSenderInfo

Содержит сведения о пользователе, запустившего PSSession, включая удостоверение пользователя и часовой пояс исходного компьютера. Эта переменная доступна только в PSSession.

`$PSSenderInfo`Переменная включает настраиваемое пользователем свойство **аппликатионаргументс** , которое по умолчанию содержит только `$PSVersionTable` из исходного сеанса. Чтобы добавить данные в свойство **аппликатионаргументс** , используйте параметр **аппликатионаргументс** `New-PSSessionOption` командлета.

### <a name="psuiculture"></a>$PSUICulture

Содержит имя языка и региональных параметров пользовательского интерфейса, используемого в данный момент в операционной системе. Язык и региональные параметры пользовательского интерфейса определяют, какие строки текста используются для элементов пользовательского интерфейса, например меню и сообщений. Это значение свойства **System.Globalization.CultureInfo.CurrentUICulture.Name** системы. Чтобы получить объект **System. Globalization. CultureInfo** для системы, используйте `Get-UICulture` командлет.

### <a name="psversiontable"></a>$PSVersionTable

Содержит хэш-таблицу только для чтения, в которой отображаются сведения о версии PowerShell, которая выполняется в текущем сеансе. Таблица содержит следующие элементы:

| Свойство                  | Описание                                   |
| ------------------------- | --------------------------------------------- |
| **BuildVersion**          | Номер сборки текущей версии       |
| **CLRVersion**            | Версия среды CLR    |
|                           | СРЕДУ                                         |
| **пскомпатиблеверсионс**  | Совместимые версии PowerShell    |
|                           | с текущей версией                      |
| **PSEdition**             | Это свойство имеет значение "Desktop", для |
|                           | Версии Windows Server и клиента Windows.   |
|                           | Это свойство имеет значение "Core" для     |
|                           | PowerShell, работающий на Nano Server или       |
|                           | Windows IOT.                                  |
| **псремотингпротоколверсион** | Версия удаленного экземпляра PowerShell      |
|                           | Протокол управления.                          |
| **PSVersion**             | Номер версии PowerShell                 |
| **сериализатионверсион**  | Версия метода сериализации       |
| **всманстаккверсион**     | Номер версии стека WS-Management |

### <a name="pwd"></a>$PWD

Содержит объект Path, представляющий полный путь к текущему каталогу.

### <a name="sender"></a>$Sender

Содержит объект, создавший это событие. Эта переменная заполняется только в блоке действия для команды регистрации события. Значение этой переменной также можно найти в свойстве sender объекта **PSEventArgs** , который `Get-Event` возвращает.

### <a name="shellid"></a>$ShellId

Содержит идентификатор текущей оболочки.

### <a name="stacktrace"></a>$StackTrace

Содержит трассировку стека для последней ошибки.

### <a name="switch"></a>$switch

Содержит перечислитель, а не результирующие значения `Switch` инструкции. `$switch`Переменная существует только во время выполнения `Switch` инструкции. она удаляется, когда `switch` выполнение инструкции завершается. Дополнительные сведения см. в разделе [about_Switch](about_Switch.md).

Перечислители содержат свойства и методы, которые можно использовать для получения значений циклов и изменения текущей итерации цикла. Дополнительные сведения см. [в разделе Использование перечислителей](#using-enumerators).

### <a name="this"></a>$this

В блоке скрипта, который определяет свойство скрипта или метод скрипта, `$this` переменная ссылается на объект, который расширяется.

В пользовательском классе `$this` переменная ссылается на сам объект класса, который обеспечивает доступ к свойствам и методам, определенным в классе.

### <a name="true"></a>$true

Содержит **значение true**. С помощью этой переменной можно представить **значение true** в командах и скриптах.

## <a name="using-enumerators"></a>Использование перечислителей

`$input`Переменные, `$foreach` и `$switch` — это все перечислители, используемые для прохода по значениям, обрабатываемым содержащим его блоком кода.

Перечислитель содержит свойства и методы, которые можно использовать для перебора или сброса итерации, а также для получения значений итерации. Непосредственное управление перечислителями не рекомендуется.

- В циклах управление потоком ключевые слова [break](about_Break.md) и [Continue](about_Continue.md) должны быть предпочтительными.
- В функциях, принимающих входные данные конвейера, рекомендуется использовать параметры с атрибутами **валуефромпипелине** или **валуефромпипелинебипропертинаме** .

  Дополнительные сведения см. в разделе [about_Functions_Advanced_Parameters](about_Functions_Advanced_Parameters.md).

### <a name="movenext"></a>MoveNext

Метод [MoveNext](/dotnet/api/system.collections.ienumerator.movenext) перемещает перечислитель к следующему элементу коллекции. **MoveNext** возвращает **значение true** , если перечислитель был успешно расширен, и **false** , если перечислитель прошел конец коллекции.

> [!NOTE]
> **Логическое** значение, возвращенное моим методом **MoveNext** , отправляется в поток вывода.
> Вы можете подавить вывод, применив его к `[void]` или передав его в [out-NULL](xref:Microsoft.PowerShell.Core.Out-Null).
>
> ```powershell
> $input.MoveNext() | Out-Null
> ```
>
> ```powershell
> [void]$input.MoveNext()
> ```

### <a name="reset"></a>Reset

Метод [Reset](/dotnet/api/system.collections.ienumerator.reset) устанавливает перечислитель в исходное расположение, которое **предшествует** первому элементу в коллекции.

### <a name="current"></a>Текущий

[Текущее](/dotnet/api/system.collections.ienumerator.current) свойство получает элемент в коллекции или конвейере в текущей позиции перечислителя.

**Текущее** свойство будет возвращать то же самое свойство, пока не будет вызван метод **MoveNext** .

## <a name="examples"></a>Примеры

### <a name="example-1-using-the-input-variable"></a>Пример 1. Использование переменной $input

В следующем примере доступ к `$input` переменной очищает переменную до следующего выполнения блока Process. При использовании метода **Reset** переменная сбрасывается в `$input` Текущее значение конвейера.

```powershell
function Test
{
    begin
    {
        $i = 0
    }

    process
    {
        "Iteration: $i"
        $i++
        "`tInput: $input"
        "`tAccess Again: $input"
        $input.Reset()
        "`tAfter Reset: $input"
    }
}

"one","two" | Test
```

```Output
Iteration: 0
    Input: one
    Access Again:
    After Reset: one
Iteration: 1
    Input: two
    Access Again:
    After Reset: two
```

Блок Process автоматически перемещает `$input` переменную, даже если вы не обращаетесь к ней.

```powershell
$skip = $true
function Skip
{
    begin
    {
        $i = 0
    }

    process
    {
        "Iteration: $i"
        $i++
        if ($skip)
        {
            "`tSkipping"
            $skip = $false
        }
        else
        {
            "`tInput: $input"
        }
    }
}

"one","two" | Skip
```

```Output
Iteration: 0
    Skipping
Iteration: 1
    Input: two
```

### <a name="example-2-using-input-outside-the-process-block"></a>Пример 2. Использование $input за пределами блока Process

За пределами блока Process `$input` переменная представляет все значения, переданные функции.

- При доступе к `$input` переменной очищаются все значения.
- Метод **Reset** сбрасывает всю коллекцию.
- **Текущее** свойство никогда не заполняется.
- Метод **MoveNext** возвращает значение false, так как коллекция не может быть расширена.
  - При вызове **MoveNext** очищается `$input` переменная.

```powershell
Function All
{
    "All Values: $input"
    "Access Again: $input"
    $input.Reset()
    "After Reset: $input"
    $input.MoveNext() | Out-Null
    "After MoveNext: $input"
}

"one","two","three" | All
```

```Output
All Values: one two three
Access Again:
After Reset: one two three
After MoveNext:
```

### <a name="example-3-using-the-inputcurrent-property"></a>Пример 3. Использование $input. Текущее свойство

С помощью **текущего** свойства текущее значение конвейера можно получить несколько раз без использования метода **Reset** . Блок Process не вызывает метод **MoveNext** автоматически.

**Текущее** свойство никогда не будет заполнено, если явно не вызвать **MoveNext**. Доступ к **текущему** свойству можно осуществлять несколько раз в блоке Process без очистки его значения.

```powershell
function Current
{
    begin
    {
        $i = 0
    }

    process
    {
        "Iteration: $i"
        $i++
        "`tBefore MoveNext: $($input.Current)"
        $input.MoveNext() | Out-Null
        "`tAfter MoveNext: $($input.Current)"
        "`tAccess Again: $($input.Current)"
    }
}

"one","two" | Current
```

```Output
Iteration: 0
    Before MoveNext:
    After MoveNext: one
    Access Again: one
Iteration: 1
    Before MoveNext:
    After MoveNext: two
    Access Again: two
```

### <a name="example-4-using-the-foreach-variable"></a>Пример 4. Использование переменной $foreach

В отличие от `$input` переменной переменная `$foreach` всегда представляет все элементы коллекции при обращении к ним напрямую. Используйте свойство **Current** для доступа к текущему элементу коллекции, а методы **Reset** и **MoveNext** — для изменения его значения.

> [!NOTE]
> Каждая итерация `foreach` цикла будет автоматически вызывать метод **MoveNext** .

Следующий цикл выполняется только дважды. Во второй итерации коллекция перемещается в третий элемент до завершения итерации. После второй итерации теперь больше нет значений для итерации, и цикл завершается.

Свойство **MoveNext** не влияет на переменную, выбранную для итерации по коллекции ( `$Num` ).

```powershell
$i = 0
foreach ($num in ("one","two","three"))
{
    "Iteration: $i"
    $i++
    "`tNum: $num"
    "`tCurrent: $($foreach.Current)"

    if ($foreach.Current -eq "two")
    {
        "Before MoveNext (Current): $($foreach.Current)"
        $foreach.MoveNext() | Out-Null
        "After MoveNext (Current): $($foreach.Current)"
        "Num has not changed: $num"
    }
}
```

```Output
Iteration: 0
        Num: one
        Current: one
Iteration: 1
        Num: two
        Current: two
Before MoveNext (Current): two
After MoveNext (Current): three
Num has not changed: two
```

При использовании метода **Reset** текущий элемент в коллекции сбрасывается. В следующем **примере два первых элемента циклически** перебирается, так как вызывается метод **Reset** . После первых двух циклов `if` инструкция завершается ошибкой, и цикл выполняет итерацию по всем трем элементам обычно.

> [!IMPORTANT]
> Это может привести к бесконечному циклу.

```powershell
$stopLoop = 0
foreach ($num in ("one","two", "three"))
{
    ("`t" * $stopLoop) + "Current: $($foreach.Current)"

    if ($num -eq "two" -and $stopLoop -lt 2)
    {
        $foreach.Reset() | Out-Null
        ("`t" * $stopLoop) + "Reset Loop: $stopLoop"
        $stopLoop++
    }
}
```

```Output
Current: one
Current: two
Reset Loop: 0
        Current: one
        Current: two
        Reset Loop: 1
                Current: one
                Current: two
                Current: three
```

### <a name="example-5-using-the-switch-variable"></a>Пример 5. Использование переменной $switch

`$switch`Переменная имеет те же правила, что и `$foreach` переменная.
В следующем примере показаны все основные понятия перечислителя.

> [!NOTE]
> Обратите внимание, что **нотевалуатед** Case никогда не выполняется, несмотря на то, что `break` после метода **MoveNext** отсутствует оператор.

```powershell
$values = "Start", "MoveNext", "NotEvaluated", "Reset", "End"
$stopInfinite = $false
switch ($values)
{
    "MoveNext" {
        "`tMoveNext"
        $switch.MoveNext() | Out-Null
        "`tAfter MoveNext: $($switch.Current)"
    }
    # This case is never evaluated.
    "NotEvaluated" {
        "`tAfterMoveNext: $($switch.Current)"
    }

    "Reset" {
        if (!$stopInfinite)
        {
            "`tReset"
            $switch.Reset()
            $stopInfinite = $true
        }
    }

    default {
        "Default (Current): $($switch.Current)"
    }
}
```

```Output
Default (Current): Start
    MoveNext
    After MoveNext: NotEvaluated
    Reset
Default (Current): Start
    MoveNext
    After MoveNext: NotEvaluated
Default (Current): End
```

## <a name="see-also"></a>См. также статью

[about_Functions](about_Functions.md)

[about_Functions_Advanced](about_Functions_Advanced.md)

[about_Functions_Advanced_Methods](about_Functions_Advanced_Methods.md)

[about_Functions_Advanced_Parameters](about_Functions_Advanced_Parameters.md)

[about_Functions_OutputTypeAttribute](about_Functions_OutputTypeAttribute.md)

[about_Functions_CmdletBindingAttribute](about_Functions_CmdletBindingAttribute.md)

[about_Hash_Tables](about_Hash_Tables.md)

[about_Preference_Variables](about_Preference_Variables.md)

[about_Splatting](about_Splatting.md)

[about_Variables](about_Variables.md)
