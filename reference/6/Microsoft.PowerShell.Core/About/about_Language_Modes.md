---
description: Объясняет языковые режимы и их воздействие на сеансы PowerShell.
keywords: powershell,командлет
Locale: en-US
ms.date: 09/09/2019
online version: https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_language_modes?view=powershell-6&WT.mc_id=ps-gethelp
schema: 2.0.0
title: about_Language_Modes
ms.openlocfilehash: 8254760e49d5d9b2d1b035038b14414b0074435c
ms.sourcegitcommit: f874dc1d4236e06a3df195d179f59e0a7d9f8436
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2020
ms.locfileid: "93231429"
---
# <a name="about-language-modes"></a>Сведения о языковых режимах

## <a name="short-description"></a>КРАТКОЕ ОПИСАНИЕ
Объясняет языковые режимы и их воздействие на сеансы PowerShell.

## <a name="long-description"></a>ПОДРОБНОЕ ОПИСАНИЕ

Языковой режим сеанса PowerShell определяет, в части которого элементы языка PowerShell можно использовать в сеансе.

PowerShell поддерживает следующие языковые режимы:

- FullLanguage
- ConstrainedLanguage (введено в PowerShell 3,0)
- рестриктедлангуаже
- NoLanguage

### <a name="what-is-a-language-mode"></a>ЧТО ТАКОЕ ЯЗЫКОВОЙ РЕЖИМ?

Языковой режим определяет языковые элементы, разрешенные в сеансе.

Языковой режим фактически является свойством конфигурации сеанса (или "конечной точки"), используемой для создания сеанса. Все сеансы, использующие определенную конфигурацию сеанса, имеют языковой режим конфигурации сеанса.

Все сеансы PowerShell имеют языковой режим, включая PSSession, созданные с помощью `New-PSSession` командлета, временные сеансы, которые используют параметр ComputerName, и сеансы по умолчанию, которые отображаются при запуске PowerShell.

Удаленные сеансы создаются с помощью конфигураций сеансов на удаленном компьютере. Языковой режим, заданный в конфигурации сеанса, определяет языковой режим сеанса. Чтобы указать конфигурацию сеанса PSSession, используйте параметр ConfigurationName командлетов, которые создают сеанс.

### <a name="language-modes"></a>ЯЗЫКОВЫЕ РЕЖИМЫ

В этом разделе описываются языковые режимы в сеансах PowerShell.

#### <a name="full-language-fulllanguage"></a>ПОЛНЫЙ язык (Фулллангуаже)

Режим Фулллангуаже позволяет использовать все языковые элементы в сеансе.
Фулллангуаже — это языковой режим по умолчанию для сеансов по умолчанию во всех версиях Windows, за исключением Windows RT.

#### <a name="restricted-language-restrictedlanguage"></a>ОГРАНИЧЕНный язык (Рестриктедлангуаже)

В режиме Рестриктедлангуаже пользователи могут выполнять команды (командлеты, функции, команды CIM и рабочие процессы), но не могут использовать блоки сценариев.

По умолчанию в режиме Рестриктедлангуаже разрешены только следующие переменные:

- `$PSCulture`
- `$PSUICulture`
- `$True`
- `$False`
- `$Null`

Манифесты модулей, использующие режим Рестриктедлангуаже, также допускают следующие дополнительные переменные:

- `$PSScriptRoot`
- `$PSEdition` (в PowerShell Core)
- `$EnabledExperimentalFeatures` (в PowerShell Core)

Допустимы только следующие операторы сравнения:

- `-eq` равномерно
- `-gt` (больше)
- `-lt` (меньше)

Операторы присваивания, ссылки на свойство и вызовы методов не разрешены.

#### <a name="no-language-nolanguage"></a>НЕТ языка (язык)

Режим "неязыкового интерфейса" можно использовать только через API. Режим без языка означает, что текст скрипта для любой формы не разрешен. Это исключает использование метода **аддскрипт ()** , который отправляет фрагменты сценария PowerShell для синтаксического анализа и выполнения. Можно использовать только **AddCommand ()** и **аддпараметер ()** , которые не проходят через средство синтаксического анализа.

#### <a name="constrained-language-constrained-language"></a>ОГРАНИЧЕНный язык (ограниченный язык)

Режим ConstrainedLanguage позволяет использовать все командлеты и все элементы языка PowerShell, но ограничивает разрешенные типы.

Режим ConstrainedLanguage предназначен для поддержки целостности кода пользовательского режима (УМЦИ) в Windows RT. Это единственный поддерживаемый языковой режим в Windows RT, но он доступен во всех поддерживаемых системах.

УМЦИ защищает устройства ARM, разрешая установку на устройствах с Windows RT только приложений, подписанных корпорацией Майкрософт и сертифицированных корпорацией Майкрософт.
Режим ConstrainedLanguage запрещает пользователям использовать PowerShell для обхода или нарушения правил УМЦИ.

Ниже приведены функции режима ConstrainedLanguage.

- Все командлеты в модулях Windows и другие командлеты, утвержденные УМЦИ, полностью работоспособны и имеют полный доступ к системным ресурсам, за исключением указанных.

- Разрешены все элементы языка сценариев PowerShell.

- Все модули, входящие в Windows, можно импортировать, а также все команды, выполняемые при экспорте модулей в сеансе.

- В рабочем процессе PowerShell можно создавать и запускать рабочие процессы скриптов (рабочие процессы, написанные на языке PowerShell). Рабочие процессы на основе XAML не поддерживаются, и вы не можете запускать XAML в рабочем процессе скрипта, например с помощью `Invoke-Expression -Language XAML` . Кроме того, рабочие процессы не могут вызывать другие рабочие процессы, хотя разрешены вложенные рабочие процессы.

- `Add-Type`Командлет может загружать подписанные сборки, но не может загрузить произвольный код C# или API-интерфейсы Win32.

- `New-Object`Командлет можно использовать только для допустимых типов (перечисленных ниже).

- В PowerShell можно использовать только допустимые типы (перечисленные ниже). Другие типы не допускаются.

- Преобразование типов разрешено, но только если результатом является допустимый тип.

- Параметры командлета, которые преобразуют входные данные строки в типы, работают только в том случае, если результирующий тип является допустимым типом.

- Можно вызвать метод **ToString ()** и методы .NET допустимых типов (перечисленных ниже). Невозможно вызвать другие методы.

- Пользователи могут получить все свойства разрешенных типов. Пользователи могут устанавливать значения свойств только для основных типов. Разрешены только следующие объекты COM:

  - **Скрипт. словарь**
  - **Scripting.FileSystemObject;**
  - **VBScript. RegExp**

В режиме ConstrainedLanguage разрешены следующие типы. Пользователи могут получать свойства, вызывать методы и преобразовывать объекты в эти типы.

Допустимые типы:

- алиасаттрибуте
- алловемптиколлектионаттрибуте
- алловемптистрингаттрибуте
- алловнуллаттрибуте
- Массив
- Bool
- byte
- char
- кмдлетбиндингаттрибуте
- Дата и время
- Decimal
- DirectoryEntry
- DirectorySearcher
- double
- FLOAT
- Guid
- Хэш-таблицы
- INT
- Int16
- long
- манажементкласс
- ManagementObject
- манажементобжектсеарчер
- нуллстринг
- аутпуттипеаттрибуте
- параметераттрибуте
- PSCredential
- псдефаултвалуеаттрибуте
- пслистмодифиер
- PSObject
- пспримитиведиктионари
- псреференце
- пстипенамеаттрибуте
- Регулярное выражение
- SByte
- строка
- суппортсвилдкардсаттрибуте
- Параметр-переключатель
- System. Globalization. CultureInfo
- System .NET. IPAddress
- System .NET. mail. MailAddress
- System. Numerics. BigInteger
- System.Security.SecureString
- TimeSpan
- UInt16
- UInt32
- UInt64

### <a name="finding-the-language-mode-of-a-session-configuration"></a>ПОИСК ЯЗЫКОВОГО РЕЖИМА КОНФИГУРАЦИИ СЕАНСА

Если конфигурация сеанса создается с помощью файла конфигурации сеанса, то конфигурация сеанса имеет свойство Лангуажемоде. Чтобы найти языковой режим, можно получить значение свойства Лангуажемоде.

```powershell
(Get-PSSessionConfiguration -Name Test).LanguageMode
FullLanguage
```

В других конфигурациях сеанса языковой режим можно найти косвенно, находя языковой режим сеанса, созданного с помощью конфигурации сеанса.

### <a name="finding-the-language-mode-of-a-session"></a>ПОИСК ЯЗЫКОВОГО РЕЖИМА СЕАНСА

Языковой режим сеанса Фулллангуаже или ConstrainedLanguage можно найти, получая значение свойства Лангуажемоде состояния сеанса.

Пример:

```powershell
$ExecutionContext.SessionState.LanguageMode
ConstrainedLanguage
```

Однако в сеансах с Рестриктедлангуаже и неязыковыми режимами нельзя использовать метод Dot для получения значений свойств. Вместо этого сообщение об ошибке отображает языковой режим.

При выполнении `$ExecutionContext.SessionState.LanguageMode` команды в сеансе Рестриктедлангуаже PowerShell возвращает сообщения об ошибках пропертиреференценотсуппортединдатасектион и вариаблереференценотсуппортединдатасектион.

- Пропертиреференценотсуппортединдатасектион: ссылки на свойства не разрешены в ограниченном языковом режиме или в разделе данных.
- Вариаблереференценотсуппортединдатасектион переменную, на которую нельзя ссылаться в ограниченном языковом режиме, или на раздел данных имеется ссылка.

При выполнении `$ExecutionContext.SessionState.LanguageMode` команды в сеансе на языке PowerShell возвращает сообщение об ошибке скриптсноталловед.

- Скриптсноталловед: синтаксис не поддерживается этим пространством выполнения. Это может быть вызвано тем, что он находится в неязыковом режиме.

## <a name="keywords"></a>СЛОВАМИ

- about_ConstrainedLanguage
- about_FullLanguage
- about_NoLanguage
- about_RestrictedLanguage

## <a name="see-also"></a>СМ. ТАКЖЕ

- [about_Session_Configuration_Files](about_Session_Configuration_Files.md)
- [about_Session_Configurations](about_Session_Configurations.md)
