---
description: Предоставляет сведения о фоновых заданиях на локальных и удаленных компьютерах.
keywords: powershell,командлет
Locale: en-US
ms.date: 10/16/2020
online version: https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_job_details?view=powershell-6&WT.mc_id=ps-gethelp
schema: 2.0.0
title: about_Job_Details
ms.openlocfilehash: f07025cd64d7affdfa7860446bd49a1944bc3af7
ms.sourcegitcommit: 108686b166672cc08817c637dd93eb1ad830511d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/17/2020
ms.locfileid: "93232957"
---
# <a name="about-job-details"></a>Сведения о задании

## <a name="short-description"></a>Краткое описание
Предоставляет сведения о фоновых заданиях на локальных и удаленных компьютерах.

## <a name="detailed-description"></a>Подробное описание

В этом разделе объясняется понятие фонового задания и предоставляются технические сведения о работе фоновых заданий в PowerShell.

Этот раздел является дополнением к разделам [about_Jobs](about_Jobs.md), [about_Thread_Jobs](about_Thread_Jobs.md)и [about_Remote_Jobs](about_Remote_Jobs.md) .

### <a name="about-background-jobs"></a>О фоновых заданиях

Фоновое задание выполняет команду или выражение асинхронно. Он может выполнять командлет, функцию, сценарий или любую другую задачу на основе команды. Она предназначена для выполнения команд, которые выполняются в течение продолжительного периода времени, но их можно использовать для выполнения любой команды в фоновом режиме.

При выполнении синхронной команды Командная строка PowerShell подавляется до завершения команды. Но фоновое задание не подавляет командную строку PowerShell. Команда для запуска фонового задания возвращает объект задания.
Запрос возвращается немедленно, чтобы можно было работать с другими задачами во время выполнения фонового задания.

Однако при запуске фонового задания результаты не получаются немедленно, даже если задание выполняется очень быстро. Возвращаемый объект задания содержит полезные сведения о задании, но не содержит результатов задания. Для получения результатов задания необходимо выполнить отдельную команду. Можно также выполнить команды для завершения задания, ожидания завершения задания и удаления задания.

Чтобы сделать время фонового задания независимым от других команд, каждое фоновое задание выполняется в отдельном сеансе PowerShell. Однако это временное подключение, которое создается только для запуска задания и затем уничтожается, либо может быть постоянным **сеансом PSSession** , который можно использовать для выполнения нескольких связанных заданий или команд.

### <a name="using-the-job-cmdlets"></a>Использование командлетов заданий

Используйте `Start-Job` команду для запуска фонового задания на локальном компьютере.
`Start-Job` Возвращает объект задания. Кроме того, можно получить объекты, представляющие задания, запущенные на локальном компьютере с помощью `Get-Job` командлета.

Чтобы получить результаты задания, используйте `Receive-Job` команду. Если задание не завершено, `Receive-Job` возвращает частичные результаты. Можно также использовать `Wait-Job` командлет для подавления командной строки до завершения одного или всех заданий, запущенных в сеансе.

Чтобы прерывать фоновое задание, используйте `Stop-Job` командлет. Чтобы удалить задание, используйте `Remove-Job` командлет.

Дополнительные сведения о работе командлетов см. в разделе справки по каждому командлету и см. [about_Jobs](about_Jobs.md).

### <a name="starting-background-jobs-on-remote-computers"></a>Запуск фоновых заданий на удаленных компьютерах

Вы можете создавать фоновые задания и управлять ими на локальном или удаленном компьютере. Чтобы запустить фоновое задание удаленно, используйте параметр **AsJob** командлета `Invoke-Command` , например, или используйте `Invoke-Command` командлет для `Start-Job` удаленного выполнения команды. Фоновое задание также можно запустить в интерактивном сеансе.

Дополнительные сведения об удаленных фоновых заданиях см. в разделе [about_Remote_Jobs](about_Remote_Jobs.md).

### <a name="child-jobs"></a>Дочерние задания

Каждое фоновое задание состоит из родительского задания и одного или нескольких дочерних заданий. В заданиях, запущенных с помощью `Start-Job` или с параметром **AsJob** `Invoke-Command` , родительским заданием является руководитель. Он не выполняет никаких команд и не возвращает никаких результатов. Команды фактически выполняются дочерними заданиями. Задания, запущенные с помощью других командлетов, могут работать по-разному.

Дочерние задания хранятся в свойстве **чилджобс** родительского объекта Job. Свойство **чилджобс** может содержать один или несколько дочерних объектов задания.
Дочерние объекты задания имеют **имя** , **идентификатор** и **InstanceId** , отличающиеся от родительского задания, что позволяет управлять родительскими и дочерними заданиями по отдельности или как единое целое.

Чтобы получить родительские и дочерние задания задания, используйте параметр **инклудечилджобс** `Get-Job` командлета. Параметр **инклудечилджоб** появился в Windows PowerShell 3,0.

```powershell
PS> Get-Job -IncludeChildJob

Id Name   PSJobTypeName State      HasMoreData   Location    Command
-- ----   ------------- -----      -----------   --------    -------
1  Job1   RemoteJob     Failed     True          localhost   Get-Process
2  Job2                 Completed  True          Server01    Get-Process
3  Job3                 Failed     False         localhost   Get-Process
```

Чтобы получить родительское задание и только дочерние задания с определенным значением **состояния** , используйте параметр **чилджобстате** `Get-Job` командлета. Параметр **чилджобстате** появился в Windows PowerShell 3,0.

```powershell
PS> Get-Job -ChildJobState Failed

Id Name   PSJobTypeName State      HasMoreData   Location    Command
-- ----   ------------- -----      -----------   --------    -------
1  Job1   RemoteJob     Failed     True          localhost   Get-Process
3  Job3                 Failed     False         localhost   Get-Process
```

Чтобы получить дочерние задания во всех версиях PowerShell, используйте свойство **чилджоб** родительского задания.

```powershell
PS> (Get-Job Job1).ChildJobs

Id Name   PSJobTypeName State      HasMoreData   Location    Command
-- ----   ------------- -----      -----------   --------    -------
2  Job2                 Completed  True          Server01    Get-Process
3  Job3                 Failed     False         localhost   Get-Process
```

Можно также использовать `Get-Job` команду в дочернем задании, как показано в следующей команде:

```powershell
PS> Get-Job Job3

Id Name   PSJobTypeName State      HasMoreData   Location    Command
-- ----   ------------- -----      -----------   --------    -------
3  Job3                 Failed     False         localhost   Get-Process
```

Настройка дочернего задания зависит от команды, используемой для запуска задания.

- При использовании `Start-Job` для запуска задания на локальном компьютере задание состоит из родительского задания и дочернего задания, выполняющего команду.

- При использовании параметра **AsJob** `Invoke-Command` в для запуска задания на одном или нескольких компьютерах задание состоит из родительского задания и дочернего задания для каждого задания, выполняемого на каждом компьютере.

- При использовании `Invoke-Command` для выполнения `Start-Job` команды на одном или нескольких удаленных компьютерах результат совпадает с локальной командой, выполняемой на каждом удаленном компьютере. Команда возвращает объект задания для каждого компьютера. Объект задания состоит из родительского задания руководителя и одного дочернего задания, которое выполняет команду.

Родительское задание представляет все дочерние задания. При управлении родительским заданием также управляются связанные с ним дочерние задания. Например, если остановить родительское задание, все дочерние задания будут остановлены. Если вы получаете результаты родительского задания, вы получаете результаты всех дочерних заданий.

Однако вы также можете управлять дочерними заданиями по отдельности. Это наиболее полезно, если нужно исследовать проблему с заданием или получить результаты только одного из нескольких дочерних заданий, запущенных с помощью параметра **AsJob** `Invoke-Command` .

Следующая команда использует параметр **AsJob** параметра `Invoke-Command` для запуска фоновых заданий на локальном компьютере и на двух удаленных компьютерах. Команда сохраняет задание в `$j` переменной.

```powershell
PS> $j = Invoke-Command -ComputerName localhost, Server01, Server02 `
-Command {Get-Date} -AsJob
```

При отображении свойств Name и **чилджоб** задания в `$j` отображается, что команда вернула объект задания с тремя дочерними заданиями, по одному для каждого компьютера.

```powershell
PS> $j | Format-List Name, ChildJobs

Name      : Job3
ChildJobs : {Job4, Job5, Job6}
```

При отображении родительского задания показывается, что задание завершилось ошибкой.

```powershell
PS> $j

Id Name   PSJobTypeName State      HasMoreData   Location
-- ----   ------------- -----      -----------   --------
3  Job3   RemotingJob   Failed     False         localhost,Server...
```

Но при выполнении `Get-Job` команды, которая получает дочерние задания, выходные данные показывают, что не удалось выполнить только одно дочернее задание.

```powershell
PS> Get-Job -IncludeChildJobs

Id  Name   PSJobTypeName State      HasMoreData   Location    Command
--  ----   ------------- -----      -----------   --------    -------
3   Job3   RemotingJob   Failed     False         localhost,Server...
4   Job4                 Completed  True          localhost   Get-Date
5   Job5                 Failed     False         Server01    Get-Date
6   Job6                 Completed  True          Server02    Get-Date
```

Чтобы получить результаты всех дочерних заданий, используйте `Receive-Job` командлет, чтобы получить результаты родительского задания. Но вы также можете получить результаты конкретного дочернего задания, как показано в следующей команде.

```powershell
PS> Receive-Job -Name Job6 -Keep | Format-Table ComputerName,
>> DateTime -AutoSize
ComputerName DateTime
------------ --------
Server02     Thursday, March 13, 2008 4:16:03 PM
```

Функция дочерних заданий в фоновых заданиях PowerShell обеспечивает более полный контроль над выполняемыми заданиями.

### <a name="job-types"></a>Типы заданий

PowerShell поддерживает различные типы заданий для различных задач. Начиная с Windows PowerShell 3,0, разработчики могут создавать "адаптеры источников заданий", которые добавляют новые типы заданий в PowerShell и включают в модули исходные адаптеры заданий.
При импорте модуля можно использовать новый тип задания в своем сеансе.

Например, модуль PSScheduledJob добавляет запланированные задания, а модуль PSWorkflow добавляет задания рабочего процесса.

Типы пользовательских заданий могут значительно отличаться от стандартных фоновых заданий PowerShell. Например, запланированные задания сохраняются на диске; они не существуют только в определенном сеансе. Задания рабочего процесса могут быть приостановлены и возобновлены.

Командлеты, используемые для управления пользовательскими заданиями, зависят от типа задания. Для некоторых из них используются стандартные командлеты задания, такие как `Get-Job` и `Start-Job` . Другие поставляются с специализированными командлетами, которые управляют только определенным типом задания. Подробные сведения о типах настраиваемых заданий см. в разделах справки о типе задания.

Чтобы найти тип задания, используйте `Get-Job` командлет. `Get-Job` Возвращает различные объекты задания для различных типов заданий. Значение свойства **псжобтипенаме** объектов задания, которое `Get-Job` возвращает, указывает тип задания.

В следующей таблице перечислены типы заданий, которые входят в состав PowerShell.

|    Тип задания    |                       Описание                        |
| -------------- | -------------------------------------------------------- |
| баккграунджоб  | Запущено с помощью `Start-Job` командлета.                    |
| ремотежоб      | Запущено использование параметра **AsJob**             |
|                | `Invoke-Command`.                                 |
| псворкфловжоб  | Запущено использование параметра **AsJob** рабочего процесса.     |
| PSScheduledJob | Экземпляр запланированного задания, запущенный триггером задания. |
| Цимжоб         | Запущено использование параметра **AsJob** командлета из |
|                | Модуль CDXML.                                            |
| вмижоб         | Запущено использование параметра **AsJob** командлета из |
|                | Модуль WMI.                                              |
| PSEventJob     | Создано с использованием `Register-ObjectEvent` и указанием    |
|                | действие с параметром **Action** .                    |

Примечание. перед использованием `Get-Job` командлета для получения заданий определенного типа убедитесь, что модуль, добавляющий тип задания, импортируется в текущий сеанс.
В противном случае не `Get-Job` получает задания этого типа.

## <a name="examples"></a>Примеры

Следующие команды создают локальное фоновое задание, удаленное фоновое задание, задание рабочего процесса и запланированное задание. Затем он использует `Get-Job` командлет для получения заданий. `Get-Job` не получает запланированное задание, но возвращает все запущенные экземпляры запланированного задания.

Запуск фонового задания на локальном компьютере.

```powershell
PS> Start-Job -Name LocalData {Get-Process}

Id Name        PSJobTypeName   State   HasMoreData   Location   Command
-- ----        -------------   -----   -----------   --------   -------
2  LocalData   BackgroundJob   Running        True   localhost  Get-Process
```

Запуск фонового задания, выполняемого на удаленном компьютере.

```powershell
PS> Invoke-Command -ComputerName Server01 {Get-Process} `
-AsJob -JobName RemoteData

Id  Name        PSJobTypeName  State   HasMoreData   Location   Command
--  ----        -------------  -----   -----------   --------   -------
2   RemoteData  RemoteJob      Running        True   Server01   Get-Process
```

Создание запланированного задания

```powershell
PS>  Register-ScheduledJob -Name ScheduledJob -ScriptBlock `
 {Get-Process} -Trigger (New-JobTrigger -Once -At "3 PM")

Id         Name            JobTriggers     Command       Enabled
--         ----            -----------     -------       -------
1          ScheduledJob    1               Get-Process   True
```

Создайте рабочий процесс.

```powershell
PS> workflow Test-Workflow {Get-Process}
```

Запустите рабочий процесс как задание.

```powershell

PS> Test-Workflow -AsJob -JobName TestWFJob

Id  Name       PSJobTypeName   State   HasMoreData   Location   Command
--  ----       -------------   -----   -----------   --------   -------
2   TestWFJob  PSWorkflowJob   NotStarted     True   localhost  Get-Process
```

Получение заданий. Команда не получает `Get-Job` запланированные задания, но получает экземпляры запущенного запланированного задания.

```powershell
PS> Get-Job

Id  Name         PSJobTypeName  State     HasMoreData  Location  Command
--  ----         -------------  -----     -----------  --------  -------
2   LocalData    BackgroundJob  Completed True         localhost Get-Process
4   RemoteData   RemoteJob      Completed True         Server01  Get-Process
6   TestWFJob    PSWorkflowJob  Completed True         localhost WorkflowJob
8   ScheduledJob PSScheduledJob Completed True         localhost Get-Process
```

Чтобы получить запланированные задания, используйте `Get-ScheduledJob` командлет.

```powershell
PS> Get-ScheduledJob

Id         Name            JobTriggers     Command       Enabled
--         ----            -----------     -------       -------
1          ScheduledJob    1               Get-Process   True
```

## <a name="see-also"></a>См. также статью

- [about_Jobs](about_Jobs.md)
- [about_Remote_Jobs](about_Remote_Jobs.md)
- [about_Thread_Jobs](about_Thread_Jobs.md)
- [about_Remote](about_Remote.md)
- [Invoke-Command](xref:Microsoft.PowerShell.Core.Invoke-Command)
- [Start-Job](xref:Microsoft.PowerShell.Core.Start-Job)
- [Get-Job.](xref:Microsoft.PowerShell.Core.Get-Job)
- [Wait-Job](xref:Microsoft.PowerShell.Core.Wait-Job)
- [Stop-Job.](xref:Microsoft.PowerShell.Core.Stop-Job)
- [Remove-Job](xref:Microsoft.PowerShell.Core.Remove-Job)
- [New-PSSession](xref:Microsoft.PowerShell.Core.New-PSSession)
- [Enter-PSSession](xref:Microsoft.PowerShell.Core.Enter-PSSession)
- [Exit-PSSession;](xref:Microsoft.PowerShell.Core.Exit-PSSession)
