---
external help file: Microsoft.PowerShell.Commands.Utility.dll-Help.xml
keywords: powershell,командлет
Locale: en-US
Module Name: Microsoft.PowerShell.Utility
ms.date: 06/09/2017
online version: https://docs.microsoft.com/powershell/module/microsoft.powershell.utility/import-localizeddata?view=powershell-6&WT.mc_id=ps-gethelp
schema: 2.0.0
title: Import-LocalizedData
ms.openlocfilehash: 552e37f8bef096ec7d072d41186f8919bc58f630
ms.sourcegitcommit: 9b28fb9a3d72655bb63f62af18b3a5af6a05cd3f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/07/2020
ms.locfileid: "93228153"
---
# Import-LocalizedData

## Краткий обзор
Импортирует данные, зависящие от языка, в сценарии и функции в зависимости от языка и региональных параметров пользовательского интерфейса, выбранного для операционной системы.

## SYNTAX

```
Import-LocalizedData [[-BindingVariable] <String>] [[-UICulture] <String>] [-BaseDirectory <String>]
 [-FileName <String>] [-SupportedCommand <String[]>] [<CommonParameters>]
```

## DESCRIPTION

Командлет **Import-LocalizedData** динамически получает строки из подкаталога, имя которого соответствует языку пользовательского интерфейса, заданному для текущего пользователя операционной системы.
Его задачей является включение сценариев для отображения сообщений для пользователей на языке пользовательского интерфейса, выбранного текущим пользователем.

**Import-локализеддата** импортирует данные из файлов PSD1 в подкаталогах, зависящих от языка, и сохраняет их в локальной переменной, указанной в команде.
Командлет выбирает подкаталог и файл на основе значения автоматической переменной $PSUICulture.
При использовании локальной переменной в сценарии для отображения сообщения для пользователя сообщение отображается на языке пользовательского интерфейса пользователя.

Для указания дополнительного языка и региональных параметров пользовательского интерфейса, пути и имени файла, а также для добавления поддерживаемых команд и отключения сообщений об ошибке (которые появляются, если не найдены PSD1-файлы) можно использовать параметры командлета **Import-LocalizedData** .

Командлет **Import-LocalizedData** поддерживает инициативу интернационализации сценариев, которая была представлена в Windows PowerShell 2.0.
Целью этой инициативы является повышение качества обслуживания пользователей по всему миру благодаря упрощению написания сценариев для отображения сообщений для пользователя на языке интерфейса текущего пользователя.
Дополнительные сведения об этом и формате psd1ных файлов см. в разделе about_Script_Internationalization.

## Примеры

### Пример 1. Импорт текстовых строк

```
PS C:\> Import-LocalizedData -BindingVariable "Messages"
```

Эта команда импортирует текстовые строки в переменную $Messages.
Она использует значения по умолчанию для всех остальных параметров командлета.

Если команда включена в сценарий Archives.ps1 в каталоге C:\Test, и значение автоматической переменной $PsUICulture — zh-CN, командлет **Import-LocalizedData** импортирует файл Archives.psd1 в каталоге C:\test\zh-CN в переменную $Messages.

### Пример 2. Импорт локализованных строк данных

```
PS C:\> Import-LocalizedData -FileName "Test.psd1" -UICulture "en-US"

Name                           Value
----                           -----
Msg3                           "Use $_ to represent the object that is being processed."
Msg2                           "This command requires the credentials of a member of the Administrators group on the...
Msg1                           "The Name parameter is missing from the command."
```

Эта команда выполняется из командной строки; а не в сценарии.
Он получает локализованные строки данных из файла Test.psd1 и отображает их в командной строке.
Поскольку команда не используется в сценарии, параметр *FileName* является обязательным.
В команде используется параметр *UICulture* для указания языка и региональных параметров en-US.

Командлет **Import-локализеддата** Возвращает хэш-таблицу, содержащую локализованные строки данных.

### Пример 3. Импорт строк языка и региональных параметров пользовательского интерфейса

```
PS C:\> Import-LocalizedData -BindingVariable "MsgTbl" -UICulture "ar-SA" -FileName "Simple" -BaseDirectory "C:\Data\Localized"
```

Эта команда импортирует текстовые строки в переменную $MsgTbl скрипта.

Она использует параметр *UICulture* , чтобы дать командлету указание импортировать данные из файла Simple.psd1 в подкаталог ar-SA каталога C:\Data\Localized.

### Пример 4. Импорт локализованных данных в скрипт

```
PS C:\> # In C:\Test\en-US\Test.psd1:

ConvertFrom-StringData @'

# English strings

Msg1 = "The Name parameter is missing from the command."
Msg2 = "This command requires the credentials of a member of the Administrators group on the computer."
Msg3 = "Use $_ to represent the object that is being processed."
'@

# In C:\Test\Test.ps1

Import-LocalizedData -BindingVariable "Messages"
Write-Host $Messages.Msg2

# In PowerShell

PS C:\> .\Test.ps1

This command requires the credentials of a member of the Administrators group on the computer.
```

В этом примере показано, как использовать локализованные данные в простом сценарии.

В первой части примера показано содержимое файла Test.psd1.
Он содержит команду ConvertFrom-StringData, преобразующую ряд именованных текстовых строк в хэш-таблицу.
Файл Test.psd1 находится в подкаталоге en-US каталога C:\Test, содержащего сценарий.

Во второй части примера показано содержимое сценария Test.ps1.
Он содержит команду **Import-локализеддата** , которая импортирует данные из соответствующего PSD1-файла в переменную $messages и команду Write-Host, записывающую одно из сообщений в $Messagesую переменную в главное приложение.

В последней части примера выполняется сценарий.
Выходные данные показывают, что отображается правильное сообщение для пользователя на языке пользовательского интерфейса, заданном для текущего пользователя операционной системы.

### Пример 5. Замена текстовых строк по умолчанию в скрипте

```
PS C:\> # In TestScript.ps1
$UserMessages = DATA

{    ConvertFrom-StringData @'

    # English strings

        Msg1 = "Enter a name."
        Msg2 = "Enter your employee ID."
        Msg3 = "Enter your building number."
'@ }
Import-LocalizedData -BindingVariable "UserMessages"
$UserMessages.Msg1...
```

В этом примере показано, как использовать командлет **Import-LocalizedData** для замены текстовых строк по умолчанию, определенных в разделе DATA сценария.

В этом примере раздел данных скрипта TestScript.ps1 содержит команду ConvertFrom-StringData, которая преобразует содержимое раздела данных в хэш-таблицу и сохраняет в значении переменной $UserMessages.

Сценарий также включает команду **Import-LocalizedData** , которая импортирует хэш-таблицу преобразованных текстовых строк из файла TestScript.psd1 в подкаталоге, указанном значением переменной $PsUICulture.
Если команда находит PSD1-файл, она сохраняет переведенные строки из файла в значение той же переменной $UserMessages, перезаписывая хэш-таблицу, сохраненную логикой раздела DATA.

Третья команда отображает первое сообщение в переменной $UserMessages.

Если команда **Import-LocalizedData** находит PSD1-файл для языка $PsUICulture, значение переменной $UserMessages содержит переведенные текстовые строки.
В случае сбоя команды по какой-либо причине команда отображает текстовые строки по умолчанию, определенные в разделе DATA сценария.

### Пример 6. Отключение сообщений об ошибках, если культура пользовательского интерфейса не найдена

```
PS C:\> # In Day1.ps1

Import-LocalizedData -BindingVariable "Day"

# In Day2.ps1

Import-LocalizedData -BindingVariable "Day" -ErrorAction:SilentlyContinue

PS C:\> .\Day1.ps1
Import-LocalizedData : Cannot find PowerShell data file 'Day1.psd1' in directory 'C:\ps-test\fr-BE\' or any parent culture directories.
At C:\ps-test\Day1.ps1:17 char:21+ Import-LocalizedData <<<<  Day
Today is Tuesday PS C:\> .\Day2.ps1
Today is Tuesday
```

В этом примере показано, как отключить сообщения об ошибках, которые появляются, если командлет **Import-LocalizedData** не может найти каталоги, которые соответствуют языку и региональным параметрам пользовательского интерфейса текущего пользователя, или PSD1-файл для сценария в этих каталогах.

Для отключения сообщений об ошибке можно использовать общий параметр *ErrorAction* со значением SilentlyContinue.
Это особенно удобно, если вы предоставили пользовательские сообщения на языке по умолчанию или на резервной, и сообщение об ошибке не требуется.

В этом примере сравниваются два сценария, Day1.ps1 и Day2.ps1, которые включают команду **Import-LocalizedData** .
Скрипты идентичны, за исключением того, что Day2 использует общий параметр *ErrorAction* со значением SilentlyContinue.

Пример вывода показывает результаты выполнения обоих сценариев, если для языка и региональных параметров пользовательского интерфейса задано значение fr-BE, и для этого языка и параметров интерфейса не найдены соответствующие файлы или каталоги.
Day1.ps1 отображает сообщение об ошибке и данные на английском языке.
Day2.ps1 отображает только данные на английском языке.

## PARAMETERS

### -Баседиректори

Указывает базовый каталог, в котором находятся PSD1-файлы
По умолчанию используется каталог, в котором расположен сценарий.
**Import-LocalizedData** выполняет поиск PSD1-файлов для сценария во вложенных подкаталогах базового каталога, определяемых языком.

```yaml
Type: System.String
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -Биндингвариабле

Задает переменную, в которую импортируются текстовые строки.
Введите имя переменной без знака доллара ($).

В Windows PowerShell 2.0 этот параметр является обязательным.
В Windows PowerShell 3.0 этот параметр является необязательным.
Если опустить этот параметр, командлет **Import-LocalizedData** возвращает хэш-таблицу текстовых строк.
Хэш-таблица передается по конвейеру или отображается в командной строке.

При использовании **Import-LocalizedData** для замены текстовых строк по умолчанию, указанных в разделе DATA сценария, назначьте раздел DATA переменной и введите имя переменной раздела DATA в значение параметра *BindingVariable* .
Затем, когда командлет **Import-LocalizedData** сохранит импортированное содержимое в *BindingVariable* , импортированные данные будут заменены текстовыми строками по умолчанию.
Если вы не указываете текстовые строки по умолчанию, можно выбрать любое имя переменной.

```yaml
Type: System.String
Parameter Sets: (All)
Aliases: Variable

Required: False
Position: 0
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -FileName

Задает имя файла данных (PSD1) для импорта.
Введите имя файла.
Можно указать имя файла, которое не включает расширение имени файла (PSD1), или имя файла, включающее его.

Параметр *FileName* является обязательным, если командлет **Import-LocalizedData** не используется в сценарии.
В противном случае параметр является необязательным, и значение по умолчанию — базовое имя сценария.
Этот параметр можно использовать для отправки командлету **Import-LocalizedData** указания найти данные для другого PSD1-файла.

Например, если имя *файла* не указано и сценарий имеет FindFiles.ps1, то **Import-локализеддата** ищет файл данных FindFiles.psd1.

```yaml
Type: System.String
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -Суппортедкомманд

Задает командлеты и функции, которые создают только данные.

Используйте этот параметр для включения командлетов и функций, которые вы написали или протестировали.
Дополнительные сведения см. в разделе about_Script_Internationalization.

```yaml
Type: System.String[]
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -UICulture

Указывает дополнительный язык и региональные параметры пользовательского интерфейса.
Значение по умолчанию — значение автоматической переменной $PsUICulture.
Введите язык и региональные параметры пользовательского интерфейса в \<language\> - \<region\> формате, например en-US, de-de или AR-SA.

Значение параметра *UICulture* определяет зависящий от языка подкаталог (в пределах базового каталога), из которого командлет **Import-LocalizedData** получает PSD1-файл для сценария.

Командлет выполняет поиск подкаталога с тем же именем, что и значение параметра *UICulture* , или $PsUICultureую автоматическую переменную, например DE-de или AR-SA.
Если не удается найти каталог или каталог не содержит PSD1-файл для скрипта, он ищет подкаталог с именем кода языка, например de или AR.
Если не удается найти подкаталог или PSD1-файл, команда завершается ошибкой, и данные отображаются на языке по умолчанию, указанном в сценарии.

```yaml
Type: System.String
Parameter Sets: (All)
Aliases:

Required: False
Position: 1
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### Общие параметры

Этот командлет поддерживает общие параметры: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction и -WarningVariable. См. сведения в разделе [about_CommonParameters](https://go.microsoft.com/fwlink/?LinkID=113216).

## Входные данные

### Нет

В этот командлет нельзя передать входные данные.

## Выходные данные

### System.Collections.Hashtable

Командлет **Import-локализеддата** сохраняет хэш-таблицу в переменной, заданной значением параметра **биндингвариабле** .

## ПРИМЕЧАНИЯ

* Перед использованием командлета **Import-LocalizedData** осуществите локализацию сообщений для пользователя. Форматируйте сообщения для каждого языкового стандарта (языка и региональных параметров интерфейса) в хэш-таблицу пар "ключ-значение" и сохраните хэш-таблицу в файл с тем же именем, что и сценарий и расширение имени PSD1-файла. Создайте в каталоге сценария каталог для каждого поддерживаемого языка и региональных параметров пользовательского интерфейса и сохраните PSD1-файл для каждого языка интерфейса в каталоге с именем языка и региональных параметров данного интерфейса.

  Например, выполните локализацию сообщений для пользователя для языкового стандарта de-DE и форматируйте их в хэш-таблицу.
Сохраните хэш-таблицу в файл \<ScriptName\>.psd1.
Затем создайте подкаталог de-DE в каталоге сценария и сохраните файл \<ScriptName\>.psd1 для de-DE в подкаталоге de-DE.
Повторите эту процедуру для каждого поддерживаемого решением языкового стандарта.

* **Import-локализеддата** выполняет структурированный поиск локализованных сообщений пользователя для сценария.

  Командлет **Import-локализеддата** начинает поиск в каталоге, где расположен файл скрипта (или значение параметра *баседиректори* ).
Затем он ищет в базовом каталоге подкаталог с тем же именем, что и значение переменной $PsUICulture (или значение параметра *UICulture* ), например DE-de или AR-SA.
Затем он выполняет в этом подкаталоге поиск PSD1-файла с тем же именем, что и имя сценария (или значение параметра *FileName* ).

  Если **Import-локализеддата** не удается найти подкаталог с именем языка и региональных параметров пользовательского интерфейса, или подкаталог не содержит PSD1-файл для скрипта, он выполняет поиск файла. PSD1 для сценария в подкаталоге с именем кода языка, например de или AR.
Если не удается найти подкаталог или PSD1-файл, команда завершается ошибкой, данные отображаются на языке по умолчанию, указанном в сценарии, и выводится сообщение об ошибке, поясняющее, что не удалось импортировать данные.
Чтобы отключить сообщение и корректно завершить его работу, используйте общий параметр *ErrorAction* со значением SilentlyContinue.

  Если командлет **Import-LocalizedData** находит подкаталог и PSD1-файл, он импортирует хэш-таблицу сообщения для пользователя в значение параметра *BindingVariable* в команде.
Затем при отображении сообщения из хэш-таблицы в переменной отображается локализованное сообщение.

  Дополнительные сведения см. в разделе [about_Script_Internationalization](../Microsoft.PowerShell.Core/about/about_Script_Internationalization.md).

## Связанные ссылки

[Write-Host](Write-Host.md)

[Import-PowerShellDataFile](Import-PowerShellDataFile.md)
