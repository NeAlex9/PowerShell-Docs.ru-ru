---
title: Загрузка и экспорт данных форматирования | Документация Майкрософт
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 2a48de31-7961-4b0e-b58b-93466e38370b
caps.latest.revision: 6
ms.openlocfilehash: 5c5168ffd74c15066b914ad1b39d9ead947c5e7f
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62065212"
---
# <a name="loading-and-exporting-formatting-data"></a>Загрузка и экспорт данных форматирования

После создания файла форматирования, необходимо обновить данные форматирования сеанса, загрузив файлы в текущем сеансе. (Файлы форматирования, предоставляемые Windows PowerShell, загружаются средствами оснастки, зарегистрированные при открытии текущего сеанса.) После обновления данные форматирования текущего сеанса Windows PowerShell использует эти данные для отображения объектов .NET, связанный с представления, определенные в загруженных файлах форматирования. Нет ограничений на количество файлы форматирования, которые можно загрузить в текущем сеансе. Помимо обновления данные форматирования, можно экспортировать данные форматирования в текущем сеансе обратно в файл форматирования.

## <a name="loading-format-data"></a>Загрузка формат данных

Файлы форматирования могут быть загружены в текущий сеанс, используя следующие методы:

- Файл форматирования можно импортировать в текущий сеанс из командной строки. Используйте [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) командлет, как описано в следующей процедуре.

- Можно создать манифест модуля, который ссылается на файл форматирования. Модули позволяют вам форматирование файлы для распространения пакета. Используйте [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) командлет, чтобы создать манифест и [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) командлет, чтобы загрузить модуль в текущий сеанс. Дополнительные сведения о модулях см. в разделе [написание модуля Windows PowerShell](../module/writing-a-windows-powershell-module.md).

- Можно создать оснастки, ссылающийся на файле форматирования. Используйте [System.Management.Automation.PSSnapIn.Formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) для ссылки на файлы форматирования. Это настоятельно рекомендуется использовать модули в командлетах пакета и связанное форматирование и типы файлов для распространения. Дополнительные сведения о модулях см. в разделе [написание модуля Windows PowerShell](../module/writing-a-windows-powershell-module.md).

- При вызове команды программными средствами, можно добавить запись в файле форматирования к состоянию исходного сеанса пространство выполнения, где выполняются команды. Дополнительные сведения о типе .NET, используемый для добавления файла форматирования см. в разделе [System.Management.Automation.Runspaces.Sessionstateformatentry? Displayproperty = Fullname](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) класса.

Когда загружается файл форматирования, он добавляется в во внутренний список, что Windows PowerShell использует, чтобы определить, какое представление для отображения объектов в командной строке. Можно добавить в начало файла форматирования в начале списка, или его можно добавить в конец списка. Когда файл форматирования добавляется в этот список важно знать при загрузке файл форматирования, который определяет представление для объекта, который был определен, например если требуется изменить, как объект, который возвращается с помощью командлета Windows PowerShell core представляет собой существующее представление  отображается. Если вы загружаете файл форматирования, который определяет представление только для объекта, можно использовать любой из описанных выше способов.  Если вы загружаете файл форматирования, который определяет другое представление для объекта, необходимо использовать [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) командлета и добавить в начало файла в начало списка.

## <a name="storing-your-formatting-file"></a>Сохранение файла форматирования

Нет необходимости для хранения файлов форматирования на диске. Тем не менее настоятельно рекомендуется хранить их в следующую папку: `user\documents\windowspowershell\`

#### <a name="loading-a-format-file-using-import-formatdata"></a>Загрузка файла форматирования с помощью импорта-FormatData

1. Store форматирования файла на диск.

2. Запустите [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) командлет, используя один из следующих команд.

   Чтобы добавить форматирование файла в начало списка используйте следующую команду. Используйте следующую команду, чтобы изменить способ отображения объекта.

   ```powershell
   Update-FormatData -PrependPath PathToFormattingFile
   ```

   Чтобы добавить форматирование файла в конец списка используйте следующую команду.

   ```powershell
   Update-FormatData -AppendPath PathToFormattingFile
   ```

   После добавления в файл с помощью [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) командлет, вам не удается удалить файл из списка при открытом сеансе. Необходимо закрыть сеанса, чтобы удалить файл форматирования из списка.

## <a name="exporting-format-data"></a>Экспорт данных в формате

Вставьте сюда основную часть.
