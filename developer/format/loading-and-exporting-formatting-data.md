---
title: Загрузка и экспорт данных форматирования | Документация Майкрософт
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 2a48de31-7961-4b0e-b58b-93466e38370b
caps.latest.revision: 6
ms.openlocfilehash: 08c64d4094d8ba6c551b454887331666f0694f11
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/03/2019
ms.locfileid: "56860630"
---
# <a name="loading-and-exporting-formatting-data"></a><span data-ttu-id="71619-102">Загрузка и экспорт данных форматирования</span><span class="sxs-lookup"><span data-stu-id="71619-102">Loading and Exporting Formatting Data</span></span>

<span data-ttu-id="71619-103">После создания файла форматирования, необходимо обновить данные форматирования сеанса, загрузив файлы в текущем сеансе.</span><span class="sxs-lookup"><span data-stu-id="71619-103">Once you have created your formatting file, you need to update the format data of the session by loading your files into the current session.</span></span> <span data-ttu-id="71619-104">(Файлы форматирования, предоставляемые Windows PowerShell, загружаются средствами оснастки, зарегистрированные при открытии текущего сеанса.) После обновления данные форматирования текущего сеанса Windows PowerShell использует эти данные для отображения объектов .NET, связанный с представления, определенные в загруженных файлах форматирования.</span><span class="sxs-lookup"><span data-stu-id="71619-104">(The formatting files provided by Windows PowerShell are loaded by snap-ins that are registered when the current session is opened.) Once the format data of the current session is updated, Windows PowerShell uses that data to display the .NET objects associated with the views defined in the loaded formatting files.</span></span> <span data-ttu-id="71619-105">Нет ограничений на количество файлы форматирования, которые можно загрузить в текущем сеансе.</span><span class="sxs-lookup"><span data-stu-id="71619-105">There is no limit to the number of formatting files that you can load into the current session.</span></span> <span data-ttu-id="71619-106">Помимо обновления данные форматирования, можно экспортировать данные форматирования в текущем сеансе обратно в файл форматирования.</span><span class="sxs-lookup"><span data-stu-id="71619-106">In addition to updating the formatting data, you can export the format data in the current session back to a formatting file.</span></span>

## <a name="loading-format-data"></a><span data-ttu-id="71619-107">Загрузка формат данных</span><span class="sxs-lookup"><span data-stu-id="71619-107">Loading format data</span></span>

<span data-ttu-id="71619-108">Файлы форматирования могут быть загружены в текущий сеанс, используя следующие методы:</span><span class="sxs-lookup"><span data-stu-id="71619-108">Formatting files can be loaded into the current session using the following methods:</span></span>

- <span data-ttu-id="71619-109">Файл форматирования можно импортировать в текущий сеанс из командной строки.</span><span class="sxs-lookup"><span data-stu-id="71619-109">You can import the formatting file into the current session from the command line.</span></span> <span data-ttu-id="71619-110">Используйте [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) командлет, как описано в следующей процедуре.</span><span class="sxs-lookup"><span data-stu-id="71619-110">Use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet as described in the following procedure.</span></span>
- <span data-ttu-id="71619-111">Файл форматирования можно импортировать в текущий сеанс из командной строки.</span><span class="sxs-lookup"><span data-stu-id="71619-111">You can import the formatting file into the current session from the command line.</span></span> <span data-ttu-id="71619-112">Используйте [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) командлет, как описано в следующей процедуре.</span><span class="sxs-lookup"><span data-stu-id="71619-112">Use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet as described in the following procedure.</span></span>

- <span data-ttu-id="71619-113">Можно создать манифест модуля, который ссылается на файл форматирования.</span><span class="sxs-lookup"><span data-stu-id="71619-113">You can create a module manifest that references your formatting file.</span></span> <span data-ttu-id="71619-114">Модули позволяют вам форматирование файлы для распространения пакета.</span><span class="sxs-lookup"><span data-stu-id="71619-114">Modules allow you to package you formatting files for distribution.</span></span> <span data-ttu-id="71619-115">Используйте [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) командлет, чтобы создать манифест и [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) командлет, чтобы загрузить модуль в текущий сеанс.</span><span class="sxs-lookup"><span data-stu-id="71619-115">Use the [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) cmdlet to create the manifest, and the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to load the module into the current session.</span></span> <span data-ttu-id="71619-116">Дополнительные сведения о модулях см. в разделе [написание модуля Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="71619-116">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>
- <span data-ttu-id="71619-117">Можно создать манифест модуля, который ссылается на файл форматирования.</span><span class="sxs-lookup"><span data-stu-id="71619-117">You can create a module manifest that references your formatting file.</span></span> <span data-ttu-id="71619-118">Модули позволяют вам форматирование файлы для распространения пакета.</span><span class="sxs-lookup"><span data-stu-id="71619-118">Modules allow you to package you formatting files for distribution.</span></span> <span data-ttu-id="71619-119">Используйте [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) командлет, чтобы создать манифест и [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) командлет, чтобы загрузить модуль в текущий сеанс.</span><span class="sxs-lookup"><span data-stu-id="71619-119">Use the [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) cmdlet to create the manifest, and the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to load the module into the current session.</span></span> <span data-ttu-id="71619-120">Дополнительные сведения о модулях см. в разделе [написание модуля Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="71619-120">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="71619-121">Можно создать оснастки, ссылающийся на файле форматирования.</span><span class="sxs-lookup"><span data-stu-id="71619-121">You can create a snap-in that references your formatting file.</span></span> <span data-ttu-id="71619-122">Используйте [System.Management.Automation.Pssnapin.Formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) для ссылки на файлы форматирования.</span><span class="sxs-lookup"><span data-stu-id="71619-122">Use the [System.Management.Automation.Pssnapin.Formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) to reference your formatting files.</span></span> <span data-ttu-id="71619-123">Это настоятельно рекомендуется использовать модули в командлетах пакета и связанное форматирование и типы файлов для распространения.</span><span class="sxs-lookup"><span data-stu-id="71619-123">It is strongly encouraged to use modules to package cmdlets, and any associated formatting and types files for distribution.</span></span> <span data-ttu-id="71619-124">Дополнительные сведения о модулях см. в разделе [написание модуля Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="71619-124">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="71619-125">При вызове команды программными средствами, можно добавить запись в файле форматирования к состоянию исходного сеанса пространство выполнения, где выполняются команды.</span><span class="sxs-lookup"><span data-stu-id="71619-125">If you are invoking commands programmatically, you can add a formatting file entry to the initial session state of the runspace where the commands are run.</span></span> <span data-ttu-id="71619-126">Дополнительные сведения о типе .NET, используемый для добавления файла форматирования см. в разделе [System.Management.Automation.Runspaces.Sessionstateformatentry? Displayproperty = Fullname](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) класса.</span><span class="sxs-lookup"><span data-stu-id="71619-126">For more information about .NET type used to add the formatting file, see the [System.Management.Automation.Runspaces.Sessionstateformatentry?Displayproperty=Fullname](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) class.</span></span>

<span data-ttu-id="71619-127">Когда загружается файл форматирования, он добавляется в во внутренний список, что Windows PowerShell использует, чтобы определить, какое представление для отображения объектов в командной строке.</span><span class="sxs-lookup"><span data-stu-id="71619-127">When a formatting file is loaded, it is added to an internal list that Windows PowerShell uses to determine which view to use when displaying objects at the command line.</span></span> <span data-ttu-id="71619-128">Можно добавить в начало файла форматирования в начале списка, или его можно добавить в конец списка.</span><span class="sxs-lookup"><span data-stu-id="71619-128">You can prepend your formatting file to the beginning of the list, or you can append it to the end of the list.</span></span> <span data-ttu-id="71619-129">Когда файл форматирования добавляется в этот список важно знать при загрузке файл форматирования, который определяет представление для объекта, который был определен, например если требуется изменить, как объект, который возвращается с помощью командлета Windows PowerShell core представляет собой существующее представление  отображается.</span><span class="sxs-lookup"><span data-stu-id="71619-129">Knowing where your formatting file is added to this list is important if you are loading formatting file that defines a view for an object that has an existing view defined, such as when you want to change how an object that is returned by a Windows PowerShell core cmdlet is displayed.</span></span> <span data-ttu-id="71619-130">Если вы загружаете файл форматирования, который определяет представление только для объекта, можно использовать любой из описанных выше способов.</span><span class="sxs-lookup"><span data-stu-id="71619-130">If you are loading a formatting file that defines the only view for an object, you can use any of the methods described previously.</span></span>  <span data-ttu-id="71619-131">Если вы загружаете файл форматирования, который определяет другое представление для объекта, необходимо использовать [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) командлета и добавить в начало файла в начало списка.</span><span class="sxs-lookup"><span data-stu-id="71619-131">If you are loading a formatting file that defines another view for an object, you must use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet and prepend your file to the beginning of the list.</span></span>
<span data-ttu-id="71619-132">Когда загружается файл форматирования, он добавляется в во внутренний список, что Windows PowerShell использует, чтобы определить, какое представление для отображения объектов в командной строке.</span><span class="sxs-lookup"><span data-stu-id="71619-132">When a formatting file is loaded, it is added to an internal list that Windows PowerShell uses to determine which view to use when displaying objects at the command line.</span></span> <span data-ttu-id="71619-133">Можно добавить в начало файла форматирования в начале списка, или его можно добавить в конец списка.</span><span class="sxs-lookup"><span data-stu-id="71619-133">You can prepend your formatting file to the beginning of the list, or you can append it to the end of the list.</span></span> <span data-ttu-id="71619-134">Когда файл форматирования добавляется в этот список важно знать при загрузке файл форматирования, который определяет представление для объекта, который был определен, например если требуется изменить, как объект, который возвращается с помощью командлета Windows PowerShell core представляет собой существующее представление  отображается.</span><span class="sxs-lookup"><span data-stu-id="71619-134">Knowing where your formatting file is added to this list is important if you are loading formatting file that defines a view for an object that has an existing view defined, such as when you want to change how an object that is returned by a Windows PowerShell core cmdlet is displayed.</span></span> <span data-ttu-id="71619-135">Если вы загружаете файл форматирования, который определяет представление только для объекта, можно использовать любой из описанных выше способов.</span><span class="sxs-lookup"><span data-stu-id="71619-135">If you are loading a formatting file that defines the only view for an object, you can use any of the methods described previously.</span></span>  <span data-ttu-id="71619-136">Если вы загружаете файл форматирования, который определяет другое представление для объекта, необходимо использовать [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) командлета и добавить в начало файла в начало списка.</span><span class="sxs-lookup"><span data-stu-id="71619-136">If you are loading a formatting file that defines another view for an object, you must use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet and prepend your file to the beginning of the list.</span></span>

## <a name="storing-your-formatting-file"></a><span data-ttu-id="71619-137">Сохранение файла форматирования</span><span class="sxs-lookup"><span data-stu-id="71619-137">Storing Your Formatting File</span></span>

<span data-ttu-id="71619-138">Нет необходимости для хранения файлов форматирования на диске.</span><span class="sxs-lookup"><span data-stu-id="71619-138">There is no requirement for where your formatting files are stored on disk.</span></span> <span data-ttu-id="71619-139">Тем не менее настоятельно рекомендуется хранить их в следующую папку: `user\documents\windowspowershell\`</span><span class="sxs-lookup"><span data-stu-id="71619-139">However, it is strongly suggested that you store them in the following folder: `user\documents\windowspowershell\`</span></span>

#### <a name="loading-a-format-file-using-import-formatdata"></a><span data-ttu-id="71619-140">Загрузка файла форматирования с помощью импорта-FormatData</span><span class="sxs-lookup"><span data-stu-id="71619-140">Loading a format file using Import-FormatData</span></span>

1. <span data-ttu-id="71619-141">Store форматирования файла на диск.</span><span class="sxs-lookup"><span data-stu-id="71619-141">Store your formatting file to disk.</span></span>

2. <span data-ttu-id="71619-142">Запустите [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) командлет, используя один из следующих команд.</span><span class="sxs-lookup"><span data-stu-id="71619-142">Run the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet using one of the following commands.</span></span>
2. <span data-ttu-id="71619-143">Запустите [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) командлет, используя один из следующих команд.</span><span class="sxs-lookup"><span data-stu-id="71619-143">Run the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet using one of the following commands.</span></span>

   <span data-ttu-id="71619-144">Чтобы добавить форматирование файла в начало списка используйте следующую команду.</span><span class="sxs-lookup"><span data-stu-id="71619-144">To add your formatting file to the front of the list use this command.</span></span> <span data-ttu-id="71619-145">Используйте следующую команду, чтобы изменить способ отображения объекта.</span><span class="sxs-lookup"><span data-stu-id="71619-145">Use this command if you are changing how an object is displayed.</span></span>

   ```powershell
   Update-FormatData -PrependPath PathToFormattingFile
   ```

   <span data-ttu-id="71619-146">Чтобы добавить форматирование файла в конец списка используйте следующую команду.</span><span class="sxs-lookup"><span data-stu-id="71619-146">To add your formatting file to the end of the list use this command.</span></span>

   ```powershell
   Update-FormatData -AppendPath PathToFormattingFile
   ```

   <span data-ttu-id="71619-147">После добавления в файл с помощью [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) командлет, вам не удается удалить файл из списка при открытом сеансе.</span><span class="sxs-lookup"><span data-stu-id="71619-147">Once you have added a file using the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet, you cannot remove the file from the list while the session is open.</span></span> <span data-ttu-id="71619-148">Необходимо закрыть сеанса, чтобы удалить файл форматирования из списка.</span><span class="sxs-lookup"><span data-stu-id="71619-148">You must close the session to remove the formatting file from the list.</span></span>
   <span data-ttu-id="71619-149">После добавления в файл с помощью [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) командлет, вам не удается удалить файл из списка при открытом сеансе.</span><span class="sxs-lookup"><span data-stu-id="71619-149">Once you have added a file using the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet, you cannot remove the file from the list while the session is open.</span></span> <span data-ttu-id="71619-150">Необходимо закрыть сеанса, чтобы удалить файл форматирования из списка.</span><span class="sxs-lookup"><span data-stu-id="71619-150">You must close the session to remove the formatting file from the list.</span></span>

## <a name="exporting-format-data"></a><span data-ttu-id="71619-151">Экспорт данных в формате</span><span class="sxs-lookup"><span data-stu-id="71619-151">Exporting format data</span></span>

<span data-ttu-id="71619-152">Вставьте сюда основной текст раздела.</span><span class="sxs-lookup"><span data-stu-id="71619-152">Insert section body here.</span></span>
