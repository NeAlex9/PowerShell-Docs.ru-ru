---
title: Обзор командлетов | Документация Майкрософт
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- cmdlets [PowerShell SDK]
- cmdlets [PowerShell SDK], described
ms.assetid: 0aa32589-4447-4ead-a5dd-a3be99113140
caps.latest.revision: 21
ms.openlocfilehash: 14200aed2fb94c37c8b8af29650f602945e7ac1c
ms.sourcegitcommit: 58fb23c854f5a8b40ad1f952d3323aeeccac7a24
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/07/2019
ms.locfileid: "65229365"
---
# <a name="cmdlet-overview"></a><span data-ttu-id="3c441-102">Общие сведения о командлетах</span><span class="sxs-lookup"><span data-stu-id="3c441-102">Cmdlet Overview</span></span>

<span data-ttu-id="3c441-103">Командлет является упрощенная команда, которая используется в среде Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3c441-103">A cmdlet is a lightweight command that is used in the Windows PowerShell environment.</span></span> <span data-ttu-id="3c441-104">Среда выполнения Windows PowerShell вызывает эти командлеты в контексте скриптов автоматизации, которые предоставляются в командной строке.</span><span class="sxs-lookup"><span data-stu-id="3c441-104">The Windows PowerShell runtime invokes these cmdlets within the context of automation scripts that are provided at the command line.</span></span> <span data-ttu-id="3c441-105">Среда выполнения Windows PowerShell также вызывает их программно через API-интерфейсы Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3c441-105">The Windows PowerShell runtime also invokes them programmatically through Windows PowerShell APIs.</span></span>

## <a name="cmdlets"></a><span data-ttu-id="3c441-106">Командлеты</span><span class="sxs-lookup"><span data-stu-id="3c441-106">Cmdlets</span></span>

<span data-ttu-id="3c441-107">Командлеты выполняют действия и обычно возвращают объект Microsoft .NET Framework в следующую команду в конвейере.</span><span class="sxs-lookup"><span data-stu-id="3c441-107">Cmdlets perform an action and typically return a Microsoft .NET Framework object to the next command in the pipeline.</span></span> <span data-ttu-id="3c441-108">Чтобы создать командлет, должен реализовать класса cmdlet, который является производным от одного из двух базовых классов специализированного командлета.</span><span class="sxs-lookup"><span data-stu-id="3c441-108">To write a cmdlet, you must implement a cmdlet class that derives from one of two specialized cmdlet base classes.</span></span> <span data-ttu-id="3c441-109">Производный класс должен:</span><span class="sxs-lookup"><span data-stu-id="3c441-109">The derived class must:</span></span>

- <span data-ttu-id="3c441-110">Объявите атрибут, определяющий производного класса как командлет.</span><span class="sxs-lookup"><span data-stu-id="3c441-110">Declare an attribute that identifies the derived class as a cmdlet.</span></span>

- <span data-ttu-id="3c441-111">Определение открытых свойств, обозначенных с помощью атрибутов, которые идентифицируют общих свойств как параметры командлета.</span><span class="sxs-lookup"><span data-stu-id="3c441-111">Define public properties that are decorated with attributes that identify the public properties as cmdlet parameters.</span></span>

- <span data-ttu-id="3c441-112">Переопределите один или несколько входных данных, методы для обработки записей обработки.</span><span class="sxs-lookup"><span data-stu-id="3c441-112">Override one or more of the input processing methods to process records.</span></span>

<span data-ttu-id="3c441-113">Вы можете загрузить сборку, содержащую класс напрямую с помощью [Import-Module](/powershell/module/microsoft.powershell.core/import-module) командлета, или можно создать ведущее приложение, которое загружает сборку с помощью [ System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API.</span><span class="sxs-lookup"><span data-stu-id="3c441-113">You can load the assembly that contains the class directly by using the [Import-Module](/powershell/module/microsoft.powershell.core/import-module) cmdlet, or you can create a host application that loads the assembly by using the [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API.</span></span> <span data-ttu-id="3c441-114">Оба метода предоставляют командную строку и программный доступ к функциям этого командлета.</span><span class="sxs-lookup"><span data-stu-id="3c441-114">Both methods provide programmatic and command-line access to the functionality of the cmdlet.</span></span>

## <a name="cmdlet-terms"></a><span data-ttu-id="3c441-115">Командлет условия</span><span class="sxs-lookup"><span data-stu-id="3c441-115">Cmdlet Terms</span></span>

<span data-ttu-id="3c441-116">В документации по командлетам Windows PowerShell часто используются следующие термины:</span><span class="sxs-lookup"><span data-stu-id="3c441-116">The following terms are used frequently in the Windows PowerShell cmdlet documentation:</span></span>

### <a name="cmdlet-attribute"></a><span data-ttu-id="3c441-117">Атрибуты командлета</span><span class="sxs-lookup"><span data-stu-id="3c441-117">Cmdlet attribute</span></span>

<span data-ttu-id="3c441-118">Атрибут .NET Framework, который используется для объявления в классе кандлетов как командлет.</span><span class="sxs-lookup"><span data-stu-id="3c441-118">A .NET Framework attribute that is used to declare a cmdlet class as a cmdlet.</span></span>
<span data-ttu-id="3c441-119">Несмотря на то, что PowerShell использует несколько атрибутов, которые не являются обязательными, командлет атрибут является обязательным.</span><span class="sxs-lookup"><span data-stu-id="3c441-119">Although PowerShell uses several other attributes that are optional, the Cmdlet attribute is required.</span></span>
<span data-ttu-id="3c441-120">Дополнительные сведения об этом атрибуте см. в разделе [объявление атрибута командлет](cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="3c441-120">For more information about this attribute, see [Cmdlet Attribute Declaration](cmdlet-attribute-declaration.md).</span></span>

### <a name="cmdlet-parameter"></a><span data-ttu-id="3c441-121">Параметр командлета</span><span class="sxs-lookup"><span data-stu-id="3c441-121">Cmdlet parameter</span></span>

<span data-ttu-id="3c441-122">Открытые свойства, которые определяют параметры, которые доступны пользователю или приложению, на котором выполняется командлет.</span><span class="sxs-lookup"><span data-stu-id="3c441-122">The public properties that define the parameters that are available to the user or to the application that is running the cmdlet.</span></span>
<span data-ttu-id="3c441-123">Командлеты можно установить обязательные, именованный, позиционные, и *переключения* параметров.</span><span class="sxs-lookup"><span data-stu-id="3c441-123">Cmdlets can have required, named, positional, and *switch* parameters.</span></span>
<span data-ttu-id="3c441-124">Параметры-переключатели позволяют определять параметры, которые вычисляются только в том случае, если параметры указываются в вызове.</span><span class="sxs-lookup"><span data-stu-id="3c441-124">Switch parameters allow you to define parameters that are evaluated only if the parameters are specified in the call.</span></span>
<span data-ttu-id="3c441-125">Дополнительные сведения о различных типах параметров, см. в разделе [параметры командлета](cmdlet-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="3c441-125">For more information about the different types of parameters, see [Cmdlet Parameters](cmdlet-parameters.md).</span></span>

### <a name="parameter-set"></a><span data-ttu-id="3c441-126">Набор параметров</span><span class="sxs-lookup"><span data-stu-id="3c441-126">Parameter set</span></span>

<span data-ttu-id="3c441-127">Группа параметров, которые можно использовать в одной команде для выполнения определенного действия.</span><span class="sxs-lookup"><span data-stu-id="3c441-127">A group of parameters that can be used in the same command to perform a specific action.</span></span>
<span data-ttu-id="3c441-128">У командлета может быть несколько наборов параметров, но каждый набор параметров должен иметь по крайней мере один параметр, который является уникальным.</span><span class="sxs-lookup"><span data-stu-id="3c441-128">A cmdlet can have multiple parameter sets, but each parameter set must have at least one parameter that is unique.</span></span>
<span data-ttu-id="3c441-129">Структуры хороший командлетов строго предполагает, что параметр unique командлета также быть обязательным параметром.</span><span class="sxs-lookup"><span data-stu-id="3c441-129">Good cmdlet design strongly suggests that the unique parameter also be a required parameter.</span></span>
<span data-ttu-id="3c441-130">Дополнительные сведения о наборах параметров см. в разделе [командлет задает параметр](cmdlet-parameter-sets.md).</span><span class="sxs-lookup"><span data-stu-id="3c441-130">For more information about parameter sets, see [Cmdlet Parameter Sets](cmdlet-parameter-sets.md).</span></span>

### <a name="dynamic-parameter"></a><span data-ttu-id="3c441-131">Динамический параметр</span><span class="sxs-lookup"><span data-stu-id="3c441-131">Dynamic parameter</span></span>

<span data-ttu-id="3c441-132">Параметр, который добавляется в командлет во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="3c441-132">A parameter that is added to the cmdlet at runtime.</span></span>
<span data-ttu-id="3c441-133">Как правило динамические параметры добавляются в командлет при другой установлено определенное значение.</span><span class="sxs-lookup"><span data-stu-id="3c441-133">Typically, the dynamic parameters are added to the cmdlet when another parameter is set to a specific value.</span></span>
<span data-ttu-id="3c441-134">Дополнительные сведения о динамических параметров, см. в разделе [динамические параметры командлета](cmdlet-dynamic-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="3c441-134">For more information about dynamic parameters, see [Cmdlet Dynamic Parameters](cmdlet-dynamic-parameters.md).</span></span>

### <a name="input-processing-method"></a><span data-ttu-id="3c441-135">Метод обработки входных данных</span><span class="sxs-lookup"><span data-stu-id="3c441-135">Input processing method</span></span>

<span data-ttu-id="3c441-136">Метод, который командлет может использовать для обработки записей, получаемых в качестве входных данных.</span><span class="sxs-lookup"><span data-stu-id="3c441-136">A method that a cmdlet can use to process the records it receives as input.</span></span>
<span data-ttu-id="3c441-137">Методы обработки ввода включают в себя [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) метод, [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) метода [ System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) метод и [System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing) метод.</span><span class="sxs-lookup"><span data-stu-id="3c441-137">The input processing methods include the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) method, the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method, the [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) method, and the [System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing) method.</span></span> <span data-ttu-id="3c441-138">При реализации командлета, необходимо переопределить хотя бы один из [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing), [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)и [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) методы.</span><span class="sxs-lookup"><span data-stu-id="3c441-138">When you implement a cmdlet, you must override at least one of the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing), [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord), and [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) methods.</span></span>
<span data-ttu-id="3c441-139">Как правило [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) метод — метод, который вы переопределить, так как он вызывается для каждой записи, которая обрабатывает командлет.</span><span class="sxs-lookup"><span data-stu-id="3c441-139">Typically, the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method is the method that you override because it is called for every record that the cmdlet processes.</span></span>
<span data-ttu-id="3c441-140">Напротив [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) метод и [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) метода вызываются один раз для выполнения Предварительная обработка или последующей обработки записей.</span><span class="sxs-lookup"><span data-stu-id="3c441-140">In contrast, the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) method and the [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) method are called one time to perform pre-processing or post-processing of the records.</span></span>
<span data-ttu-id="3c441-141">Дополнительные сведения об этих методах см. в разделе [методы обработки ввода](cmdlet-input-processing-methods.md).</span><span class="sxs-lookup"><span data-stu-id="3c441-141">For more information about these methods, see [Input Processing Methods](cmdlet-input-processing-methods.md).</span></span>

### <a name="shouldprocess-feature"></a><span data-ttu-id="3c441-142">Функция ShouldProcess</span><span class="sxs-lookup"><span data-stu-id="3c441-142">ShouldProcess feature</span></span>

<span data-ttu-id="3c441-143">PowerShell позволяет создавать командлеты, которые пользователю запрос на отзыв прежде, чем командлет вносит изменение в систему.</span><span class="sxs-lookup"><span data-stu-id="3c441-143">PowerShell allows you to create cmdlets that prompt the user for feedback before the cmdlet makes a change to the system.</span></span>
<span data-ttu-id="3c441-144">Чтобы использовать эту функцию, командлет необходимо объявить, что он поддерживает возможность ShouldProcess, при объявлении атрибута командлет, и необходимо вызвать командлет [System.Management.Automation.Cmdlet.ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) и [ System.Management.Automation.Cmdlet.ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) методы в метод обработки входных данных.</span><span class="sxs-lookup"><span data-stu-id="3c441-144">To use this feature, the cmdlet must declare that it supports the ShouldProcess feature when you declare the Cmdlet attribute, and the cmdlet must call the [System.Management.Automation.Cmdlet.ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) and [System.Management.Automation.Cmdlet.ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) methods from within an input processing method.</span></span>
<span data-ttu-id="3c441-145">Дополнительные сведения о том, как для поддержки функций ShouldProcess см. в разделе [запрашивает подтверждение](requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="3c441-145">For more information about how to support the ShouldProcess functionality, see [Requesting Confirmation](requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="transaction"></a><span data-ttu-id="3c441-146">Транзакции</span><span class="sxs-lookup"><span data-stu-id="3c441-146">Transaction</span></span>

<span data-ttu-id="3c441-147">Логическая группа команд, которые обрабатываются как одну задачу.</span><span class="sxs-lookup"><span data-stu-id="3c441-147">A logical group of commands that are treated as a single task.</span></span>
<span data-ttu-id="3c441-148">Задача будет автоматически выполнена Если команд в группе завершается ошибкой, и у пользователя есть возможность принять или отклонить действия, выполняемые в рамках транзакции.</span><span class="sxs-lookup"><span data-stu-id="3c441-148">The task automatically fails if any command in the group fails, and the user has the choice to accept or reject the actions performed within the transaction.</span></span>
<span data-ttu-id="3c441-149">Для участия в транзакции, командлет необходимо объявить, что он поддерживает транзакции, при объявлении атрибута командлет.</span><span class="sxs-lookup"><span data-stu-id="3c441-149">To participate in a transaction, the cmdlet must declare that it supports transactions when the Cmdlet attribute is declared.</span></span>
<span data-ttu-id="3c441-150">Поддержка транзакций появилась в Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="3c441-150">Support for transactions was introduced in Windows PowerShell 2.0.</span></span>
<span data-ttu-id="3c441-151">Дополнительные сведения о транзакциях см. в разделе [как транзакции поддержки](how-to-support-transactions.md).</span><span class="sxs-lookup"><span data-stu-id="3c441-151">For more information about transactions, see [How to Support Transactions](how-to-support-transactions.md).</span></span>

## <a name="how-cmdlets-differ-from-commands"></a><span data-ttu-id="3c441-152">Командлеты отличаются от команд</span><span class="sxs-lookup"><span data-stu-id="3c441-152">How Cmdlets Differ from Commands</span></span>

<span data-ttu-id="3c441-153">Командлеты отличаются от команд в других средах командной оболочки одним из следующих способов:</span><span class="sxs-lookup"><span data-stu-id="3c441-153">Cmdlets differ from commands in other command-shell environments in the following ways:</span></span>

- <span data-ttu-id="3c441-154">Командлеты являются экземплярами классов .NET Framework; они не являются автономного исполняемые файлы.</span><span class="sxs-lookup"><span data-stu-id="3c441-154">Cmdlets are instances of .NET Framework classes; they are not stand-alone executables.</span></span>

- <span data-ttu-id="3c441-155">Командлеты могут создаваться из всего лишь десяток строк кода.</span><span class="sxs-lookup"><span data-stu-id="3c441-155">Cmdlets can be created from as few as a dozen lines of code.</span></span>

- <span data-ttu-id="3c441-156">Командлеты обычно не делайте свои собственные синтаксического анализа, ошибка презентации или форматирование выходных данных.</span><span class="sxs-lookup"><span data-stu-id="3c441-156">Cmdlets do not generally do their own parsing, error presentation, or output formatting.</span></span> <span data-ttu-id="3c441-157">Синтаксический анализ, ошибка представления и форматирование выходных данных, обрабатываются средой выполнения Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3c441-157">Parsing, error presentation, and output formatting are handled by the Windows PowerShell runtime.</span></span>

- <span data-ttu-id="3c441-158">Командлеты обработка входных объектов из конвейера, а не из потоки текста, а командлеты обычно доставлять объекты как выходные данные в конвейер.</span><span class="sxs-lookup"><span data-stu-id="3c441-158">Cmdlets process input objects from the pipeline rather than from streams of text, and cmdlets typically deliver objects as output to the pipeline.</span></span>

- <span data-ttu-id="3c441-159">Командлеты являются ориентированные на запись, так как они обрабатывают один объект за раз.</span><span class="sxs-lookup"><span data-stu-id="3c441-159">Cmdlets are record-oriented because they process a single object at a time.</span></span>

## <a name="cmdlet-base-classes"></a><span data-ttu-id="3c441-160">Командлет базовых классов</span><span class="sxs-lookup"><span data-stu-id="3c441-160">Cmdlet Base Classes</span></span>

<span data-ttu-id="3c441-161">Windows PowerShell поддерживает командлеты, которые являются производными от двух базовых классов.</span><span class="sxs-lookup"><span data-stu-id="3c441-161">Windows PowerShell supports cmdlets that are derived from the following two base classes.</span></span>

- <span data-ttu-id="3c441-162">Большинство командлетов основаны на классы платформы .NET Framework, которые являются производными от [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) базового класса.</span><span class="sxs-lookup"><span data-stu-id="3c441-162">Most cmdlets are based on .NET Framework classes that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) base class.</span></span> <span data-ttu-id="3c441-163">Наследование от этого класса позволяет командлету, чтобы использовать минимальный набор зависимостей от среды выполнения Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3c441-163">Deriving from this class allows a cmdlet to use the minimum set of dependencies on the Windows PowerShell runtime.</span></span> <span data-ttu-id="3c441-164">Это дает два преимущества.</span><span class="sxs-lookup"><span data-stu-id="3c441-164">This has two benefits.</span></span> <span data-ttu-id="3c441-165">Первый преимущество заключается в меньшие по размеру объектов командлет, что вы обычно не подвергаться влиянию изменений в среду выполнения Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3c441-165">The first benefit is that the cmdlet objects are smaller, and you are less likely to be affected by changes to the Windows PowerShell runtime.</span></span> <span data-ttu-id="3c441-166">Это второй удобно, если необходимо, можно непосредственно создать экземпляр объекта командлета и затем вызвать его напрямую, вместо вызова этого метода до среды выполнения Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3c441-166">The second benefit is that, if you have to, you can directly create an instance of the cmdlet object and then invoke it directly instead of invoking it through the Windows PowerShell runtime.</span></span>

- <span data-ttu-id="3c441-167">Более сложные командлеты основаны на классы платформы .NET Framework, которые являются производными от [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) базового класса.</span><span class="sxs-lookup"><span data-stu-id="3c441-167">The more-complex cmdlets are based on .NET Framework classes that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="3c441-168">Наследование от этого класса дает гораздо более высокий уровень доступа к среде выполнения Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3c441-168">Deriving from this class gives you much more access to the Windows PowerShell runtime.</span></span> <span data-ttu-id="3c441-169">Такой доступ позволяет командлета для вызова сценариев, чтобы получить доступ к поставщикам, а также для доступа к текущим состоянием сеанса.</span><span class="sxs-lookup"><span data-stu-id="3c441-169">This access allows your cmdlet to call scripts, to access providers, and to access the current session state.</span></span> <span data-ttu-id="3c441-170">(Чтобы получить доступ к текущим состоянием сеанса, вы get и set переменные сеанса и предпочтений.) Тем не менее производного от этого класса увеличивает размер объекта, командлет, и это означает, что командлет более тесно связан с текущей версии среды выполнения Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3c441-170">(To access the current session state, you get and set session variables and preferences.) However, deriving from this class increases the size of the cmdlet object, and it means that your cmdlet is more tightly coupled to the current version of the Windows PowerShell runtime.</span></span>

<span data-ttu-id="3c441-171">Вообще говоря, если вам требуется расширенный доступ к среде выполнения Windows PowerShell, необходимо наследовать из [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) класса.</span><span class="sxs-lookup"><span data-stu-id="3c441-171">In general, unless you need the extended access to the Windows PowerShell runtime, you should derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class.</span></span> <span data-ttu-id="3c441-172">Тем не менее среда выполнения Windows PowerShell имеет возможности подробные журналы для выполнения командлетов.</span><span class="sxs-lookup"><span data-stu-id="3c441-172">However, the Windows PowerShell runtime has extensive logging capabilities for the execution of cmdlets.</span></span> <span data-ttu-id="3c441-173">Если модель аудита зависит это ведение журнала, можно предотвратить выполнение командлета в другой командлет путем наследования от [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) класса.</span><span class="sxs-lookup"><span data-stu-id="3c441-173">If your auditing model depends on this logging, you can prevent the execution of your cmdlet from within another cmdlet by deriving from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class.</span></span>

## <a name="input-processing-methods"></a><span data-ttu-id="3c441-174">Методы обработки ввода</span><span class="sxs-lookup"><span data-stu-id="3c441-174">Input Processing Methods</span></span>

<span data-ttu-id="3c441-175">[System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) класс предоставляет следующие виртуальные методы, которые используются для обработки записей.</span><span class="sxs-lookup"><span data-stu-id="3c441-175">The [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class provides the following virtual methods that are used to process records.</span></span> <span data-ttu-id="3c441-176">Все командлет производные классы должны переопределить один или несколько из первых трех методов:</span><span class="sxs-lookup"><span data-stu-id="3c441-176">All the derived cmdlet classes must override one or more of the first three methods:</span></span>

- <span data-ttu-id="3c441-177">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing): Используется для предоставления дополнительные однократные функциональные возможности предварительной обработки командлета.</span><span class="sxs-lookup"><span data-stu-id="3c441-177">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing): Used to provide optional one-time, pre-processing functionality for the cmdlet.</span></span>

- <span data-ttu-id="3c441-178">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord): Используется для предоставления функциональности записи по обработке для командлета.</span><span class="sxs-lookup"><span data-stu-id="3c441-178">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord): Used to provide record-by-record processing functionality for the cmdlet.</span></span> <span data-ttu-id="3c441-179">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) метод может вызываться любое число раз или вообще не, в зависимости от входных данных командлета.</span><span class="sxs-lookup"><span data-stu-id="3c441-179">The [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method might be called any number of times, or not at all, depending on the input of the cmdlet.</span></span>

- <span data-ttu-id="3c441-180">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing): Используется для предоставления дополнительные однократные функциональные возможности завершающей обработки командлета.</span><span class="sxs-lookup"><span data-stu-id="3c441-180">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing): Used to provide optional one-time, post-processing functionality for the cmdlet.</span></span>

- <span data-ttu-id="3c441-181">[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing): Используется для остановки обработки при остановке командлета пользователем асинхронно (например, нажав сочетание клавиш CTRL + C).</span><span class="sxs-lookup"><span data-stu-id="3c441-181">[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing): Used to stop processing when the user stops the cmdlet asynchronously (for example,  by pressing CTRL+C).</span></span>

<span data-ttu-id="3c441-182">Дополнительные сведения об этих методах см. в разделе [методы обработки входных данных командлета](./cmdlet-input-processing-methods.md).</span><span class="sxs-lookup"><span data-stu-id="3c441-182">For more information about these methods, see [Cmdlet Input Processing Methods](./cmdlet-input-processing-methods.md).</span></span>

## <a name="cmdlet-attributes"></a><span data-ttu-id="3c441-183">Атрибуты командлета</span><span class="sxs-lookup"><span data-stu-id="3c441-183">Cmdlet Attributes</span></span>

<span data-ttu-id="3c441-184">Windows PowerShell определяет несколько атрибутов .NET Framework, которые используются для управления командлеты и укажите общую функциональность, предоставляемую Windows PowerShell и может потребоваться с помощью командлета.</span><span class="sxs-lookup"><span data-stu-id="3c441-184">Windows PowerShell defines several .NET Framework attributes that are used to manage cmdlets and to specify common functionality that is provided by Windows PowerShell and that might be required by the cmdlet.</span></span> <span data-ttu-id="3c441-185">Например атрибуты используются для назначения класса как командлет, для указания параметров командлета и запрашивает проверку входных данных, таким образом, разработчикам командлетов не нужно реализовать эту функциональность в своем коде командлета.</span><span class="sxs-lookup"><span data-stu-id="3c441-185">For example, attributes are used to designate a class as a cmdlet, to specify the parameters of the cmdlet, and to request the validation of input so that cmdlet developers do not have to implement that functionality in their cmdlet code.</span></span> <span data-ttu-id="3c441-186">Дополнительные сведения об атрибутах см. в разделе [Windows PowerShell атрибуты](./cmdlet-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="3c441-186">For more information about attributes, see [Windows PowerShell Attributes](./cmdlet-attributes.md).</span></span>

## <a name="cmdlet-names"></a><span data-ttu-id="3c441-187">Имена командлетов</span><span class="sxs-lookup"><span data-stu-id="3c441-187">Cmdlet Names</span></span>

<span data-ttu-id="3c441-188">Windows PowerShell использует пару существительное-имени в командлетах имя.</span><span class="sxs-lookup"><span data-stu-id="3c441-188">Windows PowerShell uses a verb-and-noun name pair to name cmdlets.</span></span> <span data-ttu-id="3c441-189">Например `Get-Command` командлетов, включенных в Windows PowerShell используется для получения всех командлетов, которые зарегистрированы в командной оболочке.</span><span class="sxs-lookup"><span data-stu-id="3c441-189">For example, the `Get-Command` cmdlet included in Windows PowerShell is used to get all the cmdlets that are registered in the command shell.</span></span> <span data-ttu-id="3c441-190">Команда определяет действие, выполняемое командлетом, а существительное определяет ресурс, на котором командлет выполняет его действие.</span><span class="sxs-lookup"><span data-stu-id="3c441-190">The verb identifies the action that the cmdlet performs, and the noun identifies the resource on which the cmdlet performs its action.</span></span>

<span data-ttu-id="3c441-191">Эти имена указаны в том случае, когда .NET Framework класс объявляется как командлет.</span><span class="sxs-lookup"><span data-stu-id="3c441-191">These names are specified when the .NET Framework class is declared as a cmdlet.</span></span> <span data-ttu-id="3c441-192">Дополнительные сведения о том, как объявить класс .NET Framework как командлет, см. в разделе [объявление атрибута командлет](./cmdlet-class-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="3c441-192">For more information about how to declare a .NET Framework class as a cmdlet, see [Cmdlet Attribute Declaration](./cmdlet-class-declaration.md).</span></span>

## <a name="writing-cmdlet-code"></a><span data-ttu-id="3c441-193">Написание кода командлета</span><span class="sxs-lookup"><span data-stu-id="3c441-193">Writing Cmdlet Code</span></span>

<span data-ttu-id="3c441-194">Этот документ содержит два способа обнаружения, как командлет код.</span><span class="sxs-lookup"><span data-stu-id="3c441-194">This document provides two ways to discover how cmdlet code is written.</span></span> <span data-ttu-id="3c441-195">Если вы хотите просмотреть код без долгие объяснения, см. в разделе [код примеры командлета](./examples-of-cmdlet-code.md).</span><span class="sxs-lookup"><span data-stu-id="3c441-195">If you prefer to see the code without much explanation, see [Examples of Cmdlet Code](./examples-of-cmdlet-code.md).</span></span> <span data-ttu-id="3c441-196">Если вы предпочитаете более подробного объяснения о коде, см. в разделе [руководстве GetProc](./getproc-tutorial.md), [руководстве StopProc](./stopproc-tutorial.md), или [SelectStr руководстве](./selectstr-tutorial.md) разделы.</span><span class="sxs-lookup"><span data-stu-id="3c441-196">If you prefer more explanation about the code, see the [GetProc Tutorial](./getproc-tutorial.md),  [StopProc Tutorial](./stopproc-tutorial.md), or [SelectStr Tutorial](./selectstr-tutorial.md) topics.</span></span>

<span data-ttu-id="3c441-197">Дополнительные сведения о назначении написание командлетов см. в разделе [рекомендации по разработке командлет](./cmdlet-development-guidelines.md).</span><span class="sxs-lookup"><span data-stu-id="3c441-197">For more information about the guidelines for writing cmdlets, see [Cmdlet Development Guidelines](./cmdlet-development-guidelines.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="3c441-198">См. также</span><span class="sxs-lookup"><span data-stu-id="3c441-198">See Also</span></span>

[<span data-ttu-id="3c441-199">Основные понятия Windows PowerShell командлет</span><span class="sxs-lookup"><span data-stu-id="3c441-199">Windows PowerShell Cmdlet Concepts</span></span>](./windows-powershell-cmdlet-concepts.md)

[<span data-ttu-id="3c441-200">Запись командлета Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="3c441-200">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)

[<span data-ttu-id="3c441-201">Пакет SDK для Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="3c441-201">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)
