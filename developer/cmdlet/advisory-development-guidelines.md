---
title: Рекомендации по разработке рекомендаций | Документация Майкрософт
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 79c9bcbc-a2eb-4253-a4b8-65ba54ce8d01
caps.latest.revision: 9
ms.openlocfilehash: 871a74a084da3c7ec36767b7195461e0e7290cb9
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62068799"
---
# <a name="advisory-development-guidelines"></a><span data-ttu-id="a4cc8-102">Советы по разработке</span><span class="sxs-lookup"><span data-stu-id="a4cc8-102">Advisory Development Guidelines</span></span>

<span data-ttu-id="a4cc8-103">В этом разделе приводятся рекомендации, которые следует учитывать для предотвращения хороший опыт разработки и пользователя.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-103">This section describes guidelines that you should consider to ensure good development and user experiences.</span></span> <span data-ttu-id="a4cc8-104">Иногда они могут применяться, а иногда они не могут.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-104">Sometimes they might apply, and sometimes they might not.</span></span>

## <a name="design-guidelines"></a><span data-ttu-id="a4cc8-105">Рекомендации по проектированию</span><span class="sxs-lookup"><span data-stu-id="a4cc8-105">Design Guidelines</span></span>

- [<span data-ttu-id="a4cc8-106">Поддерживает параметр InputObject (AD01)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-106">Support an InputObject Parameter (AD01)</span></span>](./advisory-development-guidelines.md#AD01)

- [<span data-ttu-id="a4cc8-107">Поддерживает параметр Force (AD02)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-107">Support the Force Parameter (AD02)</span></span>](./advisory-development-guidelines.md#AD02)

- [<span data-ttu-id="a4cc8-108">Обработка учетных данных с помощью Windows PowerShell (AD03)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-108">Handle Credentials Through Windows PowerShell (AD03)</span></span>](./advisory-development-guidelines.md#AD03)

- [<span data-ttu-id="a4cc8-109">Поддерживает параметры кодирования (AD04)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-109">Support Encoding Parameters (AD04)</span></span>](./advisory-development-guidelines.md#AD04)

- [<span data-ttu-id="a4cc8-110">Командлеты теста должен возвращать логическое значение (AD05)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-110">Test Cmdlets Should Return a Boolean (AD05)</span></span>](./advisory-development-guidelines.md#AD05)

## <a name="code-guidelines"></a><span data-ttu-id="a4cc8-111">Руководствам по кодам</span><span class="sxs-lookup"><span data-stu-id="a4cc8-111">Code Guidelines</span></span>

- [<span data-ttu-id="a4cc8-112">Выполните командлет класс соглашения об именовании (AC01)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-112">Follow Cmdlet Class Naming Conventions (AC01)</span></span>](./advisory-development-guidelines.md#AC01)

- [<span data-ttu-id="a4cc8-113">Если отсутствуют входные данные конвейера переопределить метод BeginProcessing (AC02)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-113">If No Pipeline Input Override the BeginProcessing Method (AC02)</span></span>](./advisory-development-guidelines.md#AC02)

- [<span data-ttu-id="a4cc8-114">Чтобы обрабатывать запросы остановки Переопределите метод StopProcessing (AC03)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-114">To Handle Stop Requests Override the StopProcessing Method (AC03)</span></span>](./advisory-development-guidelines.md#AC03)

- [<span data-ttu-id="a4cc8-115">Реализовать интерфейс IDisposable (AC04)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-115">Implement the IDisposable Interface (AC04)</span></span>](./advisory-development-guidelines.md#AC04)

- [<span data-ttu-id="a4cc8-116">Типы параметров пригодным к сериализации (AC05)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-116">Use Serialization-friendly Parameter Types (AC05)</span></span>](./advisory-development-guidelines.md#AC05)

- [<span data-ttu-id="a4cc8-117">Используйте SecureString для конфиденциальных данных (AC06)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-117">Use SecureString for Sensitive Data (AC06)</span></span>](./advisory-development-guidelines.md#AC06)

## <a name="design-guidelines"></a><span data-ttu-id="a4cc8-118">Рекомендации по проектированию</span><span class="sxs-lookup"><span data-stu-id="a4cc8-118">Design Guidelines</span></span>

<span data-ttu-id="a4cc8-119">При разработке командлетов следует учитывать следующие рекомендации.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-119">The following guidelines should be considered when designing cmdlets.</span></span> <span data-ttu-id="a4cc8-120">Когда вы найдете рекомендации разработки для этого применяется в вашей ситуации, убедитесь, что рассмотрим руководствам по кодам аналогичные инструкции.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-120">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="support-an-inputobject-parameter-ad01"></a><span data-ttu-id="a4cc8-121">Поддерживает параметр InputObject (AD01)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-121">Support an InputObject Parameter (AD01)</span></span>

<span data-ttu-id="a4cc8-122">Поскольку Windows PowerShell работает непосредственно с объектами Microsoft .NET Framework, объект .NET Framework часто является доступным, что точно совпадает, тип пользователя необходимо выполнение определенной операции.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-122">Because Windows PowerShell works directly with Microsoft .NET Framework objects, a .NET Framework object is often available that exactly matches the type the user needs to perform a particular operation.</span></span> <span data-ttu-id="a4cc8-123">`InputObject` — Это стандартное имя для параметра, который принимает такой объект в качестве входных данных.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-123">`InputObject` is the standard name for a parameter that takes such an object as input.</span></span> <span data-ttu-id="a4cc8-124">К примеру, образец **Stop-Proc** командлет в [руководстве StopProc](./stopproc-tutorial.md) определяет `InputObject` параметр типа процесс, который поддерживает входные данные из конвейера.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-124">For example, the sample **Stop-Proc** cmdlet in the [StopProc Tutorial](./stopproc-tutorial.md) defines an `InputObject` parameter of type Process that supports the input from the pipeline.</span></span> <span data-ttu-id="a4cc8-125">Пользователь может получить набор объектов процессов, управлять ими, чтобы выбрать точный список объектов для остановки и затем передать их в **Stop-Proc** командлет напрямую.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-125">The user can get a set of process objects, manipulate them to select the exact objects to stop, and then pass them to the **Stop-Proc** cmdlet directly.</span></span>

### <a name="support-the-force-parameter-ad02"></a><span data-ttu-id="a4cc8-126">Поддерживает параметр Force (AD02)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-126">Support the Force Parameter (AD02)</span></span>

<span data-ttu-id="a4cc8-127">В некоторых случаях командлет необходимо защитить пользователя от выполнения запрошенной операции.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-127">Occasionally, a cmdlet needs to protect the user from performing a requested operation.</span></span> <span data-ttu-id="a4cc8-128">Должен поддерживать такой командлет `Force` параметр, чтобы разрешить пользователю переопределить эту защиту, если у пользователя есть разрешения для выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-128">Such a cmdlet should support a `Force` parameter to allow the user to override that protection if the user has permissions to perform the operation.</span></span>

<span data-ttu-id="a4cc8-129">Например [Remove-Item](/powershell/module/microsoft.powershell.management/remove-item) обычно командлет не удаляет файл, доступный только для чтения.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-129">For example, the [Remove-Item](/powershell/module/microsoft.powershell.management/remove-item) cmdlet does not normally remove a read-only file.</span></span> <span data-ttu-id="a4cc8-130">Тем не менее, этот командлет поддерживает `Force` параметра, поэтому пользователь может Принудительное удаление файла только для чтения.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-130">However, this cmdlet supports a `Force` parameter so a user can force removal of a read-only file.</span></span> <span data-ttu-id="a4cc8-131">Если у пользователя уже есть разрешения на изменение атрибут только для чтения, и пользователь удаляет файл, использование `Force` параметр упрощает операции.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-131">If the user already has permission to modify the read-only attribute, and the user removes the file, use of the `Force` parameter simplifies the operation.</span></span> <span data-ttu-id="a4cc8-132">Тем не менее, если пользователь не имеет разрешения на удаление файла, `Force` параметр не оказывает влияния.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-132">However, if the user does not have permission to remove the file, the `Force` parameter has no effect.</span></span>

### <a name="handle-credentials-through-windows-powershell-ad03"></a><span data-ttu-id="a4cc8-133">Обработка учетных данных с помощью Windows PowerShell (AD03)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-133">Handle Credentials Through Windows PowerShell (AD03)</span></span>

<span data-ttu-id="a4cc8-134">Командлет необходимо определить `Credential` параметр для представления учетных данных.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-134">A cmdlet should define a `Credential` parameter to represent credentials.</span></span> <span data-ttu-id="a4cc8-135">Этот параметр должен иметь тип [System.Management.Automation.PSCredential](/dotnet/api/System.Management.Automation.PSCredential) и должны быть определены с помощью атрибута объявления учетных данных.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-135">This parameter must be of type [System.Management.Automation.PSCredential](/dotnet/api/System.Management.Automation.PSCredential) and must be defined using a Credential attribute declaration.</span></span> <span data-ttu-id="a4cc8-136">Эта поддержка автоматически запрашивает пользователя для имени пользователя, пароля или обоих, при полной учетных данных не предоставляется напрямую.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-136">This support automatically prompts the user for the user name, for the password, or for both when a full credential is not supplied directly.</span></span> <span data-ttu-id="a4cc8-137">Дополнительные сведения об атрибуте учетных данных см. в разделе [объявление атрибута учетных данных](./credential-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="a4cc8-137">For more information about the Credential attribute, see [Credential Attribute Declaration](./credential-attribute-declaration.md).</span></span>

### <a name="support-encoding-parameters-ad04"></a><span data-ttu-id="a4cc8-138">Поддерживает параметры кодирования (AD04)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-138">Support Encoding Parameters (AD04)</span></span>

<span data-ttu-id="a4cc8-139">Если командлет считывает или записывает текст в или из двоичной форме, например запись или чтение данных из файла в файловую систему, командлет должен содержать параметр Encoding, который указывает, как текст кодируется в двоичной форме.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-139">If your cmdlet reads or writes text to or from a binary form, such as writing to or reading from a file in a filesystem, then your cmdlet has to have Encoding parameter that specifies how the text is encoded in the binary form.</span></span>

### <a name="test-cmdlets-should-return-a-boolean-ad05"></a><span data-ttu-id="a4cc8-140">Командлеты теста должен возвращать логическое значение (AD05)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-140">Test Cmdlets Should Return a Boolean (AD05)</span></span>

<span data-ttu-id="a4cc8-141">Командлеты, выполните тесты в соответствии с ресурсами вы получите [System.Boolean](/dotnet/api/System.Boolean) введите в конвейер, чтобы их можно использовать в условных выражениях.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-141">Cmdlets that perform tests against their resources should return a [System.Boolean](/dotnet/api/System.Boolean) type to the pipeline so that they can be used in conditional expressions.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="a4cc8-142">Руководствам по кодам</span><span class="sxs-lookup"><span data-stu-id="a4cc8-142">Code Guidelines</span></span>

<span data-ttu-id="a4cc8-143">Следующие рекомендации можно рассматривать при написании кода командлета.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-143">The following guidelines should be considered when writing cmdlet code.</span></span> <span data-ttu-id="a4cc8-144">Когда вы найдете рекомендации для этого применяется в вашей ситуации, убедитесь, что рассмотрим рекомендации по проектированию аналогичные инструкции.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-144">When you find a guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="follow-cmdlet-class-naming-conventions-ac01"></a><span data-ttu-id="a4cc8-145">Выполните командлет класс соглашения об именовании (AC01)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-145">Follow Cmdlet Class Naming Conventions (AC01)</span></span>

<span data-ttu-id="a4cc8-146">Следующие стандартные правила именования командлеты делает обнаружение, и вы помочь пользователю понять, точно что делают командлеты.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-146">By following standard naming conventions, you make your cmdlets more discoverable, and you help the user understand exactly what the cmdlets do.</span></span> <span data-ttu-id="a4cc8-147">Такой подход особенно важен для других разработчиков, с помощью Windows PowerShell, так как командлеты, открытые типы.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-147">This practice is particularly important for other developers using Windows PowerShell because cmdlets are public types.</span></span>

#### <a name="define-a-cmdlet-in-the-correct-namespace"></a><span data-ttu-id="a4cc8-148">Определение командлета в правильное пространство имен</span><span class="sxs-lookup"><span data-stu-id="a4cc8-148">Define a Cmdlet in the Correct Namespace</span></span>

<span data-ttu-id="a4cc8-149">Обычно определить класс для командлета в пространстве имен .NET Framework, который добавляет «. Команды» в пространстве имен, представляющий продукт, в котором выполняется командлет.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-149">You normally define the class for a cmdlet in a .NET Framework namespace that appends ".Commands" to the namespace that represents the product in which the cmdlet runs.</span></span> <span data-ttu-id="a4cc8-150">Например, определенные командлеты, которые входят в состав Windows PowerShell в `Microsoft.PowerShell.Commands` пространства имен.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-150">For example, cmdlets that are included with Windows PowerShell are defined in the `Microsoft.PowerShell.Commands` namespace.</span></span>

#### <a name="name-the-cmdlet-class-to-match-the-cmdlet-name"></a><span data-ttu-id="a4cc8-151">Назовите класс командлета должно соответствовать имени командлета</span><span class="sxs-lookup"><span data-stu-id="a4cc8-151">Name the Cmdlet Class to Match the Cmdlet Name</span></span>

<span data-ttu-id="a4cc8-152">При вводе имени класса .NET Framework, который реализует командлет, имя класса "*\<глагол >**\<существительное >**\<команда >*«, где вы замените  *\<Глагол >* и  *\<существительное >* заполнители глагол и существительное, используемый для имени командлета.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-152">When you name the .NET Framework class that implements a cmdlet, name the class "*\<Verb>**\<Noun>**\<Command>*", where you replace the *\<Verb>* and *\<Noun>* placeholders with the verb and noun used for the cmdlet name.</span></span> <span data-ttu-id="a4cc8-153">Например [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) командлет реализован классом с именем `GetProcessCommand`.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-153">For example, the [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) cmdlet is implemented by a class called `GetProcessCommand`.</span></span>

### <a name="if-no-pipeline-input-override-the-beginprocessing-method-ac02"></a><span data-ttu-id="a4cc8-154">Если отсутствуют входные данные конвейера переопределить метод BeginProcessing (AC02)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-154">If No Pipeline Input Override the BeginProcessing Method (AC02)</span></span>

<span data-ttu-id="a4cc8-155">Если командлет не принимает входные данные из конвейера, обработки, следует реализовать [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) метод.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-155">If your cmdlet does not accept input from the pipeline, processing should be implemented in the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) method.</span></span> <span data-ttu-id="a4cc8-156">Использование этого метода позволяет Windows PowerShell для сохранения порядка между командлетами.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-156">Use of this method allows Windows PowerShell to maintain ordering between cmdlets.</span></span> <span data-ttu-id="a4cc8-157">Первый командлет в конвейере всегда возвращает ее объектов прежде, чем остальные командлеты в конвейере будет возможность запустить их обработки.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-157">The first cmdlet in the pipeline always returns its objects before the remaining cmdlets in the pipeline get a chance to start their processing.</span></span>

### <a name="to-handle-stop-requests-override-the-stopprocessing-method-ac03"></a><span data-ttu-id="a4cc8-158">Чтобы обрабатывать запросы остановки Переопределите метод StopProcessing (AC03)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-158">To Handle Stop Requests Override the StopProcessing Method (AC03)</span></span>

<span data-ttu-id="a4cc8-159">Переопределить [System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing) метод таким образом, чтобы командлет может обрабатывать сигнал остановки.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-159">Override the [System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing) method so that your cmdlet can handle stop signal.</span></span> <span data-ttu-id="a4cc8-160">Некоторые командлеты занять много времени для завершения их работы, и они позволяют передавать между вызовами в среду выполнения Windows PowerShell, например когда командлет блокирует поток в вызовы RPC долго выполняющейся длительное время.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-160">Some cmdlets take a long time to complete their operation, and they let a long time pass between calls to the Windows PowerShell runtime, such as when the cmdlet blocks the thread in long-running RPC calls.</span></span> <span data-ttu-id="a4cc8-161">Сюда входят командлеты, которые упрощают вызовы [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) метод, чтобы [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) метод и другие отзывы механизмы, которые может занять много времени для завершения.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-161">This includes cmdlets that make calls to the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method, to the [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method, and to other feedback mechanisms that may take a long time to complete.</span></span> <span data-ttu-id="a4cc8-162">В этих случаях пользователю может потребоваться отправить сигнал об остановке этих командлетов.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-162">For these cases the user might need to send a stop signal to these cmdlets.</span></span>

### <a name="implement-the-idisposable-interface-ac04"></a><span data-ttu-id="a4cc8-163">Реализовать интерфейс IDisposable (AC04)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-163">Implement the IDisposable Interface (AC04)</span></span>

<span data-ttu-id="a4cc8-164">Если в командлете содержит объекты, не удаляются (написанного в конвейер) [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) метод, командлет может потребоваться удаление дополнительных объектов.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-164">If your cmdlet has objects that are not disposed of (written to the pipeline) by the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method, your cmdlet might require additional object disposal.</span></span> <span data-ttu-id="a4cc8-165">Например, если командлет открывает дескриптор файла, в его [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) метод и сохраняет открыть дескриптор для использования [System.Management.Automation.Cmdlet.ProcessRecord ](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) метод, этот дескриптор должен быть закрыт по завершении обработки.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-165">For example, if your cmdlet opens a file handle in its [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) method and keeps the handle open for use by the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method, this handle has to be closed at the end of processing.</span></span>

<span data-ttu-id="a4cc8-166">Среда выполнения Windows PowerShell не всегда вызывает [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) метод.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-166">The Windows PowerShell runtime does not always call the  [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) method.</span></span> <span data-ttu-id="a4cc8-167">Например [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) метод не может быть вызван, если командлет отменяется середине операции, или если завершающей в любой части командлета возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-167">For example, the [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) method might not be called if the cmdlet is canceled midway through its operation or if a terminating error occurs in any part of the cmdlet.</span></span> <span data-ttu-id="a4cc8-168">Таким образом, класс .NET Framework для командлета, требующий очистки объектов следует реализовать полный [System.IDisposable](/dotnet/api/System.IDisposable) интерфейс шаблону, в том числе метод завершения, таким образом, чтобы среда выполнения Windows PowerShell можно вызвать оба [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) и [System.IDisposable.Dispose\*](/dotnet/api/System.IDisposable.Dispose) методы в конце обработки.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-168">Therefore, the .NET Framework class for a cmdlet that requires object cleanup should implement the complete  [System.IDisposable](/dotnet/api/System.IDisposable) interface pattern, including the finalizer, so that the Windows PowerShell runtime can call both the [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) and [System.IDisposable.Dispose\*](/dotnet/api/System.IDisposable.Dispose) methods at the end of processing.</span></span>

### <a name="use-serialization-friendly-parameter-types-ac05"></a><span data-ttu-id="a4cc8-169">Типы параметров пригодным к сериализации (AC05)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-169">Use Serialization-friendly Parameter Types (AC05)</span></span>

<span data-ttu-id="a4cc8-170">Для поддержки выполнения командлета на удаленных компьютерах, используйте типы, которые можно легко сериализовать на клиентском компьютере и затем восстановлен на компьютере сервера.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-170">To support running your cmdlet on remote computers, use types that can be easily serialized on the client computer and then rehydrated on the server computer.</span></span> <span data-ttu-id="a4cc8-171">Следующие типы, пригодным к сериализации.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-171">The follow types are serialization-friendly.</span></span>

<span data-ttu-id="a4cc8-172">Типы-примитивы:</span><span class="sxs-lookup"><span data-stu-id="a4cc8-172">Primitive types:</span></span>

- <span data-ttu-id="a4cc8-173">Byte, SByte, Decimal, Single, Double, Int16, Int32, Int64, Uint16, UInt32 и UInt64.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-173">Byte, SByte, Decimal, Single, Double, Int16, Int32, Int64, Uint16, UInt32, and UInt64.</span></span>

- <span data-ttu-id="a4cc8-174">Значение типа Boolean, Guid, Byte [], TimeSpan, даты и времени, Uri и версии.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-174">Boolean, Guid, Byte[], TimeSpan, DateTime, Uri, and Version.</span></span>

- <span data-ttu-id="a4cc8-175">Char, строка, XmlDocument.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-175">Char, String, XmlDocument.</span></span>

<span data-ttu-id="a4cc8-176">Встроенные типы rehydratable:</span><span class="sxs-lookup"><span data-stu-id="a4cc8-176">Built-in rehydratable types:</span></span>

- <span data-ttu-id="a4cc8-177">PSPrimitiveDictionary</span><span class="sxs-lookup"><span data-stu-id="a4cc8-177">PSPrimitiveDictionary</span></span>

- <span data-ttu-id="a4cc8-178">Переключатель</span><span class="sxs-lookup"><span data-stu-id="a4cc8-178">SwitchParameter</span></span>

- <span data-ttu-id="a4cc8-179">PSListModifier</span><span class="sxs-lookup"><span data-stu-id="a4cc8-179">PSListModifier</span></span>

- <span data-ttu-id="a4cc8-180">PSCredential</span><span class="sxs-lookup"><span data-stu-id="a4cc8-180">PSCredential</span></span>

- <span data-ttu-id="a4cc8-181">IP-адрес, MailAddress</span><span class="sxs-lookup"><span data-stu-id="a4cc8-181">IPAddress, MailAddress</span></span>

- <span data-ttu-id="a4cc8-182">CultureInfo</span><span class="sxs-lookup"><span data-stu-id="a4cc8-182">CultureInfo</span></span>

- <span data-ttu-id="a4cc8-183">X509Certificate2, X500DistinguishedName</span><span class="sxs-lookup"><span data-stu-id="a4cc8-183">X509Certificate2, X500DistinguishedName</span></span>

- <span data-ttu-id="a4cc8-184">RegistrySecurity DirectorySecurity FileSecurity,</span><span class="sxs-lookup"><span data-stu-id="a4cc8-184">DirectorySecurity, FileSecurity, RegistrySecurity</span></span>

<span data-ttu-id="a4cc8-185">Другие типы:</span><span class="sxs-lookup"><span data-stu-id="a4cc8-185">Other types:</span></span>

- <span data-ttu-id="a4cc8-186">SecureString</span><span class="sxs-lookup"><span data-stu-id="a4cc8-186">SecureString</span></span>

- <span data-ttu-id="a4cc8-187">Контейнеры (списки и словари указанного выше типа)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-187">Containers (lists and dictionaries of the above type)</span></span>

### <a name="use-securestring-for-sensitive-data-ac06"></a><span data-ttu-id="a4cc8-188">Используйте SecureString для конфиденциальных данных (AC06)</span><span class="sxs-lookup"><span data-stu-id="a4cc8-188">Use SecureString for Sensitive Data (AC06)</span></span>

<span data-ttu-id="a4cc8-189">При обработке конфиденциальных данных, всегда используйте [System.Security.Securestring](/dotnet/api/System.Security.SecureString) тип данных.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-189">When handling sensitive data always use the [System.Security.Securestring](/dotnet/api/System.Security.SecureString) data type.</span></span> <span data-ttu-id="a4cc8-190">Это может включать входные данные конвейера для параметров, а также возврат конфиденциальные данные в конвейер.</span><span class="sxs-lookup"><span data-stu-id="a4cc8-190">This could include pipeline input to parameters, as well as returning sensitive data to the pipeline.</span></span>

## <a name="see-also"></a><span data-ttu-id="a4cc8-191">См. также</span><span class="sxs-lookup"><span data-stu-id="a4cc8-191">See Also</span></span>

[<span data-ttu-id="a4cc8-192">Рекомендации по разработке требуется</span><span class="sxs-lookup"><span data-stu-id="a4cc8-192">Required Development Guidelines</span></span>](./required-development-guidelines.md)

[<span data-ttu-id="a4cc8-193">Рекомендации по разработке настоятельно рекомендуется</span><span class="sxs-lookup"><span data-stu-id="a4cc8-193">Strongly Encouraged Development Guidelines</span></span>](./strongly-encouraged-development-guidelines.md)

[<span data-ttu-id="a4cc8-194">Запись командлета Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a4cc8-194">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
