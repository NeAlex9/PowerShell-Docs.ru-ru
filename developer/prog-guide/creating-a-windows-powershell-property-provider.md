---
title: Создание поставщика Windows PowerShell свойства | Документация Майкрософт
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- property providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], property provider
ms.assetid: a6adca44-b94b-4103-9970-a9b414355e60
caps.latest.revision: 5
ms.openlocfilehash: 6ec0752a9ae06c5c2cdd1a1851caeeff52d8eb74
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62081841"
---
# <a name="creating-a-windows-powershell-property-provider"></a><span data-ttu-id="f93e7-102">Создание поставщика свойств Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f93e7-102">Creating a Windows PowerShell Property Provider</span></span>

<span data-ttu-id="f93e7-103">В этом разделе описывается, как создать поставщик, который позволяет пользователю управлять свойств элементов в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="f93e7-103">This topic describes how to create a provider that enables the user to manipulate the properties of items in a data store.</span></span> <span data-ttu-id="f93e7-104">Как следствие этот тип поставщиков называется поставщика свойства Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f93e7-104">As a consequence, this type of provider is referred to as a Windows PowerShell property provider.</span></span> <span data-ttu-id="f93e7-105">Например поставщик реестра предоставляемые значения раздела реестра Windows PowerShell обрабатывает как свойства элемента ключа реестра.</span><span class="sxs-lookup"><span data-stu-id="f93e7-105">For example, the Registry provider provided by Windows PowerShell handles registry key values as properties of the registry key item.</span></span> <span data-ttu-id="f93e7-106">Необходимо добавить этот тип поставщиков [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) интерфейс для реализации класса .NET.</span><span class="sxs-lookup"><span data-stu-id="f93e7-106">This type of provider must add the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface to the implementation of the .NET class.</span></span>

> [!NOTE]
> <span data-ttu-id="f93e7-107">Windows PowerShell предоставляет файл шаблона, который можно использовать для разработки поставщика Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f93e7-107">Windows PowerShell provides a template file that you can use to develop a Windows PowerShell provider.</span></span> <span data-ttu-id="f93e7-108">Файл TemplateProvider.cs можно найти в Microsoft Windows программное обеспечение Development Kit для Windows Vista и компоненты среды выполнения .NET Framework 3.0.</span><span class="sxs-lookup"><span data-stu-id="f93e7-108">The TemplateProvider.cs file is available on the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="f93e7-109">Инструкции по загрузке см. в разделе [как установка Windows PowerShell и загрузки пакета SDK для Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="f93e7-109">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="f93e7-110">Скачанный шаблон доступен в  **\<примеры PowerShell >** каталога.</span><span class="sxs-lookup"><span data-stu-id="f93e7-110">The downloaded template is available in the **\<PowerShell Samples>** directory.</span></span> <span data-ttu-id="f93e7-111">Следует создать копию этого файла и используйте ее для создания нового поставщика Windows PowerShell, удаляя любые функции, которые не требуется.</span><span class="sxs-lookup"><span data-stu-id="f93e7-111">You should make a copy of this file and use the copy for creating a new Windows PowerShell provider, removing any functionality that you do not need.</span></span>
>
> <span data-ttu-id="f93e7-112">Дополнительные сведения о других реализаций поставщика Windows PowerShell, см. в разделе [проектирование ваш поставщик PowerShell Windows](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="f93e7-112">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

> [!CAUTION]
> <span data-ttu-id="f93e7-113">Методы класса поставщика свойства должен записывать все объекты, с помощью [System.Management.Automation.Provider.Cmdletprovider.Writepropertyobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject) метод.</span><span class="sxs-lookup"><span data-stu-id="f93e7-113">The methods of your property provider should write any objects using the [System.Management.Automation.Provider.Cmdletprovider.Writepropertyobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject) method.</span></span>

<span data-ttu-id="f93e7-114">Ниже перечислены подразделы этого раздела.</span><span class="sxs-lookup"><span data-stu-id="f93e7-114">The following list contains the sections in this topic.</span></span> <span data-ttu-id="f93e7-115">Если вы не знакомы с записью поставщика свойства Windows PowerShell, прочтите эти сведения, в том порядке, в котором она появляется.</span><span class="sxs-lookup"><span data-stu-id="f93e7-115">If you are unfamiliar with writing a Windows PowerShell property provider, read this information in the order that it appears.</span></span> <span data-ttu-id="f93e7-116">Тем не менее если вы знакомы с записью поставщика свойства Windows PowerShell, перейдите непосредственно к сведениям, вам потребуется.</span><span class="sxs-lookup"><span data-stu-id="f93e7-116">However, if you are familiar with writing a Windows PowerShell property provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="f93e7-117">Определение поставщика Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f93e7-117">Defining the Windows PowerShell Provider</span></span>](#Defining-the-Windows-PowerShell-provider)

- [<span data-ttu-id="f93e7-118">Определение базовой функциональности</span><span class="sxs-lookup"><span data-stu-id="f93e7-118">Defining Base Functionality</span></span>](#Defining-Base-Functionality)

- [<span data-ttu-id="f93e7-119">Получение свойств</span><span class="sxs-lookup"><span data-stu-id="f93e7-119">Retrieving Properties</span></span>](#Retrieving-Properties)

- [<span data-ttu-id="f93e7-120">Присоединение динамических параметров в `Get-ItemProperty` командлета</span><span class="sxs-lookup"><span data-stu-id="f93e7-120">Attaching Dynamic Parameters to the `Get-ItemProperty` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Get-ItemProperty-Cmdlet)

- [<span data-ttu-id="f93e7-121">Настройка свойств</span><span class="sxs-lookup"><span data-stu-id="f93e7-121">Setting Properties</span></span>](#Setting-Properties)

- [<span data-ttu-id="f93e7-122">Присоединение динамических параметров в `Set-ItemProperty` командлета</span><span class="sxs-lookup"><span data-stu-id="f93e7-122">Attaching Dynamic Parameters to the `Set-ItemProperty` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-for-the-Set-ItemProperty-Cmdlet)

- [<span data-ttu-id="f93e7-123">Очистка свойства</span><span class="sxs-lookup"><span data-stu-id="f93e7-123">Clearing a Property</span></span>](#Clearing-Properties)

- [<span data-ttu-id="f93e7-124">Присоединение динамических параметров в `Clear-ItemProperty` командлета</span><span class="sxs-lookup"><span data-stu-id="f93e7-124">Attaching Dynamic Parameters to the `Clear-ItemProperty` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Clear-ItemProperty-Cmdlet)

- [<span data-ttu-id="f93e7-125">Создание поставщика Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f93e7-125">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-provider)

## <a name="defining-the-windows-powershell-provider"></a><span data-ttu-id="f93e7-126">Определение поставщика Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f93e7-126">Defining the Windows PowerShell provider</span></span>

<span data-ttu-id="f93e7-127">Поставщик свойств необходимо создать класс .NET, который поддерживает [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) интерфейс.</span><span class="sxs-lookup"><span data-stu-id="f93e7-127">A property provider must create a .NET class that supports the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface.</span></span> <span data-ttu-id="f93e7-128">Ниже приведено объявление класса по умолчанию из файла TemplateProvider.cs, предоставляемые Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f93e7-128">Here is the default class declaration from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration](Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration)]  -->

## <a name="defining-base-functionality"></a><span data-ttu-id="f93e7-129">Определение базовой функциональности</span><span class="sxs-lookup"><span data-stu-id="f93e7-129">Defining Base Functionality</span></span>

<span data-ttu-id="f93e7-130">[System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) интерфейс может быть подключен к любой из базовых классов поставщика, за исключением элемента [ System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) класса.</span><span class="sxs-lookup"><span data-stu-id="f93e7-130">The [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface can be attached to any of the provider base classes, with the exception of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class.</span></span> <span data-ttu-id="f93e7-131">Добавьте базовые функциональные возможности, которые требуются для базового класса, который вы используете.</span><span class="sxs-lookup"><span data-stu-id="f93e7-131">Add the base functionality that is required by the base class you are using.</span></span> <span data-ttu-id="f93e7-132">Дополнительные сведения о базовых классов, см. в разделе [проектирование ваш поставщик PowerShell Windows](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="f93e7-132">For more information about base classes, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

## <a name="retrieving-properties"></a><span data-ttu-id="f93e7-133">Получение свойств</span><span class="sxs-lookup"><span data-stu-id="f93e7-133">Retrieving Properties</span></span>

<span data-ttu-id="f93e7-134">Для получения свойств, поставщик должен реализовывать [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) метод для поддержки вызовов из `Get-ItemProperty` командлета.</span><span class="sxs-lookup"><span data-stu-id="f93e7-134">To retrieve properties, the provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method to support calls from the `Get-ItemProperty` cmdlet.</span></span> <span data-ttu-id="f93e7-135">Этот метод извлекает свойства элемент, расположенный по указанному пути поставщика внутренней (полное).</span><span class="sxs-lookup"><span data-stu-id="f93e7-135">This method retrieves the properties of the item located at the specified provider-internal path (fully-qualified).</span></span>

<span data-ttu-id="f93e7-136">`providerSpecificPickList` Параметр указывает, какие свойства следует извлечь.</span><span class="sxs-lookup"><span data-stu-id="f93e7-136">The `providerSpecificPickList` parameter indicates which properties to retrieve.</span></span> <span data-ttu-id="f93e7-137">Если этот параметр имеет `null` или пустое, метод должен извлечь все свойства.</span><span class="sxs-lookup"><span data-stu-id="f93e7-137">If this parameter is `null` or empty, the method should retrieve all properties.</span></span> <span data-ttu-id="f93e7-138">Кроме того [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) записывает экземпляр [System.Management.Automation.PSObject](/dotnet/api/System.Management.Automation.PSObject) , представляющий контейнер свойств, полученных свойств.</span><span class="sxs-lookup"><span data-stu-id="f93e7-138">In addition, [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) writes an instance of a [System.Management.Automation.PSObject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the retrieved properties.</span></span> <span data-ttu-id="f93e7-139">Метод должен вернуть nothing.</span><span class="sxs-lookup"><span data-stu-id="f93e7-139">The method should return nothing.</span></span>

<span data-ttu-id="f93e7-140">Рекомендуется реализация [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) поддерживает развертывание знаков подстановки имен свойств для каждого элемента в списке выбора.</span><span class="sxs-lookup"><span data-stu-id="f93e7-140">It is recommended that the implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) supports the wildcard expansion of property names for each element in the pick list.</span></span> <span data-ttu-id="f93e7-141">Чтобы сделать это, используйте [System.Management.Automation.Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern) Чтобы выполнить сопоставление по шаблону.</span><span class="sxs-lookup"><span data-stu-id="f93e7-141">To do this, use the [System.Management.Automation.Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern) class to perform the wildcard pattern matching.</span></span>

<span data-ttu-id="f93e7-142">Вот реализация по умолчанию [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) из файла TemplateProvider.cs, предоставляемые Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f93e7-142">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty)]  -->

#### <a name="things-to-remember-about-implementing-getproperty"></a><span data-ttu-id="f93e7-143">О чем следует помнить о реализации GetProperty</span><span class="sxs-lookup"><span data-stu-id="f93e7-143">Things to Remember About Implementing GetProperty</span></span>

<span data-ttu-id="f93e7-144">Следующие условия могут относиться к реализации [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty):</span><span class="sxs-lookup"><span data-stu-id="f93e7-144">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty):</span></span>

- <span data-ttu-id="f93e7-145">При определении класса поставщика, поставщика свойства Windows PowerShell может объявлять возможностей поставщика ExpandWildcards фильтра, Include и Exclude, из [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) перечисления.</span><span class="sxs-lookup"><span data-stu-id="f93e7-145">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="f93e7-146">В этих случаях реализация [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) метод должен соответствовать требованиям указанного пути, передаваемые методу возможности.</span><span class="sxs-lookup"><span data-stu-id="f93e7-146">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="f93e7-147">Чтобы сделать это, метод должен получить доступ к соответствующее свойство, например, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) и [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) свойства.</span><span class="sxs-lookup"><span data-stu-id="f93e7-147">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="f93e7-148">По умолчанию переопределения этого метода не следует получить средство чтения для объектов, которые скрыты от пользователя, если не [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) свойству `true`.</span><span class="sxs-lookup"><span data-stu-id="f93e7-148">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="f93e7-149">Ошибка должны записываться, если путь представляет элемент, который является скрытым от пользователя и [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) присваивается `false`.</span><span class="sxs-lookup"><span data-stu-id="f93e7-149">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-itemproperty-cmdlet"></a><span data-ttu-id="f93e7-150">Присоединение динамических параметров в командлет Get-ItemProperty</span><span class="sxs-lookup"><span data-stu-id="f93e7-150">Attaching Dynamic Parameters to the Get-ItemProperty Cmdlet</span></span>

<span data-ttu-id="f93e7-151">`Get-ItemProperty` Командлета может потребоваться дополнительные параметры, заданные динамически во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="f93e7-151">The `Get-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="f93e7-152">Для обеспечения этих динамических параметров, необходимо реализовать свойство поставщика Windows PowerShell [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) метод.</span><span class="sxs-lookup"><span data-stu-id="f93e7-152">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="f93e7-153">`path` Задаёт полный поставщик внутреннего пути, хотя `providerSpecificPickList` параметр указывает поставщика свойства, введенные в командной строке.</span><span class="sxs-lookup"><span data-stu-id="f93e7-153">The `path` parameter indicates a fully-qualified provider-internal path, while the `providerSpecificPickList` parameter specifies the provider-specific properties entered on the command line.</span></span> <span data-ttu-id="f93e7-154">Этот параметр может быть `null` или пусто, если свойства передаются по конвейеру в командлет.</span><span class="sxs-lookup"><span data-stu-id="f93e7-154">This parameter might be `null` or empty if the properties are piped to the cmdlet.</span></span> <span data-ttu-id="f93e7-155">В этом случае этот метод возвращает объект, имеющий свойства и поля с разбор атрибутов, аналогично классу командлета или [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) объекта.</span><span class="sxs-lookup"><span data-stu-id="f93e7-155">In this case, this method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="f93e7-156">Среда выполнения Windows PowerShell использует возвращенный объект для добавления параметров в командлет.</span><span class="sxs-lookup"><span data-stu-id="f93e7-156">The Windows PowerShell runtime uses the returned object to add the parameters to the cmdlet.</span></span>

<span data-ttu-id="f93e7-157">Вот реализация по умолчанию [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) из файла TemplateProvider.cs, предоставляемые Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f93e7-157">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters)]  -->

## <a name="setting-properties"></a><span data-ttu-id="f93e7-158">Настройка свойств</span><span class="sxs-lookup"><span data-stu-id="f93e7-158">Setting Properties</span></span>

<span data-ttu-id="f93e7-159">Чтобы задать свойства, необходимо реализовать свойство поставщика Windows PowerShell [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) метод для поддержки вызовов из `Set-ItemProperty` командлета.</span><span class="sxs-lookup"><span data-stu-id="f93e7-159">To set properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method to support calls from the `Set-ItemProperty` cmdlet.</span></span> <span data-ttu-id="f93e7-160">Этот метод задает одно или несколько свойств элемента по указанному пути и перезаписывает предоставленного свойства при необходимости.</span><span class="sxs-lookup"><span data-stu-id="f93e7-160">This method sets one or more properties of the item at the specified path, and overwrites the supplied properties as required.</span></span> <span data-ttu-id="f93e7-161">[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) также записывает экземпляр [System.Management.Automation.PSObject](/dotnet/api/System.Management.Automation.PSObject) , представляющий контейнер, обновленный свойства.</span><span class="sxs-lookup"><span data-stu-id="f93e7-161">[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) also writes an instance of a [System.Management.Automation.PSObject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the updated properties.</span></span>

<span data-ttu-id="f93e7-162">Вот реализация по умолчанию [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) из файла TemplateProvider.cs, предоставляемые Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f93e7-162">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty)]  -->

#### <a name="things-to-remember-about-implementing-set-itemproperty"></a><span data-ttu-id="f93e7-163">О чем следует помнить о реализации Set-ItemProperty</span><span class="sxs-lookup"><span data-stu-id="f93e7-163">Things to Remember About Implementing Set-ItemProperty</span></span>

<span data-ttu-id="f93e7-164">Следующие условия могут применяться к реализации [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty):</span><span class="sxs-lookup"><span data-stu-id="f93e7-164">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty):</span></span>

- <span data-ttu-id="f93e7-165">При определении класса поставщика, поставщика свойства Windows PowerShell может объявлять возможностей поставщика ExpandWildcards фильтра, Include и Exclude, из [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) перечисления.</span><span class="sxs-lookup"><span data-stu-id="f93e7-165">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="f93e7-166">В этих случаях реализация [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) метода необходимо убедиться, что путь, переданный в метод соответствует требованиям указанного возможности.</span><span class="sxs-lookup"><span data-stu-id="f93e7-166">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="f93e7-167">Чтобы сделать это, метод должен получить доступ к соответствующее свойство, например, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) и [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) свойства.</span><span class="sxs-lookup"><span data-stu-id="f93e7-167">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="f93e7-168">По умолчанию переопределения этого метода не следует получить средство чтения для объектов, которые скрыты от пользователя, если не [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) свойству `true`.</span><span class="sxs-lookup"><span data-stu-id="f93e7-168">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="f93e7-169">Ошибка должны записываться, если путь представляет элемент, который является скрытым от пользователя и [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) присваивается `false`.</span><span class="sxs-lookup"><span data-stu-id="f93e7-169">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="f93e7-170">Реализация [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) метод должен вызывать [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) и проверьте его возвращаемое значение перед внесением любых изменений в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="f93e7-170">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="f93e7-171">Этот метод используется для подтверждения выполнения операции, при изменении состояния системы, например, переименование файлов.</span><span class="sxs-lookup"><span data-stu-id="f93e7-171">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span> <span data-ttu-id="f93e7-172">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) отправляет имя ресурса, необходимо изменить на пользователя, со средой Windows PowerShell и обработка параметров командной строки и привилегированных переменных при определении что должно быть отображено.</span><span class="sxs-lookup"><span data-stu-id="f93e7-172">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime and handling any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="f93e7-173">После вызова [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) возвращает `true`, если можно модифицировать потенциально опасных системы, [ System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) метод должен вызывать [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) метод.</span><span class="sxs-lookup"><span data-stu-id="f93e7-173">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="f93e7-174">Этот метод отправляет сообщение с подтверждением пользователю, чтобы разрешить дополнительный отзыв указать, что операция должна быть продолжено.</span><span class="sxs-lookup"><span data-stu-id="f93e7-174">This method sends a confirmation message to the user to allow additional feedback to indicate that the operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-for-the-set-itemproperty-cmdlet"></a><span data-ttu-id="f93e7-175">Присоединение динамических параметров для командлета Set-ItemProperty</span><span class="sxs-lookup"><span data-stu-id="f93e7-175">Attaching Dynamic Parameters for the Set-ItemProperty Cmdlet</span></span>

<span data-ttu-id="f93e7-176">`Set-ItemProperty` Командлета может потребоваться дополнительные параметры, заданные динамически во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="f93e7-176">The `Set-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="f93e7-177">Для обеспечения этих динамических параметров, необходимо реализовать свойство поставщика Windows PowerShell [System.Management.Automation.Provider.Ipropertycmdletprovider.Setpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters) метод.</span><span class="sxs-lookup"><span data-stu-id="f93e7-177">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="f93e7-178">Этот метод возвращает объект, имеющий свойства и поля с разбор атрибутов, аналогично классу командлета или [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) объекта.</span><span class="sxs-lookup"><span data-stu-id="f93e7-178">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="f93e7-179">`null` Значения могут быть возвращены, если нет динамических параметров, должны быть добавлены.</span><span class="sxs-lookup"><span data-stu-id="f93e7-179">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="f93e7-180">Вот реализация по умолчанию [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) из файла TemplateProvider.cs, предоставляемые Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f93e7-180">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters)]  -->

## <a name="clearing-properties"></a><span data-ttu-id="f93e7-181">Удаление свойства</span><span class="sxs-lookup"><span data-stu-id="f93e7-181">Clearing Properties</span></span>

<span data-ttu-id="f93e7-182">Чтобы очистить свойства, необходимо реализовать свойство поставщика Windows PowerShell [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) метод для поддержки вызовов из `Clear-ItemProperty` командлета.</span><span class="sxs-lookup"><span data-stu-id="f93e7-182">To clear properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method to support calls from the `Clear-ItemProperty` cmdlet.</span></span> <span data-ttu-id="f93e7-183">Этот метод задает одно или несколько свойств для элемент, расположенный по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="f93e7-183">This method sets one or more properties for the item located at the specified path.</span></span>

<span data-ttu-id="f93e7-184">Вот реализация по умолчанию [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) из файла TemplateProvider.cs, предоставляемые Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f93e7-184">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty](Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty)]  -->

#### <a name="thing-to-remember-about-implementing-clearproperty"></a><span data-ttu-id="f93e7-185">Следует помнить о реализации ClearProperty</span><span class="sxs-lookup"><span data-stu-id="f93e7-185">Thing to Remember About Implementing ClearProperty</span></span>

<span data-ttu-id="f93e7-186">Следующие условия могут относиться к реализации [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty):</span><span class="sxs-lookup"><span data-stu-id="f93e7-186">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty):</span></span>

- <span data-ttu-id="f93e7-187">При определении класса поставщика, поставщика свойства Windows PowerShell может объявлять возможностей поставщика ExpandWildcards фильтра, Include и Exclude, из [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) перечисления.</span><span class="sxs-lookup"><span data-stu-id="f93e7-187">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="f93e7-188">В этих случаях реализация [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) метод должен соответствовать требованиям указанного пути, передаваемые методу возможности.</span><span class="sxs-lookup"><span data-stu-id="f93e7-188">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="f93e7-189">Чтобы сделать это, метод должен получить доступ к соответствующее свойство, например, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) и [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) свойства.</span><span class="sxs-lookup"><span data-stu-id="f93e7-189">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="f93e7-190">По умолчанию переопределения этого метода не следует получить средство чтения для объектов, которые скрыты от пользователя, если не [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) свойству `true`.</span><span class="sxs-lookup"><span data-stu-id="f93e7-190">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="f93e7-191">Ошибка должны записываться, если путь представляет элемент, который является скрытым от пользователя и [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) присваивается `false`.</span><span class="sxs-lookup"><span data-stu-id="f93e7-191">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="f93e7-192">Реализация [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) метод должен вызывать [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess ](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) и проверьте его возвращаемое значение перед внесением любых изменений в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="f93e7-192">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="f93e7-193">Этот метод используется для подтверждения выполнения операции, перед изменении состояния системы, таких как очистка содержимого.</span><span class="sxs-lookup"><span data-stu-id="f93e7-193">This method is used to confirm execution of an operation before a change is made to system state, such as clearing content.</span></span> <span data-ttu-id="f93e7-194">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) отправляет имя ресурса, необходимо изменить на пользователя, в среде выполнения Windows PowerShell, принимая во внимание любые параметры командной строки или привилегированных переменных в Определяет, что должно быть отображено.</span><span class="sxs-lookup"><span data-stu-id="f93e7-194">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="f93e7-195">После вызова [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) возвращает `true`, если можно модифицировать потенциально опасных системы, [ System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) метод должен вызывать [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) метод.</span><span class="sxs-lookup"><span data-stu-id="f93e7-195">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="f93e7-196">Этот метод отправляет сообщение с подтверждением пользователю, чтобы разрешить дополнительный отзыв указать, что потенциально опасные операции должно быть продолжено.</span><span class="sxs-lookup"><span data-stu-id="f93e7-196">This method sends a confirmation message to the user to allow additional feedback to indicate that the potentially dangerous operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-to-the-clear-itemproperty-cmdlet"></a><span data-ttu-id="f93e7-197">Присоединение динамических параметров в командлет Clear-ItemProperty</span><span class="sxs-lookup"><span data-stu-id="f93e7-197">Attaching Dynamic Parameters to the Clear-ItemProperty Cmdlet</span></span>

<span data-ttu-id="f93e7-198">`Clear-ItemProperty` Командлета может потребоваться дополнительные параметры, заданные динамически во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="f93e7-198">The `Clear-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="f93e7-199">Для обеспечения этих динамических параметров, необходимо реализовать свойство поставщика Windows PowerShell [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) метод.</span><span class="sxs-lookup"><span data-stu-id="f93e7-199">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) method.</span></span> <span data-ttu-id="f93e7-200">Этот метод возвращает объект, имеющий свойства и поля с разбор атрибутов, аналогично классу командлета или [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) объекта.</span><span class="sxs-lookup"><span data-stu-id="f93e7-200">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="f93e7-201">`null` Значения могут быть возвращены, если нет динамических параметров, должны быть добавлены.</span><span class="sxs-lookup"><span data-stu-id="f93e7-201">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="f93e7-202">Вот реализация по умолчанию [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) из файла TemplateProvider.cs, предоставляемые Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f93e7-202">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters)]  -->

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="f93e7-203">Создание поставщика Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f93e7-203">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="f93e7-204">См. в разделе [регистрация командлетов, поставщиков и размещения приложений](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="f93e7-204">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="see-also"></a><span data-ttu-id="f93e7-205">См. также</span><span class="sxs-lookup"><span data-stu-id="f93e7-205">See Also</span></span>

[<span data-ttu-id="f93e7-206">Поставщик Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f93e7-206">Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="f93e7-207">Поставщик разработки Your Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f93e7-207">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="f93e7-208">Расширение типов объектов и форматирование</span><span class="sxs-lookup"><span data-stu-id="f93e7-208">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="f93e7-209">Регистрация командлетов, поставщиков и ведущих приложений</span><span class="sxs-lookup"><span data-stu-id="f93e7-209">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)