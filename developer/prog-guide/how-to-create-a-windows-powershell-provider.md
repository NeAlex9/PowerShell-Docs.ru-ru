---
title: Создание поставщика Windows PowerShell | Документация Майкрософт
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- providers [PowerShell Programmer's Guide]
- providers [PowerShellProgrammer's Guide], creating
- Windows PowerShell Programmer's Guide, providers
ms.assetid: 863e48e9-7206-4c6a-a59a-2ab2d30396bc
caps.latest.revision: 5
ms.openlocfilehash: ffbf8028ba2b52e77d8e22c061baa9b8b67f6da3
ms.sourcegitcommit: 4a2cf30351620a58ba95ff5d76b247e601907589
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2019
ms.locfileid: "71323074"
---
# <a name="how-to-create-a-windows-powershell-provider"></a><span data-ttu-id="08321-102">Как создать поставщика Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="08321-102">How to Create a Windows PowerShell Provider</span></span>

<span data-ttu-id="08321-103">В этом разделе описывается создание поставщика Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="08321-103">This section describes how to build a Windows PowerShell provider.</span></span> <span data-ttu-id="08321-104">Поставщик Windows PowerShell можно рассматривать двумя способами.</span><span class="sxs-lookup"><span data-stu-id="08321-104">A Windows PowerShell provider can be considered in two ways.</span></span> <span data-ttu-id="08321-105">Для пользователя поставщик представляет набор сохраненных данных.</span><span class="sxs-lookup"><span data-stu-id="08321-105">To the user, the provider represents a set of stored data.</span></span> <span data-ttu-id="08321-106">Например, хранимые данные могут быть метабазой службы IIS (IIS), реестром Microsoft Windows, файловой системой Windows, Active Directory, а также переменными и псевдонимами данных, хранящимися в Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="08321-106">For example, the stored data can be the Internet Information Services (IIS) Metabase, the Microsoft Windows Registry, the Windows file system, Active Directory, and the variable and alias data stored by Windows PowerShell.</span></span>

<span data-ttu-id="08321-107">Для разработчика поставщик Windows PowerShell является интерфейсом между пользователем и данными, к которым ему необходим доступ.</span><span class="sxs-lookup"><span data-stu-id="08321-107">To the developer, the Windows PowerShell provider is the interface between the user and the data that the user needs to access.</span></span> <span data-ttu-id="08321-108">С этой точки зрения каждый тип поставщика, описанный в этом разделе, поддерживает набор определенных базовых классов и интерфейсов, позволяющих среде выполнения Windows PowerShell предоставлять пользователю определенные командлеты обычным способом.</span><span class="sxs-lookup"><span data-stu-id="08321-108">From this perspective, each type of provider described in this section supports a set of specific base classes and interfaces that allow the Windows PowerShell runtime to expose certain cmdlets to the user in a common way.</span></span>

## <a name="providers-provided-by-windows-powershell"></a><span data-ttu-id="08321-109">Поставщики, предоставляемые Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="08321-109">Providers Provided by Windows PowerShell</span></span>

<span data-ttu-id="08321-110">Windows PowerShell предоставляет несколько поставщиков (таких как Поставщик FileSystem, поставщик реестра и поставщик псевдонимов), которые используются для доступа к известным хранилищам данных.</span><span class="sxs-lookup"><span data-stu-id="08321-110">Windows PowerShell provides several providers (such as the FileSystem provider, Registry provider, and Alias provider) that are used to access known data stores.</span></span> <span data-ttu-id="08321-111">Для получения дополнительных сведений о поставщиках, предоставляемых Windows PowerShell, используйте следующую команду для доступа к справке в Интернете:</span><span class="sxs-lookup"><span data-stu-id="08321-111">For more information about the providers supplied by Windows PowerShell, use the following command to access online Help:</span></span>

<span data-ttu-id="08321-112">**PS > Get-Help about_Providers**</span><span class="sxs-lookup"><span data-stu-id="08321-112">**PS>get-help about_providers**</span></span>

## <a name="accessing-the-stored-data-using-windows-powershell-paths"></a><span data-ttu-id="08321-113">Доступ к сохраненным данным с помощью путей Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="08321-113">Accessing the Stored Data Using Windows PowerShell Paths</span></span>

<span data-ttu-id="08321-114">Поставщики Windows PowerShell доступны для среды выполнения Windows PowerShell и для команд программным способом с помощью путей Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="08321-114">Windows PowerShell providers are accessible to the Windows PowerShell runtime and to commands programmatically through the use of Windows PowerShell paths.</span></span> <span data-ttu-id="08321-115">В большинстве случаев эти пути используются для прямого доступа к данным через поставщика.</span><span class="sxs-lookup"><span data-stu-id="08321-115">Most of the time, these paths are used to directly access the data through the provider.</span></span> <span data-ttu-id="08321-116">Однако некоторые пути могут быть разрешены в внутренние пути, которые позволяют командлету использовать для доступа к данным не Windows PowerShell интерфейсы программирования (API).</span><span class="sxs-lookup"><span data-stu-id="08321-116">However, some paths can be resolved to provider-internal paths that allow a cmdlet to use non-Windows PowerShell application programming interfaces (APIs) to access the data.</span></span> <span data-ttu-id="08321-117">Дополнительные сведения о работе поставщиков Windows PowerShell в Windows PowerShell см. в разделе [как работает Windows](https://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58)PowerShell.</span><span class="sxs-lookup"><span data-stu-id="08321-117">For more information about how Windows PowerShell providers operate within Windows PowerShell, see [How Windows PowerShell Works](https://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58).</span></span>

## <a name="exposing-provider-cmdlets-using-windows-powershell-drives"></a><span data-ttu-id="08321-118">Предоставление командлетов поставщика с помощью дисков Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="08321-118">Exposing Provider Cmdlets Using Windows PowerShell Drives</span></span>

<span data-ttu-id="08321-119">Поставщик Windows PowerShell предоставляет свои поддерживаемые командлеты с помощью виртуальных дисков Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="08321-119">A Windows PowerShell provider exposes its supported cmdlets using virtual Windows PowerShell drives.</span></span> <span data-ttu-id="08321-120">Windows PowerShell применяет следующие правила для диска Windows PowerShell:</span><span class="sxs-lookup"><span data-stu-id="08321-120">Windows PowerShell applies the following rules for a Windows PowerShell drive:</span></span>

- <span data-ttu-id="08321-121">Имя диска может быть любой буквенно-цифровой последовательности.</span><span class="sxs-lookup"><span data-stu-id="08321-121">The name of a drive can be any alphanumeric sequence.</span></span>

- <span data-ttu-id="08321-122">Диск может быть указан в любой допустимой точке пути, называемой "root".</span><span class="sxs-lookup"><span data-stu-id="08321-122">A drive can be specified at any valid point on a path, called a "root".</span></span>

- <span data-ttu-id="08321-123">Диск может быть реализован для любых хранимых данных, а не только для файловой системы.</span><span class="sxs-lookup"><span data-stu-id="08321-123">A drive can be implemented for any stored data, not just the file system.</span></span>

- <span data-ttu-id="08321-124">Каждый диск сохраняет свое текущее рабочее расположение, позволяя пользователю сохранять контекст при сдвиге между дисками.</span><span class="sxs-lookup"><span data-stu-id="08321-124">Each drive keeps its own current working location, allowing the user to retain context when shifting between drives.</span></span>

## <a name="in-this-section"></a><span data-ttu-id="08321-125">в этом разделе</span><span class="sxs-lookup"><span data-stu-id="08321-125">In This Section</span></span>

<span data-ttu-id="08321-126">В следующей таблице перечислены разделы, в которых содержатся примеры кода, построенные друг от друга.</span><span class="sxs-lookup"><span data-stu-id="08321-126">The following table lists topics that include code examples that build on each other.</span></span> <span data-ttu-id="08321-127">Начиная со второго раздела, базовый поставщик Windows PowerShell можно инициализировать и деинициализировать с помощью среды выполнения Windows PowerShell. в следующем разделе добавляется функция для доступа к данным, а в следующем разделе добавляются функции для манипулирования данными ( элементы в сохраненных данных) и т. д.</span><span class="sxs-lookup"><span data-stu-id="08321-127">Starting with the second topic, the basic Windows PowerShell provider can be initialized and uninitialized by the Windows PowerShell runtime, the next topic adds functionality for accessing the data, the next topic adds functionality for manipulating the data (the items in the stored data), and so on.</span></span>

|<span data-ttu-id="08321-128">Раздел</span><span class="sxs-lookup"><span data-stu-id="08321-128">Topic</span></span>|<span data-ttu-id="08321-129">Определение</span><span class="sxs-lookup"><span data-stu-id="08321-129">Definition</span></span>|
|-----------|----------------|
|[<span data-ttu-id="08321-130">Разработка поставщика Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="08321-130">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)|<span data-ttu-id="08321-131">В этом разделе обсуждаются вещи, которые следует учитывать перед реализацией поставщика Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="08321-131">This topic discusses things you should consider before implementing a Windows PowerShell provider.</span></span> <span data-ttu-id="08321-132">В нем перечислены базовые классы и интерфейсы поставщика Windows PowerShell, которые используются.</span><span class="sxs-lookup"><span data-stu-id="08321-132">It summarizes the Windows PowerShell provider base classes and interfaces that are used.</span></span>|
|[<span data-ttu-id="08321-133">Создание базового поставщика Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="08321-133">Creating a Basic Windows PowerShell Provider</span></span>](./creating-a-basic-windows-powershell-provider.md)|<span data-ttu-id="08321-134">В этом разделе показано, как создать поставщик Windows PowerShell, позволяющий среде выполнения Windows PowerShell инициализировать и деинициализировать поставщик.</span><span class="sxs-lookup"><span data-stu-id="08321-134">This topic shows how to create a Windows PowerShell provider that allows the Windows PowerShell runtime to initialize and uninitialize the provider.</span></span>|
|[<span data-ttu-id="08321-135">Создание поставщика диска Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="08321-135">Creating a Windows PowerShell Drive Provider</span></span>](./creating-a-windows-powershell-drive-provider.md)|<span data-ttu-id="08321-136">В этом разделе показано, как создать поставщик Windows PowerShell, позволяющий пользователю обращаться к хранилищу данных через диск Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="08321-136">This topic shows how to create a Windows PowerShell provider that allows the user to access a data store through a Windows PowerShell drive.</span></span>|
|[<span data-ttu-id="08321-137">Создание поставщика элементов Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="08321-137">Creating a Windows PowerShell Item Provider</span></span>](./creating-a-windows-powershell-item-provider.md)|<span data-ttu-id="08321-138">В этом разделе показано, как создать поставщик Windows PowerShell, позволяющий пользователю управлять элементами в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="08321-138">This topic shows how to create a Windows PowerShell provider that allows the user to manipulate the items in a data store.</span></span>|
|[<span data-ttu-id="08321-139">Создание поставщика контейнера Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="08321-139">Creating a Windows PowerShell Container Provider</span></span>](./creating-a-windows-powershell-container-provider.md)|<span data-ttu-id="08321-140">В этом разделе показано, как создать поставщик Windows PowerShell, позволяющий пользователю работать с многослойными хранилищами данных.</span><span class="sxs-lookup"><span data-stu-id="08321-140">This topic shows how to create a Windows PowerShell provider that allows the user to work on multilayer data stores.</span></span>|
|[<span data-ttu-id="08321-141">Создание поставщика навигации Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="08321-141">Creating a Windows PowerShell Navigation Provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)|<span data-ttu-id="08321-142">В этом разделе показано, как создать поставщик Windows PowerShell, позволяющий пользователю перемещаться по элементам хранилища данных иерархически.</span><span class="sxs-lookup"><span data-stu-id="08321-142">This topic shows how to create a Windows PowerShell provider that allows the user to navigate the items of a data store in a hierarchical manner.</span></span>|
|[<span data-ttu-id="08321-143">Создание поставщика содержимого Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="08321-143">Creating a Windows PowerShell Content Provider</span></span>](./creating-a-windows-powershell-content-provider.md)|<span data-ttu-id="08321-144">В этом разделе показано, как создать поставщик Windows PowerShell, позволяющий пользователю управлять содержимым элементов в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="08321-144">This topic shows how to create a Windows PowerShell provider that allows the user to manipulate the content of items in a data store.</span></span>|
|[<span data-ttu-id="08321-145">Создание поставщика свойств Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="08321-145">Creating a Windows PowerShell Property Provider</span></span>](./creating-a-windows-powershell-property-provider.md)|<span data-ttu-id="08321-146">В этом разделе показано, как создать поставщик Windows PowerShell, позволяющий пользователю управлять свойствами элементов в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="08321-146">This topic shows how to create a Windows PowerShell provider that allows the user to manipulate the properties of items in a data store.</span></span>|

## <a name="see-also"></a><span data-ttu-id="08321-147">См. также</span><span class="sxs-lookup"><span data-stu-id="08321-147">See Also</span></span>

[<span data-ttu-id="08321-148">Как работает Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="08321-148">How Windows PowerShell Works</span></span>](https://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58)

[<span data-ttu-id="08321-149">Пакет SDK для Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="08321-149">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="08321-150">Руководством программиста Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="08321-150">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)
