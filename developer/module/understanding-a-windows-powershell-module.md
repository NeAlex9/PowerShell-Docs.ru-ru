---
title: Основные сведения о модуле Windows PowerShell | Документация Майкрософт
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: d4e38235-9987-4347-afd2-0f7d1dc8f64a
caps.latest.revision: 19
ms.openlocfilehash: 77d328bc1cb8cb42d5a10f107a149c05ab270ce3
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/03/2019
ms.locfileid: "56862740"
---
# <a name="understanding-a-windows-powershell-module"></a>Общие сведения о модулях Windows PowerShell

Объект *модуль* представляет собой набор связанных функциональных возможностей Windows PowerShell, сгруппированных как единое удобный (обычно сохранены в одном каталоге). Путем определения набора файлов связанных скриптов, сборки и связанные ресурсы, как модуль, можно ссылаться, загрузки, сохранения и совместного использования кода гораздо проще, чем вы бы в противном случае.

Основная цель модуля разрешено модульность (т. е, повторного использования и абстракции) кода Windows PowerShell. Например самый простой способ создания модуля является просто сохраните скрипт Windows PowerShell с расширением .psm1. Это позволит к элементу управления (т. е, сделать общедоступным или частным) функции и переменные, содержащимся в скрипте. Сохранение скрипта в файле с расширением psm1 также позволяет управлять областью действия определенных переменных. Наконец, можно также использовать командлеты такие как [Install-Module](/powershell/module/PowershellGet/Install-Module) для организации, установить и использовать сценарий в качестве стандартных блоков для больших решений.

## <a name="module-components-and-types"></a>Модуль компонентов и типы

Модуль состоит из четырех основных компонентов:

1. Некоторые сортировки файла кода — обычно является сборкой управляемого командлет или сценарий PowerShell.

2. Все, что может указанного выше файла кода например дополнительных сборок, помогают файлы или сценарии.

3. Файл манифеста, который описывает перечисленных выше файлов, а также хранит метаданные, такие как автор и управления версиями...

4. Каталог, содержащий все выше содержимое, а находится где PowerShell достаточно найти его.

   Обратите внимание на то, что ни один из этих компонентов, сами по себе не действительно необходимы. Например модуль с технической точки зрения может быть только скрипт находится в файле с расширением psm1. Также возможно модуль, который представляет файл манифеста, который используется главным образом в целях упорядочения. Можно также написать сценарий, который динамически создает модуль и таким образом не нужен каталог для хранения любого элемента в. В следующих разделах описаны типы модулей, которые можно получить комбинировать их вместе различные части модуля.

### <a name="script-modules"></a>Модули сценариев

Как и предполагает название, *модуль сценария* является файл (psm1), содержащий любой допустимый код Windows PowerShell. Скрипт разработчики и Администраторы могут использовать этот тип модуля для создания модулей, члены которого включают функции, переменные и многое другое. Дело в том модуль сценария — просто сценарий Windows PowerShell с другим расширением, что позволяет администраторам использовать функции импорта, экспорта и управления на нем.

Кроме того можно использовать файл манифеста для включения других ресурсов в модуле, например файлы данных, другие зависимые модули или среды выполнения скриптов. Файлы манифеста также полезны для отслеживания метаданные, такие как сведения о разработке и управления версиями.

Наконец модуль сценария, как и любой другой модуль, который не создается динамически, необходимо сохранить в папке, которая может достаточно обнаруживать PowerShell. Как правило это на путь к модулю PowerShell; но при необходимости вы можете явно описать установки вашего модуля. Дополнительные сведения см. в разделе [как написать модуль сценария PowerShell](./how-to-write-a-powershell-script-module.md).

### <a name="binary-modules"></a>Двоичные модули

Объект *двоичного модуля* является сборкой .NET Framework (.dll), которая содержит скомпилированный код, например C#. Командлет разработчики могут использовать этот тип модуля для совместного использования командлетов, поставщиков и многое другое. (Существующие оснасток можно также использовать как двоичные модули.) По сравнению с модуль сценария, двоичный модуль позволяет создавать командлеты, которые работают быстрее, или воспользоваться функциями (например, многопоточность), которые не так же просто, в код в сценариях Windows PowerShell.

Как с помощью модулей сценариев, можно включить файл манифеста для описания дополнительные ресурсы, используемые в модуле, а также отслеживать метаданные о модуле. Аналогичным образом возможно, следует установить двоичного модуля в папке, где-нибудь вдоль пути к модулю PowerShell. Дополнительные сведения см. в разделе Практическое [способы написания двоичного модуля PowerShell](./how-to-write-a-powershell-binary-module.md).

### <a name="manifest-modules"></a>Модули манифестов

Объект *манифеста модуля* является модулем, который использует файл манифеста для описания всех компонентов, но не имеет каких-либо основной сборкой или сценария. (Формально, оставляет манифеста модуля `ModuleToProcess` или `RootModule` пустой манифеста.) Тем не менее можно по-прежнему использовать другие возможности модуля, например возможность загрузить зависимые сборки или автоматического выполнения определенных сценариев предварительной обработки. Модуль манифеста может использоваться как легко упаковать ресурсы, которые будут использовать другие модули, например вложенные модули, сборки, типы или форматы. Дополнительные сведения см. в разделе [как написание манифеста модуля PowerShell](./how-to-write-a-powershell-module-manifest.md).

### <a name="dynamic-modules"></a>Динамические модули

Объект *динамический модуль* модуль не загружен из, или при сохранении в файл. Вместо этого они создаются динамически с помощью сценария с помощью [New-Module](/powershell/module/Microsoft.PowerShell.Core/New-Module) командлета. Этот тип модуля позволяет скрипт создать модуль по запросу, не нужно загружать и сохранять в постоянное хранилище. По своей природе предназначен Краткосрочный характер динамический модуль и таким образом, может быть недоступна для `Get-Module` командлета. Аналогичным образом они требуют манифестах модуля, а также сделать они скорее всего, потребуется постоянное папки для хранения их связанные сборки.

## <a name="module-manifests"></a>Манифестах модуля

Объект *манифеста модуля* представляет собой файл psd1, содержащий хэш-таблицу. Ключи и значения в хэш-таблице выполните следующие действия:

- Описывают содержимое и атрибуты модуля.

- Определяют необходимые условия.

- Определите, как обрабатываются компоненты.

  Манифесты не являются необходимыми элементами модулей. Модули можно ссылаться на файлы сценариев (ps1), файлов модуля сценариев (psm1-файлы), файлы манифеста (psd1), форматирование и введите файлы (ps1xml), командлетов и поставщиков сборки (DLL-файл), файлы ресурсов, файлы справки, файлы локализации или любого другого файла или ресурса, входит в пакет как часть модуля. Международные скрипт папка модуля также содержит набор файлов каталога сообщений. При добавлении файла манифеста в папке модуля, можно ссылаться несколько файлов как единое целое, указывающие на манифест.

  Манифест сам описаны следующие категории сведений.

- Метаданные о модуле, например номер версии модуля, автор и описание.

- Компоненты, необходимые для импорта модуля, например версии Windows PowerShell, в версии среды выполнения (CLR) и необходимые модули.

- Директивы обработки, таких как сценарии, форматы и типы для обработки.

- Ограничения на элементы модуля, который нужно экспортировать, например псевдонимы, функции, переменные и командлеты для экспорта.

  Дополнительные сведения см. в разделе [как написание манифеста модуля PowerShell](./how-to-write-a-powershell-module-manifest.md).

## <a name="storing-and-installing-a-module"></a>Хранение и установка модуля

После создания скрипта, binary или манифеста модуля, можно сохранить работу в расположении, что другие могут получить доступ. Например модуль могут храниться в папке системы, где установлен Windows PowerShell, или могут храниться в папке пользователя.

Вообще говоря, можно определить, где следует установить модуль с помощью одного из путей, хранящиеся в `$ENV:PSModulePath` переменной. С помощью одного из этих путей означает, что PowerShell автоматически для поиска и загрузки модуля, когда пользователь делает вызов к нему в своем коде. При сохранении модуля где-то еще, можно явно разрешить PowerShell знать, передав расположение вашего модуля в виде параметра при вызове `Install-Module`.

Независимо от того, путь к папке называется *базового* модуля (ModuleBase), и имя сценария, binary или манифеста модуля файл должен быть совпадает с именем папки модуля, за исключением следующих случаев:

- Динамические модули, созданные `New-Module` командлета можно присваивать имена на `Name` параметр командлета.

- Модули, импортированные из объекты сборки по  **`Import-Module` -сборки** команда именуются в соответствии со следующим синтаксисом: `"dynamic_code_module_" + assembly.GetName()`.

  Дополнительные сведения см. в разделе [Установка модуля PowerShell](./installing-a-powershell-module.md) и [изменении пути установки PSModulePath](./modifying-the-psmodulepath-installation-path.md).

## <a name="module-cmdlets-and-variables"></a>Командлеты модуля и переменные

Следующие командлеты и переменные предоставляются Windows PowerShell для создания и управления модулями.

[Новый модуль](/powershell/module/Microsoft.PowerShell.Core/New-Module) командлет этот командлет создает новый динамический модуль, который существует только в памяти. Модуль создается на основе блок сценария и его экспортированных элементов, например его функции и переменные, сразу же доступны в рамках сеанса и остаются доступными, пока не будет закрыт сеанс.

[Новый-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) командлет этот командлет создает новый файл манифеста модуля (psd1), заполняет его значения и сохраняет файл манифеста по указанному пути. Этот командлет может также использоваться для создания шаблона манифеста модуля, который можно заполнить вручную.

[Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) командлет этот командлет добавляет один или несколько модулей в текущий сеанс.

[Get-Module](/powershell/module/Microsoft.PowerShell.Core/Get-Module) командлет этот командлет извлекает сведения о модулях, которые были или могут быть импортированы в текущий сеанс.

[Export-ModuleMember](/powershell/module/Microsoft.PowerShell.Core/Export-ModuleMember) командлет этот командлет задает элементы модуля (например, командлеты, функции, переменные и псевдонимы), экспортируемые из файла модуля (psm1-файлы) скрипта или из динамического модуля, созданного с помощью `New-Module` командлета.

[Remove-Module](/powershell/module/Microsoft.PowerShell.Core/Remove-Module) командлет этот командлет удаляет модули из текущего сеанса.

[Test-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/Test-ModuleManifest) командлет, этот командлет проверяет, точно ли описывает манифест модуля компонентов модуля, проверяя, что файлы, которые перечислены в файле манифеста модуля (.psd1) фактически существуют по указанным путям.

$PSScriptRoot эта переменная содержит каталог, из которого выполняется модуль скрипта. Это позволяет сценариям использовать путь к модулю для доступа к другим ресурсам.

$env: PSModulePath эта переменная среды содержит список каталогов, в которых Windows PowerShell хранятся модули. Windows PowerShell использует значения этой переменной, при импорте модулей автоматически и обновление разделов справки по модулям.

## <a name="see-also"></a>См. также

[Написание модуля Windows PowerShell](./writing-a-windows-powershell-module.md)
