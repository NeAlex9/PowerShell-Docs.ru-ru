---
title: Справочник по PowerShell Windows - новые возможности
ms.date: 09/13/2016
ms.topic: article
ms.openlocfilehash: 364d081ddf2f87ceeaa47732266a35f4a126246f
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/03/2019
ms.locfileid: "56858550"
---
# <a name="whats-new"></a>Новые возможности

Windows PowerShell 2.0 предоставляет следующие новые функции для использования при написании командлетов, поставщиков и хост-приложений.

## <a name="modules"></a>Модули

Теперь можно упаковать и распространения решений Windows PowerShell с помощью модулей. Модули позволяют создавать секции, упорядочивать и абстрагировать код Windows PowerShell в автономной и многократно используемых единиц. Дополнительные сведения о модулях см. в разделе Написание модуля Windows PowerShell.

## <a name="the-powershell-class"></a>Класс PowerShell

Класс PowerShell обеспечивает более простое решение для создания приложений, называется хост-приложения, которые программное выполнение команды. Этот класс позволяет создать конвейер команд, укажите пространству выполнения, который используется для выполнения команд и укажите вызова команды синхронно или асинхронно.

## <a name="the-runspacepool-class"></a>Класс RunspacePool

Пулов пространства выполнения можно создавать несколькими средами с помощью одного вызова. Метод CreateRunspacePool предоставляет несколько перегрузок, которые можно использовать для создания пространства выполнения, который имеет те же функции, такие как том же узле, начальное состояние сеанса и сведения о соединении.

## <a name="the-initialsessionstate-class"></a>Класс InitialSessionState

Класс InitialSessionState позволяет создавать конфигурации состояния сеанса, который используется при открытии пространства выполнения. Можно создать пользовательскую конфигурацию, конфигурации по умолчанию, содержащих команды, предоставляемые mshshort и конфигурации, команды которого ограничены на основе возможностей сеанса.

## <a name="remote-runspaces"></a>Удаленного пространства выполнения

Теперь можно создавать пространства выполнения, который можно открыть на удаленных компьютерах, что позволяет выполнять команды на удаленном компьютере и собирать результаты локально. Чтобы создать в удаленном пространстве выполнения, необходимо указать сведения о подключении к удаленному при создании пространства выполнения. См. также методы CreateRunspace и CreateRunspacePool, примеры. Сведения о соединении определяется классом RunspaceConnectionInfo.

## <a name="private-runspace-elements"></a>Элементы пространства выполнения Private

Теперь можно создавать пространства выполнения, элементы которого являются общедоступными или частными. Это позволяет создавать пространства выполнения, элементы которого доступны к пространству выполнения, но недоступны для пользователя. Чтобы узнать, какие элементы пространства выполнения может быть личными ConstrainedSessionStateEntry см.

## <a name="runspace-threading-modes-and-apartment-state"></a>Пространства выполнения, режимы и состояние подразделения работы с потоками

Теперь можно указать, каким образом создаются и используются при выполнении команд в пространстве выполнения потоков. См. в разделе свойства System.Management.Automation.Runspaces.Runspace.ThreadOptions и System.Management.Automation.Runspaces.RunspacePool.ThreadOptions.

Теперь можно получить состояние подразделения потоков, которые используются для выполнения команд в пространстве выполнения. См. в разделе свойства System.Management.Automation.Runspaces.Runspace.ApartmentState и System.Management.Automation.Runspaces.RunspacePool.ApartmentState.

## <a name="transaction-cmdlets"></a>Командлеты Transaction

Теперь можно создавать командлеты, которые можно использовать в рамках транзакции. При использовании командлета в транзакции, его действий являются временными и их можно принять или отклонить с помощью командлетов транзакции, предоставляемые Windows PowerShell.

Дополнительные сведения о транзакциях см. в разделе Практическое поддерживает транзакции.

## <a name="transaction-provider"></a>Поставщик транзакции

Теперь можно создать поставщики, которые могут использоваться в рамках транзакции. Как и командлеты, при использовании поставщика в транзакции, его действий являются временными и их можно принять или отклонить с помощью командлетов транзакции, предоставляемые Windows PowerShell.

Дополнительные сведения об указании поддержка транзакций в пределах класса поставщика см. в разделе свойство System.Management.Automation.Provider.CmdletProviderAttribute.ProviderCapabilities.

## <a name="job-cmdlets"></a>Командлеты заданий

Теперь можно писать командлеты, которые можно выполнять свои действия в виде задания. Эти задания выполняются в фоновом режиме без взаимодействия с текущим сеансом. Дополнительные сведения о том, как Windows PowerShell поддерживает задания см. в разделе фоновых заданий.

## <a name="cmdlet-output-types"></a>Типы выходных данных командлета

Теперь можно указать типы .NET Framework, возвращаемые командлетов путем объявления атрибута OutputType при написании командлетов. Это позволит определить, какие типы объектов возвращаются командлетом, просмотрев свойство OutputType командлета.

## <a name="event-support"></a>Поддержка событий

Теперь можно писать командлеты, добавления и удаления событий. См. Описание класса PSEvent.

## <a name="proxy-commands"></a>Команды прокси-сервера

Теперь можно написать команды прокси-сервера, которые могут использоваться для запуска другой команды. Прокси-команды, позволяет контролировать, какие функциональные возможности командлета источник доступен для пользователя. Например можно создать команду прокси-сервера, которая удаляет параметр, который предоставляется с помощью источника команды. См. Описание класса ProxyCommand.

## <a name="multiple-choice-prompts"></a>Несколько вариантов выбора строки

Теперь можно написать приложения, которые могут предоставлять подсказок, которые позволяют пользователю выбирать несколько вариантов. См. в разделе интерфейса IHostUISupportsMultipleChoiceSelection

## <a name="interactive-sessions"></a>Интерактивные сеансы

Теперь можно писать приложения, которые можно запускать и останавливать интерактивный сеанс на удаленном компьютере.
См. в разделе интерфейса IHostSupportsInteractiveSession.

## <a name="custom-cmdlet-help-for-providers"></a>Справка пользовательского командлета для поставщиков

Теперь можно создать настраиваемые разделы справки по командлетам поставщика. Разделы справки по командлетам пользовательских смогут объяснить, как командлет работает в поставщик путь и документа специальных возможностей, включая динамические параметры, которые поставщик добавляет в командлет.
