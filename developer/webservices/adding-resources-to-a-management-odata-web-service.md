---
title: Добавление ресурсов в OData веб-службы управления | Документация Майкрософт
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: e620bf6d-76be-47b0-a7a8-f43418f30c60
caps.latest.revision: 6
ms.openlocfilehash: b81a32b867795ae51c3f5308c2f82c31ed2747fa
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62080787"
---
# <a name="adding-resources-to-a-management-odata-web-service"></a>Добавление ресурсов в веб-службу управления OData

В этом примере демонстрируется добавление ресурса к существующей веб-службы OData для управления с помощью конструктора схемы управления OData. [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) пример создает веб-службы, предоставляющий ресурсы процесса и сервер. В этом примере вы добавите ресурс виртуальной машины (VM) в веб-службу.

## <a name="prerequisites"></a>Необходимые компоненты

В этом разделе предполагается, что вы загрузили и установили [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) пример, как описано в разделе [веб-службы Windows PowerShell](./creating-a-management-odata-web-service.md), и, загрузка и установка завершена [Конструктор схем OData управления](https://marketplace.visualstudio.com/items?itemName=jlisc0.ManagementODataSchemaDesigner). В этом разделе также предполагается, что у вас есть модуль Windows PowerShell Hyper-V, установленных на компьютере, предназначенный для настройки конечной точки Odata для управления.

## <a name="adding-vm-as-a-resource-to-the-web-service"></a>Добавление виртуальной Машины в качестве ресурса в веб-службу

Первым делом для импорта схемы из существующей конечной точки OData для управления в конструктор схем. Ниже описано, как это сделать.

#### <a name="importing-an-existing-schema-into-the-schema-designer"></a>Импорт существующей схемы в конструктор схем

1. Откройте конструктор схем OData управления.

2. Из **файл** меню, выберите **файл** ; **Новый** ; **Файл**. **Новый файл** откроется диалоговое окно.

3. Нажмите кнопку **модель управления OData**, а затем нажмите кнопку **откройте**.

4. Щелкните правой кнопкой мыши в главном окне и нажмите кнопку **файл схемы** ; **Импорта**. **Откройте** откроется диалоговое окно.

5. Перейдите к папке, предназначенный для настройки веб-службы OData для управления [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) образца. Если вы использовали сценарий Windows PowerShell, в состав этого образца для настройки конечной точки без изменения сценария, эту папку является **C:\inetpub\wwwroot\Modata**. Выберите Schema.mof и нажмите кнопку **откройте**.

   На этом этапе открыть файлы Schema.mof и Schema.xml в текстовом редакторе и обратите внимание на то, что они содержат сопоставления для процесса и службы ресурсов. Schema.MOF-файл использует [Distributed Management Task Force](https://www.dmtf.org/) standard (DTMF) управляемого объекта (MOF). Файл schema.xml использует схему XML, описанной в [схема сопоставления ресурсов](./resource-mapping-schema.md).

   Следующая процедура описывается импорт командлетов Hyper-V в для модели схемы.

#### <a name="importing-cmdlets-into-the-schema"></a>Импорт командлетов в схеме

1. Щелкните правой кнопкой мыши на пустую область окна конструктора схемы и нажмите кнопку **командлеты импорта**. **Мастер импорта командлета** откроется диалоговое окно.

2. Убедитесь, что **локального компьютера** выбран и нажмите кнопку **Далее**.

3. Убедитесь, что выбран установленных модулей Windows PowerShell и выберите в раскрывающемся списке Hyper-V. Нажмите кнопку **Далее**. Нажмите кнопку **Далее**.

4. В **существительное командлет** выберите **виртуальной Машины**. Нажмите кнопку **Далее**.

5. В этом примере будет создана привязка только команды Get и Delete с командлетами. Очистить **создать** и **обновление** флажки и убедитесь, что **получить** и **удалить** проверяются флажки. Убедитесь, что `Get-VM` командлет выбран для **получить**и `Remove-VM` командлет выбран для **удалить**.

6. Поскольку метаданные для виртуальной Машины командлеты не содержит тип выходных данных, необходимо выполнить командлет, чтобы указать тип выходных данных. Выберите **укажите тип выходных данных** и нажмите кнопку **выполните командлет**. **Запустить командлет** откроется диалоговое окно. Нажмите кнопку **Запустить**. **Тип CLR** заполнится `VirtualMachine` типа. Нажмите кнопку **ОК**, затем нажмите кнопку **Далее**.

7. По умолчанию выбраны все свойства объекта VirtualMachine. Вы можете очистить все свойства, которые вы не хотите как часть данных, возвращаемых при запросе к ресурсу веб-службы. Нажмите кнопку **Далее**.

8. Необходимо выбрать хотя бы одно свойство для использования в качестве ключа. Выберите **имя** в списке, а также выберите **Далее**.

9. Следующее окно позволяет сопоставить свойства OData для управления ресурса к свойствам базовых командлетов. Мастер сопоставляет свойства с одинаковыми именами по умолчанию. Например `ComputerName` сопоставляется свойство ресурса `ComputerName` свойство командлетов.  Это позволяет указать `ComputerName` свойство в запросе к веб-службе и передается значение, указываемое `Get-VM` командлета. `Id` и `Name` также сопоставляются по умолчанию.

   10. Нажмите кнопку **Далее**, затем нажмите кнопку **Готово**.

       Ресурс виртуальной Машины появится в окне конструктора схемы. Можно просмотреть свойства и операции, связанные с ресурсом. После этого вы экспортируете Обновленная схема файлы в виртуальный каталог для веб-службы.

#### <a name="exporting-schema-files-from-the-schema-designer"></a>Экспорт файлов схемы из конструктора схем

1. Щелкните правой кнопкой мыши на пустую область окна конструктора схемы и нажмите кнопку **файл схемы** ; **Экспорт**. **Сохранить как** откроется диалоговое окно.

2. Перейдите в тот же каталог, из которой импортируется MOF-файл. Имя файла, так же, как исходный файл MOF (Schema.mof по умолчанию) и нажмите кнопку **Сохранить**. Убедитесь, что вы хотите перезаписать существующий файл.

   Несмотря на то, что она не указана явным образом в **Сохранить как** диалоговое окно, этот параметр заменяет файлы Schema.mof и Schema.xml.

## <a name="next-steps"></a>Дальнейшие действия

Новый ресурс виртуальной Машины доступ из веб-службы OData для управления, необходимо обновить файл RbacConfiguration.xml, чтобы разрешить доступ к модуль Windows PowerShell Hyper-V, как описано в разделе [авторизации на основе ролей, Настройка](./configuring-role-based-authorization.md), а также необходимо будет перезапустить веб-службу.